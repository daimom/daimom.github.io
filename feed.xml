<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:base="https://daimom.github.io">
    <title>åº¦ä¼°ç­†è¨˜æœ¬</title>
    <link href="https://daimom.github.io/feed.xml" rel="self" />
    <link href="https://daimom.github.io" />
    <updated>2025-07-08T10:28:18Z</updated>
    <id>https://daimom.github.io</id>
        <entry>
            <title>
                91. elasticsearch ingest processorè£œå……
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/91. elasticsearch ingest processorè£œå……/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;è£œå……ingest çš„ processor&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä¸Šç¯‡æåˆ°ï¼Œæ­£å¸¸è¦ç­‰ILMè·‘å®Œå¾Œï¼Œæ‰€è¨­å®šçš„default_pipelineæ‰æœƒå¯«å…¥ã€‚&lt;br /&gt;
ä½†ä»Šå¤©æ˜¯å¯ä»¥ææ—©è®“ä»–è·‘ILMï¼Œé€™æ¨£å°±æœƒæŠŠé è¨­çš„default_pipelineå¯«é€²å»äº†ã€‚&lt;/p&gt;
&lt;p&gt;è€Œåªè¦åœ¨default_pipeline è¨­å®šå¥½ï¼Œå¾ŒçºŒå†æ”¹pipelineçš„è¨­å®šæ™‚ï¼Œéƒ½æœƒç›´æ¥å½±éŸ¿ç•¶ä¸‹çš„è¨­å®šã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨index templateè¨­å®špipeline&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/90-fig.10.jpg&quot; alt=&quot;90-fig.10.jpg&quot; /&gt;&lt;/li&gt;
&lt;li&gt;åˆ° Devtools åŸ·è¡Œä¸‹é¢æŒ‡ä»¤&lt;br /&gt;
å¼·åˆ¶datastreamåŸ·è¡ŒILM&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;POST /filebeat-8.1.0/_rollover
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/data-streams.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;DataStream&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://www.gushiciku.cn/pl/gtvK/zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Elasticsearch 7.X data stream æ·±å…¥è©³è§£&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;ingest&quot; tabindex=&quot;-1&quot;&gt;ingest è£œå……&lt;/h1&gt;
&lt;p&gt;processoråˆ†æˆå¥½å¹¾å€‹é¡å‹&lt;/p&gt;
&lt;p&gt;ä¸Šä¸€ç¯‡æ˜¯ä½¿ç”¨grok(é€™å€‹æ˜¯ä½¿ç”¨æ­£å‰‡å»ç¯©é¸å­—ä¸²)ï¼Œ&lt;br /&gt;
æœ‰äººå»ºè­°ä½¿ç”¨Dissectï¼Œé€Ÿåº¦æ¯”grokå¿«ï¼Œä½†åªé©ç”¨æ–¼æœ‰å›ºå®šåˆ†éš”å­—ä¸²çš„messageã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ç°¡å–®æ•˜è¿°ç”¨é€”ï¼Œè©³ç´°å°±é»é€£çµéå»çœ‹äº†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/append-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Append&lt;/a&gt;&lt;br /&gt;
åœ¨ç¾æœ‰çš„å­—ä¸²å…§å¢åŠ å€¼&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/bytes-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Bytes&lt;/a&gt;&lt;br /&gt;
æŠŠç©ºé–“è¨ˆç®—æ–¹å¼(kb,mb,gb...)è½‰æˆbyte&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/ingest-circle-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Circle&lt;/a&gt;&lt;br /&gt;
æŠŠåœ“å½¢è½‰çˆ²è¿‘ä¼¼ä»–å€‘çš„è¦å‰‡å¤šé‚Šå½¢ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“é€™èƒ½åšå•¥ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/community-id-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Community ID&lt;/a&gt;&lt;br /&gt;
è¨ˆç®—ç¶²è·¯è³‡æ–™æµçš„idï¼Œèƒ½é€éæ­¤idé—œè¯ç›¸é—œçš„ç¶²è·¯äº‹ä»¶&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/convert-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Convert&lt;/a&gt;&lt;br /&gt;
å°‡æ¬„ä½å…§å®¹è½‰çˆ²integerã€longã€floatã€doubleã€stringã€booleanã€ip&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/csv-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;CSV&lt;/a&gt;&lt;br /&gt;
å°‡æ¬„ä½ä¸­çš„çš„è³‡æ–™ç•¶ä½œcsvå»è¾¨åˆ¥&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/date-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Date&lt;/a&gt;&lt;br /&gt;
å°‡æ¬„ä½å…§å®¹è½‰çˆ²æ—¥æœŸæ ¼å¼&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/date-index-name-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Date index name&lt;/a&gt;&lt;br /&gt;
å°‡æ—¥æœŸå–å‡ºä½œçˆ²indexçš„åç¨±&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/dissect-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Dissect&lt;/a&gt;&lt;br /&gt;
èˆ‡grokç›¸ä¼¼ï¼Œä½†ä¸ä½¿ç”¨æ­£å‰‡ä½œçˆ²çµæ§‹åŒ–æ¬„ä½&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/dot-expand-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Dot expander&lt;/a&gt;&lt;br /&gt;
æœƒå°‡ . è¦–çˆ²ä¸€å€‹ç‰©ä»¶çš„åç¨±ï¼Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;  foo.bar :value
  foo : { 
	bar: value
  }
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/drop-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Drop&lt;/a&gt;&lt;br /&gt;
æ ¹æ“šæ¢ä»¶åˆªé™¤document&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/enrich-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Enrich&lt;/a&gt;&lt;br /&gt;
æ ¹æ“šæ¬„ä½è¦å‰‡ï¼Œè‡ªå‹•æ–°å¢è³‡æ–™&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/fail-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Fail&lt;/a&gt;&lt;br /&gt;
ç•¶éŒ¯èª¤æ™‚ï¼Œå‚³é€è¨Šæ¯&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/fingerprint-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Fingerprint&lt;/a&gt;&lt;br /&gt;
è¨ˆç®—documentçš„hashå€¼&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/foreach-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Foreach&lt;/a&gt;&lt;br /&gt;
ç•¶å…ƒç´ æ•¸é‡ä¸ç¢ºå®šæ™‚ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/geoip-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GeoIP&lt;/a&gt;&lt;br /&gt;
æ ¹æ“šåœ°ç†ä½ç½®æä¾›æ›´å¤šè³‡è¨Š&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/grok-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Grok&lt;/a&gt;&lt;br /&gt;
å¾documentä¸­æˆªå–çµæ§‹åŒ–çš„å­—ä¸²å‡ºä¾†(æ­£å‰‡)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/gsub-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Gsub&lt;/a&gt;&lt;br /&gt;
ä½¿ç”¨æ­£å‰‡æˆ–å–ä»£ä¾†è½‰æ›å­—ä¸²&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/htmlstrip-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;HTML strip&lt;/a&gt;&lt;br /&gt;
å¾æ¬„ä½ä¸­ç§»é™¤htmlçš„tag&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/inference-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Inference&lt;/a&gt;&lt;br /&gt;
Uses a pre-trained data frame analytics model to infer against the data that is being ingested in the pipeline.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/join-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Join&lt;/a&gt;&lt;br /&gt;
å°‡æ¬„ä½ä¸­çš„arrayå€¼ç”¨åˆ†éš”ç¬¦ä¸²èµ·ä¾†&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/json-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;JSON&lt;/a&gt;&lt;br /&gt;
å°‡jsonå­—ä¸²è½‰æˆjsonæ ¼å¼&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/kv-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;KV&lt;/a&gt;&lt;br /&gt;
æŒ‡å®šæ¬„ä½è‡ªå‹•è§£æè¨Šæ¯&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/lowercase-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Lowercase&lt;/a&gt;&lt;br /&gt;
å°‡å­—ä¸²è½‰æˆå°å¯«&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/network-direction-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Network direction&lt;/a&gt;&lt;br /&gt;
æ ¹æ“šä¾†æºIPåŠç›®çš„IPè¨ˆç®—æ˜¯ inboundæˆ– outbonud&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/pipeline-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Pipeline&lt;/a&gt;&lt;br /&gt;
åœ¨pipelineå…§åŸ·è¡Œå…¶ä»–çš„pipeline&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/registered-domain-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Registered domain&lt;/a&gt;&lt;br /&gt;
è§£ædomainï¼Œå€åˆ†å‡º sub-doaminã€top-level domain&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/remove-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Remove&lt;/a&gt;&lt;br /&gt;
ç§»é™¤æ¬„ä½&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/rename-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Rename&lt;/a&gt;&lt;br /&gt;
æ›´æ”¹æ¬„ä½åç¨±&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/script-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Script&lt;/a&gt;&lt;br /&gt;
åŸ·è¡Œscript&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/set-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Set&lt;/a&gt;&lt;br /&gt;
æŒ‡ä»¤æ¬„ä½å¯«å€¼&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/ingest-node-set-security-user-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Set security user&lt;/a&gt;&lt;br /&gt;
é€šéé è™•ç†ç¨‹åºï¼Œå¾ç›®å‰é©—è­‰çš„ä½¿ç”¨è€…æˆªå–è³‡æ–™&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/sort-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Sort&lt;/a&gt;&lt;br /&gt;
å°æ¬„ä½å…§çš„arrayåšæ’åº&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/split-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Split&lt;/a&gt;&lt;br /&gt;
ä½¿ç”¨åˆ†éš”ç¬¦è™Ÿï¼Œå°‡å­—ä¸²åˆ‡æˆarray&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/trim-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Trim&lt;/a&gt;&lt;br /&gt;
ç§»é™¤æ¬„ä½ç©ºç™½&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/uppercase-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Uppercase&lt;/a&gt;&lt;br /&gt;
å°‡å­—ä¸²è½‰æˆå¤§å¯«&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/urldecode-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;URL decode&lt;/a&gt;&lt;br /&gt;
å°‡URLç¶²å€è§£ç¢¼&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/uri-parts-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;URI parts&lt;/a&gt;&lt;br /&gt;
å°‡URLè«‹æ±‚æ‹†é–‹æˆURI object&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/user-agent-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;User agent&lt;/a&gt;&lt;br /&gt;
è§£æuser_agent&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/91. elasticsearch ingest processorè£œå……/" />
        </entry>
        <entry>
            <title>
                90. elasticsearch ingest pipeline
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/90. elasticsearch ingest pipeline/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ç”¨filebeat è’é›† nginxçš„è³‡æ–™ï¼Œå–å¾—çš„Nginxè³‡æ–™æ²’å†ç¶“éåˆ†è§£ï¼Œ&lt;br /&gt;
å°è‡´æ²’è¾¦æ³•é‹ç”¨åœ¨efkä¸Šé¢ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/90-fig.1.jpg&quot; alt=&quot;90-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;ui&quot; tabindex=&quot;-1&quot;&gt;å…ˆç”¨UIè¬›è§£æ­¥é©Ÿã€‚&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…ˆä¾†çœ‹ä¸€ä¸‹nginxçš„messageï¼Œç„¶å¾Œå†åˆ†æè£¡é¢çš„æ¬„ä½&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;127.0.0.1 - - [06/May/2022:06:44:01 +0000] , http-host: &#92;&amp;quot;abc.boxing.com&#92;&amp;quot; , URL: &#92;&amp;quot;GET /static/tpl/analytics/index.html?v=51817715.1 HTTP/1.1&#92;&amp;quot;  , request-status : &#92;&amp;quot;200&#92;&amp;quot;  ,   body-byte: 0  ,http-referer: &#92;&amp;quot;https://abc.boxing.com/mobile&#92;&amp;quot;  ,user-agent: &#92;&amp;quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36&#92;&amp;quot; , X-Forwarded-For : &#92;&amp;quot;132.235.211.18,10.107.10.14&#92;&amp;quot; ,   request-time: &#92;&amp;quot;0.000&#92;&amp;quot;  , response_time : &#92;&amp;quot;-&#92;&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šçš„æ ¼å¼æœ‰ç‰¹åˆ¥å»èª¿æ•´éï¼Œè©³æƒ…å¯åƒè€ƒï¼Œ&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/56.%20GKE%E8%A8%98%E9%8C%84%20nginx%20log/&quot;&gt;56. GKEè¨˜éŒ„ nginx log&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;
&lt;p&gt;ingest pipeline&lt;br /&gt;
UIç•«é¢ï¼ŒStack Management -&amp;gt; Ingest Pipelines-&amp;gt; Create pipeline&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/90-fig.2.jpg&quot; alt=&quot;90-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Add a processor&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/90-fig.3.jpg&quot; alt=&quot;90-fig.3.jpg&quot; /&gt;&lt;br /&gt;
Processor ï¼š Grok&lt;br /&gt;
Field ï¼š message&lt;br /&gt;
patterns:&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;%{IPORHOST:nginx.source.ip} %{USER:nginx.user.id} %{USER:nginx.user.name} &#92;&#92;[%{HTTPDATE:nginx.@timestamp}&#92;&#92;] , http-host: &#92;&amp;quot;%{DATA:nginx.url.host}&#92;&amp;quot; , URL: &#92;&amp;quot;%{WORD:nginx.http.request.method} %{DATA:nginx.url.path} HTTP/%{NUMBER:nginx.http.version}&#92;&amp;quot;  , request-status : &#92;&amp;quot;%{NUMBER:nginx.http.response.status_code:int}&#92;&amp;quot;  ,   body-byte: %{NUMBER:nginx.http.response.body.bytes:int}  ,http-referer: &#92;&amp;quot;%{DATA:nginx.http.request.referer}&#92;&amp;quot;  ,user-agent: %{QS:nginx.user_agent} , X-Forwarded-For : &#92;&amp;quot;%{DATA:nginx.http.request.xff}&#92;&amp;quot; ,   request-time: &#92;&amp;quot;%{NUMBER:nginx.http.request.time}&#92;&amp;quot;  , response_time : &#92;&amp;quot;(?:-|%{NUMBER:nginx.http.request.time:int})&#92;&amp;quot;    
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤è™•çš„patternsæ˜¯ç¬¦åˆæˆ‘ä¸Šé¢(1)çš„è¨Šæ¯ï¼Œæ‰€ç”¢ç”Ÿçš„ã€‚&lt;/p&gt;
&lt;p&gt;ps. Grok Debugger è¨˜å¾—è¦8.1å¾Œæ‰æœ‰ï¼Œå¦‚æœç‰ˆæœ¬éä½ï¼Œå¯ä»¥åƒè€ƒä¸‹æ–¹ï¼Œç”¨DevToolsä¸‹æŒ‡ä»¤çš„æ–¹å¼é™¤éŒ¯ã€‚&lt;/p&gt;
&lt;p&gt;Grokç°¡å–®èªªï¼Œ&lt;/p&gt;
&lt;blockquote å‹æ…‹ï¼šè¦å­˜çš„æ¬„ä½åç¨±=&quot;&quot;&gt;
&lt;p&gt;%&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‹æ…‹æœ‰å“ªäº›ï¼Œåƒè€ƒé€£çµã€ grok-patternsã€&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/kibana/8.1/xpack-grokdebugger.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Grok Debugger&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/8.1/grok-processor.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Grok processor&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/grok.html#grok-syntax&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Grokking grok&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/elastic/elasticsearch/blob/master/libs/grok/src/main/resources/patterns/legacy/grok-patterns&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;grok-patterns&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;æ¸¬è©¦&lt;br /&gt;
å¯«å¥½äº†å¾Œï¼Œä¸æ¸¬è©¦ä¸€ä¸‹ä¹Ÿä¸çŸ¥é“æ˜¯å°æˆ–éŒ¯ï¼Œ&lt;br /&gt;
åˆ°æ–°å»ºçš„ç•«é¢ï¼Œå³é‚Šçš„ä¸­é–“ï¼Œæœ‰Add Documentçš„é¸é …ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/90-fig.4.jpg&quot; alt=&quot;90-fig.4.jpg&quot; /&gt;&lt;br /&gt;
ä¹‹å¾Œè¼¸å…¥è¦æ¸¬è©¦çš„ç¯„ä¾‹&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/90-fig.5.jpg&quot; alt=&quot;90-fig.5.jpg&quot; /&gt;&lt;br /&gt;
å…§å®¹ç‚ºï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;    {
      &amp;quot;_source&amp;quot;: {
        &amp;quot;message&amp;quot;: &amp;quot;127.0.0.1 - - [06/May/2022:06:44:01 +0000] , http-host: &#92;&amp;quot;abc.boxing.com&#92;&amp;quot; , URL: &#92;&amp;quot;GET /static/tpl/analytics/index.html?v=51817715.1 HTTP/1.1&#92;&amp;quot;  , request-status : &#92;&amp;quot;200&#92;&amp;quot;  ,   body-byte: 0  ,http-referer: &#92;&amp;quot;https://abc.boxing.com/mobile&#92;&amp;quot;  ,user-agent: &#92;&amp;quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36&#92;&amp;quot; , X-Forwarded-For : &#92;&amp;quot;132.235.211.18,10.107.10.14&#92;&amp;quot; ,   request-time: &#92;&amp;quot;0.000&#92;&amp;quot;  , response_time : &#92;&amp;quot;-&#92;&amp;quot;&amp;quot;
      }
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŒ‰ä¸‹ Run the pipelineï¼Œæœ‰æˆåŠŸå°±æœƒè·‘çµæœå‡ºä¾†äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/90-fig.6.jpg&quot; alt=&quot;90-fig.6.jpg&quot; /&gt;&lt;br /&gt;
å¤±æ•—çš„è©±ï¼Œæœƒè®Šæˆä¸‹é¢çš„åœ–ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/90-fig.7.jpg&quot; alt=&quot;90-fig.7.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ­¤è™•çš†åƒè€ƒå®˜æ–¹ç¯„ä¾‹&lt;br /&gt;
ref. &lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/common-log-format-example.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Example: Parse logs in the Common Log Format&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;api&quot; tabindex=&quot;-1&quot;&gt;ä½¿ç”¨apiæ¸¬è©¦&lt;/h3&gt;
&lt;p&gt;åœ¨UIä¸Šé¢æ¸¬è©¦ Grokå¯¦åœ¨å¾ˆç´¯ï¼Œé™¤äº†ç”¨å‰›å‰›æåˆ°çš„ Grok Debugä»¥å¤–ã€‚&lt;br /&gt;
å°±æ˜¯ç›´æ¥ç”¨apiæ–¹å¼ç›´æ¥é©—è­‰äº†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Note,  8.1 æˆ‘ç”¨Grok Debugger æœ‰äº›ç‰¹æ®Šå­—å…ƒæœƒç„¡æ³•match ï¼Œä½†ç”¨APIæ²’å•é¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Nginx ç‚º ingest Pipeline Name&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹API çš†åœ¨ DevToolsé©—è­‰&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/90-fig.8.jpg&quot; alt=&quot;90-fig.8.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é©—è­‰Document&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;POST _ingest/pipeline/Nginx/_simulate
{
  &amp;quot;docs&amp;quot;: [
    {
      &amp;quot;_source&amp;quot;: {
        &amp;quot;message&amp;quot;: &amp;quot;127.0.0.1 - - [06/May/2022:06:44:01 +0000] , http-host: &#92;&amp;quot;abc.boxing.com&#92;&amp;quot; , URL: &#92;&amp;quot;GET /static/tpl/analytics/index.html?v=51817715.1 HTTP/1.1&#92;&amp;quot;  , request-status : &#92;&amp;quot;200&#92;&amp;quot;  ,   body-byte: 0  ,http-referer: &#92;&amp;quot;https://abc.boxing.com/mobile&#92;&amp;quot;  ,user-agent: &#92;&amp;quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36&#92;&amp;quot; , X-Forwarded-For : &#92;&amp;quot;132.235.211.18,10.107.10.14&#92;&amp;quot; ,   request-time: &#92;&amp;quot;0.000&#92;&amp;quot;  , response_time : &#92;&amp;quot;-&#92;&amp;quot;&amp;quot;
      }
    }
  ]
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;ä¿®æ”¹grok&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;
PUT _ingest/pipeline/Nginx
{
  &amp;quot;description&amp;quot;: &amp;quot;My optional pipeline description&amp;quot;,
  &amp;quot;processors&amp;quot;: [
    {
      &amp;quot;grok&amp;quot;: {
        &amp;quot;description&amp;quot;: &amp;quot;Extract fields from &#39;message&#39;&amp;quot;,
        &amp;quot;field&amp;quot;: &amp;quot;message&amp;quot;,
        &amp;quot;patterns&amp;quot;: [&amp;quot;%{IPORHOST:nginx.source.ip} %{USER:nginx.user.id} %{USER:nginx.user.name} &#92;&#92;[%{HTTPDATE:nginx.@timestamp}&#92;&#92;] , http-host: &#92;&amp;quot;%{DATA:nginx.url.host}&#92;&amp;quot; , URL: &#92;&amp;quot;%{WORD:nginx.http.request.method} %{DATA:nginx.url.path} HTTP/%{NUMBER:nginx.http.version}&#92;&amp;quot;  , request-status : &#92;&amp;quot;%{NUMBER:nginx.http.response.status_code:int}&#92;&amp;quot;  ,   body-byte: %{NUMBER:nginx.http.response.body.bytes:int}  ,http-referer: &#92;&amp;quot;%{DATA:nginx.http.request.referer}&#92;&amp;quot;  ,user-agent: %{QS:nginx.user_agent} , X-Forwarded-For : &#92;&amp;quot;%{DATA:nginx.http.request.xff}&#92;&amp;quot; ,   request-time: &#92;&amp;quot;%{NUMBER:nginx.http.request.time}&#92;&amp;quot;  , response_time : &#92;&amp;quot;(?:-|%{NUMBER:nginx.http.request.time:int})&#92;&amp;quot;&amp;quot;],
         &amp;quot;ignore_failure&amp;quot;: false
      }
    }
  ]
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ignore_failure ç‚ºå¿½ç•¥éŒ¯èª¤ï¼Œfalseçš„è©±ï¼Œåªè¦æœ‰ä¸€å€‹æ²’éï¼Œ&lt;br /&gt;
ingest pipelineå°±æœƒåœæ­¢ã€‚&lt;/p&gt;
&lt;h3 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿°å…©ç¨®æ–¹æ³•ï¼Œéƒ½å¯ä»¥å»ºç«‹ä¸”æ¸¬è©¦ï¼Œå°±çœ‹å“ªç¨®ç¿’æ…£ã€‚&lt;br /&gt;
ä½†è¦å°‡ingest å¥—ç”¨åˆ°data stream æˆ– indexçš„è©±ï¼Œ&lt;br /&gt;
åˆæ˜¯å¦ä¸€ç¯‡äº†....ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¶•æ™‚é–“çš„æ–¹æ³•ï¼Œåˆ°  Index Managemenet ä¿®æ”¹ Index  Templates&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/90-fig.9.jpg&quot; alt=&quot;90-fig.9.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åˆ° index settings å°‡ default_pipeline ä¿®æ”¹ç‚ºä½ çš„ ingest pipeline name&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/90-fig.10.jpg&quot; alt=&quot;90-fig.10.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œå°±ç­‰ lifecycleæ¢ä»¶é”åˆ°æ™‚ï¼Œå»ºç«‹æ–°çš„indexï¼Œå°±æœƒå¥—ç”¨ä¸Šå»äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¶•æ™‚é–“çš„è©±ï¼Œè«‹çœ‹ä¸‹ä¸€ç¯‡ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/ingest.html#set-default-pipeline&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;set-default-pipeline&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.16/index-modules.html#index-default-pipeline&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;index.default_pipeline&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://elasticstack.blog.csdn.net/article/details/105790798&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Elasticsearchï¼šElasticå¯è§€æ¸¬æ€§ - é‹ç”¨ pipeline ä½¿æ•¸æ“šçµæ§‹åŒ–&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/90. elasticsearch ingest pipeline/" />
        </entry>
        <entry>
            <title>
                84.Elasticsearchç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/84.Elasticsearchç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¸Šä¸€ç¯‡æ˜¯æ‹¿ä¾†ä¿®æ­£ç›®å‰ç‰ˆæœ¬èˆ‡2.xç‰ˆæœ¬çš„å·®ç•°&lt;br /&gt;
é€™ç¯‡æ˜¯æ‹¿ä¾†ç•¶ç­†è¨˜&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h3 id=&quot;å…©ç¨®æŸ¥è©¢æ–¹å¼&quot; tabindex=&quot;-1&quot;&gt;å…©ç¨®æŸ¥è©¢æ–¹å¼&lt;/h3&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;GET /megacorp/_search?q=last_name:Smith
GET /megacorp/_search
{
    &amp;quot;query&amp;quot; : {
        &amp;quot;match&amp;quot; : {
            &amp;quot;last_name&amp;quot; : &amp;quot;Smith&amp;quot;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h3 id=&quot;æœå°‹æ–¹å¼&quot; tabindex=&quot;-1&quot;&gt;æœå°‹æ–¹å¼&lt;/h3&gt;
å¦‚æœç”¨kibanaæœå°‹çš„è©±ï¼Œå·®ç•°å°±åœ¨ä¸€å€‹æœ‰åŠ  &amp;quot;&amp;quot;(é›™å¼•è™Ÿ)ï¼Œå¦ä¸€å€‹æ²’æœ‰&lt;br /&gt;
match_phrase ï¼š æ˜¯æœ‰åŠ é›™å¼•è™Ÿçš„çŸ­å¥æœå°‹&lt;br /&gt;
match ï¼š æ˜¯å…¨æ–‡æœå°‹ï¼Œåˆ†æ•¸è¶Šé«˜çš„è¡¨ç¤ºé—œé€£åº¦è¶Šé«˜&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/84-fig.1.jpg&quot; alt=&quot;84-fig.1.jpg&quot; /&gt;&lt;/li&gt;
&lt;li&gt;
&lt;h3 id=&quot;aggreations&quot; tabindex=&quot;-1&quot;&gt;aggreations(èšåˆ)&lt;/h3&gt;
é¡ä¼¼sqlçš„ group by åŠŸèƒ½&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;
&lt;h3 id=&quot;å¢é›†å¥åº·åº¦&quot; tabindex=&quot;-1&quot;&gt;å¢é›†å¥åº·åº¦&lt;/h3&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;  GET _cluster/health/
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;status çš„ç‹€æ…‹&lt;/p&gt;
&lt;p&gt;greenï¼šæ‰€æœ‰çš„ä¸»åˆ†ç‰‡å’Œå‰¯æœ¬åˆ†ç‰‡éƒ½æ­£å¸¸é‹è¡Œã€‚&lt;br /&gt;
yellowï¼šæ‰€æœ‰çš„ä¸»åˆ†ç‰‡éƒ½æ­£å¸¸é‹è¡Œï¼Œä½†ä¸æ˜¯æ‰€æœ‰çš„å‰¯æœ¬åˆ†ç‰‡éƒ½æ­£å¸¸é‹è¡Œã€‚&lt;br /&gt;
redï¼šæœ‰ä¸»åˆ†ç‰‡æ²’èƒ½æ­£å¸¸é‹è¡Œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h3 id=&quot;node&quot; tabindex=&quot;-1&quot;&gt;é›†ç¾¤nodeé…å°æ–¹å¼&lt;/h3&gt;
cluster.nameç›¸åŒï¼Œå°±æœƒè‡ªå‹•ç™¼ç¾é›†ç¾¤ä¸¦åŠ å…¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/84.Elasticsearchç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                80. ECK 8.1 ,APM intergrationå®‰è£æ–¹å¼
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/80. ECK 8.1 ,APM intergrationå®‰è£æ–¹å¼/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¸€å…©å€‹æœˆæ²’çœ‹ï¼Œæ²’æƒ³åˆ°ç‰ˆæœ¬å°±è¡åˆ°8.1äº†ï¼Œ&lt;br /&gt;
ç…§ä»¥å‰çš„åšæ³•ï¼Œç™¼ç¾ä¸€å †éŒ¯èª¤ï¼Œ&lt;br /&gt;
precondition &#39;apm integration installed&#39; failed: error querying Elasticsearch for integration index templates: unexpected HTTP status: 404 Not Found..&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç‰ˆæœ¬å‡ç´šå¾Œï¼Œæ¶æ§‹è®Šæˆä¸‹åœ–(1)&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/80-fig.0.png&quot; alt=&quot;80-fig.0.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æ‰å°è‡´ä¸‹åœ–çš„éŒ¯èª¤ç™¼ç”Ÿï¼Œ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/80-fig.1.jpg&quot; alt=&quot;80-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åŸå› æ˜¯ï¼ŒECKå‡ç´šï¼Œ&lt;br /&gt;
æ‰€ä»¥çµ±ä¸€è¦å…ˆåœ¨kibanaä¸Šé¢å…ˆå®‰è£ APM intergrationã€‚&lt;/p&gt;
&lt;blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;If you install version 8.2.0 of APM Server before installing the APM integration, you will see error logs similar to the following. You must go back and install the APM integration before data can be ingested into Elasticsearch.&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.elastic.co/guide/en/apm/guide/master/upgrade-8.0-self-standalone.html#_upgrade_steps&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Upgrade a self-installation of APM Server standalone to 8.2.0&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Step 1.&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/80-fig.2.jpg&quot; alt=&quot;80-fig.2.jpg&quot; /&gt;&lt;br /&gt;
Step 2.&lt;/p&gt;
&lt;p&gt;å®‰è£APM serverå³å¯ï¼Œå®‰è£å®Œå¾Œï¼Œ&lt;br /&gt;
é¸æ“‡ ã€Add Elastic Agent laterã€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/80-fig.3.jpg&quot; alt=&quot;80-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
1. &lt;a href=&quot;https://www.elastic.co/guide/en/apm/guide/current/upgrade-to-apm-integration.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Upgrade to the Elastic APM integration&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/80. ECK 8.1 ,APM intergrationå®‰è£æ–¹å¼/" />
        </entry>
        <entry>
            <title>
                69. kibanaéŒ¯èª¤è§£æ³• , parent Data too large...
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/69. kibanaéŒ¯èª¤è§£æ³• , parent Data too large.../</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘ç”¨kibanaåšæŸ¥è©¢æˆ–ä»»ä½•çš„APIå–è³‡æ–™æ™‚ï¼Œ&lt;br /&gt;
æœ‰æ©Ÿç‡æœƒç™¼ç”Ÿä¸‹åˆ—çš„éŒ¯èª¤&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[parent] Data too large, data for [&amp;lt;http_request&amp;gt;] would be [1054296800/1005.4mb],&lt;br /&gt;
which is larger than the limit of [1020054732/972.7mb],&lt;br /&gt;
real usage: [1054296800/1005.4mb],&lt;br /&gt;
new bytes reserved: [0/0b], usages [request=83853312/79.9mb,&lt;br /&gt;
fielddata=0/0b, in_flight_requests=0/0b, model_inference=0/0b,&lt;br /&gt;
eql_sequence=0/0b, accounting=23686052/22.5mb]&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é›–ç„¶èªªå¾ˆå¶ç™¼ï¼Œä½†æœ€è¿‘æœ‰è¶Šä¾†è¶Šåš´é‡çš„è¶¨å‹¢ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œé¼»å­æ‘¸ä¸€æ‘¸ï¼Œä¾†è§£æ±ºå§ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆçœ‹åˆ°é€™ä¸€ç¯‡  &lt;a href=&quot;https://discuss.elastic.co/t/what-does-this-error-mean-data-too-large-data-for-transport-request/209345&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;What does this error mean - Data too large, data for [&amp;lt;transport_request&amp;gt;]&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é€™é‚Šæœ‰å¾ˆå¥½çš„è§£é‡‹ï¼Œç™¼ç”Ÿçš„åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;ç°¡å–®èªªå°±æ˜¯ESæœ¬èº«çš„æ–·è·¯å™¨ç™¼ç”Ÿä½œç”¨ï¼Œ&lt;br /&gt;
å°è‡´è«‹æ±‚å¤±æ•—ã€‚&lt;/p&gt;
&lt;p&gt;æ–·è·¯å™¨çš„æ–‡ç« å¯åƒè€ƒä¸‹é¢&lt;br /&gt;
ref .&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/circuit-breaker.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;circuit breaker æ–·è·¯å™¨&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„éŒ¯èª¤çš„æ„æ€è¡¨ç¤ºï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[&amp;lt;http_request&amp;gt;] would be [1054296800/1005.4mb],&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;http_requestçš„è«‹æ±‚éœ€è¦ 1005.4 mb&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;which is larger than the limit of [1020054732/972.7mb],&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è«‹æ±‚çš„ä¸Šé™æ˜¯ 972.7mb&lt;/p&gt;
&lt;p&gt;æ­¤æ™‚å¯ä»¥åˆ° DevTools ï¼Œè¼¸å…¥ä¸‹é¢æŒ‡ä»¤[1]&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET _cat/nodes?v=true&amp;amp;h=name,node*,heap*
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/69-fig.1.jpg&quot; alt=&quot;69-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ç›®å‰çš„è¨˜æ†¶é«”ä½¿ç”¨é‡ï¼ˆæ³¨æ„ï¼Œæ­¤åœ–ä¸¦ä¸æ˜¯äº‹ç™¼ç•¶ä¸‹çš„è¨˜æ†¶é«”ä½¿ç”¨é‡ï¼‰&lt;/p&gt;
&lt;p&gt;è§£æ±ºæ–¹å¼[2]ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç•¶ä¸‹æŸ¥çœ‹heap.max åªæœ‰1G ï¼Œæ•…å…ˆåŠ å¤§è¨˜æ†¶é«”åˆ°2Gã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: elasticsearch.k8s.elastic.co/v1
kind: Elasticsearch
metadata:
  name: yabo
  namespace: elastic-system
spec:
  version: 7.16.2
  nodeSets:
  - name: all
    count: 3
    podTemplate:
      spec:
        containers:
        - name: elasticsearch
          env:
          - name: ES_JAVA_OPTS
            value: -Xms2g -Xmx2g
          resources:
            requests:
              memory: 4Gi
            limits:
              memory: 4Gi  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-managing-compute-resources.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Manage compute resources&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;shardsæ•¸é‡å¤ªå¤š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åŒæ¨£50Gçš„æª”æ¡ˆï¼Œ5å€‹10Gï¼Œè·Ÿ1å€‹50G  shardsï¼Œ&lt;br /&gt;
å‰è€…çš„ramä½¿ç”¨é‡æœƒæ¯”è¼ƒå¤šã€‚&lt;br /&gt;
ä½†shardsè¨­å¤ªé«˜ï¼Œç•¶node æ›æ‰æ™‚ï¼Œ&lt;br /&gt;
å›å¾©çš„æ™‚é–“æœƒè®Šé•·ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ILMçš„shardå¤§å°ï¼Œå»ºè­°ç¯„åœæ˜¯åœ¨ 10G~50G ä¹‹é–“ï¼Œ&lt;br /&gt;
ä½†ä»è¦è¦–æƒ…æ³è€Œå®šã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/size-your-shards.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Size your shards&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
[1] : &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/68.ECK%20,%20api%E7%AD%86%E8%A8%98/&quot;&gt;68.ECK , apiç­†è¨˜&lt;/a&gt;&lt;br /&gt;
[2] : &lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.14/fix-common-cluster-issues.html#high-jvm-memory-pressure&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; Fix common cluster issues&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/69. kibanaéŒ¯èª¤è§£æ³• , parent Data too large.../" />
        </entry>
        <entry>
            <title>
                68.ECK , apiç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/68.ECK , apiç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;åœ¨æ‰€æœ‰çš„apiå¾Œé¢ï¼ŒåŠ ä¸Š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;v=true     é¡¯ç¤ºæ¨™é¡Œ
sort=column name    æ’åº
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥è©¢ç›®å‰çš„esè¨˜æ†¶é«”ä½¿ç”¨é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;GET _cat/nodes?v=true&amp;amp;h=name,node*,heap*
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è©³ç´°çš„è³‡æ–™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET _nodes/stats?filter_path=nodes.*.jvm.mem.pools.old
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.14/fix-common-cluster-issues.html#circuit-breaker-errors&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Fix common cluster issues&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¡¯ç¤ºclusterç‹€æ…‹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;GET _cluster/health/
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;é¡¯ç¤ºshard æ˜ç´°&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;GET _cat/shards/filebeat*?v=true&amp;amp;s=index
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;é¡¯ç¤ºindexæ˜ç´°&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;GET _cat/indices/filebeat*?v=true&amp;amp;s=index
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/68.ECK , apiç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                67. ECKï¼Œfilebeat LOGè’é›†éºå¤±
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/67. ECKï¼Œfilebeat LOGè’é›†éºå¤±/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘åŒäº‹å›å ±èªªï¼Œpod æœ‰äº›logæ²’æœ‰é€²åˆ°ECKè£é¢å»ï¼Œ&lt;br /&gt;
ä¸€æŸ¥é‚„çœŸçš„æ˜¯é€™æ¨£ï¼Œ&lt;br /&gt;
ä½†QAç’°å¢ƒæ²’å•é¡Œï¼Œ&lt;br /&gt;
ååProdå°±ç‚¸äº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬ä¾†ä¹Ÿæœ‰æƒ³èªªæ˜¯ä¸æ˜¯çœŸçš„æ²’æœ‰logï¼Œ&lt;br /&gt;
åˆ°filebeatçš„podå»æŸ¥ï¼Œé‚£äº›æ²’é€²å»çš„pod logä¹Ÿéƒ½æ˜¯å­˜åœ¨ã€‚&lt;/p&gt;
&lt;p&gt;logè·¯å¾‘&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/var/log/containers/
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ•…å…ˆæ’é™¤ï¼Œæœå‹™æ²’æœ‰å¯«å…¥logçš„å¯èƒ½æ€§ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœƒä¸æœƒæ˜¯filebeatåœ¨è®€å–logæ™‚çš„æš«å­˜ç©ºé–“ä¸è¶³ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½†å¦‚æœæ˜¯æ­¤æƒ…æ³çš„è©±ï¼Œæ‡‰è©²æ˜¯å…¨éƒ¨çš„filebeatéƒ½æœƒæœ‰logéºå¤±ï¼Œé€™æ¬¡çš„æƒ…æ³æ˜¯åœ¨æŸäº›nodeä¸Šçš„æœå‹™ logéƒ½æœ‰é€²åˆ°ESï¼Œ&lt;br /&gt;
å…¶ä»–çš„nodeéƒ½æ²’æœ‰ã€‚ä½†ä¹Ÿæ˜¯æœ‰æ­¤å¯èƒ½æ€§ã€‚&lt;/p&gt;
&lt;p&gt;èª¿æ•´filebeatå…§éƒ¨è³‡æº&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/ninjavan-tech/logging-with-efk-in-gke-e11676f781e6&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Logging with EFK in GKE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/configuring-internal-queue.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Configure the internal queue&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;filebeatä¸€ç›´é‡å•Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¹‹å¾Œè·‘å»çœ‹filebeatçš„podç‹€æ…‹ï¼Œ&lt;br /&gt;
ç™¼ç¾æœ‰å¾ˆå¤šå€‹podå¸¸å¸¸ä¸æ–·çš„é‡æ–°å•Ÿå‹•ï¼Œ&lt;br /&gt;
å†åˆ°è£¡é¢å»çœ‹è©³ç´°å…§å®¹ï¼Œ&lt;br /&gt;
ç™¼ç¾cpuè·Ÿ è¨˜æ†¶é«”çš„ä½¿ç”¨é‡å¾ˆé«˜ï¼Œ&lt;br /&gt;
æ¨æ¸¬å¯èƒ½æ˜¯ç”±æ–¼è³‡æºä¸è¶³å°è‡´ã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥è©¢filebeatå®˜æ–¹å»ºè­°çš„ä½¿ç”¨è³‡æºæ˜¯å¤šå°‘ã€‚&lt;/p&gt;
&lt;p&gt;filebeatå»ºè­°ä½¿ç”¨&lt;br /&gt;
cpu : 500Mi&lt;br /&gt;
memory: 500Mi&lt;/p&gt;
&lt;p&gt;æ”¹å®Œå¾Œï¼Œè§€å¯Ÿäº†ç´„ä¸€å€‹ç¦®æ‹œï¼Œlodéƒ½æœ‰æŒçºŒé€²å»ï¼Œæ‡‰è©²æ˜¯æ²’å•é¡Œï¼Œä½†å®¹é‡ä¹Ÿå› æ­¤çˆ†å¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-managing-compute-resources.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Manage compute resources&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/67. ECKï¼Œfilebeat LOGè’é›†éºå¤±/" />
        </entry>
        <entry>
            <title>
                61. kibana æŸ¥è©¢èªæ³•
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/61. kibana æŸ¥è©¢èªæ³•/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;KQLå…¶å¯¦æ²’å¾ˆè¤‡é›œï¼Œ&lt;br /&gt;
å»ºè­°æŠŠä»‹ç´¹&lt;a href=&quot;https://www.elastic.co/guide/en/kibana/7.15/kuery-query.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kibana Query Language&lt;/a&gt;çœ‹å®Œå¾ŒåŸºæœ¬ä¸Šå°±æœƒäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦å¸¸ç”¨çš„æ˜¯ï¼Œä½¿ç”¨ ç‰¹å®šæ¬„ä½æœå°‹ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è¬ç”¨å­—å…ƒ *&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œ&lt;br /&gt;
ä»Šå¤©è¦æœå°‹ä¸€å€‹ pod Name å« grafana&lt;br /&gt;
é‚£KQL å¯è¼¸å…¥&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubernetes.pod.name: *grafana*
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœå°‹å‡ºä¾†çš„åç¨±ï¼Œåªè¦æ˜¯ ä¸­é–“æœ‰ grafanaçš„é€šé€šæœƒåˆ—å‡ºã€‚&lt;/p&gt;
&lt;p&gt;è¦ºå¾—å‰é¢åç¨±å¤ªé•·çš„è©±ï¼Œ&lt;a href=&quot;http://xn--pod-0v1e893z.name/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è¼¸å…¥pod.name&lt;/a&gt;ï¼Œç”¨ä¸‹æ‹‰é¸æ“‡å°±å¥½ã€‚&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å¼•è™Ÿä½¿ç”¨&amp;quot; &amp;quot;&lt;br /&gt;
å°‡è£¡é¢çš„å­—è®Šæˆä¸€å€‹è©æœå°‹&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	message: &amp;quot;hello world&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;ä¸ä½¿ç”¨å¼•è™Ÿ&lt;br /&gt;
è£¡é¢çš„å­—éƒ½æœƒåˆ†åˆ¥æœå°‹ï¼Œå·²ä¸‹é¢ä¾†èªªå°±æ˜¯ æœƒæœå°‹ hello è·Ÿ world&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubernetes.pod.name: hello world
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;and è·Ÿ or æ¢ä»¶&lt;br /&gt;
å¤šæ¢ä»¶æŸ¥è©¢&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	message: &amp;quot;hello world&amp;quot; and kubernetes.pod.name:*grafana*
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;not å¦å®š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	not (kubernetes.pod.name: *grafana*)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;å¤§æ–¼ å°æ–¼ ç­‰æ–¼ åˆ¤æ–·å¼  &amp;gt;, &amp;gt;= , &amp;lt;,&amp;lt;=&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	@timestamp &amp;lt; &amp;quot;2021-01-30&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;7&quot;&gt;
&lt;li&gt;
&lt;p&gt;é‚„æœ‰ä¸€ç¨®ä¸ä½¿ç”¨KQLçš„æŸ¥è©¢ï¼ŒLucene&lt;br /&gt;
é€™ç¨®èªæ³•å¯æ”¯æ´æ­£å‰‡è¡¨é”å¼ï¼Œä½†KQLä¸æ”¯æ´ã€‚&lt;br /&gt;
ref.&lt;a href=&quot;https://www.elastic.co/guide/en/kibana/7.15/lucene-query.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Lucene query syntax&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;nested fields çœ‹ä¾†æ˜¯å¯ä»¥æŸ¥è©¢æ•´ä¸²çš„json&lt;br /&gt;
ä½†æˆ‘æƒ³ä¸åˆ°å¯ä»¥é‹ç”¨åœ¨å“ª&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœå°‹x-forward-for ip&lt;br /&gt;
æœ‰ä¸€å€‹logå¦‚ä¸‹åœ–ï¼Œé€™å€‹ç‰¹åˆ¥å¥‡æ€ªï¼Œä¸èƒ½åŠ é›™å¼•è™Ÿï¼Œ&lt;br /&gt;
ã€.ã€ åœ¨kibanaè£¡é¢ä¼¼ä¹æœ‰ç‰¹æ®Šçš„ç”¨æ³•ï¼Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/61-fig.1.jpg&quot; alt=&quot;61-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubernetes.namespace: istio-sigua and message: 103.170.26.90*
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœè¦åŠ é›™å¼•è™Ÿçš„è©±ï¼Œå°±å¿…é ˆæœå°‹å®Œæ•´çš„ipã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubernetes.namespace: istio-sigua and message: &amp;quot;221.210.89.170,10.120.17.1&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿½æ ¹ç©¶åº•ï¼Œé‚„æ˜¯è¦æŠŠmessageå°æ‡‰åˆ°æ¬„ä½...&lt;br /&gt;
æ²’æ™‚é–“ç”¨é˜¿QQ...&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœå°‹url path&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubernetes.namespace: istio-sigua and message: &amp;quot;img/huawei_ans02.c7bcdbdf.jpg&amp;quot;
kubernetes.namespace: istio-sigua and message: &amp;quot;img*&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;11&quot;&gt;
&lt;li&gt;ç‰¹æ®Šå­—å…ƒ&lt;br /&gt;
å¦‚æœè¦ç”¨ç‰¹æ®Šå­—å…ƒæŸ¥è©¢çš„è©±ï¼Œè¦åŠ ä¸Š &#92; ï¼Œ&lt;br /&gt;
ä½†åªé™æ–¼ä¸‹åˆ—é€™äº›é—œéµå­—&lt;pre&gt;&lt;code&gt;+ - &amp;amp;&amp;amp; || ! ( ) { } [ ] ^ &amp;quot; ~ * ? : &#92; /
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/kibana/7.15/kuery-query.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kibana Query Language&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://codingnote.cc/zh-hk/p/289218/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;KibanaæŸ¥è©¢èªè¨€ï¼ˆKQLï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/cjfeii/article/details/79771399&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;KibanaæŸ¥è©¢èªæ³•è©³è§£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.jesse.top/2020/08/25/elk/kibana%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kibanaæŸ¥è©¢èªæ³•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.aliyun.com/article/770157&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¤§ç¥éƒ½é€™éº¼åšï¼Œè®“ Kibana æœç´¢èªæ³• query string ä¹Ÿèƒ½è¼•æ¾ä¸Šæ‰‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/61. kibana æŸ¥è©¢èªæ³•/" />
        </entry>
        <entry>
            <title>
                60. ECKçš„ kibana è­¦å‘Šï¼Œ server.publicBaseUrl is missing
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/60. ECKçš„ kibana è­¦å‘Šï¼Œ server.publicBaseUrl is missing/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;kibanaæ™‚å¸¸é€™å€‹è­¦å‘Šå‡ºä¾†ï¼Œ&lt;br /&gt;
ä½†æˆ‘ä¸€ç›´æ‰¾ä¸åˆ°configè¦åœ¨å“ªè¨­å®šã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/60-fig.1.png&quot; alt=&quot;60-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹å¾Œå•äº†å¦å¤–ä¸€çµ„çš„å¤§å¤§ï¼Œä»–ä¹‹å‰ä¹Ÿåœ¨å¼„ECKï¼Œ&lt;br /&gt;
çµ¦äº†æˆ‘é€™æ®µã€‚&lt;br /&gt;
åŠ ä¸€å€‹configåœ¨yamlè£¡é¢&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: kibana.k8s.elastic.co/v1
kind: Kibana
metadata:
  name: yabo
  namespace: elastic-system
spec:
  version: 7.15.0
  count: 1
  config:
    server.publicBaseUrl: http://123.232.162/
  elasticsearchRef:
    name: yabo
  http:
    tls:
      selfSignedCertificate:
        disabled: true
    service:
      spec:
        ports:
          - name: http
            port: 5601
            targetPort: 5601    
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://debugah.com/solved-kibana-7-14-0-error-server-publicbaseurl-is-missing-and-should-be-configured-when-running-in-a-production-environment-18768/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; [Solved] Kibana 7.14.0 error: server.publicBaseUrl is missing and should be configured when running in a production environment.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/kibana/current/settings.html#server-basePath&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Configure Kibana&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/60. ECKçš„ kibana è­¦å‘Šï¼Œ server.publicBaseUrl is missing/" />
        </entry>
        <entry>
            <title>
                58. é™¤éŒ¯ç”¨çš„ECK API
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/58. é™¤éŒ¯ç”¨çš„ECK API/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å¾ˆä¹…ä¹‹å‰è¦å¯«ä¸€ç›´æ²’å¯«ï¼Œ&lt;br /&gt;
æœ€è¿‘ç¢°åˆ°å•é¡Œï¼Œä¾†é‚„äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h2 id=&quot;primary-shard&quot; tabindex=&quot;-1&quot;&gt;Primary Shard (ææ˜‡ç³»çµ±å„²å­˜å®¹é‡)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;shard æ˜¯ Elasticsearch åˆ†æ•£å¼å„²å­˜çš„åŸºç¤ï¼ŒåŒ…å« primary shard &amp;amp; replica shard&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¯ä¸€å€‹ shard å°±æ˜¯ä¸€å€‹ Lucene instance&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;primary shard åŠŸèƒ½æ˜¯å°‡ä¸€ä»½è¢«ç´¢å¼•å¾Œçš„è³‡æ–™ï¼Œåˆ†æ•£åˆ°å¤šå€‹ data node ä¸Šå­˜æ”¾ï¼Œå¯¦ç¾å„²å­˜æ–¹é¢çš„æ°´å¹³æ“´å±•&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;primary shard çš„æ•¸é‡åœ¨å»ºç«‹ index æ™‚å°±æœƒæŒ‡å®šï¼Œå¾ŒçºŒæ˜¯ç„¡æ³•ä¿®æ”¹çš„ï¼Œè‹¥è¦ä¿®æ”¹å°±å¿…é ˆè¦é€²è¡Œ reindex&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;replica-shard&quot; tabindex=&quot;-1&quot;&gt;Replica Shard (æé«˜è³‡æ–™å¯ç”¨æ€§)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;replica shard ç”¨ä¾†æä¾›è³‡æ–™é«˜å¯ç”¨æ€§ï¼Œç•¶ primary shard éºå¤±æ™‚ï¼Œreplica shard å°±å¯ä»¥è¢« promote æˆ primary shard ä¾†ä¿æŒè³‡æ–™å®Œæ•´æ€§&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;replica shard æ•¸é‡å¯ä»¥å‹•æ…‹èª¿æ•´ï¼Œè®“æ¯å€‹ data node ä¸Šéƒ½æœ‰å®Œæ•´çš„è³‡æ–™&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;replica shard å¯ä»¥ä¸€å®šç¨‹åº¦çš„æé«˜è®€å–(æŸ¥è©¢)çš„æ•ˆèƒ½&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è‹¥ä¸è¨­å®š replica shardï¼Œä¸€æ—¦æœ‰ data node æ•…éšœå°è‡´ primary shard éºå¤±ï¼Œè³‡æ–™å¯èƒ½å°±ç„¡æ³•æ¢å¾©äº†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ES 7.0 é–‹å§‹ï¼Œprimary shard é è¨­ç‚ºÂ &lt;code&gt;1&lt;/code&gt;ï¼Œreplica shard é è¨­ç‚ºÂ &lt;code&gt;0&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://godleon.github.io/blog/Elasticsearch/Elasticsearch-distributed-mechanism/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; [Elasticsearch] åˆ†æ•£å¼ç‰¹æ€§ &amp;amp; åˆ†æ•£å¼æœå°‹çš„æ©Ÿåˆ¶&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;shard-and-amp&quot; tabindex=&quot;-1&quot;&gt;Shard çš„è¦åŠƒ &amp;amp; è¨­å®š&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;primary shard æ•¸é‡è¨­å®šå¤ªå°æœƒé‡åˆ°ä»¥ä¸‹å•é¡Œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ index è³‡æ–™å¢åŠ å¾ˆå¿«æ™‚ï¼Œcluster ç„¡æ³•é€šéå¢åŠ  node æ•¸é‡å° index é€²è¡Œè³‡æ–™æ“´å±•&lt;/li&gt;
&lt;li&gt;å–®ä¸€ shard è³‡æ–™å¤ªå¤§ï¼Œå°è‡´è³‡æ–™é‡æ–°åˆ†é…è€—æ™‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;primary shard æ•¸é‡è¨­å®šå¤ªå¤§æœƒé‡åˆ°ä»¥ä¸‹å•é¡Œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°è‡´æ¯å€‹ shard å®¹é‡å¾ˆå°ï¼Œè®“ä¸€å€‹ data node ä¸Šæœ‰éå¤š shard è€Œå½±éŸ¿æ•ˆèƒ½&lt;/li&gt;
&lt;li&gt;å½±éŸ¿æœå°‹æ™‚çš„ç›¸é—œæ€§ç®—åˆ†ï¼Œæœƒè®“çµ±è¨ˆçµæœå¤±æº–&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;replica shard è‹¥è¨­å®šéå¤šï¼Œæœƒé™ä½ cluster æ•´é«”çš„å¯«å…¥æ•ˆèƒ½&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;# æŸ¥nodeçš„ç‹€æ…‹
GET _cluster/health/

# å–å¾—ç›®å‰æ‰€æœ‰çš„shardï¼ŒåŠ ä¸Š?v å¯é¡¯ç¤ºæ¬„ä½åç¨±
GET _cat/shards?v

# å–å¾—ç›®å‰çš„shardè¨­å®šæ•¸é‡ï¼ˆå¥½å¹¾æ¬¡éƒ½æ˜¯é€™å€‹å€¼æš´äº†ï¼Œå°è‡´logç„¡æ³•å¯«å…¥)
GET /_cluster/settings

# è¨­å®šnodeçš„shardæœ€å¤§æ•¸é‡
PUT /_cluster/settings
{
  &amp;quot;persistent&amp;quot;: {
    &amp;quot;cluster.max_shards_per_node&amp;quot;: 1000
  }
}


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-shards.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;cat shards APIæ¬„ä½ä»‹ç´¹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/58. é™¤éŒ¯ç”¨çš„ECK API/" />
        </entry>
        <entry>
            <title>
                57.filebeat è£œå……èªªæ˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/57.filebeat è£œå……èªªæ˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å…§å®¹&quot; tabindex=&quot;-1&quot;&gt;å…§å®¹&lt;/h1&gt;
&lt;h3 id=&quot;efk-57-filebeat-2024-05-28-2024-05-28&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/57.filebeat%20%E8%A3%9C%E5%85%85%E8%AA%AA%E6%98%8E/#2024-05-28&quot;&gt;&lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#2024/05/28è£œå……&quot;&gt;#2024/05/28è£œå……&lt;/a&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h2 id=&quot;filebeat&quot; tabindex=&quot;-1&quot;&gt;filebeatæŠ“è³‡æ–™çš„æ–¹å¼&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;autodiscover&lt;/li&gt;
&lt;li&gt;without autodiscover&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœç”¨(2) çš„æ–¹å¼ï¼Œåœ¨GKEä¸Šé¢ï¼Œä½ è¦ä½¿ç”¨ add_kubernetes_metadataï¼Œå»å–å¾—pod name,namespace..ç­‰ï¼Œ&lt;br /&gt;
é€šé€šæŠ“ä¸åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;å› ç‚º(2)æ˜¯ç›´æ¥å»nodeçš„logè£¡é¢æŠ“è³‡æ–™ï¼Œä¸¦æ²’æœ‰é€éapiçš„æ–¹å¼ï¼Œ&lt;br /&gt;
æ‰€ä»¥å¦‚æœè¦å–å¾— pod nameçš„è©±ï¼Œå¯èƒ½è¦å¾log pathç€æ‰‹ã€‚&lt;br /&gt;
æ‡‰è©²æ˜¯å¯ä»¥å¾ingest å»è™•ç†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†ç”¨(1)ï¼Œè³‡æ–™å°±é€šé€šé€²ä¾†äº†ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/57.fig-1.jpg&quot; alt=&quot;57.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥é‚„æ˜¯ç”¨(1)å§ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-beat-configuration-examples.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Configuration Examples&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/add-kubernetes-metadata.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Add Kubernetes metadata&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;æ’é™¤è³‡æ–™çš„æ–¹å¼&quot; tabindex=&quot;-1&quot;&gt;æ’é™¤è³‡æ–™çš„æ–¹å¼&lt;/h2&gt;
&lt;p&gt;æ²’æœ‰è¨˜éŒ„logä¸çŸ¥é“ï¼Œä¸€è¨˜éŒ„äº†æ‰çŸ¥é“ã€‚&lt;br /&gt;
è³‡æ–™æœ‰å¤ è‚¥ã€‚&lt;/p&gt;
&lt;p&gt;é–‹å§‹è·ŸåŒä»èªªï¼Œæ²’æœ‰å¿…è¦çš„ä¸è¦ç•™ã€‚&lt;br /&gt;
ä½†æœ‰äº›æ˜¯å…ˆå¤©é™åˆ¶ï¼Œå°±æ˜¯æœƒæ‹¼å‘½å°ï¼Œé‚£è©²æ€éº¼è§£æ±ºã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ’é™¤è¨Šæ¯å…§çš„ç‰¹å®šæ–‡å­—ï¼Œé€šé€šä¸æ”¶&lt;br /&gt;
åœ¨autodiscover åº•ä¸‹ä½¿ç”¨ exclude_lines&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;autodiscover:
  providers:
  - type: kubernetes
    node: ${NODE_NAME}                                              
    hints:
      enabled: true
      default_config:
        type: container
        paths:
        - /var/log/containers/*${data.kubernetes.container.id}.log
        exclude_lines: 
        - &amp;quot;.*(NAT rule custom-iptables|unknown operand).*&amp;quot;  # æ’é™¤ k8s-custom-iptables
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-input-log.html#filebeat-input-log-exclude-lines&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Log input&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;æ’é™¤ç‰¹å®šnamespace&lt;br /&gt;
åœ¨  processors åº•ä¸‹åŠ  drop_eventï¼Œé€™é‚Šæœ‰ç”¨åˆ°conditionçš„æ¢ä»¶ï¼Œå»ºè­°çœ‹ä¸€ä¸‹æ–‡ä»¶æ¯”è¼ƒæ¸…æ¥šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;processors:
- add_cloud_metadata: {}
- drop_event.when:
    or:
    - equals:
        kubernetes.namespace: &amp;quot;kube-system&amp;quot;
    - equals:
        kubernetes.namespace: &amp;quot;elastic-system&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/drop-event.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Drop events&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/60566173/how-we-can-filter-namespace-in-filebeat-kubernetes&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;how-we-can-filter-namespace-in-filebeat-kubernetes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/defining-processors.html#conditions&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;conditions&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;ç§»é™¤ç‰¹å®šæ¬„ä½&quot; tabindex=&quot;-1&quot;&gt;ç§»é™¤ç‰¹å®šæ¬„ä½&lt;/h2&gt;
&lt;p&gt;æœ‰äº›æ¬„ä½å¾—åˆ°çš„å€¼æ˜¯é‡è¤‡çš„ï¼Œ&lt;br /&gt;
æ‰€ä»¥é€™äº›ä¹Ÿéƒ½å¯ä»¥ç æ‰ã€‚&lt;br /&gt;
processors åº•ä¸‹åŠ   drop_fields&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;processors:
- drop_fields:
      fields: 
        - &#39;kubernetes.node&#39;
        - &#39;kubernetes.namespace_uid&#39;
        - &#39;agent.hostname&#39;
        - &#39;cloud.account&#39;
        - &#39;cloud.provider&#39;
        - &#39;cloud.instance.name&#39;
        - &#39;container.id&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/drop-fields.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Drop fields from events&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;è©³ç´°åƒæ•¸èªªæ˜&quot; tabindex=&quot;-1&quot;&gt;è©³ç´°åƒæ•¸èªªæ˜&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;type: log &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#inputé¡å‹ç‚ºlog&quot;&gt;#inputé¡å‹ç‚ºlog&lt;/a&gt;
enable: true &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è¡¨ç¤ºæ˜¯è©²logé¡å‹é…ç½®ç”Ÿæ•ˆ&quot;&gt;#è¡¨ç¤ºæ˜¯è©²logé¡å‹é…ç½®ç”Ÿæ•ˆ&lt;/a&gt;
pathsï¼š     &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#æŒ‡å®šè¦ç›£æ§çš„æ—¥èªŒï¼Œç›®å‰æŒ‰ç…§Goèªè¨€çš„globå‡½æ•¸è™•ç†ã€‚æ²’æœ‰å°é…ç½®ç›®éŒ„åšéæ­¸è™•ç†ï¼Œæ¯”å¦‚é…ç½®çš„å¦‚æœæ˜¯ï¼š&quot;&gt;#æŒ‡å®šè¦ç›£æ§çš„æ—¥èªŒï¼Œç›®å‰æŒ‰ç…§Goèªè¨€çš„globå‡½æ•¸è™•ç†ã€‚æ²’æœ‰å°é…ç½®ç›®éŒ„åšéæ­¸è™•ç†ï¼Œæ¯”å¦‚é…ç½®çš„å¦‚æœæ˜¯ï¼š&lt;/a&gt;
- /var/log/* /*.log  &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å‰‡åªæœƒå»/var/logç›®éŒ„çš„æ‰€æœ‰å­ç›®éŒ„ä¸­å°‹æ‰¾ä»¥&quot;&gt;#å‰‡åªæœƒå»/var/logç›®éŒ„çš„æ‰€æœ‰å­ç›®éŒ„ä¸­å°‹æ‰¾ä»¥&lt;/a&gt;&amp;quot;.log&amp;quot;çµå°¾çš„æ–‡ä»¶ï¼Œè€Œä¸æœƒå°‹æ‰¾/var/logç›®éŒ„ä¸‹ä»¥&amp;quot;.log&amp;quot;çµå°¾çš„æ–‡ä»¶ã€‚
recursive_glob.enabled: &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å•Ÿç”¨å…¨å±€éæ­¸æ¨¡å¼ï¼Œä¾‹å¦‚/foo/&quot;&gt;#å•Ÿç”¨å…¨å±€éæ­¸æ¨¡å¼ï¼Œä¾‹å¦‚/foo/&lt;/a&gt;**åŒ…æ‹¬/foo, /foo/*, /foo/*/*
encodingï¼š#æŒ‡å®šè¢«ç›£æ§çš„æ–‡ä»¶çš„ç·¨ç¢¼é¡å‹ï¼Œä½¿ç”¨plainå’Œutf-8éƒ½æ˜¯å¯ä»¥è™•ç†ä¸­æ–‡æ—¥èªŒçš„
exclude_lines: [&#39;^DBG&#39;] &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#ä¸åŒ…å«åŒ¹é…æ­£å‰‡çš„è¡Œ&quot;&gt;#ä¸åŒ…å«åŒ¹é…æ­£å‰‡çš„è¡Œ&lt;/a&gt;
include_lines: [&#39;^ERR&#39;, &#39;^WARN&#39;]  &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#åŒ…å«åŒ¹é…æ­£å‰‡çš„è¡Œ&quot;&gt;#åŒ…å«åŒ¹é…æ­£å‰‡çš„è¡Œ&lt;/a&gt;
harvester_buffer_size: 16384 &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#æ¯å€‹harvesteråœ¨ç²å–æ–‡ä»¶æ™‚ä½¿ç”¨çš„ç·©æ²–å€çš„å­—ç¯€å¤§å°&quot;&gt;#æ¯å€‹harvesteråœ¨ç²å–æ–‡ä»¶æ™‚ä½¿ç”¨çš„ç·©æ²–å€çš„å­—ç¯€å¤§å°&lt;/a&gt;
max_bytes: 10485760 &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å–®å€‹æ—¥èªŒæ¶ˆæ¯å¯ä»¥æ“æœ‰çš„æœ€å¤§å­—ç¯€æ•¸ã€‚max_bytesä¹‹å¾Œçš„æ‰€æœ‰å­—ç¯€éƒ½è¢«ä¸Ÿæ£„è€Œä¸ç™¼é€ã€‚é»˜èªå€¼ç‚º10MB&quot;&gt;#å–®å€‹æ—¥èªŒæ¶ˆæ¯å¯ä»¥æ“æœ‰çš„æœ€å¤§å­—ç¯€æ•¸ã€‚max_bytesä¹‹å¾Œçš„æ‰€æœ‰å­—ç¯€éƒ½è¢«ä¸Ÿæ£„è€Œä¸ç™¼é€ã€‚é»˜èªå€¼ç‚º10MB&lt;/a&gt; (10485760)
exclude_files: [&#39;&#92;.gz$&#39;]  &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#ç”¨æ–¼åŒ¹é…å¸Œæœ›Filebeatå¿½ç•¥çš„æ–‡ä»¶çš„æ­£å‰‡è¡¨é”å¼åˆ—è¡¨&quot;&gt;#ç”¨æ–¼åŒ¹é…å¸Œæœ›Filebeatå¿½ç•¥çš„æ–‡ä»¶çš„æ­£å‰‡è¡¨é”å¼åˆ—è¡¨&lt;/a&gt;
ingore_older: 0 &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é»˜èªç‚º0ï¼Œè¡¨ç¤ºç¦ç”¨ï¼Œå¯ä»¥é…ç½®2hï¼Œ2mç­‰ï¼Œæ³¨æ„ignore_olderå¿…é ˆå¤§æ–¼close_inactiveçš„å€¼&quot;&gt;#é»˜èªç‚º0ï¼Œè¡¨ç¤ºç¦ç”¨ï¼Œå¯ä»¥é…ç½®2hï¼Œ2mç­‰ï¼Œæ³¨æ„ignore_olderå¿…é ˆå¤§æ–¼close_inactiveçš„å€¼&lt;/a&gt;.è¡¨ç¤ºå¿½ç•¥è¶…éè¨­ç½®å€¼æœªæ›´æ–°çš„
æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¾ä¾†æ²’æœ‰è¢«harvesteræ”¶é›†
close_* &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#close_&quot;&gt;#close_&lt;/a&gt; *é…ç½®é¸é …ç”¨æ–¼åœ¨ç‰¹å®šæ¨™å‡†æˆ–æ™‚é–“ä¹‹å¾Œé—œé–‰harvesterã€‚ é—œé–‰harvesteræ„å‘³è‘—é—œé–‰æ–‡ä»¶è™•ç†ç¨‹åºã€‚ å¦‚æœåœ¨harvesteré—œé–‰
å¾Œæ–‡ä»¶è¢«æ›´æ–°ï¼Œå‰‡åœ¨scan_frequencyéå¾Œï¼Œæ–‡ä»¶å°‡è¢«é‡æ–°æ‹¾å–ã€‚ ä½†æ˜¯ï¼Œå¦‚æœåœ¨harvesteré—œé–‰æ™‚ç§»å‹•æˆ–åˆªé™¤æ–‡ä»¶ï¼ŒFilebeatå°‡ç„¡æ³•å†æ¬¡æ¥æ”¶æ–‡ä»¶
ï¼Œä¸¦ä¸”harvesteræœªè®€å–çš„ä»»ä½•æ•¸æ“šéƒ½å°‡ä¸Ÿå¤±ã€‚
close_inactive  &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å•Ÿå‹•é¸é …æ™‚ï¼Œå¦‚æœåœ¨åˆ¶å®šæ™‚é–“æ²’æœ‰è¢«è®€å–ï¼Œå°‡é—œé–‰æ–‡ä»¶å¥æŸ„&quot;&gt;#å•Ÿå‹•é¸é …æ™‚ï¼Œå¦‚æœåœ¨åˆ¶å®šæ™‚é–“æ²’æœ‰è¢«è®€å–ï¼Œå°‡é—œé–‰æ–‡ä»¶å¥æŸ„&lt;/a&gt;
è®€å–çš„æœ€å¾Œä¸€æ¢æ—¥èªŒå®šç¾©ç‚ºä¸‹ä¸€æ¬¡è®€å–çš„èµ·å§‹é»ï¼Œè€Œä¸æ˜¯åŸºæ–¼æ–‡ä»¶çš„ä¿®æ”¹æ™‚é–“
å¦‚æœé—œé–‰çš„æ–‡ä»¶ç™¼ç”Ÿè®ŠåŒ–ï¼Œä¸€å€‹æ–°çš„harversterå°‡åœ¨scan_frequencyé‹è¡Œå¾Œè¢«å•Ÿå‹•
å»ºè­°è‡³å°‘è¨­ç½®ä¸€å€‹å¤§æ–¼è®€å–æ—¥èªŒé »ç‡çš„å€¼ï¼Œé…ç½®å¤šå€‹prospectorä¾†å¯¦ç¾é‡å°ä¸åŒæ›´æ–°é€Ÿåº¦çš„æ—¥èªŒæ–‡ä»¶
ä½¿ç”¨å…§éƒ¨æ™‚é–“æˆ³æ©Ÿåˆ¶ï¼Œä¾†åæ˜ è¨˜éŒ„æ—¥èªŒçš„è®€å–ï¼Œæ¯æ¬¡è®€å–åˆ°æœ€å¾Œä¸€è¡Œæ—¥èªŒæ™‚é–‹å§‹å€’è¨ˆæ™‚ä½¿ç”¨2h 5m ä¾†è¡¨ç¤º
close_rename &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#ç•¶é¸é …å•Ÿå‹•ï¼Œå¦‚æœæ–‡ä»¶è¢«é‡å‘½åå’Œç§»å‹•ï¼Œfilebeaté—œé–‰æ–‡ä»¶çš„è™•ç†è®€å–&quot;&gt;#ç•¶é¸é …å•Ÿå‹•ï¼Œå¦‚æœæ–‡ä»¶è¢«é‡å‘½åå’Œç§»å‹•ï¼Œfilebeaté—œé–‰æ–‡ä»¶çš„è™•ç†è®€å–&lt;/a&gt;
close_removed &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#ç•¶é¸é …å•Ÿå‹•ï¼Œæ–‡ä»¶è¢«åˆªé™¤æ™‚ï¼Œfilebeaté—œé–‰æ–‡ä»¶çš„è™•ç†è®€å–é€™å€‹é¸é …å•Ÿå‹•å¾Œï¼Œå¿…é ˆå•Ÿå‹•clean_removed&quot;&gt;#ç•¶é¸é …å•Ÿå‹•ï¼Œæ–‡ä»¶è¢«åˆªé™¤æ™‚ï¼Œfilebeaté—œé–‰æ–‡ä»¶çš„è™•ç†è®€å–é€™å€‹é¸é …å•Ÿå‹•å¾Œï¼Œå¿…é ˆå•Ÿå‹•clean_removed&lt;/a&gt;
close_eof &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é©åˆåªå¯«ä¸€æ¬¡æ—¥èªŒçš„æ–‡ä»¶ï¼Œç„¶å¾Œfilebeaté—œé–‰æ–‡ä»¶çš„è™•ç†è®€å–&quot;&gt;#é©åˆåªå¯«ä¸€æ¬¡æ—¥èªŒçš„æ–‡ä»¶ï¼Œç„¶å¾Œfilebeaté—œé–‰æ–‡ä»¶çš„è™•ç†è®€å–&lt;/a&gt;
close_timeout &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#ç•¶é¸é …å•Ÿå‹•æ™‚ï¼Œfilebeatæœƒçµ¦æ¯å€‹harvesterè¨­ç½®é å®šç¾©æ™‚é–“ï¼Œä¸ç®¡é€™å€‹æ–‡ä»¶æ˜¯å¦è¢«è®€å–ï¼Œé”åˆ°è¨­å®šæ™‚é–“å¾Œï¼Œå°‡è¢«é—œé–‰&quot;&gt;#ç•¶é¸é …å•Ÿå‹•æ™‚ï¼Œfilebeatæœƒçµ¦æ¯å€‹harvesterè¨­ç½®é å®šç¾©æ™‚é–“ï¼Œä¸ç®¡é€™å€‹æ–‡ä»¶æ˜¯å¦è¢«è®€å–ï¼Œé”åˆ°è¨­å®šæ™‚é–“å¾Œï¼Œå°‡è¢«é—œé–‰&lt;/a&gt;
close_timeout ä¸èƒ½ç­‰æ–¼ignore_older,æœƒå°è‡´æ–‡ä»¶æ›´æ–°æ™‚ï¼Œä¸æœƒè¢«è®€å–å¦‚æœoutputä¸€ç›´æ²’æœ‰è¼¸å‡ºæ—¥èªŒäº‹ä»¶ï¼Œé€™å€‹timeoutæ˜¯ä¸æœƒè¢«å•Ÿå‹•çš„ï¼Œ
è‡³å°‘è¦è¦æœ‰ä¸€å€‹äº‹ä»¶ç™¼é€ï¼Œç„¶å¾Œhaverterå°‡è¢«é—œé–‰
è¨­ç½®0 è¡¨ç¤ºä¸å•Ÿå‹•
clean_inactived &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å¾æ³¨å†Šè¡¨æ–‡ä»¶ä¸­åˆªé™¤å…ˆå‰æ”¶ç²çš„æ–‡ä»¶çš„ç‹€æ…‹&quot;&gt;#å¾æ³¨å†Šè¡¨æ–‡ä»¶ä¸­åˆªé™¤å…ˆå‰æ”¶ç²çš„æ–‡ä»¶çš„ç‹€æ…‹&lt;/a&gt;
è¨­ç½®å¿…é ˆå¤§æ–¼ignore_older+scan_frequencyï¼Œä»¥ç¢ºä¿åœ¨æ–‡ä»¶ä»åœ¨æ”¶é›†æ™‚æ²’æœ‰åˆªé™¤ä»»ä½•ç‹€æ…‹
é…ç½®é¸é …æœ‰åŠ©æ–¼æ¸›å°æ³¨å†Šè¡¨æ–‡ä»¶çš„å¤§å°ï¼Œç‰¹åˆ¥æ˜¯å¦‚æœæ¯å¤©éƒ½ç”Ÿæˆå¤§é‡çš„æ–°æ–‡ä»¶
æ­¤é…ç½®é¸é …ä¹Ÿå¯ç”¨æ–¼é˜²æ­¢åœ¨Linuxä¸Šé‡ç”¨inodeçš„Filebeatå•é¡Œ
clean_removed &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å•Ÿå‹•é¸é …å¾Œï¼Œå¦‚æœæ–‡ä»¶åœ¨ç£ç›¤ä¸Šæ‰¾ä¸åˆ°ï¼Œå°‡å¾æ³¨å†Šè¡¨ä¸­æ¸…é™¤filebeat&quot;&gt;#å•Ÿå‹•é¸é …å¾Œï¼Œå¦‚æœæ–‡ä»¶åœ¨ç£ç›¤ä¸Šæ‰¾ä¸åˆ°ï¼Œå°‡å¾æ³¨å†Šè¡¨ä¸­æ¸…é™¤filebeat&lt;/a&gt;
å¦‚æœé—œé–‰close removed å¿…é ˆé—œé–‰clean removed
scan_frequency &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#prospectoræª¢æŸ¥æŒ‡å®šç”¨æ–¼æ”¶ç²çš„è·¯å¾‘ä¸­çš„æ–°æ–‡ä»¶çš„é »ç‡&quot;&gt;#prospectoræª¢æŸ¥æŒ‡å®šç”¨æ–¼æ”¶ç²çš„è·¯å¾‘ä¸­çš„æ–°æ–‡ä»¶çš„é »ç‡&lt;/a&gt;,é»˜èª10s
tail_filesï¼š#å¦‚æœè¨­ç½®ç‚ºtrueï¼ŒFilebeatå¾æ–‡ä»¶å°¾é–‹å§‹ç›£æ§æ–‡ä»¶æ–°å¢å…§å®¹ï¼ŒæŠŠæ–°å¢çš„æ¯ä¸€è¡Œæ–‡ä»¶ä½œç‚ºä¸€å€‹äº‹ä»¶ä¾æ¬¡ç™¼é€ï¼Œ
è€Œä¸æ˜¯å¾æ–‡ä»¶é–‹å§‹è™•é‡æ–°ç™¼é€æ‰€æœ‰å…§å®¹ã€‚
symlinksï¼š#ç¬¦è™Ÿéˆæ¥é¸é …å…è¨±Filebeaté™¤å¸¸è¦æ–‡ä»¶å¤–,å¯ä»¥æ”¶é›†ç¬¦è™Ÿéˆæ¥ã€‚æ”¶é›†ç¬¦è™Ÿéˆæ¥æ™‚ï¼Œå³ä½¿å ±å‘Šäº†ç¬¦è™Ÿéˆæ¥çš„è·¯å¾‘ï¼Œ
Filebeatä¹Ÿæœƒæ‰“é–‹ä¸¦è®€å–åŸå§‹æ–‡ä»¶ã€‚
backoffï¼š &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#backoffé¸é …æŒ‡å®šFilebeatå¦‚ä½•ç©æ¥µåœ°æŠ“å–æ–°æ–‡ä»¶é€²è¡Œæ›´æ–°ã€‚é»˜èª1sï¼Œbackoffé¸é …å®šç¾©Filebeatåœ¨é”åˆ°EOFä¹‹å¾Œ&quot;&gt;#backoffé¸é …æŒ‡å®šFilebeatå¦‚ä½•ç©æ¥µåœ°æŠ“å–æ–°æ–‡ä»¶é€²è¡Œæ›´æ–°ã€‚é»˜èª1sï¼Œbackoffé¸é …å®šç¾©Filebeatåœ¨é”åˆ°EOFä¹‹å¾Œ&lt;/a&gt;
å†æ¬¡æª¢æŸ¥æ–‡ä»¶ä¹‹é–“ç­‰å¾…çš„æ™‚é–“ã€‚
max_backoffï¼š &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#åœ¨é”åˆ°EOFä¹‹å¾Œå†æ¬¡æª¢æŸ¥æ–‡ä»¶ä¹‹å‰Filebeatç­‰å¾…çš„æœ€é•·æ™‚é–“&quot;&gt;#åœ¨é”åˆ°EOFä¹‹å¾Œå†æ¬¡æª¢æŸ¥æ–‡ä»¶ä¹‹å‰Filebeatç­‰å¾…çš„æœ€é•·æ™‚é–“&lt;/a&gt;
backoff_factorï¼š &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#æŒ‡å®šbackoffå˜—è©¦ç­‰å¾…æ™‚é–“å¹¾æ¬¡ï¼Œé»˜èªæ˜¯2&quot;&gt;#æŒ‡å®šbackoffå˜—è©¦ç­‰å¾…æ™‚é–“å¹¾æ¬¡ï¼Œé»˜èªæ˜¯2&lt;/a&gt;
harvester_limitï¼š#harvester_limité¸é …é™åˆ¶ä¸€å€‹prospectorä¸¦è¡Œå•Ÿå‹•çš„harvesteræ•¸é‡ï¼Œç›´æ¥å½±éŸ¿æ–‡ä»¶æ‰“é–‹æ•¸

tags &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#åˆ—è¡¨ä¸­æ·»åŠ æ¨™ç°½ï¼Œç”¨ééæ¿¾ï¼Œä¾‹å¦‚ï¼štags&quot;&gt;#åˆ—è¡¨ä¸­æ·»åŠ æ¨™ç°½ï¼Œç”¨ééæ¿¾ï¼Œä¾‹å¦‚ï¼štags&lt;/a&gt;: [&amp;quot;json&amp;quot;]
fields &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å¯é¸å­—æ®µï¼Œé¸æ“‡é¡å¤–çš„å­—æ®µé€²è¡Œè¼¸å‡ºå¯ä»¥æ˜¯æ¨™é‡å€¼ï¼Œå…ƒçµ„ï¼Œå­—å…¸ç­‰åµŒå¥—é¡å‹&quot;&gt;#å¯é¸å­—æ®µï¼Œé¸æ“‡é¡å¤–çš„å­—æ®µé€²è¡Œè¼¸å‡ºå¯ä»¥æ˜¯æ¨™é‡å€¼ï¼Œå…ƒçµ„ï¼Œå­—å…¸ç­‰åµŒå¥—é¡å‹&lt;/a&gt;
é»˜èªåœ¨sub-dictionaryä½ç½®
filebeat.inputs:
fields:
app_id: query_engine_12
fields_under_root &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å¦‚æœå€¼ç‚ºtureï¼Œé‚£éº¼fieldså­˜å„²åœ¨è¼¸å‡ºæ–‡æª”çš„é ‚ç´šä½ç½®&quot;&gt;#å¦‚æœå€¼ç‚ºtureï¼Œé‚£éº¼fieldså­˜å„²åœ¨è¼¸å‡ºæ–‡æª”çš„é ‚ç´šä½ç½®&lt;/a&gt;

multiline.pattern &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å¿…é ˆåŒ¹é…çš„regexpæ¨¡å¼&quot;&gt;#å¿…é ˆåŒ¹é…çš„regexpæ¨¡å¼&lt;/a&gt;
multiline.negate &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å®šç¾©ä¸Šé¢çš„æ¨¡å¼åŒ¹é…æ¢ä»¶çš„å‹•ä½œæ˜¯&quot;&gt;#å®šç¾©ä¸Šé¢çš„æ¨¡å¼åŒ¹é…æ¢ä»¶çš„å‹•ä½œæ˜¯&lt;/a&gt; å¦å®šçš„ï¼Œé»˜èªæ˜¯false
å‡å¦‚æ¨¡å¼åŒ¹é…æ¢ä»¶&#39;^b&#39;ï¼Œé»˜èªæ˜¯falseæ¨¡å¼ï¼Œè¡¨ç¤ºè¬›æŒ‰ç…§æ¨¡å¼åŒ¹é…é€²è¡ŒåŒ¹é… å°‡ä¸æ˜¯ä»¥bé–‹é ­çš„æ—¥èªŒè¡Œé€²è¡Œåˆä¸¦
å¦‚æœæ˜¯trueï¼Œè¡¨ç¤ºå°‡ä¸ä»¥bé–‹é ­çš„æ—¥èªŒè¡Œé€²è¡Œåˆä¸¦
multiline.match # æŒ‡å®šFilebeatå¦‚ä½•å°‡åŒ¹é…è¡Œçµ„åˆæˆäº‹ä»¶,åœ¨ä¹‹å‰æˆ–è€…ä¹‹å¾Œï¼Œå–æ±ºæ–¼ä¸Šé¢æ‰€æŒ‡å®šçš„negate
multiline.max_lines &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å¯ä»¥çµ„åˆæˆä¸€å€‹äº‹ä»¶çš„æœ€å¤§è¡Œæ•¸ï¼Œè¶…éå°‡ä¸Ÿæ£„ï¼Œé»˜èª500&quot;&gt;#å¯ä»¥çµ„åˆæˆä¸€å€‹äº‹ä»¶çš„æœ€å¤§è¡Œæ•¸ï¼Œè¶…éå°‡ä¸Ÿæ£„ï¼Œé»˜èª500&lt;/a&gt;
multiline.timeout &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å®šç¾©è¶…æ™‚æ™‚é–“ï¼Œå¦‚æœé–‹å§‹ä¸€å€‹æ–°çš„äº‹ä»¶åœ¨è¶…æ™‚æ™‚é–“å…§æ²’æœ‰ç™¼ç¾åŒ¹é…ï¼Œä¹Ÿå°‡ç™¼é€æ—¥èªŒï¼Œé»˜èªæ˜¯5smax_procs&quot;&gt;#å®šç¾©è¶…æ™‚æ™‚é–“ï¼Œå¦‚æœé–‹å§‹ä¸€å€‹æ–°çš„äº‹ä»¶åœ¨è¶…æ™‚æ™‚é–“å…§æ²’æœ‰ç™¼ç¾åŒ¹é…ï¼Œä¹Ÿå°‡ç™¼é€æ—¥èªŒï¼Œé»˜èªæ˜¯5smax_procs&lt;/a&gt; &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è¨­ç½®å¯ä»¥åŒæ™‚åŸ·è¡Œçš„æœ€å¤§CPUæ•¸ã€‚é»˜èªå€¼ç‚ºç³»çµ±ä¸­å¯ç”¨çš„é‚è¼¯CPUçš„æ•¸é‡ã€‚name&quot;&gt;#è¨­ç½®å¯ä»¥åŒæ™‚åŸ·è¡Œçš„æœ€å¤§CPUæ•¸ã€‚é»˜èªå€¼ç‚ºç³»çµ±ä¸­å¯ç”¨çš„é‚è¼¯CPUçš„æ•¸é‡ã€‚name&lt;/a&gt; &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#ç‚ºè©²filebeatæŒ‡å®šåå­—ï¼Œé»˜èªç‚ºä¸»æ©Ÿçš„hostname&quot;&gt;#ç‚ºè©²filebeatæŒ‡å®šåå­—ï¼Œé»˜èªç‚ºä¸»æ©Ÿçš„hostname&lt;/a&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/zsql/p/13137833.htmll&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä¸€ç¯‡æ–‡ç« ææ‡‚filebeatï¼ˆELKï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;filebeat-log&quot; tabindex=&quot;-1&quot;&gt;filebeat logå¯«å…¥åˆ°æª”æ¡ˆ&lt;/h2&gt;
&lt;p&gt;filebeatåœ¨é‹ä½œæ™‚ï¼Œæœƒç”¢ç”Ÿä¸€å †logï¼Œé€™äº›æˆ‘åŸæœ¬éƒ½ä¸æƒ³è®“ä»–è¼¸å‡ºï¼Œç›´æ¥å¯«åœ¨è‡ªå·±çš„æª”æ¡ˆå°±å¥½ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/57.fig-2.jpg&quot; alt=&quot;57.fig-2.jpg&quot; /&gt;&lt;br /&gt;
ä½†æ²’æ¸¬è©¦æˆåŠŸï¼Œæœ€å¾Œåªå¥½æ¡ç”¨æ²»æ¨™ä¸æ²»æœ¬çš„æ–¹å¼ï¼Œ&lt;br /&gt;
åœ¨è©²namespaceåº•ä¸‹çš„logé€šé€šä¸é€²ESã€‚&lt;/p&gt;
&lt;p&gt;ç•™ä¸€ä¸‹æŸ¥åˆ°çš„è³‡æ–™ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;logging:
    to_files: true
    metrics.enabled: false 
    files:
      path: &#39;/usr/share/filebeat/logs&#39;
      name: &#39;filebeat&#39;
      rotateeverybytes: 10485760 # = 10MB
      keepfiles: 7
      permission: &#39;0640&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/configuration-logging.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Configure logging&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;yaml-operator&quot; tabindex=&quot;-1&quot;&gt;å®Œæ•´yamlï¼Œä½¿ç”¨operator&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: beat.k8s.elastic.co/v1beta1
kind: Beat
metadata:
  name: yabo
  namespace: elastic-system
spec:
  type: filebeat
  version: 7.15.0
  elasticsearchRef:
    name: yabo
  kibanaRef:
    name: yabo
  config:
    filebeat:
      autodiscover:
        providers:
        - type: kubernetes
          node: ${NODE_NAME}    
          hints:
            enabled: true
            default_config:
              type: container
              paths:
              - /var/log/containers/*${data.kubernetes.container.id}.log
              exclude_lines: 
              - &amp;quot;.*(NAT rule custom-iptables|unknown operand).*&amp;quot;  # æ’é™¤ k8s-custom-iptables
              - &amp;quot;.*(YABO_WS.Services.PromoWebSocketService|YABO_WS.BLL.ActivityEventLogic).*&amp;quot;      
    processors:
    - add_cloud_metadata: {}
    # - add_host_metadata: {}
    - drop_event.when:
        or:
        - equals:
            kubernetes.namespace: &amp;quot;kube-system&amp;quot;
        - equals:
            kubernetes.namespace: &amp;quot;elastic-system&amp;quot;
    - drop_fields:
          fields: 
            - &#39;kubernetes.node&#39;
            - &#39;kubernetes.namespace_uid&#39;
            - &#39;agent.hostname&#39;
            - &#39;cloud.account&#39;
            - &#39;cloud.provider&#39;
            - &#39;cloud.instance.name&#39;
            - &#39;container.id&#39;
    - decode_json_fields:
          fields: [&amp;quot;message&amp;quot;]
          target: &amp;quot;&amp;quot;
          overwrite_keys: true   
    # æ¸¬è©¦æ²’ç”¨ï¼Œç„¡æ³•å¯«åˆ° 
    # logging:
    #   to_files: true
    #   metrics.enabled: false 
    #   files:
    #     path: &#39;/usr/share/filebeat/logs&#39;
    #     name: &#39;filebeat&#39;
    #     rotateeverybytes: 10485760 # = 10MB
    #     keepfiles: 7
    #     permission: &#39;0644&#39;
  daemonSet:
    podTemplate:
      spec:
        serviceAccountName: filebeat
        automountServiceAccountToken: true
        terminationGracePeriodSeconds: 30
        dnsPolicy: ClusterFirstWithHostNet
        hostNetwork: true # Allows to provide richer host metadata
        containers:
        - name: filebeat
          securityContext:
            runAsUser: 0
            # If using Red Hat OpenShift uncomment this:
            &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#privileged&quot;&gt;#privileged&lt;/a&gt;: true
          volumeMounts:
          - name: varlogcontainers
            mountPath: /var/log/containers
          - name: varlogpods
            mountPath: /var/log/pods
          - name: varlibdockercontainers
            mountPath: /var/lib/docker/containers
          env:
            - name: NODE_NAME
              valueFrom:
                fieldRef:
                  fieldPath: spec.nodeName
        volumes:
        - name: varlogcontainers
          hostPath:
            path: /var/log/containers
        - name: varlogpods
          hostPath:
            path: /var/log/pods
        - name: varlibdockercontainers
          hostPath:
            path: /var/lib/docker/containers
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: filebeat
rules:
- apiGroups: [&amp;quot;&amp;quot;] # &amp;quot;&amp;quot; indicates the core API group
  resources:
  - namespaces
  - pods
  - nodes
  verbs:
  - get
  - watch
  - list
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: filebeat
  namespace: elastic-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: filebeat
subjects:
- kind: ServiceAccount
  name: filebeat
  namespace: elastic-system
roleRef:
  kind: ClusterRole
  name: filebeat
  apiGroup: rbac.authorization.k8s.io

...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/jatq/articles/14651723.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ECKéƒ¨ç½²&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://arch-long.cn/articles/elasticsearch/FileBeat.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;FileBeat&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.codeless.me/posts/elastic-beats-on-google-kubernetes-engine-gke/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Elastic Beats on Google Kubernetes Engine (GKE)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/DanRoscigno/GKE-on-Prem-logging-and-metrics/blob/master/filebeat-kubernetes.yaml&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;filebeat-kubernetes.yaml&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.deepnetwork.com/blog/2020/01/27/ELK-stack-filebeat-k8s-deployment.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How to Setup an ELK Stack and Filebeat on Kubernetes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;2024-05-28&quot; tabindex=&quot;-1&quot;&gt;2024/05/28è£œå……&lt;/h2&gt;
&lt;h3 id=&quot;autodiscover-log-indices&quot; tabindex=&quot;-1&quot;&gt;ä½¿ç”¨autodiscoverï¼Œæ‹†åˆ†å…©å€‹log indices&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸‹ç¨‹å¼ç¢¼ç‚ºã€ç‰‡æ®µã€ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: beat.k8s.elastic.co/v1beta1
kind: Beat
metadata:
  name: prod
  namespace: elastic-system
spec:
  type: filebeat
  version: 8.13.2
  elasticsearchRef:
    name: prod
    namespace: elastic-system
  kibanaRef:
    name: prod
    namespace: elastic-system
  config:     
    filebeat:
      autodiscover:
        providers:
        - type: kubernetes
          node: ${NODE_NAME} 
          templates:
            - condition:
                equals:
                  kubernetes.labels.app: &amp;quot;video&amp;quot;
              config:
                - type: container
                  paths:
                    - /var/log/containers/*${data.kubernetes.container.id}.log
                  processors:
                    - add_kubernetes_metadata:
                        host: ${NODE_NAME}                                                       
            - condition:
                equals:
                  kubernetes.labels.app: &amp;quot;auth&amp;quot;
              config:
                - type: container
                  paths:
                    - /var/log/containers/*${data.kubernetes.container.id}.log
                  processors:
                    - add_kubernetes_metadata:
                        host: ${NODE_NAME}                                                       
    processors:
    - add_cloud_metadata: {} 
    output.elasticsearch:
      username: &amp;quot;elastic&amp;quot;
      password: &amp;quot;password&amp;quot;  
      index: &amp;quot;logs-%{[kubernetes.labels.app]}-%{+yyyy.MM.dd}&amp;quot;
      indices:
        - index: &amp;quot;videoworker-%{+yyyy.MM.dd}&amp;quot;
          when.equals:
            kubernetes.labels.app: &amp;quot;videoworker&amp;quot;
        - index: &amp;quot;authcontrol-%{+yyyy.MM.dd}&amp;quot;
          when.equals:
            kubernetes.labels.app: &amp;quot;authcontrol&amp;quot; 
    setup.template.enabled: true
    setup.template.name: &amp;quot;filebeat-8.13.2&amp;quot;
    setup.template.pattern: &amp;quot;filebeat-8.13.2&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;èªªæ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;config.filebeat.autodiscover.providers ï¼šåº•ä¸‹ä½¿ç”¨templateï¼Œä½œç‚ºæ‹†åˆ†çš„ç¯„æœ¬ï¼ŒåŸå…ˆæ˜¯ä½¿ç”¨hintsæ©Ÿåˆ¶ï¼Œä½¿ç”¨é—œéµlabelä½œç‚ºæ“·å–çš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;output.elasticsearch: è¼¸å‡ºåˆ°elasticsearch ï¼Œé è¨­çš„indexä½¿ç”¨ logsä½œç‚ºdatastreamï¼Œåº•ä¸‹çš„indiceså‰‡æ˜¯å†ç´°åˆ†è¦å‰‡ï¼Œ å¦‚æœç¬¦åˆè¦å‰‡ï¼Œå‰‡ä½¿ç”¨å…¶ä»–çš„datastreamåç¨±ã€‚&lt;/p&gt;
&lt;p&gt;å®˜æ–¹æ–‡ä»¶ï¼Œæ˜¯ä¸ç”¨å¯«output.elasticsearchï¼Œä½†æˆ‘æä¸å‡ºä¾†ã€‚&lt;br /&gt;
æ”¹å¤©åœ¨ç¹¼çºŒè¿½äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/configuration-autodiscover-hints.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Hints based autodiscover&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-beat-configuration-examples.html#k8s-beat-configuration-examples&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Filebeat example&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/57.filebeat è£œå……èªªæ˜/" />
        </entry>
        <entry>
            <title>
                55. esåŸºæœ¬æ¦‚å¿µç¯‡
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/55. esåŸºæœ¬æ¦‚å¿µç¯‡/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å…ˆä¾†å€‹æ¯”è¼ƒå®¹æ˜“å°æ¯”çš„è¡¨æ ¼ï¼Œä½†ä¸å®Œå…¨ä¸€æ¨£ï¼Œ&lt;br /&gt;
æœ‰å¹¾å€‹æ˜¯æˆ‘è‡ªå·±åŠ ä¸Šå»çš„ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;RDBMS&lt;/th&gt;
&lt;th&gt;Elasticsearch&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;VM&lt;/td&gt;
&lt;td&gt;Node&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Table&lt;/td&gt;
&lt;td&gt;Index&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Row&lt;/td&gt;
&lt;td&gt;Document&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Column&lt;/td&gt;
&lt;td&gt;Field&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Schema&lt;/td&gt;
&lt;td&gt;Mapping&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SQL&lt;/td&gt;
&lt;td&gt;DSL&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://godleon.github.io/blog/Elasticsearch/Elasticsearch-getting-started/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[Elasticsearch] åŸºæœ¬æ¦‚å¿µ &amp;amp; æœå°‹å…¥é–€&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;æ‘˜è¦&quot; tabindex=&quot;-1&quot;&gt;æ‘˜è¦&lt;/h2&gt;
&lt;h4 id=&quot;node&quot; tabindex=&quot;-1&quot;&gt;Node&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Master Node&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è™•ç†å»ºç«‹/åˆªé™¤ index çš„ requestï¼Œä¸¦å¯¦éš›åŸ·è¡Œ&lt;/li&gt;
&lt;li&gt;æ±ºå®šæ¯å€‹ shard è¦è¢«åˆ†é…åˆ°å“ªå€‹ data node ä¸Š&lt;/li&gt;
&lt;li&gt;ç¶­è­· &amp;amp; æ›´æ–° cluster state&lt;/li&gt;
&lt;li&gt;ç•¶ master nodeå‡ºå•é¡Œï¼Œmaster eligible nodeï¼ˆå¾clusterè¨­å®šå¤šå€‹ï¼‰æœƒé–‹å§‹é¸èˆ‰ï¼Œé¸å‡ºä¸‹ä¸€å€‹ master node&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Coordinating Node(å”èª¿ç¯€é»)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰nodeé è¨­éƒ½æ˜¯ Coordinating Node&lt;/li&gt;
&lt;li&gt;è™•ç†requestçš„node ä»¥åŠ æœ€å¾Œé€²è¡Œçµæœçš„å½™æ•´&lt;/li&gt;
&lt;li&gt;coordinating node å¯ä»¥ç›´æ¥æ¥æ”¶ search request ä¸¦è™•ç†ï¼Œä¸éœ€è¦é€é master node è½‰éä¾†&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Data Node&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯ä»¥ä¿å­˜è³‡æ–™çš„ nodeï¼Œæ¯å€‹ node å•Ÿå‹•å¾Œéƒ½æœƒé è¨­æ˜¯ data nodeï¼Œå¯ä»¥é€éè¨­å®š &lt;code&gt;node.data: false&lt;/code&gt; åœç”¨ data node åŠŸèƒ½&lt;/li&gt;
&lt;li&gt;é€éå¢åŠ  data node å¯ä»¥è§£æ±ºè³‡æ–™æ°´å¹³æ“´å±• &amp;amp; è§£æ±ºå–®é»æ•…éšœå°è‡´è³‡æ–™éºå¤±çš„å•é¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cluster Stateï¼ˆé›†ç¾¤ç‹€æ…‹)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŒ…å«æ‰€æœ‰nodeè³‡è¨Š&lt;/li&gt;
&lt;li&gt;åŒ…å«æ‰€æœ‰index åŠ ç›¸å°æ‡‰çš„ mapping/settingé…ç½®&lt;/li&gt;
&lt;li&gt;shardçš„è·¯ç”±è³‡è¨Š&lt;/li&gt;
&lt;li&gt;æ¯å€‹nodeä¸Šéƒ½æœ‰Cluster Stateï¼Œåªæœ‰master å¯ä¿®æ”¹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;shard&quot; tabindex=&quot;-1&quot;&gt;Shard&lt;/h4&gt;
&lt;h6 id=&quot;shard-1&quot; tabindex=&quot;-1&quot;&gt;å°‡ç´¢å¼•åŠƒåˆ†æˆå¤šä»½çš„èƒ½åŠ›ï¼Œé€™äº›ä»½å°±å«åšåˆ†ç‰‡ï¼ˆshardï¼‰&lt;/h6&gt;
&lt;p&gt;ä¾‹å¦‚ä½ æœ‰ä¸€å€‹index ï¼ˆ1T) ï¼Œè¦æ€éº¼å­˜åˆ°ä¸åŒçš„Nodeï¼Œ&lt;br /&gt;
æ­¤æ™‚å°±éœ€è¦ä½¿ç”¨(shard)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;shard æ˜¯ ESåˆ†æ•£å¼å„²å­˜çš„åŸºç¤ï¼ŒåŒ…å« primary shard åŠ replica shard&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¯ä¸€å€‹shard å°±æ˜¯ä¸€å€‹  Lucene instance(ç”¨æ–¼å…¨æ–‡æª¢ç´¢å’Œæœå°‹ e.g. Solr,Elasticsearch...)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Primary Shard(æå‡ç³»çµ±å„²å­˜å®¹é‡)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°‡ä¸€ä»½è¢«ç´¢å¼•å¾Œçš„è³‡æ–™ï¼Œåˆ†æ•£åˆ°å¤šå€‹data nodeä¸Šå­˜æ”¾&lt;/li&gt;
&lt;li&gt;primary shard çš„æ•¸é‡åœ¨å»ºç«‹ indexæ™‚å°±æœƒæŒ‡å®šï¼Œç„¡æ³•å¾ŒçºŒä¿®æ”¹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Replica Shardï¼ˆæé«˜è³‡æ–™å¯ç”¨æ€§)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç•¶primary shardéºå¤±ï¼ŒReplica shardå¯ä»¥è¢«æ¨æˆ primary shard&lt;/li&gt;
&lt;li&gt;replica shardæ•¸é‡å¯å‹•æ…‹èª¿æ•´ï¼Œè®“æ¯å€‹data nodeä¸Šéƒ½æœ‰å®Œæ•´è³‡æ–™&lt;/li&gt;
&lt;li&gt;å¯ä¸€å®šç¨‹åº¦æé«˜æŸ¥è©¢çš„æ•ˆèƒ½&lt;/li&gt;
&lt;li&gt;ES7.0é–‹å§‹ï¼Œprimary shard é è¨­ç‚º1 ,replica shardé è¨­ ç‚º0&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚ä¸è¨­å®šreplica shardï¼Œä¸€æ—¦data node æ•…éšœå°è‡´ primary shardéºå¤±ï¼Œè³‡æ–™ç„¡æ³•å¾©åŸ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Shardè¨­å®š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;replica shardè¨­å®šéå¤šï¼Œæœƒé™ä½clsuteræ•´é«”çš„å¯«å…¥æ•ˆèƒ½&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;replica shard å¿…é ˆå’Œ primary shard è¢«åˆ†é…åœ¨ä¸åŒçš„ data node ä¸Šï¼›ä½†æ‰€æœ‰çš„ primary shard å¯ä»¥åœ¨åŒä¸€å€‹ data node ä¸Š&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;command&quot; tabindex=&quot;-1&quot;&gt;Command&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å–å¾—Cluster å¥åº·ç‹€æ…‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;	GET _cluster/health/
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Status&lt;br /&gt;
- Green ï¼šè¡¨ç¤º Primary shard &amp;amp; Replica Shardå¯æ­£å¸¸åˆ†é…&lt;br /&gt;
- Yellowï¼šè¡¨ç¤º Primay shardå¯æ­£å¸¸åˆ†é…ï¼Œä½†Replica shard åˆ†é…æœ‰å•é¡Œ&lt;br /&gt;
- Redï¼šæœ‰Primary shard ç„¡æ³•æ­£å¸¸åˆ†é…&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å–å¾— Shardç‹€æ…‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;	GET _cat/shards
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/55.fig-1.jpg&quot; alt=&quot;55.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;p ï¼šä»£è¡¨ primary shard&lt;br /&gt;
r  ï¼šä»£è¡¨ replica shard&lt;br /&gt;
2. shardçš„åˆ†ä½ˆæƒ…å½¢ï¼Œåœ¨å“ªå€‹nodeä¸Š&lt;br /&gt;
3. æ¯å€‹shardåŒ…å«çš„documentæ•¸é‡ &amp;amp; ç©ºé–“&lt;/p&gt;
&lt;h4 id=&quot;æƒ…å¢ƒ&quot; tabindex=&quot;-1&quot;&gt;æƒ…å¢ƒ&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœcluster åªæœ‰ä¸€å€‹node ï¼Œå…¨éƒ¨æœƒè¢« primary shardä½”æ“šï¼Œå°è‡´ replica shard ç„¡æ³•è¢«åˆ†é…ï¼Œå› æ­¤clusterå¥åº·ç‹€æ…‹ç‚º yellow&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;è³‡æ–™å¯«å…¥&quot; tabindex=&quot;-1&quot;&gt;è³‡æ–™å¯«å…¥&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;cache&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è³‡æ–™å¯«å…¥å¾Œç„¡æ³•è®Šå‹•ï¼Œé¿å…lockæ©Ÿåˆ¶æ‰€å¸¶ä¾†çš„æ•ˆèƒ½å•é¡Œ&lt;/li&gt;
&lt;li&gt;å› ä¸å¯è®Šå‹•ï¼Œè‹¥è¦è®“æ–°çš„document å¯è¢«æœå°‹ï¼Œéœ€è¦é‡å»ºindex&lt;/li&gt;
&lt;li&gt;å¯«å…¥documentå‰ï¼Œæœƒå…ˆå¯«åˆ° Index Bufferçš„å„²å­˜ç©ºé–“&lt;/li&gt;
&lt;li&gt;æ»¿è¶³æ¢ä»¶(Index Bufferä½”æ»¿) or ç‰¹å®šæ™‚é–“(é è¨­ä¸€ç§’ä¸€æ¬¡)ï¼Œæœƒå°‡ Buffer å¯«å…¥ Segment ã€‚å¯«å…¥çš„éç¨‹å«Refreshã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;transaction log&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯å€‹shardéƒ½æœ‰å°æ‡‰çš„transaction log&lt;/li&gt;
&lt;li&gt;å¯«å…¥documentçš„æ™‚å€™ï¼ŒåŒæ™‚ä¹Ÿæœƒå¯«å…¥ transaction log&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://godleon.github.io/blog/Elasticsearch/Elasticsearch-distributed-mechanism/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[Elasticsearch] åˆ†æ•£å¼ç‰¹æ€§ &amp;amp; åˆ†æ•£å¼æœå°‹çš„æ©Ÿåˆ¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/UbuntuTouch/article/details/99443042&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Elasticsearch ä¸­çš„ä¸€äº›é‡è¦æ¦‚å¿µ: cluster, node, index, document, shards åŠ replica&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://jeff-yen.medium.com/elasticsearch-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E5%8F%8A%E8%A6%8F%E5%8A%83-e1763b856a08&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Elasticsearch åŸºæœ¬åŸç†åŠè¦åŠƒ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/55. esåŸºæœ¬æ¦‚å¿µç¯‡/" />
        </entry>
        <entry>
            <title>
                53. apm error
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/53. apm error/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;éŒ¯èª¤è¨Šæ¯&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There are no ingest nodes in this cluster, unable to forward request to an ingest node.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ESçš„yaml&lt;br /&gt;
å¢åŠ &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;node.roles:
- ingest
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Node&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/UbuntuTouch/article/details/99702199&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¦‚ä½•åœ¨ Elasticsearch ä¸­ä½¿ç”¨ pipeline API ä¾†å°äº‹ä»¶é€²è¡Œè™•ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://discuss.elastic.co/t/there-are-no-ingest-nodes-in-this-cluster-unable-to-forward-request-to-an-ingest-node/279740&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;There are no ingest nodes in this cluster, unable to forward request to an ingest node&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/53. apm error/" />
        </entry>
        <entry>
            <title>
                52. ILM è¨­å®š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/52. ILM è¨­å®š/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨é è¨­çš„filebeat.yamlè¨­å®šï¼Œ&lt;br /&gt;
å°è‡´ç¾åœ¨elasticsearchçš„logçˆ†ç‚¸äº†ã€‚&lt;br /&gt;
é€£é–‹éƒ½é–‹ä¸èµ·ä¾†ã€‚&lt;br /&gt;
æ‰€ä»¥é€™æ¬¡è¦è§£æ±ºå…©å€‹å•é¡Œï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è‡ªå‹•åˆªé™¤èˆŠçš„log&lt;/li&gt;
&lt;li&gt;å°‡logæ ¹æ“šæ—¥æœŸåˆ†é…&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç¶“éä¸€æ—©ä¸Šçš„ç ”ç©¶ï¼Œç™¼ç¾æˆ‘æƒ³å¾—è·Ÿæˆ‘è¦è§£æ±ºçš„å•é¡Œä¸ä¸€æ¨£XDDD&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æœ¬æ–‡æœƒåœ¨æ¢è¨ILMçš„è¨­å®š&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æœ‰äº›è§€å¿µè·Ÿæˆ‘æƒ³å¾—ä¸ä¸€æ¨£ï¼Œ&lt;br /&gt;
ä¸‹åœ–çœ‹åˆ°çš„ indicesï¼Œæ˜¯åœ¨elasticSearchï¼ˆç°¡ç¨±ESï¼‰ä¸Šï¼Œ&lt;br /&gt;
æ‰€å»ºç«‹çš„ã€‚&lt;/p&gt;
&lt;p&gt;ESä¸Šçš„indicesæœƒé•·é€™æ¨£&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/52-fig.1.jpg&quot; alt=&quot;52-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è·ŸfileBeatæ²’æœ‰é—œä¿‚ï¼ŒfileBeatåªè² è²¬æŠŠè³‡æ–™ä¸Ÿéå»ESä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ç•¶ç„¶è£¡é¢ä¹Ÿæœ‰ä¸€äº›è¨­å®šï¼Œç­‰ä»¥å¾Œæœ‰ç©ºå†ä¾†ç ”ç©¶ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆåˆ° kibanaçš„ç•«é¢ï¼Œ&lt;br /&gt;
åˆ° Management ä¸­å»è¨­å®šILM&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/52-fig.2.jpg&quot; alt=&quot;52-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è£¡é¢çš„è¨­å®šï¼Œè«‹åƒè€ƒä¸‹é¢æ–‡ç« ï¼Œ&lt;br /&gt;
æˆ–æ˜¯ç›´æ¥çœ‹è‹±æ–‡ä¹Ÿå¯ä»¥æ‡‚ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æœ€å¥½å…ˆçœ‹ä¸€ä¸‹æ–‡ç« ï¼Œesçš„ indices å€åˆ†æˆä¸‰å€‹éšæ®µï¼Œ&lt;br /&gt;
æ”¹å®Œè¨­å®šå¾Œï¼Œä¸¦ä¸æœƒç«‹å³ç”Ÿæ•ˆï¼Œåªæœ‰ç•¶éåº¦åˆ°ä¸‹ä¸€å€‹éšæ®µçš„æ™‚å€™ï¼Œé…ç½®æ‰æœƒç”Ÿæ•ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯èªªï¼Œå¦‚æœä½ ä¸€ç›´åœ¨ Hot phaseï¼Œ&lt;br /&gt;
é‚£æ°¸é ä¸æœƒåŸ·è¡Œä½ å‰›è¨­å®šçš„åƒæ•¸ã€‚&lt;/p&gt;
&lt;p&gt;ä½†ä¸€ç•¶ä½ é€²å…¥Warm phaseæ™‚ï¼Œ&lt;br /&gt;
ä½ å‰›å‰›è¨­å®šçš„åƒæ•¸å°±éƒ½æœƒåŸ·è¡Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/52-fig.3.jpg&quot; alt=&quot;52-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–åœ¨å„å€‹ phase ï¼Œèƒ½åšçš„äº‹æƒ…ä¹Ÿéƒ½ä¸ä¸€æ¨£ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Index Lifecycle Management çš„éšæ®µ&lt;/th&gt;
&lt;th&gt;æ­¤éšæ®µä¸­å¯ä»¥åŸ·è¡Œçš„æ“ä½œæœ‰ä»€éº¼&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Hot&lt;/td&gt;
&lt;td&gt;Force merge, Rollover, Set priority, Unfollow&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Warm&lt;/td&gt;
&lt;td&gt;Allocate, Force merge, Read only, Set priority, Shrink, Unfollow&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Cold&lt;/td&gt;
&lt;td&gt;Allocate, Freeze, Set priority, Unfollow&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Delete&lt;/td&gt;
&lt;td&gt;Delete, Wait for snapshot&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;åƒè¦åˆªé™¤ indices çš„è©±ï¼Œå°±å¿…é ˆè¦åˆ° Delete phaseçš„éšæ®µæ‰å¯ä»¥ã€‚&lt;/p&gt;
&lt;p&gt;ps. å¦‚æœç™¼ç¾æ²’æœ‰çœ‹åˆ° delete phaseï¼Œ&lt;br /&gt;
è¦å…ˆæŠŠä¸‹åœ–çš„é–‹é—œåˆ‡æ›éå»ï¼Œdelete phase æ‰æœƒå‡ºç¾ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/52-fig.4.jpg&quot; alt=&quot;52-fig.4.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è¨­å®šå®Œå¾Œï¼Œå¯ä»¥åˆ° Dev Tools ï¼Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥è©¢æœ‰å“ªäº› indices&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;GET /_cat/indices

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/52-fig.5.jpg&quot; alt=&quot;52-fig.5.jpg&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥indicesç‹€æ…‹&lt;br /&gt;
å°‡å³é‚Šçš„ indicsï¼Œå–ä»£ä¸‹é¢çš„url ã€‚&lt;br /&gt;
é€™é‚Šä½¿ç”¨çš„ indices åç¨±ç‚º filebeat-7.15.0-2021.10.07-000001 ï¼Œå¦‚æœè¦çŸ¥é“jsonå…§çš„å…§å®¹æ„ç¾©ï¼Œè«‹åƒè€ƒä¸‹é¢é€£çµã€Explain lifecycle APIã€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;GET filebeat-7.15.0-2021.10.07-000001/_ilm/explain
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/52-fig.6.jpg&quot; alt=&quot;52-fig.6.jpg&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å•Ÿå‹• ILM&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;POST /_ilm/start
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10244575&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å–¬å”æ•™ Elastic - 11 - ç®¡ç† Index çš„ Best Practices (3/7) - Index Lifecycle Management (ILM)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/cn/blog/implementing-hot-warm-cold-in-elasticsearch-with-index-lifecycle-management&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨ç´¢å¼•ç”Ÿå‘½é€±æœŸç®¡ç†å¯¦ç¾ç†±æº«å†·æ¶æ§‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/6.7/ilm-explain-lifecycle.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Explain lifecycle API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://discuss.elastic.co/t/automatically-delete-old-indices/190276&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Automatically delete old indices&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è·Ÿé€™æ¬¡çš„å•é¡Œæ²’é—œä¿‚ï¼Œä½†é‚„æ˜¯ç•™å€‹é€£çµ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://shazi.info/filebeat-harvester-%E7%9A%84-file-handler-close-%E8%88%87-clean-%E6%A9%9F%E5%88%B6/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Filebeat harvester çš„ file handler close èˆ‡ clean æ©Ÿåˆ¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.51cto.com/u_10120275/2132800&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;filebeaté€²ç¨‹å¯«æ»¿ç£ç›¤çš„æƒ…æ³è™•ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://codingnote.cc/zh-tw/p/134769/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä¸€ç¯‡æ–‡ç« ææ‡‚filebeatï¼ˆELKï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/whych/p/9958188.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Filebeaté…ç½®åƒè€ƒæ‰‹å†Š&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;curator&quot; tabindex=&quot;-1&quot;&gt;curator&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.twblogs.net/a/5e511223bd9eee21167f04b2&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;elasticsearch curatorå®‰è£åŠæ‡‰ç”¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/@vidyasonawane20/install-and-configure-elasticsearch-curator-to-delete-the-old-indices-acee09344852&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Install and configure Elasticsearch Curator to delete the old indices.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.johnwu.cc/article/elk-purge-elasticsearch-index.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ELK æ•™å­¸ - å®šæœŸæ¸…é™¤ Elasticsearch è³‡æ–™&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/52. ILM è¨­å®š/" />
        </entry>
        <entry>
            <title>
                43.è‡ªå»ºECK on GKE
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/43.è‡ªå»ºECK on GKE/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;Elastic Cloud on Kubernetes ç°¡åŒ–äº†åœ¨ Kubernetes ä¸­é‹è¡Œ Elasticsearch å’Œ Kibana çš„ä½œæ¥­ï¼ŒåŒ…æ‹¬è¨­ç½®ã€å‡ç´šã€å¿«ç…§ã€æ“´å±•ã€é«˜å¯ç”¨æ€§ã€å®‰å…¨æ€§ç­‰&lt;/p&gt;
&lt;p&gt;istio å®‰è£æ™‚ï¼Œé–‹log&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;istioctl manifest install -f loadBalancerSourceRange.yaml --set meshConfig.accessLogFile=/dev/stdout
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–æ˜¯æ›´æ”¹yaml ï¼ŒåŠ ä¸Š meshConfigé€™æ®µ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kind: IstioOperator
apiVersion: install.istio.io/v1alpha1
metadata:
  annotations:
    install.istio.io/ignoreReconcile: &#39;true&#39;
  name: istio-external
  namespace: istio-system
spec:
  meshConfig:
    accessLogFile: /dev/stdout
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ECK&lt;/p&gt;
&lt;p&gt;Kubernetes before 1.16ä»¥ä¸Šç‰ˆæœ¬&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl create -f https://download.elastic.co/downloads/eck/2.1.0/crds.yaml
kubectl apply -f https://download.elastic.co/downloads/eck/2.1.0/operator.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;éœ€å…ˆå®‰è£ elasticsearch Operator&lt;br /&gt;
ref.&lt;a href=&quot;https://operatorhub.io/operator/elastic-cloud-eck&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Elasticsearch (ECK) Operator&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½ˆç½² elasticsearch&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt;EOF | kubectl apply -f -
apiVersion: elasticsearch.k8s.elastic.co/v1
kind: Elasticsearch
metadata:
  name: quickstart
spec:
  version: 7.15.0
  nodeSets:
  - name: default
    count: 1
    config:
      node.store.allow_mmap: false
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æª¢æŸ¥ç‹€æ…‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;	kubectl get elasticsearch
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ°podè£¡é¢æ¸¬è©¦elasticæ˜¯å¦æ­£å¸¸&lt;br /&gt;
å¯†ç¢¼éœ€ä½¿ç”¨ kubectl get secret  å–å¾—ï¼Œ&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/43.%E8%87%AA%E5%BB%BAECK%20on%20GKE/#%E5%8F%96%E5%BE%97%E5%AF%86%E7%A2%BC%EF%BC%9A&quot;&gt;&lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å–å¾—å¯†ç¢¼ï¼š&quot;&gt;#å–å¾—å¯†ç¢¼ï¼š&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl https://10.107.201.126:9200 -u &#39;elastic:J1fO9bu8adfsepYK8rIu91a73o&#39; -k
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­£å¸¸çš„è©±ï¼Œæœƒé¡¯ç¤º&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/43-fig.0.jpg&quot; alt=&quot;43-fig.0.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;ä½ˆç½²kibana&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt;EOF | kubectl apply -f -
apiVersion: kibana.k8s.elastic.co/v1
kind: Kibana
metadata:
  name: quickstart
spec:
  version: 7.15.0
  count: 1
  elasticsearchRef:
    name: quickstart
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æª¢æŸ¥ç‹€æ…‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;	kubectl get kibana
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç™»å…¥&lt;/p&gt;
&lt;p&gt;å¸³è™Ÿï¼šelastic&lt;/p&gt;
&lt;h4 id=&quot;å–å¾—å¯†ç¢¼ï¼š&quot; tabindex=&quot;-1&quot;&gt;å–å¾—å¯†ç¢¼ï¼š&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;kubectl get secret quickstart-es-elastic-user -o=jsonpath=&#39;{.data.elastic}&#39; | base64 --decode; echo
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è½‰port&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl port-forward service/quickstart-kb-http 5601
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;url : &lt;a href=&quot;https://localhost:5601/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://localhost:5601&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;beat&quot; tabindex=&quot;-1&quot;&gt;beat&lt;/h1&gt;
&lt;p&gt;Beats å…¶å¯¦æ˜¯ä¸€ç³»åˆ—å·¥å…·çš„ç¸½ç¨±ï¼Œå¯ä»¥è§£æ±ºä¸‹åˆ—çš„å•é¡Œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è®€å–æª”æ¡ˆ&lt;/li&gt;
&lt;li&gt;æå–æŒ‡æ¨™&lt;/li&gt;
&lt;li&gt;æå–ç¶²è·¯è³‡æ–™&lt;/li&gt;
&lt;li&gt;æ¸¬è©¦æœå‹™å¯ç”¨æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ‰é€™äº› Filebeat, Metricbeat,Heartbeat,Packetbeat...ç­‰&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/GeZmgxJ.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥è©¢ç›®å‰æœ‰å“ªäº›indexäº†&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/43-fig.1.jpg&quot; alt=&quot;43-fig.1.jpg&quot; /&gt;&lt;br /&gt;
åˆ°DevToolsåŸ·è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET _cat/indices?s=index
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://www.elastic.co/beats/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Beats&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10235198&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ã€ESæ–°æ‰‹ï¼Œç ´é–€è€Œå…¥ï¼ã€‘Day9 - æˆ‘è¦‹æ•…æˆ‘åœ¨ï¼Observability åŸºç¤ä¹‹è¶´ç‰¹ç¡&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10236378&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ã€ESæ–°æ‰‹ï¼Œç ´é–€è€Œå…¥ï¼ã€‘Day13 - é—œæ–¼ Metrics çš„ 23456 äº‹&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;filebeat&quot; tabindex=&quot;-1&quot;&gt;Filebeat&lt;/h2&gt;
&lt;p&gt;æ—¥èªŒè™•ç†å·¥å…·ï¼Œåªè¦æœƒç”¢ç”Ÿæ—¥èªŒçš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨å®ƒï¼Œå®ƒå¯ä»¥å¹«åŠ©ä½ å°‡æ—¥èªŒå‚³é€åˆ° Elasticsearch æˆ–å…¶ä»–çš„ç³»çµ±ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/Bj8v2F5.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
log ä½ç½®&lt;br /&gt;
/var/log/containers&lt;/p&gt;
&lt;p&gt;æŸ¥è©¢å‚³äº†å“ªäº›è³‡æ–™åˆ°elastic searchè£¡é¢ã€‚&lt;br /&gt;
åŒæ¨£ä½¿ç”¨ Devtools&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET filebeat-*/_search
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/43-fig.2.jpg&quot; alt=&quot;43-fig.2.jpg&quot; /&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/57.filebeat%20%E8%A3%9C%E5%85%85%E8%AA%AA%E6%98%8E/&quot;&gt;57.filebeat è£œå……èªªæ˜&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://linyencheng.github.io/2020/09/09/elastic-observability-logging-introduction/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Elastic Logging X Filebeat æ·±å…¥ç†è§£&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;metricsbeat&quot; tabindex=&quot;-1&quot;&gt;Metricsbeat&lt;/h2&gt;
&lt;p&gt;å°‡æŒ‡æ¨™å‚³é€åˆ° Elasticsearch åˆ†æï¼Œä¸¦æ­é… Kibana åšè¦–è¦ºåŒ–ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡æ¨™è‘—é‡åœ¨è³‡è¨Šçš„é€±æœŸæ€§æ¸¬é‡ï¼Œè®“æˆ‘å€‘å¯ä»¥ç­è§£ç³»çµ±çš„ç‹€æ…‹å¦‚ç¡¬ç¢Ÿç©ºé–“ã€CPUä½¿ç”¨ç‡ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10235524&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ESæ–°æ‰‹ï¼Œç ´é–€è€Œå…¥ï¼ã€‘Day10 - çœ¼è¦‹ç‚ºæ†‘ï¼Observability åŸºç¤ä¹‹è¶´ç‰¹ä½›&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;apm&quot; tabindex=&quot;-1&quot;&gt;APM&lt;/h2&gt;
&lt;p&gt;APM çš„å…¨åæ˜¯ Application Performance Monitoringï¼ˆæ‡‰ç”¨ç¨‹å¼æ•ˆèƒ½ç›£æ§ï¼‰ï¼Œæ˜¯ç”¨ä¾†å›ç­”ä¸‹é¢å…©å€‹ä¸»è¦çš„å•é¡Œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‡‰ç”¨ç¨‹å¼è¦èŠ±å¤šä¹…æ™‚é–“ä¾†ç­”è¦†è«‹æ±‚ï¼ˆrequestï¼‰ï¼Ÿ&lt;/li&gt;
&lt;li&gt;æ‡‰ç”¨ç¨‹å¼é‡åˆ°ä»€éº¼ç¨®é¡çš„éŒ¯èª¤ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Elastic APM æ˜¯ç”±ä¸‹åˆ— 4 å€‹çµ„ä»¶æ‰€æ§‹æˆï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;APM Agents&lt;/li&gt;
&lt;li&gt;APM Server&lt;/li&gt;
&lt;li&gt;Elasticsearch&lt;/li&gt;
&lt;li&gt;Kibana&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/kyuDM8Q.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;apm-server&quot; tabindex=&quot;-1&quot;&gt;ä½ˆç½²APM server&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt;EOF | kubectl apply -f -
apiVersion: apm.k8s.elastic.co/v1
kind: ApmServer
metadata:
  name: apm-server-quickstart
  namespace: default
spec:
  version: 7.15.0
  count: 1
  elasticsearchRef:
    name: quickstart
  kibanaRef:
    name: quickstart
  config:
    output:
      elasticsearch:
        host: [quickstart-es-http.default:9200]
        username: elastic
        password: &amp;quot;E1R10XXXXXXfr40&amp;quot;
        protocol: &amp;quot;http&amp;quot;
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šçš„passwordè¦ç›´æ¥ä¸‹æŒ‡ä»¤æŸ¥è©¢ï¼Œé€™å€‹æ˜¯å‰é¢ç™»å…¥kibanaçš„å¯†ç¢¼ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get secret quickstart-es-elastic-user -o=jsonpath=&#39;{.data.elastic}&#39; | base64 --decode; echo
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚ºäº†ç’°å¢ƒå–®ç´”ï¼Œæ‰€ä»¥åªä½¿ç”¨httpï¼Œè¦ç”¨httpsè«‹åƒè€ƒé€£çµ &lt;a href=&quot;https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-apm-advanced-configuration.html#k8s-apm-existing-es&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Reference an existing Elasticsearch cluster&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://linyencheng.github.io/2020/09/12/elastic-apm-fundamentals/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Elastic APM åŸºç¤æ•™å­¸&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10235524&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ESæ–°æ‰‹ï¼Œç ´é–€è€Œå…¥ï¼ã€‘Day10 - çœ¼è¦‹ç‚ºæ†‘ï¼Observability åŸºç¤ä¹‹è¶´ç‰¹ä½›&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-apm-server.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Run APM Server on ECK&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;go-apm-agent&quot; tabindex=&quot;-1&quot;&gt;GO-APM agent&lt;/h2&gt;
&lt;p&gt;åœ¨å»ºç«‹ apm-serverçš„æ™‚å€™ï¼Œ&lt;br /&gt;
æœƒåŒæ™‚å»ºç«‹å¥½ secret token ï¼Œé€™å€‹åŒæ¨£éœ€è¦ä¸‹æŒ‡ä»¤å–å¾—ï¼Œ&lt;br /&gt;
ä¹‹å¾Œåœ¨ agentä¸Šé¢è¨­å®šå®Œï¼Œæ‰èƒ½å°‡è³‡æ–™å‚³åˆ° APM serverä¸Šé¢ã€‚&lt;/p&gt;
&lt;p&gt;é€™é‚Šå–config  nameç‚º ( [apm name]apm-token )&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  kubectl get secret apm-server-quickstart-apm-token -o=jsonpath=&#39;{.data.secret-token}&#39; | base64 --decode; echo
  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¨­å®šAPM serverç’°å¢ƒè®Šæ•¸ï¼Œç”±æ–¼æˆ‘çš„æœå‹™éƒ½æ˜¯docker imageï¼Œ&lt;br /&gt;
æ‰€ä»¥è¦æŠŠè®Šæ•¸å¯«åœ¨Dockerfileè£¡é¢ï¼Œç•¶æ‰“åŒ…æ™‚ï¼Œä¸€ä½µè¨­å®šå¥½&lt;a href=&quot;https://www.elastic.co/guide/en/apm/agent/go/current/configuration.html#config-server-url&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç’°å¢ƒè®Šæ•¸&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
...
ENV ELASTIC_APM_SERVER_URL=https://apm-server-quickstart-apm-http.default:8200
ENV ELASTIC_APM_SERVICE_NAME=webhook
ENV ELASTIC_APM_SECRET_TOKEN=9m9XXXXXXGjwdIk41
ENV ELASTIC_APM_VERIFY_SERVER_CERT=false
ENV ELASTIC_APM_ENVIRONMENT=qa
...

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œå† main.go ï¼ŒåŠ ä¸Šä¸‹é¢å¹¾è¡Œã€‚&lt;br /&gt;
é€™ä»½goçš„ç¨‹å¼ï¼Œæœ¬èº«ä½¿ç”¨äº† &lt;a href=&quot;https://www.elastic.co/guide/en/apm/agent/go/current/builtin-modules.html#builtin-modules-apmgorilla&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gorilla/mux&lt;/a&gt;çš„webæ¡†æ¶&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç…§å®˜æ–¹æ–‡ä»¶çš„èªªæ˜ï¼ŒåŠ ä¸Šä¸‹é¢å¹¾è¡Œã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import (
	&amp;quot;github.com/gorilla/mux&amp;quot;

	&amp;quot;go.elastic.co/apm/module/apmgorilla&amp;quot;
)

func main() {
	router := mux.NewRouter()
	apmgorilla.Instrument(router)
	http.ListenAndServe(&amp;quot;:80&amp;quot;, router)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸»è¦åªæœ‰  apmgorilla.Instrument(router) é€™è¡Œï¼Œ&lt;br /&gt;
ç„¶å¾Œåªè¦æœ‰ç¶“é80 portçš„è³‡æ–™å°±é€šé€šéƒ½æœƒé€²å…¥åˆ°APMè£¡é¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/43-fig.3.jpg&quot; alt=&quot;43-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€™å¼µåœ–è£¡é¢çš„TPSæ„æ€ï¼Œå¯åƒè€ƒ &lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;blog.45.ç¶²ç«™æ•ˆèƒ½æŒ‡æ¨™ä¸€è¦½ï¼ˆæœªï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://www.elastic.co/guide/en/cloud-on-k8s/master/k8s-apm-connecting.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;APM Server secret token&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.elastic.co/cn/blog/how-to-instrument-your-go-app-with-the-elastic-apm-go-agent&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¦‚ä½•ä½¿ç”¨ Elastic APM Go ä»£ç†ç‚º Go æ‡‰ç”¨è£è¼‰æ¸¬é‡å·¥å…·&lt;/a&gt;&lt;br /&gt;
[&lt;a href=&quot;https://myapollo.com.tw/zh-tw/docker-env/&quot; title=&quot;Docker ç’°å¢ƒè®Šæ•¸ä½¿ç”¨ç­†è¨˜&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Docker ç’°å¢ƒè®Šæ•¸ä½¿ç”¨ç­†è¨˜&lt;/a&gt;](&lt;a href=&quot;https://myapollo.com.tw/zh-tw/docker-env/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://myapollo.com.tw/zh-tw/docker-env/&lt;/a&gt;)&lt;br /&gt;
&lt;a href=&quot;https://www.gushiciku.cn/pl/pYOg/zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Elastic APM-Go Agentä»‹ç´¹(ä¸­æ–‡ç¿»è­¯)&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.elastic.co/guide/en/cloud-on-k8s/master/k8s-apm-connecting.html#k8s-apm-secret-token&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;connect to the APM Server&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://blog.csdn.net/UbuntuTouch/article/details/105527468&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Solutionsï¼šå®‰å…¨çš„APMæœå‹™å™¨è¨ªå•&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;vue-apm-agent&quot; tabindex=&quot;-1&quot;&gt;vue-APM agent&lt;/h2&gt;
&lt;p&gt;å®‰è£ä¾è³´å¥—ä»¶&lt;/p&gt;
&lt;h2 id=&quot;kibana&quot; tabindex=&quot;-1&quot;&gt;Kibana&lt;/h2&gt;
&lt;p&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/61.%20kibana%20%E6%9F%A5%E8%A9%A2%E8%AA%9E%E6%B3%95/&quot;&gt;61. kibana æŸ¥è©¢èªæ³•&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://www.elastic.co/guide/en/kibana/7.15/kuery-query.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kibana Query Language&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/43.è‡ªå»ºECK on GKE/" />
        </entry>
        <entry>
            <title>
                187. ECKçš„filebeat
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/187. ECKçš„filebeat/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¸€èˆ¬filebeatï¼Œæˆ‘ä¹‹å‰éƒ½æ˜¯åšæˆdaemonsetï¼Œ&lt;br /&gt;
ç›´æ¥æŠ“æ¨™æº–è¼¸å‡ºï¼Œå‚³å»elasticserachè£é¢ã€‚&lt;br /&gt;
ä½†ç›®å‰ï¼Œä»–å€‘é‚„æ˜¯ç¿’æ…£å¯«æ–‡å­—æª”åˆ°ç‰¹å®šç›®éŒ„ï¼Œ&lt;br /&gt;
filebeatå†å»é‚£å€‹ç›®éŒ„æŠ“è³‡æ–™å¯«å…¥ï¼Œ&lt;br /&gt;
æ‰€ä»¥è®Šæˆä¹Ÿè¦æ›è¼‰ä¸€å€‹readwritemanyçš„nfsã€‚&lt;br /&gt;
é‚£é‚Šè¨­å®šæˆ‘é‚„æœ‰é»å›°æƒ‘ï¼Œé‚„éœ€è¦æ¸¬è©¦ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;Elasticsearch 8.* ç‰ˆæœ¬å¾Œï¼Œéƒ½è¦æ±‚åŠ å¯†æ†‘è­‰ï¼Œ&lt;br /&gt;
æ‰€ä»¥è¦ç”¨httpå‚³å¾ˆéº»ç…©ï¼Œ&lt;br /&gt;
å¯èƒ½é‚„è¦é™å®šç‰ˆæœ¬ï¼Œæœ€å¾Œæˆ‘ä¹Ÿæ”¾æ£„äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ECKçš„å¥½è™•æ˜¯ä¸ç”¨ç‰¹åˆ¥è¨­å®šcaï¼Œ&lt;br /&gt;
ä½†filebeaté€™é‚Šçš„è¨­å®šå°±è¦æŒ‡å®škibanaè·Ÿelasticsearchäº†&lt;br /&gt;
ä½†åœ¨ä¸åŒçš„nsï¼Œæ•…éœ€ç‰¹åˆ¥æŒ‡å®šnsã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: beat.k8s.elastic.co/v1beta1
kind: Beat
metadata:
  name: filebeat
spec:
  type: filebeat
  version: 8.11.0
  elasticsearchRef:
    name: fixed
    namespace: elastic-system
  kibanaRef:
    name: fixed
    namespace: elastic-system
  config:
    filebeat.inputs:
      &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#websocketclient&quot;&gt;#websocketclient&lt;/a&gt;
      - type: log
        ignore_older: 24h
        enabled: true
        paths:
          - /var/log/app-logs/websocketclient/*.log
        json.keys_under_root: true
        json.add_error_key: true
        fields_under_root: true
        tags: [&amp;quot;prod-sms-back-websocketclient&amp;quot;]
      &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#filebeat_self&quot;&gt;#filebeat_self&lt;/a&gt;
      - type: log
        ignore_older: 24h
        enabled: true
        paths:
          - /var/log/filebeat/*.ndjson
        json.keys_under_root: true
        json.add_error_key: true
        fields_under_root: true
        tags: [&amp;quot;filebeat_self&amp;quot;]
    processors:
      - timestamp:
          field: LoggingTime
          layouts:
            - &#39;2006-01-02T15:04:05Z&#39;
            - &#39;2006-01-02T15:04:05.999Z&#39;
            - &#39;2006-01-02T15:04:05.999-07:00&#39;
          test:
            - &#39;2019-06-22T16:33:51Z&#39;
            - &#39;2019-11-18T04:59:51.123Z&#39;
            - &#39;2020-08-03T07:10:20.123456+02:00&#39;
      - add_locale:
          format: offset
      - drop_fields:
          fields: [&amp;quot;agent&amp;quot;, &amp;quot;input&amp;quot;, &amp;quot;host&amp;quot;, &amp;quot;log&amp;quot;, &amp;quot;ecs&amp;quot;, &amp;quot;data_stream&amp;quot;, &amp;quot;event.timezone&amp;quot;, &amp;quot;LoggingTime&amp;quot;]
    output.elasticsearch:
      username: &amp;quot;elastic&amp;quot;
      password: &amp;quot;abc&amp;quot;      
      indices:
      &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#websocketclient&quot;&gt;#websocketclient&lt;/a&gt;
      - index: &amp;quot;prod-sms-back-websocketclient-%{+yyyy.MM.dd}&amp;quot;
        when.contains:
            tags: &amp;quot;prod-sms-back-websocketclient&amp;quot;
      &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#filebeat_self&quot;&gt;#filebeat_self&lt;/a&gt;
      - index: &amp;quot;filebeat_self-%{+yyyy.MM.dd}&amp;quot;
        when.contains:
          tags: &amp;quot;filebeat_self&amp;quot;
    logging:
      metrics.enabled: false
      level: info
      to_files: true
      files:
        path: /var/log/filebeat
        name: filebeat
        keepfiles: 7
        permissions: 0644          
  deployment:
    podTemplate:
      spec:
        automountServiceAccountToken: true
        terminationGracePeriodSeconds: 30
        dnsPolicy: ClusterFirstWithHostNet
        hostNetwork: true # Allows to provide richer host metadata
        containers:
        - name: filebeat
          securityContext:
            runAsUser: 0
            # If using Red Hat OpenShift uncomment this:
            &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#privileged&quot;&gt;#privileged&lt;/a&gt;: true
          volumeMounts:
          - name: applog
            mountPath: /var/log/app-logs            
        volumes:
        - name: applog
          persistentVolumeClaim:
            claimName: logs-nfs-test-pvc 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‚™è¨»ä¸€ä¸‹ï¼Œå®Œæ•´ECKå®‰è£çš„yaml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;# 1. setup eck operator and crd
# kubectl create -f https://download.elastic.co/downloads/eck/2.10.0/crds.yaml
# kubectl apply -f https://download.elastic.co/downloads/eck/2.10.0/operator.yaml


apiVersion: elasticsearch.k8s.elastic.co/v1
kind: Elasticsearch
metadata:
  name: fixed
  # name: yabo
  namespace: elastic-system
spec:  
  version: 8.11.0
  nodeSets:
  - name: all
    count: 1
    podTemplate:      
      spec:  
        containers:
        - name: elasticsearch
          env:
          - name: ES_JAVA_OPTS
            value: -Xms2g -Xmx2g
          resources:
            requests:
              memory: 4Gi
            limits:
              memory: 4Gi  
    config:
      node.roles:
          - master
          - data
          - ingest
      node.attr.attr_name: attr_value
      node.store.allow_mmap: false   
    volumeClaimTemplates:
    - metadata:
        name: elasticsearch-data # Do not change this name unless you set up a volume mount for the data path.
      spec:
        accessModes:
        - ReadWriteOnce
        resources:
          requests:
            storage: 100Gi
        storageClassName: standard        
# å„²å­˜ç©ºé–“éœ€è¦åŠ å¤§ï¼Œé è¨­åªæœ‰1G ä¸å¤ 

---

apiVersion: kibana.k8s.elastic.co/v1
kind: Kibana
metadata:
  name: fixed
  namespace: elastic-system
spec:
  version: 8.11.0
  count: 1
  elasticsearchRef:
    name: fixed    
  http:
    tls:
      selfSignedCertificate:
        disabled: true
    service:
      spec:
        ports:
          - name: http
            port: 5601
            targetPort: 5601        

---

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.cnblogs.com/jatq/articles/14651723.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ECKéƒ¨ç½²&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/187. ECKçš„filebeat/" />
        </entry>
        <entry>
            <title>
                111. filebeat error
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/111. filebeat error/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;ç¦®æ‹œä¸€ä¸Šç­å°±è½åŒäº‹å†èªªï¼Œfilebeat stageç’°å¢ƒæœ‰å•é¡Œï¼Œ&lt;br /&gt;
æˆ‘é‚„åœ¨ç¦®æ‹œä¸€ç—‡å€™ç¾¤é˜¿~~&lt;br /&gt;
å“ï½SREçš„å®¿å‘½ï¼Œå…ˆä¿®å§&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä¸€é–‹å§‹çš„å•é¡Œå¾ˆç°¡å–®ï¼Œå°±output serviceè¨­å®šéŒ¯èª¤ï¼Œ&lt;br /&gt;
ç„¡æ³•é€£ç·šã€‚&lt;/p&gt;
&lt;p&gt;æ”¹å®Œå¾Œï¼Œæ›å¦ä¸€å€‹éŒ¯èª¤ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Validation Failed: 1: this action would add [2] total shards, but this cluster currently has [1000]/[1000] maximum shards open&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%92%20EFK/111.fig-1.jpg&quot; alt=&quot;111.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;googleä¸€ä¸‹ï¼Œå°±çœ‹åˆ°&lt;a href=&quot;https://shazi.info/elasticsearch-7-x-node-%E9%96%8B%E6%94%BE-1000-%E5%80%8B-shards-%E9%99%90%E5%88%B6/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Elasticsearch 7.x node é–‹æ”¾ 1000 å€‹ shards é™åˆ¶&lt;/a&gt;äº†ã€‚&lt;br /&gt;
ä¸Šé¢é€£çµæ˜¯ç”¨curl æ‰“ç¶²å€ç›´æ¥æ”¹ï¼Œä¸‹é¢æ˜¯åˆ°dev Toolsä¸‹æŒ‡ä»¤ï¼Œ&lt;br /&gt;
æ‰€ä»¥æœ‰é»ä¸ä¸€æ¨£ã€‚&lt;br /&gt;
åˆ°kibanaä¸Šçš„dev toolsåŠ ä¸Šé€™æ®µï¼ŒæŠŠ1000çš„ä¸Šé™æ‹‰å¤§ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;PUT _cluster/settings
{
  &amp;quot;persistent&amp;quot;: { 
    &amp;quot;cluster.max_shards_per_node&amp;quot;: &amp;quot;3000&amp;quot; 
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-update-settings.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;cluster-update-settings&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;non-zero-metrics-in-the-last-30s&quot; tabindex=&quot;-1&quot;&gt;Non-zero metrics in the last 30s&lt;/h3&gt;
&lt;p&gt;çœ‹filebeatè£é¢çš„è¨Šæ¯ï¼Œä¸€ç›´å‡ºç¾é€™ä¸²ã€‚&lt;br /&gt;
é—œæ‰å§ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# If enabled, filebeat periodically logs its internal metrics that have changed
# in the last period. For each metric that changed, the delta from the value at
# the beginning of the period is logged. Also, the total values for
# all non-zero internal metrics are logged on shutdown. The default is true.
&lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#logging&quot;&gt;#logging&lt;/a&gt;.metrics.enabled: true

# The period after which to log the internal metrics. The default is 30s.
&lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#logging&quot;&gt;#logging&lt;/a&gt;.metrics.period: 30s
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†åœ¨filebeat yamlä¸­ï¼Œæ˜¯é€™æ¨£çš„ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;logging:
  metrics.enabled: false
  level: info
  to_files: true
  files:
    path: /var/log/filebeat
    name: filebeat
    keepfiles: 7
    permissions: 0644   
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.  &lt;a href=&quot;https://discuss.elastic.co/t/non-zero-metrics-in-the-last-30s-meaning/173970&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Non-zero metrics in the last 30s: meaning&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/111. filebeat error/" />
        </entry>
        <entry>
            <title>
                0.EFK MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—’ EFK/0.EFK MOC/</id>
            <content type="html">
                &lt;h1 id=&quot;æ¦‚å¿µ&quot; tabindex=&quot;-1&quot;&gt;æ¦‚å¿µ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/55.%20es%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E7%AF%87/&quot;&gt;55. esåŸºæœ¬æ¦‚å¿µç¯‡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;81. Beat vs elastic agent&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;83. Elasticsearch æ¬Šå¨æŒ‡å— ä¿®æ­£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/84.Elasticsearch%E7%AD%86%E8%A8%98/&quot;&gt;84.Elasticsearchç­†è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;å»ºç½®&quot; tabindex=&quot;-1&quot;&gt;å»ºç½®&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/43.%E8%87%AA%E5%BB%BAECK%20on%20GKE/&quot;&gt;43.è‡ªå»ºECK on GKE&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;è¨­å®š&quot; tabindex=&quot;-1&quot;&gt;è¨­å®š&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/54.%20istio%20%E6%8E%9B%E8%BC%89ECK%20kibana/&quot;&gt;54. istio æ›è¼‰ECK kibana&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/52.%20ILM%20%E8%A8%AD%E5%AE%9A/&quot;&gt;52. ILM è¨­å®š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/57.filebeat%20%E8%A3%9C%E5%85%85%E8%AA%AA%E6%98%8E/&quot;&gt;57.filebeat è£œå……èªªæ˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/80.%20ECK%208.1%20,APM%20intergration%E5%AE%89%E8%A3%9D%E6%96%B9%E5%BC%8F/&quot;&gt;80. ECK 8.1 ,APM intergrationå®‰è£æ–¹å¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/90.%20elasticsearch%20ingest%20pipeline/&quot;&gt;90. elasticsearch ingest pipeline&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/91.%20elasticsearch%20ingest%20processor%E8%A3%9C%E5%85%85/&quot;&gt;91. elasticsearch ingest processorè£œå……&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;usage&quot; tabindex=&quot;-1&quot;&gt;Usage&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/68.ECK%20,%20api%E7%AD%86%E8%A8%98/&quot;&gt;68.ECK , apiç­†è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/61.%20kibana%20%E6%9F%A5%E8%A9%A2%E8%AA%9E%E6%B3%95/&quot;&gt;Kibanaä¸€èˆ¬ä½¿ç”¨è€…æŸ¥è©¢èªæ³•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;86. efk apmåœ–è¡¨&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/53.%20apm%20error/&quot;&gt;53. apm error&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/60.%20ECK%E7%9A%84%20kibana%20%E8%AD%A6%E5%91%8A%EF%BC%8C%20server.publicBaseUrl%20is%20missing/&quot;&gt;60. ECKçš„ kibana è­¦å‘Šï¼Œ server.publicBaseUrl is missing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/67.%20ECK%EF%BC%8Cfilebeat%20LOG%E8%92%90%E9%9B%86%E9%81%BA%E5%A4%B1/&quot;&gt;67. ECKï¼Œfilebeat LOGè’é›†éºå¤±&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/69.%20kibana%E9%8C%AF%E8%AA%A4%E8%A7%A3%E6%B3%95%20,%20parent%20Data%20too%20large.../&quot;&gt;69. kibanaéŒ¯èª¤è§£æ³• , parent Data too large...&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/111.%20filebeat%20error/&quot;&gt;111. filebeat error&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—’ EFK/0.EFK MOC/" />
        </entry>
        <entry>
            <title>
                188. CloudSQL server æŸ¥è©¢è¨˜æ†¶é«”
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—„ Database/188. CloudSQL server æŸ¥è©¢è¨˜æ†¶é«”/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;é€±äº”ç¢°åˆ°sql serverçš„è¨˜æ†¶é«”é£†æ¼²åˆ°90%ï¼Œ&lt;br /&gt;
æ‰¾å¾Œç«¯çœ‹äº†ä¸€ä¸‹ï¼Œçœ‹ä¸å‡ºå€‹æ‰€ä»¥ç„¶ã€‚&lt;br /&gt;
å¾ˆä¸å¹¸çš„ï¼Œç¦®æ‹œå…­åˆè¡åˆ°95%ï¼Œ&lt;br /&gt;
åªå¥½ç·Šæ€¥ç¶­è­·é‡é–‹äº†ï¼Œ&lt;br /&gt;
ç¦®æ‹œä¸€é–‹å§‹æ‰¾å•é¡Œã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å¯¦éš›ä¸Šè¦æŠŠè¨˜æ†¶é«”æ“åˆ°100%ï¼Œé‚„çœŸçš„å¾ˆé›£ã€‚&lt;br /&gt;
è©¦äº†å¥½å¹¾å¤©ï¼Œæœ€å¤šåªèƒ½åˆ°97%ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œæœå‹™éƒ½æ²’ä»€éº¼ç—‡ç‹€ï¼Œ&lt;br /&gt;
è®“æˆ‘å€‘é–‹å§‹æƒ³ï¼Œæ˜¯ä¸æ˜¯cloudSQLçœŸçš„å¼·ï¼Œ&lt;br /&gt;
é€™è¦æ“ä¸‹å»éƒ½æ²’äº‹ã€‚&lt;/p&gt;
&lt;p&gt;å†ä¾†æŸ¥åˆ°cloudSQLçš„ä¸€ç¯‡æ–‡ç« ï¼Œ&lt;/p&gt;
&lt;p&gt;CloudSQLçš„è¨˜æ†¶é«”åˆ†æˆä¸‹é¢å¹¾ç¨®&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sql/docs/sqlserver/optimize-high-memory-usage#cache&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;CachesÂ Â å¿«å–&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sql/docs/sqlserver/optimize-high-memory-usage#fixed-memory&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Fixed memoryÂ Â å›ºå®šè¨˜æ†¶é«”&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sql/docs/sqlserver/optimize-high-memory-usage#sql-server-overhead&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SQL Server overheadÂ Â SQL Server é–‹éŠ·&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sql/docs/sqlserver/optimize-high-memory-usage#oltp&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;In-Memory online transactional processing (OLTP)&lt;br /&gt;
è¨˜æ†¶é«”ä¸­ç·šä¸Šäº‹å‹™è™•ç† (OLTP)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç„¶å¾Œï¼Œæˆ‘å€‘å¾—çŸ¥å¯ä»¥æ›´æ”¹ &lt;code&gt;max server memory&lt;/code&gt;ï¼Œ&lt;br /&gt;
å¼·è¿«SQLä¸è¦ä½¿ç”¨é‚£éº¼å¤šçš„è¨˜æ†¶é«”ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%84%20Database/188-fig.1.jpg&quot; alt=&quot;188-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œï¼Œå†ç…§ä¹‹å‰çš„å£“æ¸¬æ–¹å¼æ‰“ä¸‹å»ï¼Œæš´äº†ã€‚&lt;br /&gt;
ç¢ºå®šæœƒå½±éŸ¿æœå‹™ã€‚&lt;/p&gt;
&lt;p&gt;å†é‡å° &lt;code&gt;max server memory&lt;/code&gt; ï¼Œå¢åŠ å®¹é‡æ¸¬è©¦ï¼Œ&lt;br /&gt;
æˆ‘å€‘å¾—åˆ°ä¸‹é¢çš„çµè«–ã€‚&lt;/p&gt;
&lt;p&gt;ç•¶ &lt;code&gt;Page life expectancy&lt;/code&gt;Â é€™å€‹å€¼åªè¦&amp;lt;300ï¼Œ&lt;br /&gt;
å°±æœ‰å¯èƒ½é€ æˆæœå‹™çš„å»¶é²ã€‚&lt;br /&gt;
ç•¶æ‰çš„ç•¶ä¸‹ï¼Œé€™å€‹å€¼éƒ½æ˜¯è™•æ–¼0ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Page life expectancy&lt;/code&gt;Â è¡¨ç¤ºæœ€èˆŠçš„é é¢åœ¨ç·©è¡æ± ä¸­åœç•™çš„æ™‚é–“ï¼ˆä»¥ç§’ç‚ºå–®ä½ï¼‰ï¼Œå¾®è»Ÿå»ºè­°é€™å€‹å€¼å†300ä»¥ä¸Šã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT Â  [object_name],Â  [counter_name],Â  [cntr_value] FROM Â  sys.dm_os_performance_countersWHERE Â  [object_name] LIKE Â  &#39;%Manager%&#39;AND Â  [counter_name] = &#39;Page life expectancy&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘å€‘å¯ä»¥åŒæ™‚çœ‹ä¸€ä¸‹æœ‰æ²’æœ‰SQLè™•æ–¼pendingç‹€æ…‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECTÂ  @@SERVERNAME AS [Server Name],Â  RTRIM([object_name]) AS [Object Name],Â  cntr_value AS [Memory Grants Pending]FROM Â  sys.dm_os_performance_counters WITH(NOLOCK)WHEREÂ  [object_name] LIKE Â  N&#39;%Memory Manager%&#39; Â -- Handles named instancesAND Â  counter_name = N&#39;Memory Grants Pending&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç•¶é€™å€‹å€¼&amp;gt;0æ™‚ï¼Œè¡¨ç¤ºsqlæœå‹™å·²ç¶“é¢è‡¨å´©æ½°é‚Šç·£ï¼Œ&lt;br /&gt;
è©²æº–å‚™é‡å•“è³‡æ–™åº«äº†ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/sql/docs/sqlserver/optimize-high-memory-usage&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Optimize high memory consumption in instances&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—„ Database/188. CloudSQL server æŸ¥è©¢è¨˜æ†¶é«”/" />
        </entry>
        <entry>
            <title>
                166. MSSQL 2017ç‰ˆæœ¬å·®ç•°
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—„ Database/166. MSSQL 2017ç‰ˆæœ¬å·®ç•°/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä»Šå¤©åœ¨æŸ¥linuxçš„MSSQLæ˜¯ä»€éº¼ç‰ˆæœ¬ï¼Œæ‰ç™¼ç¾é è¨­æ˜¯é–‹ç™¼ç‰ˆã€‚&lt;br /&gt;
åˆå»¶ä¼¸ä¸€å€‹å•é¡Œï¼Œé–‹ç™¼æ¿çš„ä¸Šé™åˆ°å“ªï¼Ÿ&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å› ç‚ºå¾®è»Ÿçš„ç¶²ç«™ï¼Œé€£çµå¸¸æ­»æ‰ï¼Œå°±å…ˆç¯€éŒ„éä¾†äº†ï¼Œ&lt;br /&gt;
åœ¨linuxä¸Šé¢å®‰è£çš„æ˜¯Developeré–‹ç™¼è€…ç‰ˆæœ¬ï¼Œ&lt;br /&gt;
åŠŸèƒ½è·ŸEnterpriseä¸€è‡´ã€‚&lt;/p&gt;
&lt;h3 id=&quot;å·®ç•°&quot; tabindex=&quot;-1&quot;&gt;å·®ç•°&lt;/h3&gt;
&lt;p&gt;æŒ‡åˆ—å‡ºè³‡æºä½¿ç”¨çš„æ¯”è¼ƒï¼Œå…¶ä»–ç´°éƒ¨åŠŸèƒ½ï¼Œè«‹åƒè€ƒä¸‹é¢ç¶²å€&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åŠŸèƒ½&lt;/th&gt;
&lt;th&gt;Enterprise&lt;/th&gt;
&lt;th&gt;æ¨™æº–&lt;/th&gt;
&lt;th&gt;Web&lt;/th&gt;
&lt;th&gt;Express&lt;/th&gt;
&lt;th&gt;å¿«é€Ÿ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å–®ä¸€åŸ·è¡Œå€‹é«”æ‰€ä½¿ç”¨çš„è¨ˆç®—å®¹é‡ä¸Šé™ - SQL Server è³‡æ–™åº«å¼•æ“1&lt;/td&gt;
&lt;td&gt;ä½œæ¥­ç³»çµ±æœ€å¤§å€¼&lt;/td&gt;
&lt;td&gt;é™åˆ¶ç‚º 4 å€‹æ’æ§½æˆ– 24 å€‹æ ¸å¿ƒçš„è¼ƒå°è€…&lt;/td&gt;
&lt;td&gt;é™åˆ¶ç‚º 4 å€‹æ’æ§½æˆ– 16 å€‹æ ¸å¿ƒçš„è¼ƒå°è€…&lt;/td&gt;
&lt;td&gt;é™åˆ¶ç‚º 1 å€‹æ’æ§½æˆ– 4 å€‹æ ¸å¿ƒçš„è¼ƒå°è€…&lt;/td&gt;
&lt;td&gt;é™åˆ¶ç‚º 1 å€‹æ’æ§½æˆ– 4 å€‹æ ¸å¿ƒçš„è¼ƒå°è€…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å–®ä¸€åŸ·è¡Œå€‹é«”æ‰€ä½¿ç”¨çš„è¨ˆç®—å®¹é‡ä¸Šé™ - Analysis Services æˆ– Reporting Services&lt;/td&gt;
&lt;td&gt;ä½œæ¥­ç³»çµ±æœ€å¤§å€¼&lt;/td&gt;
&lt;td&gt;é™åˆ¶ç‚º 4 å€‹æ’æ§½æˆ– 24 å€‹æ ¸å¿ƒçš„è¼ƒå°è€…&lt;/td&gt;
&lt;td&gt;é™åˆ¶ç‚º 4 å€‹æ’æ§½æˆ– 16 å€‹æ ¸å¿ƒçš„è¼ƒå°è€…&lt;/td&gt;
&lt;td&gt;é™åˆ¶ç‚º 1 å€‹æ’æ§½æˆ– 4 å€‹æ ¸å¿ƒçš„è¼ƒå°è€…&lt;/td&gt;
&lt;td&gt;é™åˆ¶ç‚º 1 å€‹æ’æ§½æˆ– 4 å€‹æ ¸å¿ƒçš„è¼ƒå°è€…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¯å€‹ SQL Server è³‡æ–™åº«å¼•æ“åŸ·è¡Œå€‹é«”çš„ç·©è¡é›†å€è¨˜æ†¶é«”ä¸Šé™&lt;/td&gt;
&lt;td&gt;ä½œæ¥­ç³»çµ±æœ€å¤§å€¼&lt;/td&gt;
&lt;td&gt;128 GB&lt;/td&gt;
&lt;td&gt;64 GB&lt;/td&gt;
&lt;td&gt;1410 MB&lt;/td&gt;
&lt;td&gt;1410 MB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¯å€‹ SQL Server è³‡æ–™åº«å¼•æ“åŸ·è¡Œå€‹é«”çš„ç·©è¡é›†å€å»¶ä¼¸å®¹é‡ä¸Šé™&lt;/td&gt;
&lt;td&gt;32 * (æœ€å¤§ä¼ºæœå™¨è¨˜æ†¶é«”è¨­å®š)&lt;/td&gt;
&lt;td&gt;4 * (æœ€å¤§ä¼ºæœå™¨è¨˜æ†¶é«”è¨­å®š)&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¯å€‹ SQL Server è³‡æ–™åº«å¼•æ“åŸ·è¡Œå€‹é«”çš„è³‡æ–™è¡Œå­˜æ”¾å€å€æ®µå¿«å–çš„è¨˜æ†¶é«”ä¸Šé™&lt;/td&gt;
&lt;td&gt;ç„¡é™åˆ¶çš„è¨˜æ†¶é«”&lt;/td&gt;
&lt;td&gt;32 GB&lt;/td&gt;
&lt;td&gt;16 GB&lt;/td&gt;
&lt;td&gt;352 MB&lt;/td&gt;
&lt;td&gt;352 MB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SQL Server è³‡æ–™åº«å¼•æ“ä¸­æ¯å€‹è³‡æ–™åº«çš„è¨˜æ†¶é«”æœ€ä½³åŒ–è³‡æ–™å¤§å°ä¸Šé™&lt;/td&gt;
&lt;td&gt;ç„¡é™åˆ¶çš„è¨˜æ†¶é«”&lt;/td&gt;
&lt;td&gt;32 GB&lt;/td&gt;
&lt;td&gt;16 GB&lt;/td&gt;
&lt;td&gt;352 MB&lt;/td&gt;
&lt;td&gt;352 MB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¯å€‹ Analysis Services åŸ·è¡Œå€‹é«”ä½¿ç”¨çš„è¨˜æ†¶é«”ä¸Šé™&lt;/td&gt;
&lt;td&gt;ä½œæ¥­ç³»çµ±æœ€å¤§å€¼&lt;/td&gt;
&lt;td&gt;è¡¨æ ¼å¼ï¼š16 GB MOLAPï¼š64 GB&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¯å€‹ Reporting Services åŸ·è¡Œå€‹é«”ä½¿ç”¨çš„è¨˜æ†¶é«”ä¸Šé™&lt;/td&gt;
&lt;td&gt;ä½œæ¥­ç³»çµ±æœ€å¤§å€¼&lt;/td&gt;
&lt;td&gt;64 GB&lt;/td&gt;
&lt;td&gt;64 GB&lt;/td&gt;
&lt;td&gt;4 GB&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é—œè¯å¼è³‡æ–™åº«å¤§å°ä¸Šé™&lt;/td&gt;
&lt;td&gt;524 PB&lt;/td&gt;
&lt;td&gt;524 PB&lt;/td&gt;
&lt;td&gt;524 PB&lt;/td&gt;
&lt;td&gt;10 GB&lt;/td&gt;
&lt;td&gt;10 GB&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;è¨‚åƒ¹&quot; tabindex=&quot;-1&quot;&gt;è¨‚åƒ¹&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;SQL Server 2017 ç‰ˆæœ¬&lt;/th&gt;
&lt;th&gt;é©åˆ...&lt;/th&gt;
&lt;th&gt;æˆæ¬Šæ¨¡å‹&lt;/th&gt;
&lt;th&gt;é€šè·¯ä¾›æ‡‰æƒ…æ³&lt;/th&gt;
&lt;th&gt;å…¬é–‹ç„¡ç´šåˆ¥åƒ¹æ ¼ (ç¾å…ƒ)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Enterprise&lt;/td&gt;
&lt;td&gt;å…¨æ–¹ä½çš„ä»»å‹™é—œéµæ€§æ•ˆèƒ½ï¼Œå¯æ»¿è¶³åš´è‹›çš„è³‡æ–™åº«å’Œå•†æ¥­æ™ºæ…§éœ€æ±‚ã€‚æä¾›æœ€é«˜ç´šçš„æœå‹™å’Œæ•ˆèƒ½ï¼Œè¶³ä»¥æ‡‰ä»˜ç¬¬ 1 å±¤å·¥ä½œè² è¼‰ã€‚[7]&lt;/td&gt;
&lt;td&gt;æ¯å€‹æ ¸å¿ƒ[8]&lt;/td&gt;
&lt;td&gt;å¤§é‡æˆæ¬Šã€ä»£ç®¡&lt;/td&gt;
&lt;td&gt;14,256 ç¾å…ƒ[9]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Standard - æ¯ä¸€æ ¸å¿ƒ&lt;/td&gt;
&lt;td&gt;æ ¸å¿ƒè³‡æ–™ç®¡ç†å’Œå•†æ¥­æ™ºæ…§åŠŸèƒ½ï¼Œèƒ½ä»¥æœ€å°‘çš„ IT è³‡æºä¾†è™•ç†éé—œéµçš„å·¥ä½œè² è¼‰ã€‚&lt;/td&gt;
&lt;td&gt;æ¯å€‹æ ¸å¿ƒ[8]&lt;/td&gt;
&lt;td&gt;å¤§é‡æˆæ¬Šã€ä»£ç®¡&lt;/td&gt;
&lt;td&gt;3,717 ç¾å…ƒ[9]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Standard - ä¼ºæœå™¨ + CAL&lt;/td&gt;
&lt;td&gt;æ ¸å¿ƒè³‡æ–™ç®¡ç†å’Œå•†æ¥­æ™ºæ…§åŠŸèƒ½ï¼Œèƒ½ä»¥æœ€å°‘çš„ IT è³‡æºä¾†è™•ç†éé—œéµçš„å·¥ä½œè² è¼‰ã€‚&lt;/td&gt;
&lt;td&gt;ä¼ºæœå™¨ + CAL[10]&lt;/td&gt;
&lt;td&gt;å¤§é‡æˆæ¬Šã€ä»£ç®¡ã€é›¶å”® FPP&lt;/td&gt;
&lt;td&gt;931 ç¾å…ƒ[9]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Developer&lt;/td&gt;
&lt;td&gt;å…·æœ‰å®Œæ•´åŠŸèƒ½çš„ SQL Server è»Ÿé«”ç‰ˆæœ¬ï¼Œå¯è®“é–‹ç™¼äººå“¡ä»¥ç¬¦åˆæˆæœ¬æ•ˆç›Šçš„æ–¹å¼å»ºç½®ã€æ¸¬è©¦å’Œå±•ç¤ºä»¥ SQL Server è»Ÿé«”ç‚ºåŸºç¤çš„æ‡‰ç”¨ç¨‹å¼ã€‚&lt;/td&gt;
&lt;td&gt;æ¯å€‹ä½¿ç”¨è€…&lt;/td&gt;
&lt;td&gt;å…è²»ä¸‹è¼‰&lt;/td&gt;
&lt;td&gt;å…è²»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Web&lt;/td&gt;
&lt;td&gt;å®‰å…¨ã€ç¬¦åˆæˆæœ¬æ•ˆç›Šä¸”å¯é«˜åº¦èª¿æ•´çš„è³‡æ–™å¹³å°ï¼Œå¯ç”¨ä¾†æ‰“é€ å…¬ç”¨ç¶²ç«™ã€‚åƒ…ä¾›ç¬¬ä¸‰æ–¹è»Ÿé«”æœå‹™æä¾›è€…ä½¿ç”¨ã€‚&lt;/td&gt;
&lt;td&gt;ä¸é©ç”¨&lt;/td&gt;
&lt;td&gt;åƒ…æä¾›ä»£ç®¡&lt;/td&gt;
&lt;td&gt;è«‹åƒé–±ä»£ç®¡åˆä½œå¤¥ä¼´çš„å®šåƒ¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Express&lt;/td&gt;
&lt;td&gt;å…è²»çš„å…¥é–€ç´šçš„è³‡æ–™åº«ï¼Œéå¸¸é©åˆç”¨ä¾†å­¸ç¿’å’Œå»ºç½®æœ€å¤š 10 GB çš„æ¡Œé¢èˆ‡å°å‹ä¼ºæœå™¨è³‡æ–™é©…å‹•æ‡‰ç”¨ç¨‹å¼ã€‚&lt;/td&gt;
&lt;td&gt;ä¸é©ç”¨&lt;/td&gt;
&lt;td&gt;å…è²»ä¸‹è¼‰&lt;/td&gt;
&lt;td&gt;å…è²»&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://www.microsoft.com/zh-tw/sql-server/sql-server-2017?rtc=1&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SQLServer 2017&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://learn.microsoft.com/zh-TW/sql/sql-server/editions-and-components-of-sql-server-2017?view=sql-server-ver16#Cross-BoxScaleLimits&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SQL Server 2017 çš„ç‰ˆæœ¬åŠæ”¯æ´åŠŸèƒ½&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—„ Database/166. MSSQL 2017ç‰ˆæœ¬å·®ç•°/" />
        </entry>
        <entry>
            <title>
                153. CloudSQL MSSQLæ¸›å°‘è³‡æ–™åº«å¤§å°
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—„ Database/153. CloudSQL MSSQLæ¸›å°‘è³‡æ–™åº«å¤§å°/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;ä¹Ÿä¸çŸ¥é“æˆ‘æ€éº¼ä¹Ÿå…¼DBAäº†ï¼Œæœ‰ç¨®MISçš„æ„Ÿè¦ºï¼Œå•¥éƒ½ç®¡ã€‚&lt;br /&gt;
å¦‚æœè³‡æ–™é‡å¤ªå¤šï¼Œåˆªé™¤è³‡æ–™å¾Œï¼Œæ˜¯ä¸æœƒæŠŠç©ºé–“é‡‹æ”¾çš„ï¼Œ&lt;br /&gt;
éœ€è¦å°è³‡æ–™åº«åšå£“ç¸®ï¼Œå®¹é‡æ‰æœƒé‚„å‡ºä¾†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;é †ä¾¿èªªä¸€ä¸‹æŸ¥å®¹é‡çš„æ­¥é©Ÿ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æŸ¥è³‡æ–™åº«çš„å®¹é‡&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-sql&quot;&gt;SELECT DB_NAME(database_id) N&#39;è³‡æ–™åº«&#39;, physical_name N&#39;å¯¦é«”æª”æ¡ˆ&#39;, type_desc N&#39;æª”æ¡ˆé¡å‹&#39;, state_desc N&#39;æª”æ¡ˆç‹€æ…‹&#39;, size*8.0/1024 N&#39;æª”æ¡ˆå¤§å°(MB)&#39;
FROM sys.master_files
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;æŸ¥è©¢è³‡æ–™è¡¨å¤§å°&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-sql&quot;&gt;SELECT 
    t.NAME AS TableName,
    s.Name AS SchemaName,
    p.rows,
    SUM(a.total_pages) * 8 AS TotalSpaceKB, 
    CAST(ROUND(((SUM(a.total_pages) * 8) / 1024.00), 2) AS NUMERIC(36, 2)) AS TotalSpaceMB,
    SUM(a.used_pages) * 8 AS UsedSpaceKB, 
    CAST(ROUND(((SUM(a.used_pages) * 8) / 1024.00), 2) AS NUMERIC(36, 2)) AS UsedSpaceMB, 
    (SUM(a.total_pages) - SUM(a.used_pages)) * 8 AS UnusedSpaceKB,
    CAST(ROUND(((SUM(a.total_pages) - SUM(a.used_pages)) * 8) / 1024.00, 2) AS NUMERIC(36, 2)) AS UnusedSpaceMB
FROM 
    sys.tables t
INNER JOIN
    sys.indexes i ON t.OBJECT_ID = i.object_id
INNER JOIN 
    sys.partitions p ON i.object_id = p.OBJECT_ID AND i.index_id = p.index_id
INNER JOIN 
    sys.allocation_units a ON p.partition_id = a.container_id
LEFT OUTER JOIN 
    sys.schemas s ON t.schema_id = s.schema_id
WHERE 
    t.NAME NOT LIKE &#39;dt%&#39; 
    AND t.is_ms_shipped = 0
    AND i.OBJECT_ID &amp;gt; 255 
GROUP BY 
    t.Name, s.Name, p.Rows
ORDER BY 
    TotalSpaceMB DESC, t.Name
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;åˆªé™¤å®Œå¾Œï¼Œå¯ä»¥å…ˆåšäº¤æ˜“è¨˜éŒ„æª”å£“ç¸®&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-sql&quot;&gt;ALTER DATABASE DB_name SET RECOVERY simple
use DB_name
go
dbcc shrinkfile(&#39;DB_name_log&#39;,2)

ALTER DATABASE table_name SET RECOVERY FULL
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;å£“ç¸®DBï¼Œå°‡ç©ºé–“é‡‹æ”¾ï¼Œå¯ä»¥ç”¨æŒ‡ä»¤ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨SSMSæ“ä½œ&lt;br /&gt;
æŒ‡ä»¤ï¼Œå¯ä»¥è·Ÿstep 3 ä¸€èµ·å‹•ä½œ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-sql&quot;&gt;1.  DBCC SHRINKDATABASE(N&#39;DB_name&#39; )
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–æ˜¯ç›´æ¥ç…§åœ–æ“ä½œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%84%20Database/153-fig.1.jpg&quot; alt=&quot;153-fig.1.jpg&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%97%84%20Database/153-fig.2.jpg&quot; alt=&quot;153-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/questions/10209350&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SQL SERVER å£“ç¸®è³‡æ–™åº«å¾ŒMDFæ²’è®Šå°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://hackmd.io/@ab-5tCCfRu2OkxqJptnkGg/BJFBvHD2w&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;MsSql å£“ç¸®è³‡æ–™åº«(å«ä¿®å¾©è³‡æ–™åº«)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://dotblogs.com.tw/jamesfu/2014/02/23/compression&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[SQL]æ–¯æ–¯æœ‰ä¸‰ç¨®ï¼ŒSQL Server ä¸Šè³‡æ–™åº«çš„ã€Œå£“ç¸®ã€ä¹Ÿæœ‰ä¸‰ç¨®å–” !&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://learn.microsoft.com/zh-tw/sql/t-sql/database-console-commands/dbcc-shrinkdatabase-transact-sql?view=sql-server-ver16&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;DBCC SHRINKDATABASE (Transact-SQL)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://hackmd.io/@Not/H1YBRk6qw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ¸…é™¤SQL Server Logæª” (äº¤æ˜“ç´€éŒ„)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://dotblogs.com.tw/jamesfu/2015/05/16/deleterecords&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è§£æ±ºå¤§é‡è³‡æ–™åˆªé™¤ï¼Œé€ æˆè³‡æ–™åº«äº¤æ˜“ç´€éŒ„æª”æ¡ˆå®¹é‡éå¤§ä¸”è€—è²»æ™‚é–“ä¹‹è™•ç†&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—„ Database/153. CloudSQL MSSQLæ¸›å°‘è³‡æ–™åº«å¤§å°/" />
        </entry>
        <entry>
            <title>
                150. mysqlå‚™ä»½é‚„åŸæŒ‡ä»¤
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—„ Database/150. mysqlå‚™ä»½é‚„åŸæŒ‡ä»¤/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;h2 id=&quot;lets-encript-br-server&quot; tabindex=&quot;-1&quot;&gt;èª¿æ•´è‡ªå‹•å–å¾—letsEncriptçš„æ¶æ§‹ï¼Œ&lt;br /&gt;
æ‰€ä»¥å°±ç¨ç«‹é–‹äº†ä¸€å€‹serverï¼Œè¦æŠŠæœå‹™ç§»éå»ã€‚&lt;/h2&gt;
&lt;p&gt;ç„¶å¾Œæ‰ç™¼ç¾ï¼Œæˆ‘çš„ä¸Šä¸€ä»»æ˜¯å€‹å¾ˆæˆç†Ÿçš„å·¥ç¨‹å¸«ï¼Œæœ€æ„›é€ è¼ªå­&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä»¥ä¸‹éƒ½æ˜¯ç”±dockerå»ºç«‹ï¼Œä¹Ÿæœ‰å…¶ä»–æ–¹å¼å¯ä»¥åšã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‚™ä»½å…¨éƒ¨dbçš„æŒ‡ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;docker exec percona sh -c &amp;quot;mysqldump -u root -p&amp;lt;password&amp;gt; -A --opt&amp;quot; &amp;gt; backup.sql
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç•¶ç„¶ï¼Œä¹Ÿå¯ä»¥é¸æ“‡é€²å…¥åˆ°containerè£é¢ï¼ŒåŸ·è¡ŒæŒ‡ä»¤ï¼Œå†ç”¨docker cpçš„æ–¹å¼æŠŠæª”æ¡ˆæ‹‰å‡ºä¾†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é‚„åŸDBçš„æŒ‡ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;docker exec -i mysql sh -c &amp;quot;mysql -u root -p&amp;lt;password&amp;gt;&amp;quot; &amp;lt; backup.sql  
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;é€£ç·šè‡³mysql&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;mysql -uroot -p&amp;lt;password&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;é¡¯ç¤ºå…¨éƒ¨DB&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-sql&quot;&gt;show databases;
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;é¡¯ç¤ºå…¨éƒ¨table&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-sql&quot;&gt;show tables;
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;å»ºç«‹ä½¿ç”¨è€…&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-sql&quot;&gt;CREATE USER &#39;totp-auth&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;password&#39;;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šæ³¨æ„ï¼Œå¦‚æœä½¿ç”¨è€…æ˜¯å¾éæœ¬åœ°é€£éä¾†è³‡æ–™åº«çš„è©±ï¼Œä¸è¦ä½¿ç”¨localhostã€‚æˆ‘å¿˜äº†é€™é»ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¿®æ”¹ä½¿ç”¨è€…&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-sql&quot;&gt;RENAME USER &#39;totp-auth&#39;@&#39;localhost&#39; TO &#39;totp-auth&#39;@&#39;%&#39;;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰¿æ¥ä¸Šä¸€æ®µèªæ³•ï¼Œå¦‚æœå·²ç¶“æ–°å¢çš„è©±ï¼Œç”¨æ­¤æ–¹å¼ä¿®æ”¹ã€‚&lt;br /&gt;
%ç‚ºä»»æ„ipï¼Œæˆ–è€…å¯ä»¥æ”¹æˆ192.168.1.% è«¸å¦‚æ­¤é¡çš„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æˆäºˆä½¿ç”¨è€…DBæ¬Šé™&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-sql&quot;&gt;GRANT ALL PRIVILEGES ON db.* TO &#39;totp-auth&#39;@&#39;localhost&#39;;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://hub.docker.com/_/percona&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;percona(dockerhub)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.vixual.net/blog/archives/53&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[MySQL]è³‡æ–™åº«çš„å‚™ä»½èˆ‡é‚„åŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.ltsplus.com/mysql/mysql-add-new-users-databases-privileges&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;MySQL æ–°å¢ä½¿ç”¨è€…åŠå»ºç«‹è³‡æ–™åº«æ¬Šé™&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://serverfault.com/questions/329795/mysql-users-changed-their-ip-address-whats-the-best-way-to-deal-with-this&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;MySQL users changed their IP address. What&#39;s the best way to deal with this?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://klab.tw/2022/08/daily-automatic-backup-of-mysql-mariadb-and-mongodb-in-docker/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ¯å¤©å®šæ™‚è‡ªå‹•å‚™ä»½Dockerå…§çš„MySQLã€MariaDBèˆ‡MongoDBï¼ŒLinuxã€macOSèˆ‡Windowséƒ½å¯ç”¨&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—„ Database/150. mysqlå‚™ä»½é‚„åŸæŒ‡ä»¤/" />
        </entry>
        <entry>
            <title>
                0.Database MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ—„ Database/0.Database MOC/</id>
            <content type="html">
                &lt;h1 id=&quot;my-sql&quot; tabindex=&quot;-1&quot;&gt;MySQL&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%84%20Database/150.%20mysql%E5%82%99%E4%BB%BD%E9%82%84%E5%8E%9F%E6%8C%87%E4%BB%A4/&quot;&gt;150. mysqlå‚™ä»½é‚„åŸæŒ‡ä»¤&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;mssql&quot; tabindex=&quot;-1&quot;&gt;MSSQL&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%84%20Database/153.%20CloudSQL%20MSSQL%E6%B8%9B%E5%B0%91%E8%B3%87%E6%96%99%E5%BA%AB%E5%A4%A7%E5%B0%8F/&quot;&gt;153. CloudSQL MSSQLæ¸›å°‘è³‡æ–™åº«å¤§å°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/120.%20%E6%8C%87%E4%BB%A4%E5%82%99%E4%BB%BDcloudSQL%E5%8F%8A%E4%B8%8B%E8%BC%89/&quot;&gt;120. æŒ‡ä»¤å‚™ä»½cloudSQLåŠä¸‹è¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%84%20Database/188.%20CloudSQL%20server%20%E6%9F%A5%E8%A9%A2%E8%A8%98%E6%86%B6%E9%AB%94/&quot;&gt;188. CloudSQL server æŸ¥è©¢è¨˜æ†¶é«”&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ—„ Database/0.Database MOC/" />
        </entry>
        <entry>
            <title>
                174. win10 ä¸‹è¼‰Microsoft Storeçš„æª”æ¡ˆ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ–¼ Window/174. win10 ä¸‹è¼‰Microsoft Storeçš„æª”æ¡ˆ/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å”¸&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å”¸&lt;/h1&gt;
&lt;p&gt;çœ‹åˆ°XDMæœ‰æ–°ç‰ˆçš„ï¼Œå› çˆ²èˆŠç‰ˆåªè¦ä¸‹è¼‰æœ‰ä¸­æ–‡å­—çš„æª”æ¡ˆï¼Œ&lt;br /&gt;
æª”æ¡ˆåç¨±å°±æ˜¯äº‚ç¢¼ï¼Œä½†æ˜¯æ–°ç‰ˆåˆåªèƒ½å¾å¾®è»Ÿå•†åº—ä¸‹è¼‰...&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ‰¾åˆ°ç¶²å€&lt;br /&gt;
é¦–å…ˆä½ è¦çŸ¥é“ä½ è¦çš„ç¨‹å¼çš„å¾®è»Ÿå®˜æ–¹å•†åº—ç¶²å€ã€‚&lt;br /&gt;
ç›´æ¥ç”¨googleæœå°‹å³å¯ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%96%BC%20Window/174-fig.1.jpg&quot; alt=&quot;174-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ°&lt;a href=&quot;https://store.rg-adguard.net/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç¶²ç«™&lt;/a&gt; ï¼Œè²¼ä¸Šä½ çš„ç¶²å€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é¸æ“‡å‰¯æª”åç‚º ã€appxbundleã€ ä¸‹è¼‰&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%96%BC%20Window/174-fig.2.jpg&quot; alt=&quot;174-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://adersaytech.com/tutorial/kb-article/download-ms-store-offline-package.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Win10/Win11 å¦‚ä½•ä¸‹è¼‰ Microsoft Store é›¢ç·šå®‰è£æª”ï¼Ÿ&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ–¼ Window/174. win10 ä¸‹è¼‰Microsoft Storeçš„æª”æ¡ˆ/" />
        </entry>
        <entry>
            <title>
                113. å¾®è»Ÿå®˜æ–¹office å¤§é‡æˆæ¬Š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ–¼ Window/113. å¾®è»Ÿå®˜æ–¹office å¤§é‡æˆæ¬Š/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;YTäº‚çœ‹çš„æ™‚å€™ï¼Œçœ‹åˆ°æœ‰ä¸€å€‹å½±ç‰‡ï¼Œå†è¬›å¦‚ä½•ç²å–å…è²»çš„officeï¼Œ&lt;br /&gt;
é€™å…¶å¯¦ä¸æ˜¯æ–°èï¼Œä½†æœ‰å•é¡Œçš„é€šå¸¸éƒ½æ˜¯å†ç ´è§£ä¸Šé¢ï¼Œ&lt;br /&gt;
å¯èƒ½è¢«äººæƒ¡æ„äº‚å¡é–“è«œç¨‹å¼æˆ–æœ¨é¦¬ã€‚&lt;br /&gt;
ä½†ç¾åœ¨é©—è­‰ç›´æ¥å¾å®˜æ–¹ä¾†äº†&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å¾®è»Ÿå®˜æ–¹SNï¼š&lt;br /&gt;
&lt;a href=&quot;https://learn.microsoft.com/zh-tw/DeployOffice/vlactivation/gvlks&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä»¥ KMS å’Œ Active Directory ç‚ºåŸºç¤çš„ Officeã€Project å’Œ Visio å•Ÿç”¨ GVLK&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸æƒ³çœ‹åœ–ç‰‡çš„ï¼Œè«‹ç›´æ¥çœ‹å½±ç‰‡&lt;br /&gt;
&lt;a href=&quot;https://www.youtube.com/watch?v=VSjRx7Hoa60&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¦‚ä½•å…è²»ç²å–Officeè»Ÿä»¶ï¼Ÿé€™æ˜¯æœ€å¼·çš„å®‰è£æ•™å­¸ï¼ | é›¶åº¦è§£èªª&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å¿«é€Ÿèªªæ˜éç¨‹ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å…ˆåˆ° å¾®è»Ÿå®˜æ–¹ä¸‹è¼‰ &lt;a href=&quot;https://www.microsoft.com/en-us/download/details.aspx?id=49117&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Office Deployment Tool&lt;/a&gt;ï¼Œç„¶å¾Œå®‰è£åˆ°æ–°çš„è³‡æ–™å¤¾ï¼Œé€™é‚ŠæŒ‡å®šå®‰è£åˆ°&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; D:&#92;office  
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç„¶å¾Œé–‹å•“ &lt;a href=&quot;https://config.office.com/deploymentsettings&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;office è‡ªè¨‚å·¥å…·&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é¸æ“‡ä½ è¦çš„ç”¢å“ã€é …ç›®&lt;br /&gt;
ï¼ˆé™„è¨»ï¼ŒLTSCä»£è¡¨çš„æ˜¯Long Time Service Channelï¼Œé•·æœŸæœå‹™é€šé“)&lt;br /&gt;
ç”¢å“ç‰ˆæœ¬ï¼šè‡ªè¡ŒæŒ‘é¸&lt;br /&gt;
èªè¨€ï¼šç¹é«”ä¸­æ–‡&lt;br /&gt;
æˆæ¬Šèˆ‡å•“ç”¨ï¼šç¢ºèªæ˜¯KMS&lt;br /&gt;
å…¶ä»–é è¨­å³å¯ã€‚&lt;br /&gt;
å¥½äº†å¾Œï¼ŒæŒ‰å³ä¸ŠåŒ¯å‡ºï¼Œç„¶å¾Œå­˜åˆ°å‰›å‰› 1. çš„ä½ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;D:&#92;office 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/blog.113-fig.1.jpg&quot; alt=&quot;blog.113-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä»¥æœ€é«˜æ¬Šé™é–‹å•“å‘½ä»¤æç¤ºå­—å…ƒï¼Œåˆ‡æ›ç›®éŒ„åˆ° å‰›å‰›ä¸‹è¼‰çš„ä½ç½®ï¼Œç„¶å¾Œä¸‹è¼‰officeï¼Œä¸‹è¼‰å®Œå¾Œå®‰è£ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd D:&#92;office 
setup /download config.xml
setup /configure config.xml
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®‰è£å®Œæˆå¾Œæ‡‰è©²å°±æœƒå•“å‹•äº†ï¼Œå¦‚æœæ²’æœ‰å•“å‹•ï¼Œåˆ°å‰›å‰›officeå®‰è£çš„ä½ç½®ï¼Œé€šå¸¸åœ¨ ä¸‹é¢ä½ç½®ï¼Œç‰ˆæœ¬ä¸åŒï¼Œå¾Œé¢çš„æ•¸å­—ä¹Ÿæœƒä¸åŒã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:&#92;Program Files&#92;Microsoft Office&#92;Office16
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä»¥æœ€é«˜æ¬Šé™é–‹å•“å‘½ä»¤æç¤ºå­—å…ƒï¼Œåˆ‡æ›ç›®éŒ„åˆ° 5. çš„ä½ç½®ï¼Œç„¶å¾Œä¾åºåŸ·è¡ŒæŒ‡ä»¤ï¼Œå®Œæˆå¾Œã€é‡é–‹é›»è…¦ã€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;cd C:&#92;Program Files&#92;Microsoft Office&#92;Office16
slmgr /skms kms.03k.org
slmgr /ato
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/blog.113-fig.2.jpg&quot; alt=&quot;blog.113-fig.2.jpg&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ–¼ Window/113. å¾®è»Ÿå®˜æ–¹office å¤§é‡æˆæ¬Š/" />
        </entry>
        <entry>
            <title>
                47. GO get åƒæ•¸
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ’» Code/Golang/47. GO get åƒæ•¸/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;åƒæ•¸&lt;/p&gt;
&lt;p&gt;æè¿°&lt;/p&gt;
&lt;p&gt;-d&lt;/p&gt;
&lt;p&gt;åŸ·è¡Œä¸‹è¼‰ï¼Œä½†ä¸åŸ·è¡Œå®‰è£å‹•ä½œã€‚&lt;/p&gt;
&lt;p&gt;-f&lt;/p&gt;
&lt;p&gt;åªæœ‰åœ¨ä½¿ç”¨ -u åƒæ•¸æ™‚ï¼Œæ‰æœƒæœ‰æ•ˆã€‚å¯ä»¥å¿½ç•¥æª¢æŸ¥ä»¥ä¸‹è¼‰ package çš„å°å…¥è·¯å¾‘ã€‚å¦‚æœä»£ç¢¼æ˜¯å¾å…¶ä»–é …ç›® fork ï¼Œå°±å¯ä»¥æ¡å–é€™æ¨£çš„åšæ³•ã€‚&lt;/p&gt;
&lt;p&gt;-fix&lt;/p&gt;
&lt;p&gt;ä¸‹è¼‰ package å…ˆåŸ·è¡Œä¿®æ­£åœ¨é€²è¡Œç·¨è­¯å®‰è£ã€‚&lt;/p&gt;
&lt;p&gt;-insecure&lt;/p&gt;
&lt;p&gt;å…è¨±ä½¿ç”¨ http (éå®‰å…¨) ä¾†ä¸‹è¼‰ packageï¼Œé€šå¸¸æ˜¯åœ¨å…§éƒ¨é–‹ç™¼ç’°å¢ƒä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;-t&lt;/p&gt;
&lt;p&gt;ä¸‹è¼‰ package ï¼Œåœ¨å®‰è£éç¨‹åŒæ™‚ä¸‹è¼‰å®‰è£ç›¸é—œä¾è³´ä»£ç¢¼åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;-u&lt;/p&gt;
&lt;p&gt;å¼·åˆ¶æ›´æ–°å·²ç¶“ä¸‹è¼‰çš„ package ä»¥åŠä¾è³´ä»£ç¢¼åŒ…ã€‚ï¼ˆgo get é è¨­æŒ‡æœƒä¸æœƒæ›´æ–°å·²ç¶“ä¸‹è¼‰çš„package)&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://hoohoo.top/blog/go-module-and-go-get-common-parameter-descriptions/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GO MODULEèˆ‡ GO GET å¸¸ç”¨åƒæ•¸èªªæ˜&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ’» Code/Golang/47. GO get åƒæ•¸/" />
        </entry>
        <entry>
            <title>
                40. golang é‡æ–°è®€å–è¨­å®šæª”çš„æ–¹æ³•
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ’» Code/Golang/40. golang é‡æ–°è®€å–è¨­å®šæª”çš„æ–¹æ³•/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å› ç‚ºç¢°åˆ°ä¸€å€‹å¥‡æ€ªçš„å•é¡Œï¼Œéœ€è¦ä¸€ç›´å»æ”¹golangçš„configæª”ï¼Œ&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å°±å†æƒ³äº†ï¼Œèƒ½ä¸èƒ½åƒä»¥å‰çš„phpæˆ–htmlï¼Œå–®ç´”æ”¹configï¼Œé‡æ–°æ•´ç†å°±èƒ½æŠ“åˆ°è³‡æ–™ã€‚&lt;/p&gt;
&lt;p&gt;çµæœ.......&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å…ˆèªªçµè«–ï¼Œç›´æ¥ä¿®æ”¹configï¼Œç„¶å¾Œå¼·åˆ¶é—œé–‰golangçš„process ï¼Œæ˜¯è¡Œä¸é€šçš„ã€‚&lt;/p&gt;
&lt;p&gt;ç’°å¢ƒï¼Œgolang   podï¼ŒåŸ·è¡Œç¨‹å¼çš„æ–¹å¼ï¼Œ&lt;br /&gt;
æ˜¯å…ˆ æ‰“åŒ…æˆä¸€å€‹æª”æ¡ˆï¼Œå†æ”¾åˆ°alpine linuxä¸Šé¢çš„podç›´æ¥åŸ·è¡Œã€‚&lt;/p&gt;
&lt;h3 id=&quot;config&quot; tabindex=&quot;-1&quot;&gt;ç›®æ¨™ï¼Œä¸é‡æ–°æ‰“åŒ…ç¨‹å¼ä¿®æ”¹config&lt;/h3&gt;
&lt;p&gt;å¯¦é©—çš„æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆæŸ¥è©¢æ˜¯ä¸æ˜¯æœ‰golangçš„ç¨‹å¼åœ¨åŸ·è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	ps
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/Golang/40-fig.1.jpg&quot; alt=&quot;40-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;
&lt;p&gt;ç”±æ–¼æ­¤ç¨‹å¼æ˜¯ç›´æ¥æŠ“åŒè³‡æ–™å¤¾çš„config&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/Golang/40-fig.2.jpg&quot; alt=&quot;40-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ‚²åŠ‡å¾—ä¾†äº†ï¼Œä¿®æ”¹å®Œappsettings.jsonå¾Œï¼Œåªè¦åˆªé™¤/app/main ï¼Œå°±æœƒç›´æ¥è·³å‡ºï¼Œpodè‡ªå‹•é‡å•Ÿã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	kill -s 26
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://blog.gtwang.org/linux/linux-kill-killall-xkill/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åœ¨ Linux ä¸­ä½¿ç”¨ killã€killall èˆ‡ xkill ç­‰æŒ‡ä»¤å¼·è¿«é—œé–‰ç¨‹å¼&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ€å¾Œæœ‰å¹¾å€‹æ–¹æ¡ˆï¼Œgolangæœ‰&lt;br /&gt;
&lt;a href=&quot;https://learnku.com/articles/33561&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç†±æ›´æ–°é…ç½®æ–‡ä»¶&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://studygolang.com/articles/5398&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Golangç†±åŠ è¼‰é…ç½®å¯¦è¸&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸å‹•ç¨‹å¼çš„è©±ï¼Œç›®å‰æƒ³åˆ°çš„æ˜¯ï¼Œç›´æ¥é‡æ–°æ‰“åŒ…ï¼ŒæŠŠconfigä¸Ÿé€²å»imageè£¡é¢ã€‚&lt;/p&gt;
&lt;p&gt;ä¾†æºçš„æ˜ åƒæª”ï¼Œç›´æ¥æ”¹æˆæœ¬ä¾†çš„imageï¼Œ&lt;br /&gt;
ç„¶å¾Œcopy æ”¹å®Œçš„appsetings.jsonåˆ°ç›®çš„ï¼Œ&lt;br /&gt;
é€™æ¨£ç¨‹å¼ä¸ç”¨é‡æ–°ç·¨è­¯ï¼Œä½†è¦é‡æ–°æ‰“åŒ…imageã€‚&lt;br /&gt;
docker build&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FROM gcr.io/rproject/source:adminQA-0.0.27
ARG website
ARG location
ARG type
WORKDIR /app

COPY  appsettings.json /app/

EXPOSE 80
# ä¸æ›´æ”¹æ¬Šé™æœƒç™¼ç”Ÿæ¬Šé™éŒ¯èª¤
RUN chmod +x /init.sh
RUN [&amp;quot;chmod&amp;quot;, &amp;quot;+x&amp;quot;, &amp;quot;/init.sh&amp;quot;]
ENTRYPOINT [&amp;quot;sh&amp;quot;,&amp;quot;-x&amp;quot;,&amp;quot;/init.sh&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ’» Code/Golang/40. golang é‡æ–°è®€å–è¨­å®šæª”çš„æ–¹æ³•/" />
        </entry>
        <entry>
            <title>
                156. Golangç°¡ç•¥ç­†è¨˜ï¼ˆä¸€ï¼‰
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ’» Code/Golang/156. Golangç°¡ç•¥ç­†è¨˜ï¼ˆä¸€ï¼‰/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;ç§‘æŠ€å§‹çµ‚ä¾†è‡ªæ–¼äººé¡çš„æƒ°æ€§ï¼Œ&lt;br /&gt;
å…¥å‘æš—é»‘å¾Œï¼Œå‰äº›æ—¥å­çµ‚æ–¼æ‰“åˆ°äº†ä¸–ç•Œä¸‰ï¼Œ&lt;br /&gt;
è¦æ‰“ä¸–ç•Œç‹ï¼Œæ¯æ¬¡éƒ½è¦å»ç¶²ç«™çœ‹ï¼Œå¥½éº»ç…©ã€‚&lt;br /&gt;
æ‰€ä»¥ï¼Œå…ˆçˆ¬èŸ²ï¼Œç„¶å¾Œå†è¨­å€‹30åˆ†é˜å€’æ•¸è¨ˆæ™‚é€šçŸ¥è©²æ‰“ç‹äº†ã€‚&lt;br /&gt;
scrapy+Golang&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/Golang/156-fig.0.jpg&quot; alt=&quot;156-fig.0.jpg&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;github-a-href-https-github-com-daimom-d4countdowntimer-target-blank-class-external-link-d4countdowntimer-a&quot; tabindex=&quot;-1&quot;&gt;Github: &lt;a href=&quot;https://github.com/daimom/d4countdowntimer&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;d4countdowntimer&lt;/a&gt;&lt;/h3&gt;
&lt;hr /&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç§æœ‰å‡½æ•¸ï¼Œé–‹é ­æ˜¯å°å¯«ï¼Œåªèƒ½åœ¨åŒä¸€å€‹æª”æ¡ˆè£é¢ä½¿ç”¨ï¼Œ&lt;br /&gt;
å…¬é–‹å‡½æ•¸ï¼Œé–‹é ­è¦å¤§å¯«ï¼Œèƒ½çµ¦å…¶ä»–æª”æ¡ˆä½¿ç”¨&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ioutil å·²åœ¨bo 1.16æ£„ç”¨ï¼Œæ”¹ç”¨ io&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-go&quot;&gt;ioutil.ReadAll -&amp;gt; io.ReadAll
ioutil.ReadFile -&amp;gt; os.ReadFile
ioutil.ReadDir -&amp;gt; os.ReadDir
// others
ioutil.NopCloser -&amp;gt; io.NopCloser
ioutil.TempDir -&amp;gt; os.MkdirTemp
ioutil.TempFile -&amp;gt; os.CreateTemp
ioutil.WriteFile -&amp;gt; os.WriteFile
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://stackoverflow.com/questions/75206234/for-go-ioutil-readall-ioutil-readfile-ioutil-readdir-deprecated&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;for-go-ioutil-readall-ioutil-readfile-ioutil-readdir-deprecated&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è½‰æ›unix time&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-go&quot;&gt;location, err := time.LoadLocation(&amp;quot;Asia/Taipei&amp;quot;)
if err != nil {
  panic(err)
}

unixtime, err := strconv.ParseInt(d4event[&amp;quot;unixtime&amp;quot;], 10, 64)
if err != nil {
  fmt.Println(&amp;quot;è½‰æ›å¤±æ•—:&amp;quot;, err)
  return
}
t := time.Unix(unixtime, 0)
fmt.Println(t.In(location))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://stackoverflow.com/questions/43915900/how-to-convert-unix-time-to-time-time-in-golang&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;how-to-convert-unix-time-to-time-time-in-golang&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;import å¾Œé¢åŠ ä¸Š _&lt;br /&gt;
ä½¿ç”¨ã€import _&amp;quot;&lt;a href=&quot;http://github.com/gorilla/mux&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;github.com/gorilla/mux&lt;/a&gt;&amp;quot; ã€‘åªæ˜¯å¼•ç”¨è©²packageï¼Œåƒ…åƒ…æ˜¯ç‚ºäº†å‘¼å«init()å‡½æ•¸ï¼Œæ‰€ä»¥ç„¡æ³•é€šépackageåç¨±ï¼Œä¾†å‘¼å«packageè£é¢çš„å…¶ä»–å‡½æ•¸&lt;br /&gt;
re. &lt;a href=&quot;https://blog.csdn.net/972301/article/details/49127821&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Golang import ä¸‰ç¨®ç‰¹æ®Šå½¢å¼ï¼šä¸‹åŠƒç·šã€é»ã€åˆ¥å&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/spf13/viper&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;github.com/spf13/viper&lt;/a&gt; è¨­å®šæª”è§£æ±ºæ–¹æ¡ˆ&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-golang&quot;&gt;token :=viper.GetStringSlice(&amp;quot;Line.Token&amp;quot;) # æœ‰è³‡æ–™
tokens :=viper.GetStringMapStringSlice(&amp;quot;Line&amp;quot;)
token := tokens[&amp;quot;Token&amp;quot;]  # ç„¡è³‡æ–™ï¼ˆå› ç‚ºè½‰æˆå°å¯«äº†ï¼‰
token := tokens[&amp;quot;token&amp;quot;]  # æœ‰è³‡æ–™
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/Golang/156-fig.1.jpg&quot; alt=&quot;156-fig.1.jpg&quot; /&gt;&lt;br /&gt;
çœ‹github å°±æœ‰äººæœ‰è¨è«–åˆ°é€™å€‹&lt;a href=&quot;https://github.com/spf13/viper/issues/1014&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å•é¡Œ&lt;/a&gt;ï¼Œä½†åˆ°ç¾åœ¨é‚„æ˜¯ç„¡è§£ï¼Œ&lt;br /&gt;
æœ‰äººå»ºè­°æ”¹ç”¨go-yaml/yamlä¾†åš configæª”çš„è®€å–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ™‚é–“è™•ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-golang&quot;&gt;//ç¾åœ¨æ™‚é–“
now := time.Now()
//æ™‚é–“æ ¼å¼
fmt.Println(&amp;quot;now :&amp;quot; + now.Format(&amp;quot;2006-01-02 15:04:05&amp;quot;)) 
//æ—¥æœŸç›¸åŠ 
t2 := now.Add(5 * time.Minute)  
//æ—¥æœŸç›¸æ¸›
subMin := t2.Sub(now)  
//æ—¥æœŸç›¸æ¸›çš„æ™‚é–“ï¼Œä»¥åˆ†é˜é¡¯ç¤º
fmt.Println(subMin.Minutes()) 
//æ—¥æœŸç›¸æ¸›çš„æ™‚é–“ï¼Œå››æ¨äº”å…¥é¡¯ç¤ºåˆ°åˆ†
fmt.Println(subMin.Round(time.Minute))
//æ—¥æœŸç›¸æ¸›çš„æ™‚é–“ï¼Œå››æ¨äº”å…¥é¡¯ç¤ºåˆ°åˆ†ï¼Œå†ä»¥åˆ†é˜é¡¯ç¤ºè½‰int
fmt.Println(int(subMin.Round(time.Minute).Minutes()))


//æ—¥æœŸç›¸åŠ 
firstStopTime := t.Add(-35 * time.Minute)
//åˆ¤æ–·now æ˜¯å¦åœ¨ firstStopTimeä¹‹å¾Œ
if now.After(firstStopTime) {}
//åˆ¤æ–·now æ˜¯å¦åœ¨ firstStopTimeä¹‹å‰
if now.Before(firstStopTime){}
//åˆ¤æ–·nowæ˜¯å¦è·ŸfirstStopTimeä¸€æ¨£
if now.Equal(firstStopTime){}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
-&lt;a href=&quot;https://matthung0807.blogspot.com/2022/01/go-compare-datetime.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Golang æ—¥æœŸæ™‚é–“æ¯”è¼ƒ compare datetime&lt;/a&gt;&lt;br /&gt;
-&lt;a href=&quot;https://www.zhangbj.com/p/652.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Go æ™‚é–“åŠ æ¸›ã€è¨ˆç®—æ–¹æ³•è€—ã€æ¯«ç§’è½‰ Time&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;switchç”¨æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-golang&quot;&gt;subMin := 132
//ä¸€èˆ¬ç”¨æ³•
switch subMin {
case 0, 2, 3, 1:
    fmt.Println(&amp;quot;LineNotify&amp;quot;)
default:
    fmt.Println(&amp;quot;Error&amp;quot;)
}

//ä¸æŒ‡å®šè®Šæ•¸
switch {
case subMin%10 == 0, subMin%10 == 2:
    fmt.Println(&amp;quot;LineNotify&amp;quot;)
default:
    fmt.Println(subMin)
}


&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;cron ç°¡æ˜“ç”¨æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-golang&quot;&gt;c := cron.New()

//* æ¯åˆ†é˜åŸ·è¡Œä¸€æ¬¡
c.AddFunc(&amp;quot;* * * * *&amp;quot;, func() {
  if &amp;lt;condition&amp;gt; {
  c.Stop()
  }
})
c.Start()

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://eddycjy.gitbook.io/golang/di-3-ke-gin/cron&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è·Ÿç…é­šå­¸GO-Cronå®šæ™‚ä»»å‹™&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://www.readfog.com/a/1637371620314157056&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;golang cron v3 å®šæ™‚ä»»å‹™&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ’» Code/Golang/156. Golangç°¡ç•¥ç­†è¨˜ï¼ˆä¸€ï¼‰/" />
        </entry>
        <entry>
            <title>
                155. scrapyçˆ¬æš—é»‘ç·¨å¹´å²çš„ä¸–ç•Œç‹æ™‚é–“
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ’» Code/Golang/155. scrapyçˆ¬æš—é»‘ç·¨å¹´å²çš„ä¸–ç•Œç‹æ™‚é–“/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;å¥½ä¹…æ²’å¯«çˆ¬èŸ²äº†ï¼Œ&lt;br /&gt;
æœ€è¿‘ç©æš—é»‘IVï¼Œé–‹å§‹æ¥è§¸åˆ°ä¸–ç•Œç‹çš„æ™‚å€™ï¼Œæ™‚é–“å¾ˆä¸å›ºå®šï¼Œ&lt;br /&gt;
ç„¶å¾Œéš”äº†å¹¾å¤©ç™¼ç¾&lt;a href=&quot;https://diablo4.cc/tw/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æš—é»‘ç·¨å¹´å²&lt;/a&gt;ï¼Œ&lt;br /&gt;
æœ‰ä¸–ç•Œç‹çš„é€šçŸ¥æ™‚é–“å€’æ•¸äº†ã€‚&lt;br /&gt;
æœ‰è³‡æ–™å°±å¥½è¾¦äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;é–‹å•“scrapyå°ˆæ¡ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;scrapy start &amp;lt;project_name&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;åˆå§‹åŒ–(åœ¨ä¸Šä¸€å€‹æ­¥é©ŸåŸ·è¡Œå®Œå¾Œï¼Œå°±æœ‰ç›¸é—œæŒ‡ä»¤æœƒé¡¯ç¤ºåœ¨è¢å¹•ä¸Š)&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;scrapy genspider d4spider https://diablo4.cc/tw/
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çµæ§‹å¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â”œâ”€â”€ d4notify
â”‚Â Â  â”œâ”€â”€ __init__.py
â”‚Â Â  â”œâ”€â”€ __pycache__
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __init__.cpython-310.pyc
â”‚Â Â  â”‚Â Â  â””â”€â”€ settings.cpython-310.pyc
â”‚Â Â  â”œâ”€â”€ items.py
â”‚Â Â  â”œâ”€â”€ middlewares.py
â”‚Â Â  â”œâ”€â”€ pipelines.py
â”‚Â Â  â”œâ”€â”€ settings.py
â”‚Â Â  â””â”€â”€ spiders
â”‚Â Â      â”œâ”€â”€ __init__.py
â”‚Â Â      â”œâ”€â”€ __pycache__
â”‚Â Â      â”‚Â Â  â””â”€â”€ __init__.cpython-310.pyc
â”‚Â Â      â””â”€â”€ d4spider.py
â””â”€â”€ scrapy.cfg
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;åŸ·è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;scrapy crawl d4spider
&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/daimom/d4notify&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GITHUB-D4Notfiy&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å–å¾—å±¬æ€§&lt;br /&gt;
ç¢°åˆ°å€‹å¥‡æ€ªçš„èªæ³•ï¼Œdivè£é¢æœ‰å€‹è‡ªè¨‚çš„å±¬æ€§ï¼Œ&lt;br /&gt;
ç”¨scrapyè¦å–å€¼çš„è©±ï¼Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;div data-displaytime=&amp;quot;1687258903&amp;quot;&amp;gt;2023-06-20 19:01&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;div::attr(data-displaytime).get()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æ¨£æœƒå–å¾— 1687258903 é€™å€‹æ•¸å­—&lt;br /&gt;
ref. &lt;a href=&quot;https://stackoverflow.com/questions/53074642/scrapy-scraping-html-custom-attributes&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;scrapy-scraping-html-custom-attributes&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;extract_first() è·Ÿ extract() ,å¯ç”¨get()è·Ÿgetall()å–ä»£&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://scrapy-chs.readthedocs.io/zh_CN/0.24/topics/selectors.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é¸æ“‡å™¨(Selectors)&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ’» Code/Golang/155. scrapyçˆ¬æš—é»‘ç·¨å¹´å²çš„ä¸–ç•Œç‹æ™‚é–“/" />
        </entry>
        <entry>
            <title>
                59. git refsï¼Œbranch è·Ÿ tagæ˜¯ä¸€æ¨£çš„ã€‚
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ’» Code/59. git refsï¼Œbranch è·Ÿ tagæ˜¯ä¸€æ¨£çš„ã€‚/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;gitçš„ä¸»è¦æ¶æ§‹å…¶å¯¦éƒ½åœç¹ç€ refs ï¼Œ&lt;br /&gt;
branch è·Ÿ tag å…¶å¯¦æ˜¯ä¸€æ¨£çš„æ±è¥¿ï¼Œ&lt;br /&gt;
ç›´æ¥å»çœ‹ .gitçš„è³‡æ–™å¤¾ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„æ¶æ§‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;	tree .git/refs
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;â”œâ”€â”€ heads&lt;br /&gt;
â”‚Â Â  â”œâ”€â”€ apm2&lt;br /&gt;
â”‚Â Â  â””â”€â”€ testapmlog&lt;br /&gt;
â”œâ”€â”€ remotes&lt;br /&gt;
â”‚Â Â  â””â”€â”€ origin&lt;br /&gt;
â”‚Â Â      â”œâ”€â”€ HEAD&lt;br /&gt;
â”‚Â Â      â”œâ”€â”€ apm2&lt;br /&gt;
â”‚Â Â      â”œâ”€â”€ dev_spring20211027&lt;br /&gt;
â””â”€â”€ tags&lt;/p&gt;
&lt;p&gt;heads ç›®éŒ„ï¼Œæè¿°åœ¨æœ¬æ©Ÿä¸Šçš„æ‰€æœ‰åˆ†æ”¯ï¼Œæ¯ä¸€å€‹æª”æ¡ˆå°æ‡‰ç›¸æ‡‰çš„ç›®éŒ„ã€‚&lt;br /&gt;
é–‹å•Ÿæª”æ¡ˆçš„è©±ï¼Œæœƒçœ‹åˆ°ä¸€å€‹commitçš„é›œæ¹Šå€¼ï¼Œ&lt;br /&gt;
è€Œä¸ç®¡æ˜¯branch æˆ– tag éƒ½æ˜¯æ ¹æ“šæ­¤é›œæ¹Šå€¼ï¼Œä¾†æ±ºå®šä½ ç¨‹å¼ç›®å‰æ˜¯å“ªå€‹ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cat .git/refs/heads/apm2

git log -1 apm2 
or
git show apm2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™å…©å€‹çš„é›œæ¹Šå€¼æœƒä¸€æ¨£ï¼Œ&lt;br /&gt;
æ‰€ä»¥å»ºç«‹ä¸€å€‹æ–°çš„åˆ†æ”¯ï¼Œå°gitä¾†èªªï¼Œä¹Ÿåªæ˜¯å°‡ç•¶ä¸‹çš„é›œæ¹Šå€¼å¯«åˆ°ä¸€å€‹æª”æ¡ˆå…§ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://codertw.com/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC%E5%B7%A5%E5%85%B7/25108/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Gitç³»åˆ—ä¹‹Refs èˆ‡ Reflog&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.atlassian.com/git/tutorials/refs-and-the-reflog&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åŸæ–‡- Refs and the Reflog&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ’» Code/59. git refsï¼Œbranch è·Ÿ tagæ˜¯ä¸€æ¨£çš„ã€‚/" />
        </entry>
        <entry>
            <title>
                38.æ­£å‰‡å–ä»£ï¼Œç•™ä¸‹ç‰¹å®šå­—ä¸²
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ’» Code/38.æ­£å‰‡å–ä»£ï¼Œç•™ä¸‹ç‰¹å®šå­—ä¸²/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ‡¶äººçš„æ–¹å¼åˆä¾†äº†ï¼Œ&lt;br /&gt;
æœ‰ä¸€æ•´æ‰¹çš„è³‡æ–™ï¼Œä¸€å€‹ä¸€å€‹æ”¹æˆ‘è¦ºå¾—å¥½éº»ç…©ï¼Œ&lt;br /&gt;
é‚£å°±ç”¨æ­£å‰‡æ•´æ‰¹ä¿®å§&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å…ˆä¾†çœ‹å€‹ç¯„ä¾‹ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;code&amp;gt;
	&amp;lt;field name=&amp;quot;videoId&amp;quot;&amp;gt;&amp;lt;![CDATA[28713]]&amp;gt;&amp;lt;/field&amp;gt;
	&amp;lt;field name=&amp;quot;code&amp;quot;&amp;gt;&amp;lt;![CDATA[CWPBD-62]]&amp;gt;&amp;lt;/field&amp;gt;
	&amp;lt;field name=&amp;quot;artistId&amp;quot;&amp;gt;&amp;lt;![CDATA[5005]]&amp;gt;&amp;lt;/field&amp;gt;
	&amp;lt;field name=&amp;quot;sort&amp;quot;&amp;gt;&amp;lt;![CDATA[9054]]&amp;gt;&amp;lt;/field&amp;gt;
	&amp;lt;field name=&amp;quot;views&amp;quot;&amp;gt;&amp;lt;![CDATA[23004]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;/code&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¦å°‡![CDATA[]] ä¸­é–“çš„å­—ä¸²ç•™ä¸‹ä¾†ï¼Œ&lt;br /&gt;
é€™é‚Šå…¶å¯¦æœ‰å…©ç¨®åšæ³•ï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ç¨®æ˜¯ç”¨å–ä»£çš„ï¼Œå…ˆæŠŠ ![CDATA[  åˆªé™¤ï¼Œå†æŠŠ ]] åˆªé™¤&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é‚„æœ‰å¦ä¸€ç¨®å°±æ˜¯ä¸‹é¢çš„ç¯„ä¾‹ï¼Œç›´æ¥ç”¨æ­£å‰‡å–ä»£ï¼Œç•™ä¸‹ä¸­é–“çš„å­—ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆå¯«å¥½ä¸€å€‹æ­£å‰‡ï¼Œå¯ä»¥æŠ“åˆ° CDATAçš„è³‡æ–™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(&#92;!&#92;[CDATA&#92;[)(.*)(&#92;]&#92;])
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥åˆ°  &lt;a href=&quot;https://coding.tools/tw/regex-tester&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ­£å‰‡åœ¨ç·šæ¸¬è©¦&lt;/a&gt; æ¸¬è©¦&lt;/p&gt;
&lt;p&gt;åœ¨ ATOMçš„è©±ï¼Œæ–¼å–ä»£çš„ä½ç½®å¯«ä¸Š$2 ï¼Œé€™æ¨£å°±æœƒ ç•™ä¸‹ä¸­é–“çš„å­—äº†ã€‚(fig.1)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/38-fig.1.jpg&quot; alt=&quot;38-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæ˜¯åœ¨å¾®è»Ÿçš„excelï¼Œå‰‡æ˜¯ä½¿ç”¨ &#92;2 ï¼Œé€™æ¨£æ‰æœƒç•™ä¸‹ä¸­é–“çš„å­—ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;chrome-extension://bocbaocobfecmglnmeaeppambideimao/pdf/viewer.html?file=http%3A%2F%2Fwww.tpqri.org.tw%3A8080%2FFileUpload%2FActivity%2FActivity51%2FRegularExpressionTutorialVer350.pdf&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Regular Expressionï¼ˆæ­£å‰‡è¡¨é”å¼ï¼‰&lt;br /&gt;
å…¥é–€ä¿®ç·´ Ver3.50&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ’» Code/38.æ­£å‰‡å–ä»£ï¼Œç•™ä¸‹ç‰¹å®šå­—ä¸²/" />
        </entry>
        <entry>
            <title>
                22.telegram apiä½¿ç”¨
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ’» Code/22.telegram apiä½¿ç”¨/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¸Šä¸€ç¯‡å¯«åˆ°ç”¨flaggerï¼Œå»ºç«‹webhookç™¼é€é€šçŸ¥ã€‚&lt;br /&gt;
å…¬å¸æœ‰åœ¨ç”¨çš„å°±skypeè·Ÿ telegramï¼Œæ‰€ä»¥å°±....é–‹å§‹å§&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é¦–å…ˆä½ è¦æœ‰telegramå¸³è™Ÿ XDDD&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŠ å…¥ @BotFather ï¼Œè¼¸å…¥æŒ‡ä»¤ /newBotï¼Œé–‹å§‹å‘½åï¼Œæ³¨æ„æ©Ÿå™¨äººåç¨±å¯ä»¥ä¸ç”¨botçµå°¾ï¼Œä½†@å¸³è™Ÿæœ€å¾Œä¸€å®šæ˜¯Botçµå°¾&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/22.fig-1.jpg&quot; alt=&quot;22.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å»ºç«‹å¥½äº†å¾Œï¼Œæœƒæœ‰ä¸€çµ„tokenï¼Œè«‹ä¸è¦éš¨æ„çµ¦äººï¼Œå› ç‚ºåªè¦æœ‰é€™çµ„å°±èƒ½ç™¼é€è¨Šæ¯å‡ºå»äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/22.fig-2.jpg&quot; alt=&quot;22.fig-2.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;åˆ°æ­¤å·²ç¶“å®Œæˆä¸€åŠäº†ï¼Œå†ä¾†æ˜¯ä½¿ç”¨å–å¾—channelçš„idï¼Œå…ˆå°‡channelçš„é »é“è¨­å…¬é–‹ï¼Œä¸¦æŠŠæ©Ÿå™¨äººåŠ å…¥åˆ°channelè£¡é¢ã€‚&lt;br /&gt;
é€™é‚Šéœ€è¦è¨˜å¾—ä½ çš„chatidï¼Œä¸èƒ½è·Ÿå…¶ä»–äººçš„é‡è¤‡ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±è©¦è©¦ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/22.fig-3.jpg&quot; alt=&quot;22.fig-3.jpg&quot; /&gt;&lt;br /&gt;
ezioflaggernotfiyå°±æ˜¯æˆ‘çš„chatidï¼Œ&lt;br /&gt;
ç„¶å¾Œçµ„åˆä¸€ä¸‹apiï¼Œé€å‡ºå»å°±èƒ½å–å¾—channelçš„idï¼Œè«‹å…ˆå°‡æ©Ÿå™¨äººåŠ å…¥åˆ°channelè£¡é¢ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://api.telegram.org/bot{token}/sendMessage?chat_id={chatid}&amp;amp;text=Hello,world
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;{token} åœ¨ step.3ï¼Œå‰é¢è¨˜å¾—åŠ bot&lt;br /&gt;
{chatid} åœ¨step.4 ï¼Œè¨˜å¾—å‰é¢è¦åŠ  &lt;code&gt;@&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;é€å‡ºå»å¾Œï¼Œå›å‚³çš„è³‡æ–™ä¸Šé¢æœƒé¡¯ç¤º &lt;a href=&quot;http://chat.id/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;chat.id&lt;/a&gt;ï¼Œæ­¤æ™‚å°±èƒ½æŠŠchannel è¨­æˆ privateäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/22.fig-4.jpg&quot; alt=&quot;22.fig-4.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;å¦‚æœæ˜¯å…¬é–‹çš„channelï¼Œå°±åˆ°ç¬¬å››æ­¥å°±çµæŸäº†ã€‚&lt;br /&gt;
å¦‚æœæ˜¯ç§äººçš„è©±ï¼Œå°‡chatidæ”¹æˆ ï¼Œä¸Šé¢step.4æ‹¿åˆ°çš„ &lt;a href=&quot;http://chat.id/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;chat.id&lt;/a&gt; ï¼Œå³å¯ã€‚&lt;br /&gt;
ä¸ç”¨å†åŠ @ åœ¨chat_idå‰é¢äº†ã€‚æ­¤æ™‚æ‰€ç”¨çš„å·²æ˜¯å”¯ä¸€çš„channel snã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;https://api.telegram.org/bot1234:JMwL6qw/sendMessage&#92;?chat_id&#92;=-12345&#92;&amp;amp;text&#92;=hello,telegram
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;å¦‚æœè¨Šæ¯å¤ªé•·ï¼Œæƒ³è¦æœ‰æ˜é¡¯ä¸€é»çš„è¨Šæ¯ï¼Œå¯åŠ ä¸Šparse_mode=html&lt;br /&gt;
ä¸¦åœ¨å­—çš„å‰å¾ŒåŠ ä¸Š&lt;code&gt;abc&lt;/code&gt;ï¼Œåœ¨é›»è…¦ä¸Šçœ‹åˆ°çš„å­—æœƒæ˜é¡¯è¨±å¤šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/22.fig-5.jpg&quot; alt=&quot;22.fig-5.jpg&quot; /&gt;&lt;br /&gt;
(fig.5)&lt;br /&gt;
ä½†åœ¨æ‰‹æ©Ÿä¸Šçš„telegramï¼Œçœ‹ä¸åˆ°æ­¤ç‰¹æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://slashview.com/archive2020/20200319.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Telegram Botæ©Ÿå™¨äººç”³è«‹èˆ‡WebhookæŒ‡ä»¤å…¨ç´€éŒ„&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.tencent.com/developer/ask/146200&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¦‚ä½•ç²å¾—æ­£ç¢ºçš„telegram channel id?ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://core.telegram.org/bots#botfather&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; An introduction for developers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://core.telegram.org/bots/api#sendmessage&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;telegram-sendMessage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://rdrr.io/cran/telegram.bot/man/sendMessage.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;sendMessage: Send text messages&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://tgtw.cc/post-about-parse-mode-of-telegram&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é—œæ–¼ Telegram ä¸Šçš„è§£ææ¨¡å¼ï¼ˆMarkdownã€HTMLï¼‰ã€æ–‡å­—æ ¼å¼&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ’» Code/22.telegram apiä½¿ç”¨/" />
        </entry>
        <entry>
            <title>
                145. git submodule ä¸‹è¼‰å¤±æ•—
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ’» Code/145. git submodule ä¸‹è¼‰å¤±æ•—/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;å› ç‚ºä»–å€‘çš„æ–°å°ˆæ¡ˆæœ‰ç”¨åˆ° gitçš„submoduleï¼Œ&lt;br /&gt;
ä¹‹å‰ä¹Ÿç”¨éä¸€æ¬¡äº†ï¼Œæƒ³èªªæ‡‰è©²é‚„å¥½ï¼Œ&lt;br /&gt;
ä½†é€™æ¬¡å°±æ˜¯æ€éº¼é©—è­‰ï¼Œæ€éº¼ä¸éã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;éƒ½æ˜¯å‡ºç¾é€™å€‹éŒ¯èª¤&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Cloning into &#39;/drone/src/BackendSharedLib&#39;...&lt;br /&gt;
Host key verification failed.&lt;br /&gt;
fatal: Could not read from remote repository.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/145-fig.1.jpg&quot; alt=&quot;145-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä½†ä¹‹å‰å¯«çš„å°ˆæ¡ˆå°±æ²’é€™å€‹å•é¡Œï¼Œæ‰¾é˜¿æ‰¾ï¼Œæœ€å¾Œçµ‚æ–¼ç™¼ç¾ï¼Œ&lt;br /&gt;
å·®ç•°åœ¨ å»ºç«‹ submoduleçš„æ™‚å€™ã€‚&lt;/p&gt;
&lt;p&gt;æ‰“é–‹ .gitmodules ä¸Šé¢æœƒå¯« urlçš„ä½ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[submodule &amp;quot;SMSBackendSharedLib&amp;quot;]
	path = SMSBackendSharedLib
	url = git@github.com:ABC/sms-backend-sharedlib.git
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ¬ä¾†æ˜¯ä¸Šé¢é€™ç¨®å¯«æ³•ï¼Œä»–æœƒç”¨sshçš„æ–¹å¼å»æŠ“submoduleçš„æª”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¦æŠŠurlæ”¹æˆ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[submodule &amp;quot;SMSBackendSharedLib&amp;quot;]
	path = SMSBackendSharedLib
	url = https://github.com/ABC/sms-backend-sharedlib.git
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ä¾†ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git submodule update --init --recursive
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ¬æ©Ÿä¹Ÿå¯ä»¥ä¸‹è¼‰äº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬ä¾†é‚„æ‡·ç–‘æ˜¯ä¸æ˜¯drone clone submoduleçš„æ™‚å€™ï¼Œç”¨åˆ°éŒ¯èª¤çš„ä½¿ç”¨è€…ã€‚&lt;br /&gt;
çµæœä¸€æŸ¥æ ¹æœ¬æ²’æœ‰ä½¿ç”¨è€…ã€‚&lt;br /&gt;
å¯ä»¥ç”¨ä¸‹é¢çš„æŒ‡ä»¤æŸ¥æŸ¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git config --list

git config user.name
git config user.email
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç°¡å–®è§£é‡‹ä¸€ä¸‹ submoduleï¼Œ&lt;br /&gt;
ä»¥ä¸‹å¾chatGPTæŠ„ä¾†çš„ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨ Git ä¸­ï¼ŒSubmodule æ˜¯ä¸€å€‹å…è¨±æ‚¨åœ¨ Git å€‰åº«ä¸­åŒ…å«å¦ä¸€å€‹ Git å€‰åº«çš„æ©Ÿåˆ¶ã€‚é€šéä½¿ç”¨ Submoduleï¼Œæ‚¨å¯ä»¥å°‡ä¸€å€‹ Git å€‰åº«ä½œç‚ºå¦ä¸€å€‹ Git å€‰åº«çš„å­ç›®éŒ„é€²è¡Œç®¡ç†ã€‚é€™å°æ–¼ç®¡ç†å¤§å‹å°ˆæ¡ˆæˆ–å…±äº«ç¨‹å¼åº«éå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ç•¶æ‚¨åœ¨ Git å€‰åº«ä¸­æ–°å¢ Submodule æ™‚ï¼Œå®ƒå¯¦éš›ä¸Šæ˜¯åŒ…å«å¦ä¸€å€‹ Git å€‰åº«çš„æŒ‡å‘ã€‚ç•¶æ‚¨ clone æˆ– pull ä¸»å€‰åº«æ™‚ï¼ŒGit åªæœƒä¸‹è¼‰ Submodule çš„æŒ‡å‘ï¼Œè€Œä¸æœƒå°‡ Submodule çš„å…§å®¹ä¸€ä½µä¸‹è¼‰ã€‚é€™æ¨£å¯ä»¥ç¯€çœç©ºé–“å’Œæ™‚é–“ï¼ŒåŒæ™‚é‚„å¯ä»¥ä½¿ä¸»å€‰åº«æ›´åŠ è¼•ä¾¿ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³è¦æ›´æ–° Submodule çš„å…§å®¹ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;git submodule update&lt;/code&gt; å‘½ä»¤ä¾†ä¸‹è¼‰ Submodule çš„å…§å®¹ã€‚ç•¶æ‚¨ä¿®æ”¹ Submodule çš„å…§å®¹æ™‚ï¼Œæ‚¨éœ€è¦å…ˆé€²å…¥ Submodule çš„ç›®éŒ„ï¼Œå°å…¶é€²è¡Œ commit å’Œ pushï¼Œç„¶å¾Œè¿”å›ä¸»å€‰åº«ï¼Œå° Submodule çš„æŒ‡å‘é€²è¡Œ commit å’Œ pushã€‚é€™æ¨£å¯ä»¥ç¢ºä¿ Submodule çš„æŒ‡å‘æŒ‡å‘æ­£ç¢ºçš„ commitã€‚&lt;/p&gt;
&lt;p&gt;ç¸½ä¹‹ï¼ŒSubmodule æ˜¯ä¸€å€‹éå¸¸æœ‰ç”¨çš„æ©Ÿåˆ¶ï¼Œå¯ä»¥ä½¿ Git å€‰åº«ç®¡ç†æ›´åŠ éˆæ´»å’Œæœ‰æ•ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ’» Code/145. git submodule ä¸‹è¼‰å¤±æ•—/" />
        </entry>
        <entry>
            <title>
                110.github action pipelineç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ’» Code/110.github action pipelineç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å› ç‚ºä¹‹å‰ç”¨çš„å·´å“ˆè‡ªå‹•ç°½åˆ°ï¼Œé‚£å€‹githubè¢«å°äº†ï¼Œ&lt;br /&gt;
èªªé•åæœå‹™æ¢æ¬¾ï¼Œé‚„å¥½æˆ‘ä¸»ç¨‹å¼æœ‰ä¸‹è¼‰ä¸‹ä¾†éã€‚&lt;br /&gt;
æœªä¾†æŠŠä»–æ‰“åŒ…æˆimageå¾Œåœ¨æœ¬æ©Ÿè·‘äº†å§ï¼Œ&lt;br /&gt;
ä¸éè¦å…ˆè§£ægithubçš„workflowçœ‹æ˜¯æ€éº¼æ‰“åŒ…æˆimageçš„&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;    name: Publish
    
    on:
        push:
            branches:
                - main
            paths-ignore:
                - &amp;quot;**.md&amp;quot;
        workflow_dispatch:
    
    jobs:
    
        publish_docker:
            runs-on: ubuntu-latest
            steps:
                - name: Checkout Source Code
                  uses: actions/checkout@v3
    
                - name: Install PNPM
                  uses: pnpm/action-setup@v2.2.2
                  with:
                      version: latest
                      run_install: true
    
                - name: Build Package
                  run: pnpm build:package
    
                - name: Set up QEMU
                  uses: docker/setup-qemu-action@v2
    
                - name: Set up Docker Buildx
                  uses: docker/setup-buildx-action@v2
    
                - name: Login to Docker Hub
                  uses: docker/login-action@v2
                  with:
                      username: $
                      password: $
    
                - name: Build Image and Push
                  run: |
                      pnpm build:package
                      pnpm build:docker
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;name : actionçš„åç¨±&lt;/li&gt;
&lt;li&gt;on ï¼šä»€éº¼æ™‚å€™è§¸ç™¼&lt;/li&gt;
&lt;li&gt;job: è¦åŸ·è¡Œçš„å‹•ä½œ&lt;/li&gt;
&lt;li&gt;publish_docker : ä½œæ¥­çš„åç¨±&lt;/li&gt;
&lt;li&gt;runs-on: åŸ·è¡Œçš„os&lt;/li&gt;
&lt;li&gt;stepsï¼šåŸ·è¡Œçš„æ­¥é©Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h1&gt;
&lt;p&gt;ç”¨äº†ä¸€é™£å­ä»¥å¾Œï¼Œ&lt;br /&gt;
é‚£å€‹å°ˆæ¡ˆè¢«githubå°æ‰äº†ï¼Œ&lt;br /&gt;
æœ€å¾Œæ”¹ç”¨chrome çš„å¤–æ› &lt;img src=&quot;https://chrome.google.com/webstore/detail/%E5%B7%B4%E5%93%88%E8%87%AA%E5%8B%95%E7%B0%BD%E5%88%B0/nlcekebohjbgnfgjicklnjbnefmmgggk&quot; alt=&quot;å·´å“ˆè‡ªå‹•ç°½åˆ°&quot; /&gt; ï¼Œ&lt;br /&gt;
ç¼ºé»å°±æ˜¯é›»è…¦è¦ä¸€ç›´é–‹è‘—ï¼Œåæ­£æˆ‘é›»è…¦ä¹Ÿä¸€ç›´é–‹ç€æ‰€ä»¥æ²’é—œä¿‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ’» Code/110.github action pipelineç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                107. vscode å¿½ç•¥è¨­å®šåŒæ­¥
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ’» Code/107. vscode å¿½ç•¥è¨­å®šåŒæ­¥/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;å…¬å¸ä¸€è‡ºé›»è…¦ï¼Œæˆ‘è‡ªå·±å¸¶äº†ä¸€è‡ºmacéå»ï¼Œ&lt;br /&gt;
å› ç‚ºæˆ‘å·²ç¶“linuxç”¨ç¿’æ…£äº†ï¼ˆXï¼‰&lt;br /&gt;
ä¸å¾—ä¸èªªmacç”¨ç¿’æ…£çœŸçš„å¥½é †...&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/107.fig-1.jpg&quot; alt=&quot;107.fig-1.jpg&quot; /&gt;&lt;br /&gt;
æ‡‰è©²éƒ½çŸ¥é“linuxçš„æª”æ¡ˆç³»çµ±è·Ÿwindowsçš„æª”æ¡ˆç³»çµ±ä¸ä¸€æ¨£ã€‚&lt;br /&gt;
å‰è€…æ²’æœ‰Cã€Dã€Eçš„æ¦‚å¿µï¼Œ&lt;br /&gt;
æ‰€ä»¥vscodeçš„  &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=shalldie.background&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;background&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨åœ–ç‰‡è·¯å¾‘çš„è¨­å®šä¸Šæœƒä¸ä¸€æ¨£ï¼Œmacæ˜¯ä½¿ç”¨ä¸‹éºµé€™ç¨®æ–¹å¼è¨­å®švscodeçš„èƒŒæ™¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;file:///Users/daimom/Pictures/1275337.jpeg
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;windowså‰‡æ˜¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;file://c:&#92;Users&#92;user&#92;Pictures&#92;1275337.jpeg
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸€æ—¦åŒæ­¥çš„è©±ï¼Œå…©é‚Šçš„è·¯å¾‘å°±æœƒè¡çªï¼Œå°è‡´ä¸€é‚Šæ²’åœ–ç‰‡ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç¾åœ¨è¦è¨­å®šï¼Œå¿½ç•¥vscodeçš„åŒæ­¥è¨­å®šï¼Œè®“ä»–ä¸è¦æŠŠåœ–ç‰‡è¨­å®šçš„åœ°æ–¹ä¹ŸåŒæ­¥ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¨­å®šçš„æŸ¥è©¢æ¬„ä½ï¼Œè¼¸å…¥ ã€åŒæ­¥ã€ï¼Œ&lt;br /&gt;
é¸æ“‡å¿½ç•¥çš„è¨­å®šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%92%BB%20Code/107.fig-2.jpg&quot; alt=&quot;107.fig-2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‡‰è©²æœƒçœ‹åˆ° settingsSync.ignoredSettings ï¼Œ&lt;br /&gt;
åº•ä¸‹è¼¸å…¥background.customImages&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;settingsSync.ignoredSettings&amp;quot;: [

&amp;quot;background.customImages&amp;quot;

],
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ’» Code/107. vscode å¿½ç•¥è¨­å®šåŒæ­¥/" />
        </entry>
        <entry>
            <title>
                0.Code MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ’» Code/0.Code MOC/</id>
            <content type="html">
                &lt;h2 id=&quot;api&quot; tabindex=&quot;-1&quot;&gt;APIä¸²æ¥&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/22.telegram%20api%E4%BD%BF%E7%94%A8/&quot;&gt;22.telegram apiä½¿ç”¨&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;golang&quot; tabindex=&quot;-1&quot;&gt;Golang&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/Golang/40.%20golang%20%E9%87%8D%E6%96%B0%E8%AE%80%E5%8F%96%E8%A8%AD%E5%AE%9A%E6%AA%94%E7%9A%84%E6%96%B9%E6%B3%95/&quot;&gt;40. golang é‡æ–°è®€å–è¨­å®šæª”çš„æ–¹æ³•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/Golang/47.%20GO%20get%20%E5%8F%83%E6%95%B8/&quot;&gt;47. GO get åƒæ•¸&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/Golang/155.%20scrapy%E7%88%AC%E6%9A%97%E9%BB%91%E7%B7%A8%E5%B9%B4%E5%8F%B2%E7%9A%84%E4%B8%96%E7%95%8C%E7%8E%8B%E6%99%82%E9%96%93/&quot;&gt;155. scrapyçˆ¬æš—é»‘ç·¨å¹´å²çš„ä¸–ç•Œç‹æ™‚é–“&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/Golang/156.%20Golang%E7%B0%A1%E7%95%A5%E7%AD%86%E8%A8%98%EF%BC%88%E4%B8%80%EF%BC%89/&quot;&gt;156. Golangç°¡ç•¥ç­†è¨˜ï¼ˆä¸€ï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;æ­£å‰‡è¡¨é”å¼&quot; tabindex=&quot;-1&quot;&gt;æ­£å‰‡è¡¨é”å¼&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/38.%E6%AD%A3%E5%89%87%E5%8F%96%E4%BB%A3%EF%BC%8C%E7%95%99%E4%B8%8B%E7%89%B9%E5%AE%9A%E5%AD%97%E4%B8%B2/&quot;&gt;38.æ­£å‰‡å–ä»£ï¼Œç•™ä¸‹ç‰¹å®šå­—ä¸²&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;git&quot; tabindex=&quot;-1&quot;&gt;Git&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/59.%20git%20refs%EF%BC%8Cbranch%20%E8%B7%9F%20tag%E6%98%AF%E4%B8%80%E6%A8%A3%E7%9A%84%E3%80%82/&quot;&gt;59. git refsï¼Œbranch è·Ÿ tagæ˜¯ä¸€æ¨£çš„ã€‚&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/110.github%20action%20pipeline%E7%AD%86%E8%A8%98/&quot;&gt;110.github action pipelineç­†è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/145.%20git%20submodule%20%E4%B8%8B%E8%BC%89%E5%A4%B1%E6%95%97/&quot;&gt;145. git submodule ä¸‹è¼‰å¤±æ•—&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;ide&quot; tabindex=&quot;-1&quot;&gt;IDE&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/107.%20vscode%20%E5%BF%BD%E7%95%A5%E8%A8%AD%E5%AE%9A%E5%90%8C%E6%AD%A5/&quot;&gt;107. vscode å¿½ç•¥è¨­å®šåŒæ­¥&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ’» Code/0.Code MOC/" />
        </entry>
        <entry>
            <title>
                28.Prometheusçš„å°ˆç”¨èªè¨€promQL
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/28.Prometheusçš„å°ˆç”¨èªè¨€promQL/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;åœ¨å¯«ç›£æ§å‘Šè­¦çš„æ™‚å€™ï¼Œçœ‹åˆ¥äººå¯«å¥½çš„dashboardè£¡é¢æœ‰ä¸€å †å‡½æ•¸ï¼Œ&lt;br /&gt;
ä½†å»ååä¸çŸ¥é“è©²æ€éº¼ä½¿ç”¨ï¼Œå¾Œä¾†æ‰çŸ¥é“é€™æ˜¯ Prometheusçš„èªè¨€ PromQLï¼Œ&lt;br /&gt;
é€™é‚Šæœƒå°‡å¯«ç›£æ§æ™‚ç”¨åˆ°çš„æ±è¥¿è¨˜ä¸‹ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯é‡å°metricsåšçš„è™•ç†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h2 id=&quot;èšåˆå‡½æ•¸&quot; tabindex=&quot;-1&quot;&gt;èšåˆå‡½æ•¸&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;sum (æ±‚å’Œ)&lt;/li&gt;
&lt;li&gt;min (æœ€å°å€¼)&lt;/li&gt;
&lt;li&gt;max (æœ€å¤§å€¼)&lt;/li&gt;
&lt;li&gt;avg (å¹³å‡å€¼)&lt;/li&gt;
&lt;li&gt;stddev (æ¨™å‡†å·®)&lt;/li&gt;
&lt;li&gt;stdvar (æ¨™å‡†å·®ç•°)&lt;/li&gt;
&lt;li&gt;count (è¨ˆæ•¸)&lt;/li&gt;
&lt;li&gt;count_values (å°valueé€²è¡Œè¨ˆæ•¸)&lt;/li&gt;
&lt;li&gt;bottomk (å¾Œnæ¢æ™‚åº)&lt;/li&gt;
&lt;li&gt;topk (å‰næ¢æ™‚åº)&lt;br /&gt;
topk(10,prometheus_http_requests_total) ï¼šå‰10ç­†è³‡æ–™&lt;/li&gt;
&lt;li&gt;quantile (åˆ†ä½ˆçµ±è¨ˆ)&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;èšåˆå‡½æ•¸å¯èˆ‡by æˆ– withoutå…±åŒä½¿ç”¨ ï¼Œå¯å–å¾—metricsè£¡çš„æ¬„ä½åç¨±&lt;br /&gt;
ä¾‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;sum(rate(istio_requests_total{reporter=&amp;quot;destination&amp;quot;}[1m])) by (destination_workload)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;å…§å»ºå‡½æ•¸&quot; tabindex=&quot;-1&quot;&gt;å…§å»ºå‡½æ•¸&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;abs(çµ•å°å€¼)&lt;/li&gt;
&lt;li&gt;absent(åˆ¤æ–·æŒ‡æ¨™åç¨±æˆ–æ¨™ç±¤æ˜¯å¦æœ‰å€¼)&lt;/li&gt;
&lt;li&gt;absent_over_time(åŒä¸Šï¼Œå¤šäº†æ™‚é–“ç¯„åœ)&lt;/li&gt;
&lt;li&gt;ceil(å››æ¨äº”å…¥)&lt;/li&gt;
&lt;li&gt;changes(è¿”å›å€é–“è®Šæ•¸æ¯å€‹æ¨£æœ¬å€¼è®ŠåŒ–çš„æ¬¡æ•¸)&lt;/li&gt;
&lt;li&gt;delta(è¨ˆç®—å€é–“å‘é‡ç¬¬ä¸€å€‹å€¼å’Œæœ€å¾Œä¸€å€‹å€¼çš„å·®å€¼)&lt;/li&gt;
&lt;li&gt;floor(å–æ•´æ•¸)&lt;/li&gt;
&lt;li&gt;increase(è¿”å›å€é–“å‘é‡ç¬¬ä¸€å€‹å’Œæœ€å¾Œä¸€å€‹æ¨£æœ¬çš„å¢åŠ å€¼)&lt;/li&gt;
&lt;li&gt;rate(è¨ˆç®—å€é–“å‘é‡ v åœ¨æ™‚é–“è¦–çª—å…§å¹³å‡æ¯æ™‚é–“å¢é•·é€Ÿç‡)&lt;br /&gt;
rate(prometheus_http_requests_total[5m])  ï¼š HTTPè«‹æ±‚é‡çš„å¢é•·ç‡&lt;/li&gt;
&lt;li&gt;irate(è¨ˆç®—å€é–“å‘é‡çš„å¢é•·ç‡ï¼Œä½†æ˜¯å®ƒåæ‡‰çš„æ˜¯ç¬æ™‚å¢é•·ç‡)&lt;/li&gt;
&lt;li&gt;deriv(è¨ˆç®—æ¨£æœ¬çš„ç·šæ€§å›æ­¸æ¨¡å‹)&lt;/li&gt;
&lt;li&gt;predict_linear(é æ¸¬æ™‚é–“åºåˆ—åœ¨nç§’å¾Œçš„å€¼)&lt;/li&gt;
&lt;li&gt;sort(å°å‘é‡æŒ‰å…ƒç´ çš„å€¼é€²è¡Œå‡åºæ’åº)&lt;/li&gt;
&lt;li&gt;sort_desc(å°å‘é‡æŒ‰å…ƒç´ çš„å€¼é€²è¡Œé™åºæ’åº)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;å¯¦éš›æ¼”ç·´&quot; tabindex=&quot;-1&quot;&gt;å¯¦éš›æ¼”ç·´&lt;/h2&gt;
&lt;p&gt;å¯ä»¥å…ˆåœ¨prometheusä¸Šé¢æ¸¬è©¦èªæ³•ï¼Œç•¶æ¸¬è©¦å®Œæˆå¾Œï¼Œå†æ”¾åˆ°grafanaä¸Šé¢çœ‹å¯¦éš›çš„åœ–è¡¨ã€‚&lt;br /&gt;
ä¹Ÿå¯é€éç¾æœ‰çš„grafanaçš„dashboardè£¡é¢çš„Query Inspect å°‡Metricæ’ˆå‡ºä¾†ï¼ˆé€™é‚Šå¯ä»¥ç›´æ¥å°‡è®Šæ•¸å–å‡ºï¼‰(fig.1)&lt;br /&gt;
æ’ˆå‡ºä¾†çš„è³‡æ–™è¦å†ç¶“é &lt;a href=&quot;https://www.urldecoder.org/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;urldecode&lt;/a&gt; å°‡ç¬¦è™Ÿè½‰æˆæ­£å¸¸çš„ç¬¦è™Ÿ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/28-fig.1.jpg&quot; alt=&quot;28-fig.1.jpg&quot; /&gt;&lt;br /&gt;
(fig.1)&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰çš„Metricæ ¼å¼å¦‚ä¸‹ï¼Œ&lt;br /&gt;
æŒ‡æ¨™åç¨±åªèƒ½ç”±ASCIIå­—ç¬¦ã€æ•¸å­—ã€ä¸‹åŠƒç·šä»¥åŠå†’è™Ÿçµ„æˆä¸¦å¿…é ˆç¬¦åˆæ­£å‰‡è¡¨é”å¼[a-zA-Z_:][a-zA-Z0-9_:]*&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;metric name&amp;gt;{&amp;lt;label name&amp;gt;=&amp;lt;label value&amp;gt;, ...}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŒ¹é…å‡½æ•¸&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;=   ç­‰æ–¼&lt;/li&gt;
&lt;li&gt;!=  ä¸ç­‰æ–¼&lt;/li&gt;
&lt;li&gt;=~  é–‹é ­ç­‰æ–¼&lt;/li&gt;
&lt;li&gt;!~  é–‹é ­ä¸ç­‰æ–¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ‰æ™‚ä¹Ÿæœƒåœ¨label nameä¸Šé¢ä½¿ç”¨ æ­£è¦è¡¨ç¤ºæ³•ï¼Œé€™é‚Šä½¿ç”¨çš„æ˜¯&lt;a href=&quot;https://github.com/google/re2/wiki/Syntax&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;RE2èªæ³•&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘å€‘è¦å–å¾—memoryçš„è³‡æ–™ï¼Œå…¶ä¸­çš„imageçš„é–‹é ­åªè¦åŒ…å« &lt;a href=&quot;http://gcr.io/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcr.io&lt;/a&gt; è·Ÿ istioã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  container_memory_working_set_bytes{id!=&amp;quot;/&amp;quot;,pod=~&amp;quot;.*&amp;quot;,image=~&amp;quot;[gcr.io | istio].*&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è®Šæ•¸è¨­å®š&lt;/p&gt;
&lt;p&gt;åœ¨grafanaä¸Šé¢é€šå¸¸æœƒè¨­å®šä¸€äº›åƒæ•¸ï¼Œé€™æ˜¯ç‚ºäº†çœ‹æŒ‡å®šçš„æŒ‡æ¨™&lt;br /&gt;
æœ‰å››ç¨®å¯é¸ï¼Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;label_values(label) :&lt;br /&gt;
è¿”å›Promthuesæ‰€æœ‰ç›£æ§æŒ‡æ¨™ä¸­ï¼Œæ¨™ç±¤ç¨±ç‚ºlabelçš„æ‰€æœ‰å¯é¸å€¼&lt;/li&gt;
&lt;li&gt;label_values(metric, label) :&lt;br /&gt;
è¿”å›Promthuesæ‰€æœ‰ç›£æ§æŒ‡æ¨™metricä¸­ï¼Œæ¨™ç±¤ç¨±ç‚ºlabelçš„æ‰€æœ‰å¯é¸å€¼&lt;/li&gt;
&lt;li&gt;metrics(metric) :&lt;br /&gt;
è¿”å›æ‰€æœ‰æŒ‡æ¨™åç¨±æ»¿è¶³metricå®šç¾©æ­£å‰‡è¡¨é”å¼çš„æŒ‡æ¨™åç¨±&lt;/li&gt;
&lt;li&gt;query_result(query) :&lt;br /&gt;
è¿”å›prometheusæŸ¥è©¢èªå¥çš„æŸ¥è©¢çµæœ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸¸ç”¨çš„label_value&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  $Node       label_values(kubernetes_io_hostname)
  $Pod        label_values(kube_pod_info, pod)
  $Pod_ip     label_values(kube_pod_info, pod_ip)
  $phase      label_values(kube_pod_status_phase, phase)
  $container  label_values(kube_pod_container_info, container)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;query_resultç¯„ä¾‹ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;query_result(kube_deployment_status_replicas{namespace !~ &amp;quot;istio-system|kube-system&amp;quot;}&amp;gt;0)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è§£é‡‹ï¼šæ’é™¤Deploymentè£¡é¢çš„namespace ä¸æ˜¯ istio-systemæˆ– kube-systemï¼Œä¸¦ä¸”value&amp;gt;0çš„metricsã€‚&lt;br /&gt;
é€™é‚Šæœƒé¡¯ç¤ºå…¨éƒ¨çš„è³‡æ–™ï¼Œæ•…åœ¨regexè¦å†æŒ‡å®šæŠ“å– deploymentçš„è³‡æ–™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/.*deployment=&amp;quot;(.*?)&amp;quot;.*/
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://banzaicloud.com/blog/grafana-templating/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Grafana templating with Prometheus labels&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://yunlzheng.gitbook.io/prometheus-book/part-ii-prometheus-jin-jie/grafana/templating&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ¨¡æ¿åŒ–Dashboard&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.mdeditor.tw/pl/g0OB/zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;PromQLçš„ç°¡å–®ä½¿ç”¨&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://zhuanlan.zhihu.com/p/121104877&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Prometheus-åŸºç¤ç³»åˆ—-(å››)-PromQLèªå¥å¯¦è¸-2&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://prometheus.fuckcloudnative.io/di-san-zhang-prometheus/di-4-jie-cha-xun/functions&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;PromQL å…§ç½®å‡½æ•¸&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://yunlzheng.gitbook.io/prometheus-book/parti-prometheus-ji-chu/promql/prometheus-promql-operators-v2&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;PromQLæ“ä½œç¬¦&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/28.Prometheusçš„å°ˆç”¨èªè¨€promQL/" />
        </entry>
        <entry>
            <title>
                26.grafana alert message parameterså‚³å…¥
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/26.grafana alert message parameterså‚³å…¥/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;åœ¨è¨­è¨ˆgrafana alert messageçš„æ™‚å€™ï¼Œ&lt;br /&gt;
ä¸€ç›´æƒ³å‚³åƒæ•¸é€²å»ï¼Œçœ‹å®˜æ–¹æ–‡ç« é¡¯ç¤ºæ˜¯å¯è¡Œçš„ï¼Œ&lt;br /&gt;
ä½†æ˜¯ä¸çŸ¥é“æ˜¯æˆ‘ç†è§£èƒ½åŠ›å¤ªçˆ›é‚„æ˜¯æ–‡ç« å¯«çš„å¤ªç°¡å–®...å¼„äº†åŠå¤©æ‰ç”Ÿå‡ºä¾†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å…ˆæ±ºæ¢ä»¶ï¼Œ Grafana v7.4 ä»¥ä¸Šï¼Œæ‰èƒ½å¤ ä½¿ç”¨ Notification templating ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://grafana.com/docs/grafana/latest/alerting/notifications/#notification-templating&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Notification templating&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é€™é‚Šçš„parametersåªé™å®šæ–¼ åœ–è¡¨ä¸Šçš„ Legend çš„value&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/26-fig.1.jpg&quot; alt=&quot;26-fig.1.jpg&quot; /&gt;&lt;br /&gt;
(fig.1)ï¼Œ&lt;br /&gt;
éœ€ä½¿ç”¨ ï¼Œå°‡å€¼é¡¯ç¤ºåœ¨ä¸Šé¢ã€‚&lt;br /&gt;
æ‰€ä»¥é€™ä¸Šé¢æ²’æœ‰è³‡æ–™ï¼Œå°±ç„¡æ³•å‚³éå»çµ¦alert messageã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/26-fig.1.jpg&quot; alt=&quot;26-fig.1.jpg&quot; /&gt;&lt;br /&gt;
(fig.1)&lt;/p&gt;
&lt;p&gt;ä¹‹å¾Œåœ¨alertä¸Šé¢å‰‡å¯ä»¥ä½¿ç”¨ ${label}ï¼Œå°‡å€¼å‚³å…¥ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/26-fig.2.jpg&quot; alt=&quot;26-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;telegram å‘ˆç¾&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/26-fig.3.jpg&quot; alt=&quot;26-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç¼ºé»æ˜¯å‘Šè­¦è¨Šæ¯çš„Metricsä¸Šé¢çš„æ•¸å€¼ï¼Œæˆ‘ç›®å‰é‚„æ‰¾ä¸åˆ°æ–¹å¼å¯ä»¥è‡ªå®šã€‚&lt;br /&gt;
æ‰€ä»¥é•·çš„ä¸æ€éº¼è¨å–œã€‚&lt;br /&gt;
å¦å¤–å¯ä»¥åœ¨åœ–è¡¨ä¸Šç›´æ¥å°‡Legendéš±è—ï¼Œé€™æ¨£è‡³å°‘ç•«é¢æœƒå¥½çœ‹è¨±å¤šã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://grafana.com/docs/grafana/latest/alerting/add-notification-template/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Alert notification templating&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/26.grafana alert message parameterså‚³å…¥/" />
        </entry>
        <entry>
            <title>
                25.åœ¨GKEä¸Šçš„grafanaä¸Šå®‰è£grafana-image-renderer
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/25.åœ¨GKEä¸Šçš„grafanaä¸Šå®‰è£grafana-image-renderer/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;åœ¨å¯«grafanaçš„æ™‚å€™ï¼Œæ‰ç™¼ç¾å‘Šè­¦çš„åœ–ç‰‡ç„¡æ³•å¯„å‡ºï¼Œ&lt;br /&gt;
å¿…é ˆè¦é¡å¤–å®‰è£plugin : grafana-image-renderer ï¼Œ&lt;br /&gt;
ç„¶å¾Œï¼Œæˆ‘åˆå¡ä½äº†...&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å¦‚æœä½ çœ‹åˆ°é€™å¼µåœ–(fig.1)ï¼Œå°±è¡¨ç¤ºä½ è©²è£&lt;a href=&quot;https://grafana.com/grafana/plugins/grafana-image-renderer/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Grafana Image Renderer&lt;/a&gt;äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/25-fig.1.jpg&quot; alt=&quot;25-fig.1.jpg&quot; /&gt;&lt;br /&gt;
(fig.1)&lt;/p&gt;
&lt;p&gt;å…ˆèªªçµè«–ï¼Œæˆ‘æ¸¬éã€åœ¨podè£¡é¢åˆ©ç”¨grafana-cli å®‰è£ã€ã€ã€æ”¹æˆä½¿ç”¨ubuntuçš„imageé å…ˆå®‰è£pluginã€ï¼Œéƒ½å¤±æ•—ï¼Œæœ€å¾Œåªèƒ½å»ºç«‹ grafana-image-rendererçš„ æœå‹™ï¼Œé€éé€™å€‹æœå‹™ï¼Œè² è²¬å®£æŸ“ç•¶ä¸‹çš„å‘Šè­¦åœ–ï¼Œå†éš¨ç€telegramé€å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ä½ˆç½²çš„yamlï¼Œ grafana-image-render.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: apps/v1
kind: Deployment

metadata:
namespace: istio-system
name: grafana-image-renderer
labels:
  app: grafana-image-renderer
  version: v1
spec:
replicas: 1
selector:
  matchLabels:
    app: grafana-image-renderer
    version: v1
strategy:
  type: RollingUpdate
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 1
template:
  metadata:
    labels:
      app: grafana-image-renderer
      version: v1
  spec:
    containers:
      - image: grafana/grafana-image-renderer:latest
        imagePullPolicy: &amp;quot;Always&amp;quot;
        name: renderer
        ports:
          - containerPort: 80
        env:
          - name: &amp;quot;RENDERING_VERBOSE_LOGGING&amp;quot;
            value: &amp;quot;true&amp;quot;
        resources:
          requests:
            memory: &amp;quot;30Mi&amp;quot;
            cpu: &amp;quot;30m&amp;quot;
    restartPolicy: Always
    serviceAccountName: &amp;quot;&amp;quot;
---
apiVersion: v1
kind: Service
metadata:
namespace: istio-system
labels:
  app: grafana-image-renderer
name: grafana-image-renderer
spec:
ports:
  - name: &amp;quot;http&amp;quot;
    port: 8081
selector:
  app:  grafana-image-renderer
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œåœ¨ä½ˆç½² grafanaçš„yamlä¸Šé¢ï¼Œå¢åŠ ç’°å¢ƒåƒæ•¸&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- name: &amp;quot;GF_RENDERING_SERVER_URL&amp;quot;
  value: &amp;quot;http://grafana-image-renderer.istio-system:8081/render&amp;quot;
- name: &amp;quot;GF_RENDERING_CALLBACK_URL&amp;quot;
  value: &amp;quot;http://grafana.istio-system:3000/grafana/&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœè¦é–‹å•Ÿdebugçš„è©±ï¼ŒåŠ ä¸Š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- name: &amp;quot;GF_LOG_FILTERS&amp;quot;
  value: &amp;quot;rendering:debug&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœéœ€è¦æ›´å¤šçš„logè¨Šæ¯ï¼Œå¯åƒè€ƒ &lt;a href=&quot;https://github.com/grafana/grafana-image-renderer/blob/master/docs/remote_rendering_using_docker.md&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;grafana-image-renderer&lt;/a&gt;ï¼Œé€™é‚Šå°±æ˜¯æ”¹åŠ è‡³grafana-image-rendererä¸Šé¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€é–‹å§‹åœ¨æ¸¬è©¦çš„æ™‚å€™æœ‰ç¢°åˆ°ä¸€å€‹å•é¡Œï¼Œ&lt;br /&gt;
é‚£å°±æ˜¯æŠ“åœ–çš„æ™‚å€™ï¼Œä¸€ç›´æŠ“åˆ°grafanaçš„é¦–é (Fig.2)&lt;/p&gt;
&lt;p&gt;[[25-fig.2.jpg]]&lt;br /&gt;
(Fig.2)&lt;/p&gt;
&lt;p&gt;å¾Œä¾†æ‰ç™¼ç¾æ˜¯ GF_RENDERING_CALLBACK_URL éŒ¯èª¤ï¼Œç”±æ–¼æˆ‘çš„grafana.ini çš„ root_url æ˜¯ &lt;a href=&quot;http://localhost/grafana%EF%BC%8C&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;http://localhost/grafanaï¼Œ&lt;/a&gt;&lt;br /&gt;
æ‰€ä»¥ æˆ‘çš„ç¶²å€å¾Œé¢ä¹Ÿè¦åŠ ä¸Šgrafanaï¼Œä½†æ˜¯ï¼Œå¦‚æœåœ¨grafana.iniä¸Šé¢ çš„ root_url å¯« &lt;a href=&quot;http://localhost/grafana&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;http://localhost/grafana&lt;/a&gt;&lt;br /&gt;
é‚£telegramçš„å‘Šè­¦ï¼Œé¡¯ç¤ºçš„urlä¹Ÿæœƒè®Šæˆlocalhost (fig.3)&lt;/p&gt;
&lt;p&gt;[[25-fig.3.jpg]]&lt;br /&gt;
(Fig.3)&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œgrafana.iniçš„root_url æœ€å¥½é‚„æ˜¯å¯«å¯¦éš›çš„ipä½ç½®ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/25.åœ¨GKEä¸Šçš„grafanaä¸Šå®‰è£grafana-image-renderer/" />
        </entry>
        <entry>
            <title>
                24.grafanaè¨­è¨ˆç¯‡-ç¬¬äºŒå€‹Yè»¸
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/24.grafanaè¨­è¨ˆç¯‡-ç¬¬äºŒå€‹Yè»¸/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ‡‰è©²æ˜¯å€‹å¾ˆå¸¸è¦‹çš„åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘å»æ‰¾äº†å¾ˆä¹…ï¼Œä¸€ç›´æ‰¾ä¸åˆ°ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;è¦åšå‡ºä¾†çš„æ±è¥¿åƒï¼ˆFig.1) ä¸€æ¨£ï¼Œå·¦å³éƒ½å„æœ‰ä¸€å€‹Yè»¸æ•¸å€¼ã€‚&lt;/p&gt;
&lt;p&gt;(Fig.1)&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é¦–å…ˆè¦å…ˆåœ¨å³é‚Šçš„åœ–è¡¨å°‡showæ‰“é–‹ï¼Œï¼Œé€™è£¡åˆ†æˆå·¦å³å…©é‚Šçš„Yè»¸&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/24-fig.2.jpg&quot; alt=&quot;24-fig.2.jpg&quot; /&gt;&lt;br /&gt;
(Fig.2)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é»ä¸€ä¸‹labelçš„æ¨™ç±¤ï¼Œé¸æ“‡ Y-Axis ï¼Œå°‡ use y-axis æ‰“é–‹&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/24-fig.3.jpg&quot; alt=&quot;24-fig.3.jpg&quot; /&gt;&lt;br /&gt;
(Fig.3)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://grafana.com/blog/2020/03/10/learn-grafana-how-to-use-dual-axis-graphs/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Learn Grafana: How to use dual axis graphs&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/24.grafanaè¨­è¨ˆç¯‡-ç¬¬äºŒå€‹Yè»¸/" />
        </entry>
        <entry>
            <title>
                198. SREå¥½æ–‡é€£çµ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/198. SREå¥½æ–‡é€£çµ/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;çœ‹åˆ¥äººSREçš„æ–‡ç« ï¼Œæ„Ÿè¦ºé€™å€‹éœ€è¦è¨˜éŒ„ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://www.kawabangga.com/posts/4294&quot; title=&quot;Permalink to æœ€è¿‘çš„å·¥ä½œæ„Ÿæ‚Ÿ&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¡ç“¦é‚¦å™¶-æœ€è¿‘çš„å·¥ä½œæ„Ÿæ‚Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€™ç¯‡ä¸»è¦ä»‹ç´¹ï¼Œä»–æ˜¯æ€éº¼è§£æ±ºä¸€ç›´å ±éŒ¯çš„æ–¹æ³•ã€‚&lt;br /&gt;
ç•¶å‘Šè­¦å¤ªå¤šï¼Œåªæœƒéº»ç—¹è€Œå·²ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ç›®å‰æŠŠé€šçŸ¥åˆ†æˆå…©ç¨®ï¼Œç¬¬ä¸‰ç¨®ï¼Œå·¥å–®æˆ‘é‚„æ²’æœ‰ç¢°åˆ°é€™å€‹æ¡ˆä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;é€šçŸ¥ï¼šä¸€èˆ¬è¨Šæ¯ï¼Œä¸é‡è¦ï¼Œä½†å¿…é ˆè¦çŸ¥é“ï¼ˆæœ•ï¼ŒçŸ¥é“äº†ï¼‰é€™ç¨®æ„Ÿè¦ºã€‚&lt;br /&gt;
ç·Šæ€¥ï¼šç¾åœ¨ã€ç«‹åˆ»ã€é¦¬ä¸Šè™•ç†ï¼ˆè­·é§•ï¼ï¼ï¼‰é€™ç¨®æ„Ÿè¦º&lt;br /&gt;
å·¥å–®ï¼šéœ€è¦äººåŠ›ä»‹å…¥çš„æ“ä½œï¼ˆé‚„æ²’ç”¨éé€™ç¨®ï¼‰&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;&lt;a href=&quot;https://www.kawabangga.com/posts/4481&quot; title=&quot;Permalink to SRE çš„å·¥ä½œä»‹ç´¹&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SRE çš„å·¥ä½œä»‹ç´¹&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è·Ÿä¸Šä¸€ç¯‡åŒä¸€å€‹ä½œè€…ï¼Œè¬›SREçš„å·¥ä½œå…§å®¹ï¼Œä¸åŒå…¬å¸æœƒæœ‰ä¸åŒçš„æ¬Šé‡ã€‚&lt;br /&gt;
ä½†è‡ºç£æ‡‰è©²éƒ½æ˜¯è·ŸDevOpsæ··åœ¨ä¸€èµ·ã€‚å¯èƒ½è¦æ›´å¤§çš„å…¬å¸æ‰æœ‰å·®ï¼Ÿ&lt;br /&gt;
ä½†æˆ‘èƒ½åŠ›ä¸è¶³æ²’å»éå¤§å…¬å¸ğŸ˜¢&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;CNCFç°¡æ˜“åˆ†é¡&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/198-fig.1.png&quot; alt=&quot;198-fig.1.png&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/198. SREå¥½æ–‡é€£çµ/" />
        </entry>
        <entry>
            <title>
                197. Grafana ä»¥åŠPrometheus é™¤éŒ¯æ–¹å¼
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/197. Grafana ä»¥åŠPrometheus é™¤éŒ¯æ–¹å¼/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘åœ¨æŸ¥å€‹å•é¡Œï¼Œç„¶å¾Œå°±ç¢°åˆ°grafanaçš„åœ–è¡¨ç”¢ä¸å‡ºä¾†ï¼Œ&lt;br /&gt;
è¦æ’ˆå‡ºæ¯å€‹podç›®å‰çš„è¨˜æ†¶é«”ä½¿ç”¨é‡ç™¾åˆ†æ¯”æ˜¯å¤šå°‘ã€‚&lt;br /&gt;
æ¯å€‹podçš„è¨˜æ†¶é«”ä½¿ç”¨é‡æ˜¯å¤šå€‹ï¼Œä½†ç¸½è¨˜æ†¶é«”åªæœ‰ä¸€å€‹ï¼Œ&lt;br /&gt;
å°±é–‹å§‹æ‰¾å•é¡Œäº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;é€™å€‹åœ–ä¾†è‡ª &lt;a href=&quot;https://www.kawabangga.com/posts/5745&quot; title=&quot;Permalink to Prometheus &amp;amp; Grafana No Data æ’æŸ¥æ‰‹å†Š&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Prometheus &amp;amp; Grafana No Data æ’æŸ¥æ‰‹å†Š&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/197-fig.1.jpeg&quot; alt=&quot;197-fig.1.jpeg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ç›®å‰çš„æ’æŸ¥æ–¹å¼ï¼Œ&lt;br /&gt;
é€šå¸¸éƒ½æ˜¯å…ˆé–‹prometheusï¼Œçœ‹æŒ‡ä»¤æœ‰æ²’æœ‰è³‡æ–™ï¼Œæ²’è³‡æ–™å°±è¡¨ç¤ºå¯«éŒ¯ã€‚&lt;br /&gt;
æœ‰è³‡æ–™ï¼Œåœ¨grafana ç„¡æ³•é¡¯ç¤ºï¼Œé‚£å°±æ˜¯grafanaçš„å•é¡Œã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰ç¢°åˆ°çš„å•é¡Œæ˜¯å–®å€‹queryéƒ½æœ‰è³‡æ–™ï¼Œä½†æ¹Šåœ¨ä¸€èµ·å°±æ²’äº†ã€‚&lt;br /&gt;
å¾Œä¾†æœ‰å•äº†ä¸€ä¸‹GPTï¼Œ&lt;br /&gt;
ç™¼ç¾ç›¸é™¤çš„è©±ï¼Œè¦ç¬¦åˆä¸€äº›æ¢ä»¶ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;åœ¨ Grafana ä¸­é€²è¡ŒæŸ¥è©¢çš„ç›¸é™¤ï¼Œéœ€è¦ç¢ºä¿ä»¥ä¸‹æ¢ä»¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…©å€‹æŸ¥è©¢çš„æ™‚é–“æˆ³åŒ¹é…ï¼š&lt;/strong&gt; ç¢ºä¿å…©å€‹æŸ¥è©¢çš„æ™‚é–“æˆ³æ˜¯å°æ‡‰çš„ã€‚å¦‚æœæ™‚é–“æˆ³ä¸åŒ¹é…ï¼Œå‰‡æŸ¥è©¢çµæœç„¡æ³•æ­£ç¢ºé€²è¡Œç›¸é™¤ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¨™ç±¤åŒ¹é…ï¼š&lt;/strong&gt; ç¢ºä¿å…©å€‹æŸ¥è©¢çš„æ¨™ç±¤åŒ¹é…ã€‚é€™åŒ…æ‹¬æ™‚é–“æˆ³çš„æ¨™ç±¤ï¼Œä»¥åŠåœ¨ä½¿ç”¨ &lt;code&gt;by()&lt;/code&gt; å­å¥é€²è¡Œåˆ†çµ„æ™‚çš„æ¨™ç±¤ã€‚å¦‚æœæ¨™ç±¤ä¸åŒ¹é…ï¼ŒæŸ¥è©¢çµæœå¯èƒ½ç„¡æ³•æ­£ç¢ºåˆä½µã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ &lt;code&gt;ignoring()&lt;/code&gt; æˆ– &lt;code&gt;on()&lt;/code&gt; å­å¥ï¼š&lt;/strong&gt; å¦‚æœæœ‰ä¸€äº›æ¨™ç±¤ä¸éœ€è¦åŒ¹é…ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;ignoring()&lt;/code&gt; æˆ– &lt;code&gt;on()&lt;/code&gt; å­å¥ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-plaintext&quot;&gt;A / ignoring(label_name) B
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ &lt;code&gt;group_left&lt;/code&gt; æˆ– &lt;code&gt;group_right&lt;/code&gt; å­å¥ï¼š&lt;/strong&gt; å¦‚æœéœ€è¦åœ¨æŸ¥è©¢ä¸­ä¿ç•™æŸäº›æ¨™ç±¤ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;group_left&lt;/code&gt; æˆ– &lt;code&gt;group_right&lt;/code&gt; ä»¥ç¢ºä¿é€™äº›æ¨™ç±¤åœ¨åˆä½µæ™‚ä¿æŒä¸€è‡´ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-plaintext&quot;&gt;A / B on(label_name) group_left(label_name)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¢ºä¿æŸ¥è©¢çµæœæ˜¯æ•¸å€¼ï¼š&lt;/strong&gt; ç¢ºä¿å…©å€‹æŸ¥è©¢è¿”å›çš„çµæœæ˜¯æ•¸å€¼ï¼Œä¸¦ä¸”æ”¯æŒç›¸é™¤æ“ä½œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€å€‹ç°¡å–®çš„ä¾‹å­ï¼Œå‡è¨­ä½ æœ‰å…©å€‹æŸ¥è©¢ A å’Œ Bï¼Œè¦è¨ˆç®— A ä¸­æ¯å€‹æ™‚é–“æˆ³çš„å€¼é™¤ä»¥ B ä¸­å°æ‡‰æ™‚é–“æˆ³çš„å€¼ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-plaintext&quot;&gt;A / B
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ ¹æ“šä½ çš„æ•¸æ“šæºå’Œå…·é«”çš„éœ€æ±‚ï¼Œå¯èƒ½éœ€è¦æ ¹æ“šä¸Šè¿°æ¢ä»¶é€²è¡Œèª¿æ•´ã€‚é€™äº›æ¢ä»¶æœ‰åŠ©æ–¼ç¢ºä¿æŸ¥è©¢çµæœçš„æ­£ç¢ºæ€§ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/197. Grafana ä»¥åŠPrometheus é™¤éŒ¯æ–¹å¼/" />
        </entry>
        <entry>
            <title>
                195. SREå¯è§€æ¸¬æ€§ä¸‰å¤§æ”¯æŸ±
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/195. SREå¯è§€æ¸¬æ€§ä¸‰å¤§æ”¯æŸ±/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å»å¹´åº•çœ‹googleçš„ç ”è¨æœƒå°±æœ‰è¬›åˆ°OpenTelemetryï¼Œ&lt;br /&gt;
ä»Šå¤©åˆå‰›å¥½ç¢°åˆ°æœ‰äººåœ¨è¬›é€™å€‹æ±è¥¿ï¼Œ&lt;br /&gt;
æŒ‘å€‹æ™‚é–“æŠŠå®ƒå¼„å‡ºä¾†äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;Logs, Tracing, Metrics&lt;br /&gt;
OpenTelemetry  æ¨å‹•å¯è§€æ¸¬æ€§ä¸‰å¤§æ”¯æŸ±W3Cæ•¸æ“šæ¡é›†çš„æ¨™æº–åŒ–&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/195-fig.1.png&quot; alt=&quot;195-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/195-fig.2.png&quot; alt=&quot;195-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç¯„ä¾‹&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/195-fig.3.png&quot; alt=&quot;195-fig.3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://itplus.ithome.com.tw/vod-page/770&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¾®æœå‹™åœ¨é›²åŸç”Ÿç’°å¢ƒçš„å¯è§€æ¸¬æ€§æ‡‰ç”¨&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/195. SREå¯è§€æ¸¬æ€§ä¸‰å¤§æ”¯æŸ±/" />
        </entry>
        <entry>
            <title>
                184. grafana error  reverse proxy settings on istio
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/184. grafana error  reverse proxy settings on istio/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ¬projectï¼Œå°±æƒ³ä¹¾è„†ä¸Šistioäº†ï¼Œ&lt;br /&gt;
ç„¶å¾Œå°±å¡åˆ°æ€éº¼ä»¥å‰çš„grafanaé–‹çš„èµ·ä¾†ï¼Œç¾åœ¨çš„é–‹ä¸èµ·ä¾†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç…§ä»¥å‰çš„æ–¹å¼è¨­å®šå®Œ root_urlï¼Œ&lt;br /&gt;
é‚„æ˜¯å‡ºç¾ç›¸åŒéŒ¯èª¤&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/184-fig.1.jpg&quot; alt=&quot;184-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥æ–‡ä»¶å¾Œæ‰ç™¼ç¾ï¼Œ&lt;br /&gt;
æ‡‰è©²æ˜¯æ–°ç‰ˆ(9.5.5)éœ€è¦åŠ ä¸Š&lt;code&gt;serve_from_sub_path&lt;/code&gt;çš„åƒæ•¸ï¼Œ&lt;br /&gt;
å¦‚æœç¢°åˆ°åªåŠ äº†root_urlä¹Ÿæ˜¯çœ‹åˆ°éŒ¯èª¤ï¼Œå°±å†åŠ å€‹åƒæ•¸å§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;grafana.ini&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[server]
root_url = &amp;quot;http://&amp;lt;ip&amp;gt;/grafana/&amp;quot;
serve_from_sub_path = true
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;virtualservice.yaml&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: istio-virtualservice
  namespace: istio-system
spec:
  hosts:
  - &amp;quot;&amp;lt;ip&amp;gt;&amp;quot;
  gateways:
    - istio-system/istio-gateway
  http: 
  - name: &amp;quot;grafana&amp;quot;
    match:
      - uri:
          prefix: /grafana/
      - uri:
          exact: /grafana
    route:
      - destination:
          port:
            number: 3000
          host:  grafana.istio-system.svc.cluster.local  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://grafana.com/tutorials/run-grafana-behind-a-proxy/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Run Grafana behind a reverse proxy&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/184. grafana error  reverse proxy settings on istio/" />
        </entry>
        <entry>
            <title>
                179.  install Bindplane
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/179.  install Bindplane/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘çœ‹å®Œ2023 Google  Cloud summit ï¼Œ&lt;br /&gt;
çœ‹åˆ°ä¸€å€‹æ–°æ±è¥¿ï¼ŒOpenTelemetryï¼Œå¯ä»¥ä¸ç”¨åŸ‹ç¨‹å¼ç”¨sidecarçš„æ–¹å¼ï¼Œ&lt;br /&gt;
å°±èƒ½åšåˆ°Observabilityçš„traceï¼Œ&lt;br /&gt;
ä¸€é–‹å§‹å®‰è£OpenTelemetryï¼Œå¾Œä¾†ç™¼ç¾ï¼Œ&lt;br /&gt;
ä»–å¥½è‚¥ï¼ˆæ¸¬è©¦clusterç©ºé–“ä¸è¶³ï¼‰ï¼Œä¹‹å¾Œé‚„æéŒ¯äº†ä¸€ä»¶äº‹æƒ…ã€‚&lt;br /&gt;
å¾Œä¾†æ”¹æ¸¬è©¦Bindplaneã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;what-is-bindplane&quot; tabindex=&quot;-1&quot;&gt;What is Bindplane?&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Bindplane is an open source solution utilizing the OpAMP protocol to configure, monitor, and deploy various collectors.&lt;br /&gt;
Bindplane æ˜¯ä¸€å€‹é–‹æºè§£æ±ºæ–¹æ¡ˆï¼Œåˆ©ç”¨ OpAMP å”å®šä¾†è¨­å®šã€ç›£æ§å’Œéƒ¨ç½²å„ç¨®æ”¶é›†å™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»–æ˜¯ä¸€å€‹ç›£æ§è·Ÿlogçš„æ”¶é›†å™¨ï¼Œä»–ä¸¦ä¸æ˜¯åƒefkæˆ–google cloudé‚£æ¨£çš„æ±è¥¿ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://isitobservable.io/open-telemetry/what-is-bindplane-and-what-does-it-do&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;What is OpAMP? And what is Bindplane?&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;å®‰è£&quot; tabindex=&quot;-1&quot;&gt;å®‰è£&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Helm add source&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-ssh&quot;&gt;helm repo add &amp;quot;bindplane&amp;quot; &#92; &amp;quot;https://observiq.github.io/bindplane-op-helm&amp;quot;
helm repo update
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å»ºç«‹çµ„æ…‹ values.yaml&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;config:
  username: &amp;quot;admin&amp;quot;
  password: &amp;quot;admin&amp;quot;
  secret_key: &amp;quot;13c15d7c-233e-49e3-bef4-f7498f33518f&amp;quot;
  sessions_secret: &amp;quot;a4e5aa85-5df4-4edd-8cfe-d8a7257d09dd&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/observIQ/bindplane-op-helm/tree/main/charts/bindplane&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®Œæ•´è¨­å®šåƒæ•¸&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;å®‰è£&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;helm upgrade --install &amp;quot;bindplane&amp;quot; &#92;
  --values &amp;quot;values.yaml&amp;quot; &#92;
  --namespace bindplane &#92;
  --create-namespace &#92;
  bindplane/bindplane
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://docs.bindplane.observiq.com/docs/kubernetes-deploy-bindplane-op-server&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Deploy BindPlane OP Server on K8s&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;è¨­å®š&quot; tabindex=&quot;-1&quot;&gt;è¨­å®š&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;è¨­å®šport forwardè½‰éå»æœå‹™ä¸Š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;kubectl port-forward -n bindplane svc/bindplane 3001
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/179.  install Bindplane/" />
        </entry>
        <entry>
            <title>
                178. Install Prometheus Operator
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/178. Install Prometheus Operator/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘çœ‹å®Œ2023 Google  Cloud summit ï¼Œ&lt;br /&gt;
çœ‹åˆ°ä¸€å€‹æ–°æ±è¥¿ï¼ŒOpenTelemetryï¼Œå¯ä»¥ä¸ç”¨åŸ‹ç¨‹å¼ç”¨sidecarçš„æ–¹å¼ï¼Œ&lt;br /&gt;
å°±èƒ½åšåˆ°Observabilityçš„traceï¼Œ&lt;br /&gt;
ä½†åœ¨é‚£ä¹‹å‰ï¼Œæˆ‘è¦å…ˆåœ¨æ¸¬è©¦å¢é›†è£ä¸€ä¸‹Prometheus Operatorï¼Œ&lt;br /&gt;
ä¸ç„¶è³‡æ–™å‚³ä¸éå»ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;git clone&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;git clone https://github.com/prometheus-operator/kube-prometheus
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;install&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;kubectl apply --server-side -f manifests/setup
kubectl wait &#92;
	--for condition=Established &#92;
	--all CustomResourceDefinition &#92;
	--namespace=monitoring
kubectl apply -f manifests/
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;åˆªé™¤&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl delete --ignore-not-found=true -f manifests/ -f manifests/setup
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸éé€™å€‹å®‰è£æ–¹å¼ï¼ŒæœƒåŒ…å«&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;TheÂ &lt;a href=&quot;https://github.com/prometheus-operator/prometheus-operator&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Prometheus Operator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Highly availableÂ &lt;a href=&quot;https://prometheus.io/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Prometheus&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Highly availableÂ &lt;a href=&quot;https://github.com/prometheus/alertmanager&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Alertmanager&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/prometheus/node_exporter&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Prometheus node-exporter&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/kubernetes-sigs/prometheus-adapter&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Prometheus Adapter for Kubernetes Metrics APIs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/kubernetes/kube-state-metrics&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kube-state-metrics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://grafana.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Grafana&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è‡ªå®šå®‰è£çš„è©±ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨helm&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm repo update
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è‡ªè¨‚å®‰è£,&lt;a href=&quot;https://github.com/prometheus-community/helm-charts/blob/main/charts/kube-prometheus-stack/values.yaml&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è¨­å®šåƒè€ƒ&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;helm install test prometheus-community/kube-prometheus-stack --namespace monitoring --create-namespace --values values.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/178-fig.1.jpg&quot; alt=&quot;178-fig.1.jpg&quot; /&gt;&lt;br /&gt;
ä¸Šé¢æŒ‡ä»¤ä½¿ç”¨testç•¶é—œéµå­—ï¼Œæ‰€ä»¥éƒ¨ç½²æ™‚ä¹Ÿæœƒåœ¨ä¸Šé¢å¢åŠ &lt;/p&gt;
&lt;h1 id=&quot;è£œå……&quot; tabindex=&quot;-1&quot;&gt;è£œå……&lt;/h1&gt;
&lt;p&gt;å¦‚æœä¸æƒ³è‡ªå·±æ¶Prometheusï¼Œä¹Ÿä¸æƒ³ç”¨Google Cloud Monitorï¼Œ&lt;br /&gt;
å¯ä»¥è€ƒæ…®Googleè‡ªå·±å‡ºçš„ &lt;a href=&quot;https://cloud.google.com/stackdriver/docs/managed-prometheus?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Google Managed Prometheus å®˜æ–¹æ–‡ä»¶&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/prometheus-operator/kube-prometheus&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Github- kube-prometheus&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.amis.com/kubernetes-operators-prometheus-3584edd72275&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Helmå®‰è£ Prometheus Operator â€” ç‚º Kubernetes è¨­å®šåŠç®¡ç† Prometheus&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/%E8%BC%95%E9%AC%86%E5%B0%8F%E5%93%81-pks%E8%88%87k8s%E7%9A%84%E9%BB%9E%E6%BB%B4/google-managed-prometheus-gmp-522a25572e35&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Google Managed Prometheus (GMP)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/178. Install Prometheus Operator/" />
        </entry>
        <entry>
            <title>
                131. rabbitMQ on Prometheus
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/131. rabbitMQ on Prometheus/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘demoç’°å¢ƒç™¼ç”Ÿå•é¡Œï¼Œåˆæ­¥æ‡·ç–‘æ˜¯MQå› ç‚ºè¨Šæ¯é‡å¤ªå¤§æ›äº†ã€‚&lt;br /&gt;
ä½†æ²’æœ‰è­‰æ“šï¼Œå› ç‚ºMQçš„ç®¡ç†ä»‹é¢åªèƒ½çœ‹åˆ°ä¸€å°æ™‚çš„è³‡æ–™ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æœ¬ä¾†ç”¨operatorå®‰è£å®Œå¾Œï¼Œçœ‹äº†ä¸€äº›ä»‹ç´¹éƒ½èªªè¦é¡å¤–å•“å‹•å¤–æ›ï¼Œ&lt;br /&gt;
ä½†operatorè¦æ€éº¼å•“å‹•å¤–æ›ï¼Œæˆ‘å°±å…©çœ¼ä¸€æŠ¹é»‘äº†ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹åˆ° &lt;a href=&quot;https://blog.csdn.net/yaomingyang/article/details/104037083&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;RabbitMQå­¸ç¿’ç­†è¨˜ï¼šå…§å»ºPrometheusæ”¯æ´rabbit_prometheuså¤–æ›&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åŸä¾†ï¼Œæˆ‘çš„MQçš„15692 port å·²ç¶“é–‹äº†ï¼Œprometheuså·²ç¶“è¨­å®šå¥½ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/131-fig.1.jpg&quot; alt=&quot;131-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç”¨curlå»æŠ“è³‡æ–™ä¹Ÿæœ‰metricsï¼Œçœ‹ä¾†æ²’å•é¡Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;æƒ³èªªå¯ä»¥çµæ¡ˆäº†ï¼Œä½†æ˜¯ï¼ˆå°±æ€•é€™å€‹ä½†æ˜¯ï¼‰ï¼Œè£é¢æ²’æœ‰queueçš„è³‡æ–™ï¼Œ&lt;br /&gt;
æ‰€ä»¥çœ‹ä¸åˆ°æ¯å€‹queueçš„message rate&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/131-fig.2.jpg&quot; alt=&quot;131-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ’ˆäº†ç›¸é—œçš„metricè£é¢ä¹Ÿæ²’æœ‰Queueçš„åç¨±ï¼Œå¯ä¾›filter&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/rabbitmq/rabbitmq-prometheus/blob/master/metrics.md&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;metricsèªªæ˜&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼ŒrabitMQ on k8så»ºå¥½å¾Œï¼Œåªè¦åœ¨prometheuså¯«å€‹jobå°±èƒ½å»æ’ˆè³‡æ–™äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; - job_name: &#39;rabbitmq&#39;
   scrape_interval: 30s
   static_configs:
     - targets:
       - &#39;prod-rabbitmq.rabbitmq-system.svc.cluster.local:15692&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;prod-rabbitmq&lt;/code&gt; æŒ‡çš„æ˜¯service name.&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œï¼Œgrafana dashboardå¯ä»¥ç”¨ &lt;a href=&quot;https://grafana.com/grafana/dashboards/10991-rabbitmq-overview/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;# RabbitMQ-Overview&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/131-fig.3.png&quot; alt=&quot;131-fig.3.png&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/131. rabbitMQ on Prometheus/" />
        </entry>
        <entry>
            <title>
                124. grafana alertæ¯å››å°æ™‚é‡ç™¼ä¸€æ¬¡
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/124. grafana alertæ¯å››å°æ™‚é‡ç™¼ä¸€æ¬¡/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;æ–°çš„Grafana alert manage ï¼Œå¯èª¿æ•´çš„åœ°æ–¹é‚„çœŸå¤šé˜¿..&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å‘Šè­¦ä¸Šç·šå¾Œï¼Œåªè¦å‘Šè­¦ç‹€æ…‹æ²’è§£é™¤çš„è©±ï¼Œä»–æ¯4å°æ™‚æœƒé‡ç™¼ä¸€æ¬¡ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/124-fig.1.jpg&quot; alt=&quot;124-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åˆ° Alerting çš„ Notification policies ï¼Œè¨­å®šRoot policy&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/124-fig.2.jpg&quot; alt=&quot;124-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å±•é–‹ Timing optionsï¼Œè¨­å®š Repeat interval&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/124-fig.3.jpg&quot; alt=&quot;124-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref&lt;br /&gt;
- &lt;a href=&quot;https://community.grafana.com/t/unified-alerting-alert-triggers-every-4-hours/55053&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Unified Alerting: alert triggers every 4 hours&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/124. grafana alertæ¯å››å°æ™‚é‡ç™¼ä¸€æ¬¡/" />
        </entry>
        <entry>
            <title>
                122. Grafana 8.Xä»¥å¾Œçš„alert åƒæ•¸
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/122. Grafana 8.Xä»¥å¾Œçš„alert åƒæ•¸/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æ–°ç‰ˆçš„Grafanaæ›äº†alert ,&lt;br /&gt;
ç¾åœ¨æŠŠalerté€šé€šæ•´åˆåœ¨ä¸€èµ·äº†ï¼Œ&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œæˆ‘ä»¥å‰ç”¨çš„å‚³åƒæ•¸æ–¹æ³•ä¸èƒ½ç”¨äº†ï¼Œ&lt;br /&gt;
æœ€è¿‘éƒ½åœ¨æ¸¬è©¦é€™å€‹æ±è¥¿&lt;/p&gt;
&lt;h2 id=&quot;print-labels&quot; tabindex=&quot;-1&quot;&gt;Print Labels&lt;/h2&gt;
&lt;p&gt;å¦‚æœåœ¨summaryä¸Šé¢å¯«&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/122-fig.1.jpg&quot; alt=&quot;122-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æœƒå°å‡ºæ­¤alertä¸Šé¢çš„é è¨­labelsæ¨™ç±¤ï¼Œ&lt;/p&gt;
&lt;p&gt;ä¸‹åœ–ï¼Œæ˜¯æˆ‘è‡ªè¨‚çš„æ¨™ç±¤&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/122-fig.2.jpg&quot; alt=&quot;122-fig.2.jpg&quot; /&gt;&lt;br /&gt;
ä½†å¯¦éš›å°å‡ºä¾†çš„éƒ½æ²’æœ‰å‡ºç¾&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/122-fig.3.jpg&quot; alt=&quot;122-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é™£åˆ—å°å‡ºä¾†å¾Œï¼Œå°±èƒ½å¤ æŒ‡å®šåç¨±é¡¯ç¤ºäº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/122-fig.4.jpg&quot; alt=&quot;122-fig.4.jpg&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;print-value&quot; tabindex=&quot;-1&quot;&gt;Print Value&lt;/h2&gt;
&lt;p&gt;é€™æ¬¡æ”¹ä½¿ç”¨é€™å€‹åƒæ•¸&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœƒé¡¯ç¤º ä¸‰å€‹å€¼ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/122-fig.5.jpg&quot; alt=&quot;122-fig.5.jpg&quot; /&gt;&lt;br /&gt;
è¨­å®šæ‰€ç”¨çš„æ¢ä»¶æœ‰å…©å€‹ï¼Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%91%81%20Observability/122-fig.6.jpg&quot; alt=&quot;122-fig.6.jpg&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h2&gt;
&lt;p&gt;åŸºæœ¬ä½¿ç”¨è®Šæ•¸çš„æ–¹æ³•ï¼Œ&lt;br /&gt;
å¦‚æœè¦é€²éšé»ï¼Œå¯èƒ½å°±éœ€è¦æ”¹ç”¨alert templateäº†ã€‚&lt;/p&gt;
&lt;p&gt;alert templateåƒè€ƒä¸‹é¢ç¶²å€&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://community.grafana.com/t/how-to-use-alert-message-templates-in-grafana/67537&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How To Use Alert Message Templates in Grafana&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://grafana.com/docs/grafana/latest/alerting/manage-notifications/create-message-template/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Create and edit message templates&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;åƒè€ƒä¾†æº&quot; tabindex=&quot;-1&quot;&gt;åƒè€ƒä¾†æº&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://grafana.com/docs/grafana/latest/alerting/fundamentals/annotation-label/variables-label-annotation/#templating-labels-and-annotations&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Templating labels and annotations&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://grafana.com/docs/grafana/latest/alerting/fundamentals/annotation-label/how-to-use-labels/#grafana-reserved-labels&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Labels in Grafana Alerting&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/122. Grafana 8.Xä»¥å¾Œçš„alert åƒæ•¸/" />
        </entry>
        <entry>
            <title>
                0.Observability MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ‘ Observability/0.Observability MOC/</id>
            <content type="html">
                &lt;h1 id=&quot;æ¦‚å¿µ&quot; tabindex=&quot;-1&quot;&gt;æ¦‚å¿µ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;blog.45.ç¶²ç«™æ•ˆèƒ½æŒ‡æ¨™ä¸€è¦½ï¼ˆæœªï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;96. SREç›£æ§çš„å››å¤§æŒ‡æ¨™åŠSLIã€SLOã€SLA&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/195.%20SRE%E5%8F%AF%E8%A7%80%E6%B8%AC%E6%80%A7%E4%B8%89%E5%A4%A7%E6%94%AF%E6%9F%B1/&quot;&gt;195. SREå¯è§€æ¸¬æ€§ä¸‰å¤§æ”¯æŸ±&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/198.%20SRE%E5%A5%BD%E6%96%87%E9%80%A3%E7%B5%90/&quot;&gt;198. SREå¥½æ–‡é€£çµ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;grafana&quot; tabindex=&quot;-1&quot;&gt;Grafana&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/24.grafana%E8%A8%AD%E8%A8%88%E7%AF%87-%E7%AC%AC%E4%BA%8C%E5%80%8BY%E8%BB%B8/&quot;&gt;24.grafanaè¨­è¨ˆç¯‡-ç¬¬äºŒå€‹Yè»¸&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/25.%E5%9C%A8GKE%E4%B8%8A%E7%9A%84grafana%E4%B8%8A%E5%AE%89%E8%A3%9Dgrafana-image-renderer/&quot;&gt;25.åœ¨GKEä¸Šçš„grafanaä¸Šå®‰è£grafana-image-renderer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/26.grafana%20alert%20message%20parameters%E5%82%B3%E5%85%A5/&quot;&gt;26.grafana alert message parameterså‚³å…¥&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/28.Prometheus%E7%9A%84%E5%B0%88%E7%94%A8%E8%AA%9E%E8%A8%80promQL/&quot;&gt;28.Prometheusçš„å°ˆç”¨èªè¨€promQL&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/122.%20Grafana%208.X%E4%BB%A5%E5%BE%8C%E7%9A%84alert%20%E5%8F%83%E6%95%B8/&quot;&gt;122. Grafana 8.Xä»¥å¾Œçš„alert åƒæ•¸&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/124.%20grafana%20alert%E6%AF%8F%E5%9B%9B%E5%B0%8F%E6%99%82%E9%87%8D%E7%99%BC%E4%B8%80%E6%AC%A1/&quot;&gt;124. grafana alertæ¯å››å°æ™‚é‡ç™¼ä¸€æ¬¡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/184.%20grafana%20error%20%20reverse%20proxy%20settings%20on%20istio/&quot;&gt;184. grafana error  reverse proxy settings on istio&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/197.%20Grafana%20%E4%BB%A5%E5%8F%8APrometheus%20%E9%99%A4%E9%8C%AF%E6%96%B9%E5%BC%8F/&quot;&gt;197. Grafana ä»¥åŠPrometheus é™¤éŒ¯æ–¹å¼&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;prometheus&quot; tabindex=&quot;-1&quot;&gt;Prometheus&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/131.%20rabbitMQ%20on%20Prometheus/&quot;&gt;131. rabbitMQ on Prometheus&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/178.%20Install%20Prometheus%20Operator/&quot;&gt;178. Install Prometheus Operator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/179.%20%20install%20Bindplane/&quot;&gt;179.  install Bindplane&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ‘ Observability/0.Observability MOC/" />
        </entry>
        <entry>
            <title>
                32. nuxtJS çš„ Dockerfile
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ³ Container/32. nuxtJS çš„ Dockerfile/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;åˆå¤šäº†ä¸€å€‹æ–°çš„å¥—ä»¶è¦åšï¼Œé€™æ¬¡ç”¨çš„æ˜¯nuxt.js ï¼ŒåªçŸ¥é“æ˜¯vue.jså»¶ä¼¸å‡ºä¾†çš„æ±è¥¿...&lt;br /&gt;
ç„¶å¾Œï¼Œä¸Šå§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å›  nuxt.js ï¼Œè·Ÿgoæœ‰é»åƒéƒ½æœƒè‡ªå·±å•Ÿå‹•ä¸€å€‹ä¼ºæœå™¨çš„æœå‹™ï¼Œ&lt;br /&gt;
èµ°çš„æ˜¯SSRï¼ˆServer-Side Renderingï¼‰ï¼Œ&lt;br /&gt;
ä¸æ˜¯å¡ç‰ŒéŠæˆ²çš„SSRé˜¿ã€‚&lt;br /&gt;
SSRçš„æ„æ€æ˜¯ï¼Œé é¢ç”±å¾Œç«¯æ¸²æŸ“ï¼ŒHTMLç”±å¾Œç«¯ç”¢ç”Ÿï¼ˆæ“šèªªæ˜¯è¦è®“é€Ÿåº¦æ¯”è¼ƒå¿«ï¼‰&lt;br /&gt;
ref.&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10202217&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;02. è¬›æ­·å²ï¼Œè©±èªª SSR...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å› ç‚ºnuxt.jsæœƒè‡ªå·±å»ºç«‹ä¸€å€‹jsï¼Œ&lt;br /&gt;
æ‰€ä»¥æœ‰è¸©åˆ°ä¸€å€‹å‘ï¼Œ&lt;br /&gt;
åœ¨è¨­å®š nuxt.config.jsçš„æ™‚å€™ï¼Œ&lt;br /&gt;
è«‹ç¢ºèªå¥½port ä»¥åŠ æ˜¯ä¸æ˜¯é–‹äº†https ã€‚&lt;br /&gt;
å»ºè­°å…ˆæŸ¥ä¸€ä¸‹ nuxt.config.js çš„å…§å®¹å±¬æ€§ï¼Œå†ä¾†æ‰“åŒ…åŠä½ˆç½²ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10207002&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;16. Nuxt å…¨åŸŸè¨­å®šæª” (nuxt.config.js)ï¼Œå¯ä»¥åƒå—ï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é€™æ˜¯ç¬¬ä¸€å€‹ç‰ˆæœ¬ï¼Œä½¿ç”¨npmç·¨è­¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FROM node:11.13.0
COPY . /usr/src/nuxt-app/

RUN npm install
RUN npm run build:qa

EXPOSE 80

ENV NUXT_HOST=0.0.0.0
ENV NUXT_PORT=80

CMD [ &amp;quot;npm&amp;quot;, &amp;quot;start&amp;quot; ]

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¬¬äºŒå€‹ç‰ˆæœ¬ï¼Œæ”¹ä½¿ç”¨yarnå®‰è£ï¼Œé€™é‚Šè¦æ³¨æ„ï¼Œnodeç‰ˆæœ¬ï¼Œè«‹æŠ“æœ€æ–°çš„ï¼Œä¸ç„¶ç·¨è­¯çš„æ™‚å€™æœƒå‡ºç¾pythonéŒ¯èª¤ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  FROM node:16.3.0-alpine
  WORKDIR /usr/src/app

  COPY . .
  RUN yarn install &amp;amp;&amp;amp; yarn cache clean
  RUN yarn build
  CMD [ &amp;quot;yarn&amp;quot;, &amp;quot;start&amp;quot; ]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šåªå¯« yarn build ï¼Œæ˜¯å› ç‚ºåœ¨è¨­å®šnuxtçš„æ™‚å€™ï¼Œæœ‰å¯« build:qa è·Ÿ buildã€‚&lt;br /&gt;
å› ç‚ºæ˜¯æœ€å¾Œæ¸¬è©¦å®Œçš„æˆæœäº†ï¼Œå°±æ”¹ç”¨yarn build ï¼ŒåšçµæŸã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://twblog.hongjianching.com/2020/06/14/yarn-install-lock-version-by-yarn.lock/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨ yarn install æŒ‡ä»¤å®‰è£å¥—ä»¶æ™‚é–å®š yarn.lock ç‰ˆæœ¬&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://hub.docker.com/_/node?tab=description&amp;amp;page=1&amp;amp;ordering=last_updated&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;docker-hub node&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ³ Container/32. nuxtJS çš„ Dockerfile/" />
        </entry>
        <entry>
            <title>
                29.Dockerfile echo something
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ³ Container/29.Dockerfile echo something/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;åœ¨å¹«äººå¯«è‡ªå‹•ä½ˆç½²çš„æ™‚å€™ï¼Œç™¼ç¾ä»¥å¾€çš„Dockeræœƒé¡¯ç¤ºç•«é¢ä¸Šçš„æŒ‡ä»¤ï¼Œ&lt;br /&gt;
é€™æ¬¡éƒ½æ²’æœ‰å‡ºä¾†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;è§£æ±ºæ–¹æ¡ˆï¼ŒåŠ ä¸Š --progress=plain&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  docker build --progress=plain -t ey:0.1 .
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœæ²’æœ‰åŠ çš„è©±ï¼Œæœƒåƒ (fig.1)ï¼Œæœ‰åŠ çš„è©±ï¼Œå‰‡æœƒåƒ(fig.2)ï¼Œå°‡è¢å¹•ä¸Šçš„è³‡æ–™é¡¯ç¤ºå‡ºä¾†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  FROM gcr.io/cloud-builders/yarn:node-8.12.0 as build-env
  WORKDIR /app

  COPY . .
  RUN pwd
  RUN ls
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(fig.1)&lt;/p&gt;
&lt;p&gt;(fig.2)&lt;/p&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://stackoverflow.com/questions/64804749/docker-build-not-showing-any-output-from-commands&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Docker build not showing any output from commands&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ³ Container/29.Dockerfile echo something/" />
        </entry>
        <entry>
            <title>
                170. Dockerå•“ç”¨GPU
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ³ Container/170. Dockerå•“ç”¨GPU/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å”¸&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å”¸&lt;/h1&gt;
&lt;p&gt;ä¸Šé¢&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%B3%20Container/168.%20Docker%20build%E5%A4%B1%E6%95%97%E8%B7%B3%E5%87%BAkilled/&quot;&gt;168. Docker buildå¤±æ•—è·³å‡ºkilled&lt;/a&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8C%90%20Network/169.%20Nginx%E7%9A%84%E8%B2%A0%E8%BC%89%E5%B9%B3%E8%A1%A1/&quot;&gt;169. Nginxçš„è² è¼‰å¹³è¡¡&lt;/a&gt;ï¼Œ&lt;br /&gt;
é€™å…©ç¯‡éƒ½æ˜¯ç‚ºäº†è¦é”åˆ°å…§éƒ¨AIå¹³è‡ºå†ç”¨ï¼Œ&lt;br /&gt;
ä¸è¦è®“æ¯å€‹äººçš„é›»è…¦éƒ½è‡ªå·±è£ä¸€å †ç¨‹å¼ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;é›»è…¦è£å®Œé¡¯å¡é©…å‹•å¾Œï¼Œè¦è®“dockerè­˜åˆ¥ï¼Œ&lt;br /&gt;
é‚„éœ€è¦é¡å¤–è£  &lt;a href=&quot;https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;NVIDIA Container Toolkit&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç…§è‘—å®˜æ–¹æ–‡ä»¶ä¾†ï¼ŒæŒºå¿«çš„ã€‚&lt;/p&gt;
&lt;p&gt;é€™é‚Šè¨˜éŒ„ubuntuçš„æ–¹æ³•ï¼Œå…¶ä»–çš„å®‰è£æ–¹å¼ï¼Œè«‹åƒè€ƒä¸Šé¢æ–‡ä»¶&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ›´æ–°&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg &#92;
  &amp;amp;&amp;amp; curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | &#92;
    sed &#39;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g&#39; | &#92;
    sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list &#92;
  &amp;amp;&amp;amp; &#92;
    sudo apt-get update
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å®‰è£&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sudo apt-get install -y nvidia-container-toolkit
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;dockerè¨­å®š ï¼ˆcontainerdã€CRI-Oçš„è©±ï¼Œåƒè€ƒä¸Šé¢é€£çµï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sudo nvidia-ctk runtime configure --runtime=docker
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;é‡å•“&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sudo systemctl restart containerd
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;é©—è­‰&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sudo docker run --rm --runtime=nvidia --gpus all ubuntu nvidia-smi
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é¡¯ç¤ºä¸‹é¢çš„è³‡æ–™å°±è¡¨ç¤ºæœ‰äº†ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/170-fig.1.jpg&quot; alt=&quot;170-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;docker-compose&quot; tabindex=&quot;-1&quot;&gt;Docker-compose&lt;/h2&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨docker composeçš„è©±ï¼Œ&lt;br /&gt;
é ˆåœ¨yamlä¸Šé¢å¢åŠ ä¸€äº›è¨­å®šï¼Œcommand åˆ° capabilities&lt;br /&gt;
ç•¶ç„¶ä¹Ÿå¯ä»¥æŒ‡å®šæ­¤containerè¦åƒç¬¬å¹¾å€‹gpuï¼Œ&lt;br /&gt;
æ›´è©³ç´°èªªæ˜è«‹åƒè€ƒ&lt;a href=&quot;https://docs.docker.com/compose/gpu-support/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Turn on GPU access with Docker Compose&lt;/a&gt;&lt;br /&gt;
æç¤ºï¼šä¸»è¦åœ¨countçš„è¨­å®š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;version: &#39;3.8&#39;
services:
  python-1:
    container_name: yolox-brand-1
    image: busybox
    command: nvidia-smi
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
    pull_policy: if_not_present
    restart: always
    networks:
      - internal
networks:
  internal:
    name: internal
    driver: bridge
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ³ Container/170. Dockerå•“ç”¨GPU/" />
        </entry>
        <entry>
            <title>
                168. Docker buildå¤±æ•—è·³å‡ºkilled
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ³ Container/168. Docker buildå¤±æ•—è·³å‡ºkilled/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å”¸&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å”¸&lt;/h1&gt;
&lt;p&gt;å…§éƒ¨è¦æä¸€å€‹AIçš„é–‹ç™¼å¹³è‡ºï¼Œ&lt;br /&gt;
æ‰€ä»¥æˆ‘è² è²¬pythonçš„è² è¼‰å¹³è¡¡æ¶æ§‹ï¼Œ&lt;br /&gt;
å› çˆ²ä»–çš„ç¨‹å¼é–‹ç™¼å¥½åƒæœ‰é»å›°é›£ï¼Œå°±ç”¨nginxçš„LBä¾†åšäº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;é©—è­‰&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8C%90%20Network/169.%20Nginx%E7%9A%84%E8%B2%A0%E8%BC%89%E5%B9%B3%E8%A1%A1/&quot;&gt;169. Nginxçš„è² è¼‰å¹³è¡¡&lt;/a&gt;æ™‚ï¼Œéœ€è¦è®“ç¯„ä¾‹ç¨‹å¼é¡¯ç¤ºä¸€ä¸‹è«‹æ±‚çš„è³‡è¨Šï¼Œ&lt;br /&gt;
ç¢ºèªçœŸçš„æœ‰åšåˆ°é€™å¡Šã€‚&lt;/p&gt;
&lt;p&gt;æ‰“åŒ…ä»¥å‰çš„èˆŠAIç¨‹å¼æ™‚å°±æš´æ‰äº†ï¼Œ&lt;br /&gt;
å‡ºç¾ killedçš„errorã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; [6/8] RUN pip3 install torch torchvision torchaudio --index-url [https://download.pytorch.org/whl/cpu](https://download.pytorch.org/whl/cpu &amp;quot;https://download.pytorch.org/whl/cpu&amp;quot;):

1.293 Looking in indexes: [https://download.pytorch.org/whl/cpu](https://download.pytorch.org/whl/cpu &amp;quot;https://download.pytorch.org/whl/cpu&amp;quot;) 2.901 Collecting torch 2.917 Downloading [https://download.pytorch.org/whl/cpu/torch-2.0.1%2Bcpu-cp38-cp38-linux_x86_64.whl](https://download.pytorch.org/whl/cpu/torch-2.0.1%2Bcpu-cp38-cp38-linux_x86_64.whl &amp;quot;https://download.pytorch.org/whl/cpu/torch-2.0.1%2Bcpu-cp38-cp38-linux_x86_64.whl&amp;quot;) (195.4 MB) 11.30 Killed ------ Dockerfile:25 -------------------- 23 | RUN apt-get update &amp;amp;&amp;amp; apt-get install -y enchant &amp;amp;&amp;amp; apt-get install -y python3.7 python3-pip libgl1 &amp;amp;&amp;amp; apt-get clean &amp;amp;&amp;amp; rm -rf /var/lib/apt/lists/* 24 | RUN pip3 install --upgrade pip 25 | &amp;gt;&amp;gt;&amp;gt; RUN pip3 install torch torchvision torchaudio --index-url [https://download.pytorch.org/whl/cpu](https://download.pytorch.org/whl/cpu &amp;quot;https://download.pytorch.org/whl/cpu&amp;quot;) 26 | RUN pip3 install paddlepaddle==2.4.2 -i [https://mirror.baidu.com/pypi/simple](https://mirror.baidu.com/pypi/simple &amp;quot;https://mirror.baidu.com/pypi/simple&amp;quot;) 27 | RUN pip3 install --no-cache-dir -r requirements.txt -------------------- ERROR: failed to solve: process &amp;quot;/bin/sh -c pip3 install torch torchvision torchaudio --index-url [https://download.pytorch.org/whl/cpu](https://download.pytorch.org/whl/cpu &amp;quot;https://download.pytorch.org/whl/cpu&amp;quot;)&amp;quot; did not complete successfully: exit code: 137
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŸ¥äº†ä¸€ä¸‹ï¼Œèªªæ˜¯å› çˆ²è¨˜æ†¶é«”ä¸è¶³å°è‡´docker buildçš„æ™‚å€™æš´æ‰ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://github.com/pytorch/pytorch/issues/6935&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;PyTorch Docker build error&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;`Killed`Â means that the compiler was killed by the kernel because it used too much memory. There are a few workarounds:

- increase the memory limit for docker container
- limit the number of concurrent builds by changing theÂ `Dockerfile`Â to includeÂ `MAX_JOBS=1`Â [here](https://github.com/pytorch/pytorch/blob/master/docker/pytorch/Dockerfile#L30)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŠŠæˆ‘çš„docker resource çš„è¨˜æ†¶é«”è³‡æºåŠ å¤§å¾Œå°±å¥½äº†ï¼ˆæˆ‘macè¨˜æ†¶é«”åªæœ‰16G)ã€‚&lt;/p&gt;
&lt;p&gt;[[168-fig.1.jpg]]&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ³ Container/168. Docker buildå¤±æ•—è·³å‡ºkilled/" />
        </entry>
        <entry>
            <title>
                157. Docker NGINX-Certbot è‡ªå‹•è·ŸLet&#39;sEncrytpå–å¾—æ†‘è­‰
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ³ Container/157. Docker NGINX-Certbot è‡ªå‹•è·ŸLet&#39;sEncrytpå–å¾—æ†‘è­‰/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;å‰äººå¾ˆå¼·ï¼Œå¾ˆå²å®³ï¼Œå–œæ­¡è‡ªå·±å‹•æ‰‹ï¼Œ&lt;br /&gt;
æ‰€ä»¥ä»–ç•¶åˆé€ çš„è‡ªå‹•å–å¾—Let&#39;s Encryptçš„ç¨‹å¼ï¼Œéƒ½æ˜¯è‡ªå·±å¯«ä¸€æ•´å¥—ä¾†ç”¨ã€‚&lt;br /&gt;
ç„¶å¾Œï¼Œäº¤æ¥äº†æ•´å¥—ï¼Œä½†ç¨‹å¼æ²’äººçŸ¥é“åœ¨å¹¹å˜›ï¼Œåªæœ‰æ¯æ¬¡å‡ºå•é¡Œæ™‚ï¼Œ&lt;br /&gt;
æœƒå»ç¿»APIçœ‹æ˜¯è¦å…ˆcallå“ªå€‹ï¼Œå†callå“ªå€‹ï¼Œç„¶å¾Œå†é‡é–‹æŸäº›image&lt;br /&gt;
æ‰èƒ½æ­£ç¢ºå–å¾—ï¼Œèº«çˆ²ä¸€å€‹æ‡¶äººï¼Œè·Ÿè…¦ç´°èƒå®¹é‡éå°çš„æˆ‘ï¼Œå¯¦åœ¨è¨˜ä¸ä½é˜¿ï¼Œ&lt;br /&gt;
åªå¥½æ”¹äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h2 id=&quot;docker-k8s-cert-manage&quot; tabindex=&quot;-1&quot;&gt;é€™å€‹åªé©åˆDockerï¼Œk8sè«‹æ”¹ç”¨cert-manage&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨èªªæ˜&lt;/p&gt;
&lt;p&gt;æˆ‘é€™é‚Šæ˜¯æ›è¼‰user_conf.d åˆ° /etc/nginx/user_conf.d ï¼Œ&lt;br /&gt;
user_conf.då°±æ˜¯è¨­å®šæª”å­˜æ”¾çš„ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;docker-compose.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;version: &#39;3&#39;

services:
  nginx:
    image: jonasal/nginx-certbot:latest
    container_name: nginx
    restart: unless-stopped
    networks:
      - cicd_net
    env_file:
      - ./nginx-certbot.env
    ports:
      - 80:80
      - 443:443
    volumes:
      - nginx_secrets:/etc/letsencrypt
      - ./user_conf.d:/etc/nginx/user_conf.d

volumes:
  nginx_secrets:

# è·Ÿdrone servereæ›åœ¨åŒä¸€å±¤
networks:
  cicd_net:
    name: cicd_net
    driver: bridge  

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¨˜å¾—æ›´æ”¹emailï¼Œä¸ç„¶å•“å‹•æœƒå¤±æ•—&lt;br /&gt;
nginx-certbot.env&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Required
CERTBOT_EMAIL=&amp;lt;email&amp;gt;

# Optional (Defaults)
DHPARAM_SIZE=2048
ELLIPTIC_CURVE=secp256r1
RENEWAL_INTERVAL=8d
RSA_KEY_SIZE=2048
STAGING=0
USE_ECDSA=1

# Advanced (Defaults)
CERTBOT_AUTHENTICATOR=webroot
CERTBOT_DNS_PROPAGATION_SECONDS=&amp;quot;&amp;quot;
DEBUG=0
USE_LOCAL_CA=0

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;user_conf.dè³‡æ–™å¤¾å…§çš„æª”æ¡ˆåç¨±&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server {
    # Listen to port 443 on both IPv4 and IPv6.
    listen 443 ssl http2;
    listen [::]:443 ssl http2;

    # Domain names this server should respond to.
    server_name otpat.domain.com;

    # Load the certificate files.
    ssl_certificate         /etc/letsencrypt/live/otpat-domain-com/fullchain.pem;
    ssl_certificate_key     /etc/letsencrypt/live/otpat-domain-com/privkey.pem;
    ssl_trusted_certificate /etc/letsencrypt/live/otpat-domain-com/chain.pem;

    ssl_protocols             TLSv1.3 TLSv1.2;
    ssl_prefer_server_ciphers on;
    ssl_ecdh_curve            X25519:secp521r1:secp384r1;
    ssl_ciphers               TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;
    ssl_session_cache         shared:TLS:2m;
    ssl_buffer_size           4k;

    # OCSP stapling
    ssl_stapling on;
    ssl_stapling_verify on;
    resolver 1.1.1.1 1.0.0.1 [2606:4700:4700::1111] [2606:4700:4700::1001]; # Cloudflare

   # return 200 &#39;Let&#92;&#39;s Encrypt certificate successfully installed!&#39;;
   # add_header Content-Type text/plain;

   location / {
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header Host $http_host;

        proxy_pass http://totp-auth:9987;

        proxy_redirect off;
        proxy_http_version 1.1;
        proxy_buffering off;

        chunked_transfer_encoding off;
    }

}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®Œæˆå“ï¼Œå› ç‚ºè¦å°‡proxy_passå°åˆ°æœå‹™ä¸Šé¢ï¼Œæœ€å¥½æ˜¯è¨­æˆåŒä¸€å€‹networkï¼Œé€™é‚Šè¨­ç‚º cicd_net&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/157-fig.1.jpg&quot; alt=&quot;157-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœå•“å‹•å¤±æ•—çš„è©±ï¼Œ&lt;br /&gt;
å¯ä»¥æŸ¥ä¸€ä¸‹nginxè£é¢çš„éŒ¯èª¤è¨Šæ¯ï¼Œä¸Šé¢é€šå¸¸å¯«çš„å¾ˆæ¸…æ¥šã€‚&lt;/p&gt;
&lt;p&gt;å»ºè­°å¯ä»¥å…ˆçœ‹çœ‹é€™å…©ç¯‡&lt;br /&gt;
ref.&lt;br /&gt;
- &lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10301801&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;D15 - NGINX-Certbot Image&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://github.com/JonasAlfredsson/docker-nginx-certbot/blob/master/docs/good_to_know.md&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;github_good_to_know&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ³ Container/157. Docker NGINX-Certbot è‡ªå‹•è·ŸLet&#39;sEncrytpå–å¾—æ†‘è­‰/" />
        </entry>
        <entry>
            <title>
                154. PaddlePaddle æ‰“åŒ…image
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ³ Container/154. PaddlePaddle æ‰“åŒ…image/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;é€™æ¬¡çš„AIç¨‹å¼åˆæ›´ç‰¹åˆ¥äº†ï¼Œ&lt;br /&gt;
ä¸€å †ä¸ç›¸å®¹çš„å¥—ä»¶ï¼Œ&lt;br /&gt;
RDæ˜¯åœ¨windowsä¸Šé–‹ç™¼ï¼Œè¦åŒ…æˆimageä¸€å †ç‰†ï¼Œå˜–å˜–ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;libGL.so.1&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;apt-get install libgl1
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;pycocotools&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€™å€‹å¥½è§£æ±ºï¼Œç›´æ¥åœ¨requirements.txtä¸Šé¢å¢åŠ  pycocotools&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Paddle&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;pip3 install paddlepaddle==2.4.2 -i https://mirror.baidu.com/pypi/simple
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Paddleå®‰è£å¤±æ•—&lt;br /&gt;
é€™å€‹å°±çœŸçš„æ©Ÿè»Šäº†ï¼Œå¾Œä¾†æŸ¥æ˜¯å› çˆ²paddleï¼Œä¸æ”¯æ´alpine linuxï¼Œ&lt;br /&gt;
æœ€å¾Œåªå¥½è£åœ¨ubuntuä¸Šé¢ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://github.com/PaddlePaddle/Paddle/issues/30247&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;github issue&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;torch&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&quot;language-Dockerfile&quot;&gt;FROM ubuntu:20.04
ENV PATH &amp;quot;$PATH:/usr/local/bin&amp;quot;
WORKDIR /usr/local/app
COPY . /usr/local/app

RUN apt-get update &amp;amp;&amp;amp; apt-get install -y enchant &amp;amp;&amp;amp; apt-get install -y  python3.7 python3-pip libgl1 &amp;amp;&amp;amp; apt-get clean &amp;amp;&amp;amp; rm -rf /var/lib/apt/lists/*
RUN pip3 install --upgrade pip
RUN pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu
RUN pip3 install paddlepaddle==2.4.2 -i https://mirror.baidu.com/pypi/simple
RUN pip3 install --no-cache-dir -r requirements.txt 
ENTRYPOINT [&amp;quot;gunicorn&amp;quot;,&amp;quot;-c&amp;quot; ,&amp;quot;gunicorn_config.py&amp;quot;,&amp;quot;wsgi:app&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ³ Container/154. PaddlePaddle æ‰“åŒ…image/" />
        </entry>
        <entry>
            <title>
                152. ç¡¬ç¢Ÿç©ºé–“ä¸è¶³ï¼Œç„¡æ³•é€²å…¥å®¹å™¨
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ³ Container/152. ç¡¬ç¢Ÿç©ºé–“ä¸è¶³ï¼Œç„¡æ³•é€²å…¥å®¹å™¨/</id>
            <content type="html">
                &lt;p&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%B3%20Container/152.%20%E7%A1%AC%E7%A2%9F%E7%A9%BA%E9%96%93%E4%B8%8D%E8%B6%B3%EF%BC%8C%E7%84%A1%E6%B3%95%E9%80%B2%E5%85%A5%E5%AE%B9%E5%99%A8/#2024-07-16-docker-compose&quot;&gt;&lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#2024/07/16ï¼Œdocker&quot;&gt;#2024/07/16ï¼Œdocker&lt;/a&gt; composeè¨­å®šæ–¹æ³•&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;ä¸Šé€±åŒäº‹å•æˆ‘æ€éº¼é€£é€²å»å®¹å™¨è£é¢ï¼Œ&lt;br /&gt;
æˆ‘å¾ˆé †çš„å›ç­”æŒ‡ä»¤ï¼Œ&lt;br /&gt;
ç„¶å¾Œä»–å°±è·³å‡º é€™å€‹éŒ¯èª¤&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;failed to create runc console socket: mkdir /tmp/pty2070058578: no space left on device: unknown&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;è™•ç†å•é¡Œ&quot; tabindex=&quot;-1&quot;&gt;è™•ç†å•é¡Œ&lt;/h3&gt;
&lt;p&gt;å¾éŒ¯èª¤è¨Šæ¯çœ‹èµ·ä¾†ï¼Œå°±æ˜¯ç©ºé–“ä¸è¶³ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆçœ‹çœ‹æ˜¯å“ªé‚Šç¡¬ç¢Ÿåƒæ»¿äº†&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;df -h
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œçœ‹åˆ°user 100%...ç„¶å¾Œæ›è¼‰åœ¨ / æ ¹ç›®éŒ„ä¸‹ã€‚&lt;br /&gt;
å†ä¾†æª¢æŸ¥ç•¶å‰ç›®éŒ„ï¼Œæ¯å€‹è³‡æ–™å¤¾çš„å¤§å°&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;du -hcd 1 | sort -n
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€å¾Œè¿½é˜¿è¿½çš„ï¼Œè¿½åˆ°äº†containerçš„ç›®éŒ„&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;/var/lib/docker/&lt;br /&gt;
è£é¢æœ‰ä¸€äº›containerå®¹é‡åƒå¾—å¾ˆå¤šï¼Œ&lt;br /&gt;
æœ€å¾Œç¢ºèªæ˜¯è©²containerçš„logï¼Œé‚£å°±ç äº†å§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;rm -rf &amp;lt;container_id&amp;gt;.log
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†è«‹åŒäº‹é€£ç·šï¼Œé‚„æ˜¯å‡ºç¾åŒæ¨£çš„éŒ¯èª¤ï¼Œ&lt;br /&gt;
æ˜¯ç”±æ–¼linuxçš„ç‰¹æ€§ï¼Œå°±ç®—ä½ ç äº†æª”æ¡ˆï¼Œ&lt;br /&gt;
æ­¤æª”æ¡ˆé‚„æ˜¯è¢«å’¬ä½æ²’æœ‰é‡‹æ”¾é–‹(windowæ˜¯é€£ç éƒ½ä¸èƒ½ç )ï¼Œ&lt;br /&gt;
æ‰€ä»¥æ­¤æ™‚å»æŸ¥ç¡¬ç¢Ÿå¤§å°ï¼Œé‚„æ˜¯100% usedçš„ç‹€æ…‹ï¼Œ&lt;br /&gt;
å°‡dockeré‡é–‹å¾Œï¼Œå°±èƒ½é‡‹æ”¾ç©ºé–“äº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;è§£æ±ºå•é¡Œ&quot; tabindex=&quot;-1&quot;&gt;è§£æ±ºå•é¡Œ&lt;/h3&gt;
&lt;p&gt;ç¾åœ¨çŸ¥é“æ˜¯containerçš„logæœƒä¸€ç›´å¢é•·ï¼Œ&lt;br /&gt;
é‚£å°±è¨­å€‹æ¢ä»¶ï¼Œè®“ä»–é•·åˆ°ä¸€å®šç¨‹åº¦å¾Œå°±ä¸èƒ½å†é•·å¤§äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ­¤è·¯å¾‘æ²’æª”æ¡ˆï¼Œå‰‡å»ºç«‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;vim /etc/docker/daemon.json
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¼¸å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;{
    &amp;quot;log-driver&amp;quot;:&amp;quot;json-file&amp;quot;,
    &amp;quot;log-opts&amp;quot;:{
        &amp;quot;max-size&amp;quot; :&amp;quot;500m&amp;quot;,&amp;quot;max-file&amp;quot;:&amp;quot;3&amp;quot;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;max-size : å–®å€‹å®¹å™¨çš„å–®æª”å¤§å°&lt;br /&gt;
max-file: logæ•¸é‡&lt;/p&gt;
&lt;p&gt;å¥½äº†å¾Œï¼Œé‡å•“æœå‹™&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;systemctl daemon-reload
systemctl restart docker
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¨­å®šçš„æ—¥èªŒå¤§å°è¦å‰‡ï¼Œåªå°æ–°å»ºçš„å®¹å™¨æœ‰æ•ˆ&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/sxdcgaq8080/p/10689223.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ã€dockerã€‘dockeré™åˆ¶è¨˜éŒ„æª”å¤§å°çš„æ–¹æ³•+æŸ¥çœ‹è¨˜éŒ„æª”çš„æ–¹æ³•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.jianshu.com/p/594e0a2af6f2&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;docker å ±éŒ¯ï¼š failed to create runc console socket: mkdir /tmp/pty328598598: no space left on device&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;2024-07-16-docker-compose&quot; tabindex=&quot;-1&quot;&gt;2024/07/16ï¼Œdocker composeè¨­å®šæ–¹æ³•&lt;/h3&gt;
&lt;p&gt;åœ¨docker compose å¢åŠ ä¸‹é¢èªæ³•&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;services:
  srs:
    container_name: srs
    logging:
      driver: &amp;quot;json-file&amp;quot;
      options:
        max-size: &amp;quot;300m&amp;quot;
        max-file: &amp;quot;3&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ³ Container/152. ç¡¬ç¢Ÿç©ºé–“ä¸è¶³ï¼Œç„¡æ³•é€²å…¥å®¹å™¨/" />
        </entry>
        <entry>
            <title>
                138. gerapy+scrapyd+mongoçˆ¬èŸ²æ•´å¥—æµç¨‹
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ³ Container/138. gerapy+scrapyd+mongoçˆ¬èŸ²æ•´å¥—æµç¨‹/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;æœ‰ä¸€å¤©çªç„¶ç™¼ç¾ï¼Œæˆ‘çš„çˆ¬èŸ²ä¸æœƒå‹•äº†ï¼ŒåŸå› æ˜¯ç¶²ç«™æ”¹ç‰ˆï¼Œæ‰€ä»¥è¦å‰‡è¦æ”¹ã€‚&lt;br /&gt;
æ–¼æ˜¯ï¼Œæ—¢ç„¶éƒ½è¦æ”¹äº†ï¼Œé‚£å°±æŠŠå¾ˆä¹…ä»¥å‰æ²’æœ‰æ¦‚å¿µçš„dockeréƒ½æ”¹ä¸€æ”¹å§ï¼Œ&lt;br /&gt;
é †ä¾¿æ”¹æˆdocker composeä¸€æ¬¡è§£æ±ºã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æ›´æ–°ï¼Œå¾Œä¾†ä¹Ÿæ²’ç”¨é€™å¥—äº†ï¼Œä»–åœ¨æ’ç¨‹åŸ·è¡Œæ™‚æœ‰é»å•é¡Œï¼Œ&lt;br /&gt;
æœ€å¾Œé‚„æ˜¯å›æœ¬ä¾†çš„scrapyweb+scrapyd+mongoDBï¼Œ&lt;br /&gt;
è«‹è¦‹æ–‡ç« æœ€å¾Œçš„Docker-compose.yaml&lt;/p&gt;
&lt;h2 id=&quot;æ¶è¨­æœå‹™&quot; tabindex=&quot;-1&quot;&gt;æ¶è¨­æœå‹™&lt;/h2&gt;
&lt;p&gt;docker-compose.yml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;version: &#39;3&#39;
services:
  scrapyd:
    container_name: scrapyd
    image: vimagick/scrapyd
    volumes:
      - ./data:/var/lib/scrapyd
      - /usr/local/lib/python3.7/dist-packages
    restart: unless-stopped
    networks:
      - scrapy_net  
  gerapy:
    container_name: gerapy
    image: germey/gerapy
    volumes:
      - ./gerapy:/app/gerapy
    ports:
      - 8000:8000
    networks:
      - scrapy_net    
  mongo:
    container_name: mongo
    image: mongo:latest
    restart: always
    volumes:
      - ./mongodbdata:/data/db
    environment:
      MONGO_INITDB_ROOT_USERNAME: daimomadmin
      MONGO_INITDB_ROOT_PASSWORD: d@imom
    networks:
      - scrapy_net
    ports:
      - 27017:27017
  mongo-express:
      container_name: mongo-express
      image: mongo-express
      restart: always
      ports:
        - 8081:8081
      environment:
        ME_CONFIG_MONGODB_SERVER: 192.168.1.78
        ME_CONFIG_MONGODB_PORT: 27017
        ME_CONFIG_MONGODB_ADMINUSERNAME: daimomadmin
        ME_CONFIG_MONGODB_ADMINPASSWORD: d%40imom
      networks:
      - scrapy_net  
networks:
  scrapy_net:
    name: scrapy
    driver: bridge
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŸ·è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;docker compose up -d
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;æ³¨æ„äº‹é …&quot; tabindex=&quot;-1&quot;&gt;æ³¨æ„äº‹é …&lt;/h3&gt;
&lt;p&gt;mongo-express åº•ä¸‹çš„  ME_CONFIG_MONGODB_ADMINPASSWORD&lt;br /&gt;
ç‚ºä»€éº¼æœƒå‡ºç¾ %40ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å› ç‚ºç›´æ¥ç”¨@ æœƒå‡ºç¾éŒ¯èª¤ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;UnhandledPromiseRejectionWarning: MongoParseError: Unescaped at-sign in authority section&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯chatGPTçš„å›ç­”&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/138-fig.1.jpg&quot; alt=&quot;138-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;gerapy&quot; tabindex=&quot;-1&quot;&gt;è¨­å®šgerapy&lt;/h2&gt;
&lt;p&gt;å¦‚æœæ˜¯æ ¹æ“šä¸Šé¢çš„docker composeå»ºç«‹çš„è©±ï¼Œ&lt;br /&gt;
ç¶²å€ç”¨ localhost:8000ç™»å…¥ï¼Œ&lt;br /&gt;
é è¨­çš„å¸³å¯†æ˜¯ admin/adminï¼Œé€²å»å¾Œæœ€å¥½æ”¹ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¨­å®š scrapydçš„ä½ç½®ï¼Œåœ¨åŒä¸€å€‹networkè£é¢ï¼Œ&lt;br /&gt;
æ‰€ä»¥èƒ½é€™æ¨£äº’æ‰“ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/138-fig.2.jpg&quot; alt=&quot;138-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;ä¸Šå‚³å°ˆæ¡ˆ&lt;br /&gt;
é€™é‚Šè¦æ³¨æ„ï¼Œä¸Šå‚³çš„å£“ç¸®æª”æ¡ˆè£é¢è¦æœ‰ã€  .cfgã€çš„æª”æ¡ˆ&lt;br /&gt;
æª”æ¡ˆçµæ§‹å¦‚ä¸‹&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/138-fig.3.jpg&quot; alt=&quot;138-fig.3.jpg&quot; /&gt;&lt;br /&gt;
å£“ç¸®çš„æ™‚å€™ï¼Œè«‹é‡å°ä¸Šå±¤ç›®éŒ„ç›´æ¥å£“ç¸®ï¼Œä»¥ä¸Šåœ–ä¾†èªªå°±æ˜¯å£“ç¸®TaazeSpideré€™å€‹è³‡æ–™å¤¾ã€‚&lt;br /&gt;
ä¸Šå‚³å®Œå¾Œï¼Œå¯ä»¥æŒ‰Editï¼Œå¯ä»¥çœ‹åˆ°ç¨‹å¼ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/138-fig.4.jpg&quot; alt=&quot;138-fig.4.jpg&quot; /&gt;&lt;/li&gt;
&lt;li&gt;éƒ¨ç½²åˆ°ä¸»æ©Ÿä¸Š&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/138-fig.5.jpg&quot; alt=&quot;138-fig.5.jpg&quot; /&gt;&lt;br /&gt;
å¿…é ˆå…ˆbuildï¼Œç„¶å¾Œæ‰å¯ä»¥deployåˆ°ä¸»æ©Ÿä¸Š&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/138-fig.6.jpg&quot; alt=&quot;138-fig.6.jpg&quot; /&gt;&lt;br /&gt;
å¦‚æœç¢°åˆ°æ‰“åŒ…å¤±æ•—æˆ–æ˜¯éƒ¨ç½²å¤±æ•—ï¼Œå¯ä»¥åˆ°ä¸»æ©Ÿä¸Šçœ‹ä¸€ä¸‹logã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;docker logs gerapy
docker logs scrapyd
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;æ¸¬è©¦é‹ä½œ&lt;br /&gt;
åˆ°ä¸»æ©Ÿçš„è¨­å®šç•«é¢ï¼Œé¸æ“‡schedule ï¼Œç„¶å¾ŒæŒ‰ä¸‹run è·‘è·‘çœ‹æœ‰æ²’æœ‰æ­£å¸¸ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/138-fig.7.jpg&quot; alt=&quot;138-fig.7.jpg&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/138-fig.9.jpg&quot; alt=&quot;138-fig.9.jpg&quot; /&gt;&lt;/li&gt;
&lt;li&gt;è¨­å®šæ’ç¨‹&lt;br /&gt;
Name : éš¨æ„&lt;br /&gt;
Project ï¼šprojectsçš„åç¨±&lt;br /&gt;
Spiderï¼šåœ¨Scheduleçš„åç¨±ï¼Œå¯åƒè€ƒä¸Šåœ–&lt;br /&gt;
Clientsï¼šä¸»æ©Ÿåç¨±ï¼Œå¯ä»¥ç”¨é¸çš„&lt;br /&gt;
Triggerï¼šcrontab æ˜¯å›ºå®šçš„æ™‚é–“åŸ·è¡Œ&lt;br /&gt;
interval æ˜¯ éš”å¤šä¹…åŸ·è¡Œ&lt;br /&gt;
date æ˜¯ ç‰¹å®šæ—¥æœŸ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/138-fig.8.jpg&quot; alt=&quot;138-fig.8.jpg&quot; /&gt;&lt;br /&gt;
å¥½äº†å¾Œå¯ä»¥æŒ‰ä¸‹statusï¼Œå¯ä»¥çœ‹åˆ°ä¸‹æ¬¡åŸ·è¡Œæ™‚é–“ï¼Œå¾é€™çœ‹æœ‰æ²’æœ‰è¨­å®šæˆåŠŸã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/138-fig.11.jpg&quot; alt=&quot;138-fig.11.jpg&quot; /&gt;&lt;br /&gt;
é€™é‚Šå¯ä»¥çœ‹åˆ° Next timeçš„æ™‚é–“&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/138-fig.10.jpg&quot; alt=&quot;138-fig.10.jpg&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://github.com/Gerapy/Gerapy/issues/176&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;dockeréƒ¨ç½²æ‰“åŒ…å¤±æ•—&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://github.com/Gerapy/Gerapy&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gerapy&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://www.w3schools.com/cssref/css_selectors.php&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;CSSÂ SelectorÂ Reference&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;scrapyweb-scrapyd&quot; tabindex=&quot;-1&quot;&gt;Scrapyweb+scrapyd&lt;/h2&gt;
&lt;p&gt;æœ€å¾Œé‚„æ˜¯ç”¨å›é€™å¥—äº†ï¼Œ&lt;br /&gt;
ç©©å®šåº¦å¤§å‹ï¼Œdbçš„å¸³è™Ÿå¯†ç¢¼ï¼Œå¿…é ˆèˆ‡çˆ¬èŸ²ä¸€è‡´&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;
version: &#39;3&#39;
services:
  scrapyd:
    container_name: scrapyd
    image: germey/scrapyd
    volumes:
      - ./data:/var/lib/scrapyd
      - /usr/local/lib/python3.7/dist-packages
    restart: unless-stopped
    networks:
      - scrapy_net  
  scrapydweb:
      container_name: scrapydweb
      image: ryanvin/scrapydweb
      depends_on:
        - scrapyd
      ports:
        - 5000:5000
      environment:
        USERNAME: daiomom
        PASSWORD: password
        SCRAPYD_SERVERS: scrapyd
      volumes:
        - ./scrapydweb_data:/app
      networks:
        - scrapy_net            
  mongo:
    container_name: mongo
    image: mongo:latest
    restart: always
    volumes:
      - ./mongodbdata:/data/db
    environment:
      MONGO_INITDB_ROOT_USERNAME: daimomadmin
      MONGO_INITDB_ROOT_PASSWORD: password
    networks:
      - scrapy_net
    ports:
      - 27017:27017
  mongo-express:
      container_name: mongo-express
      image: mongo-express
      restart: always
      ports:
        - 8081:8081
      environment:
        ME_CONFIG_MONGODB_SERVER: 192.168.1.78
        ME_CONFIG_MONGODB_PORT: 27017
        ME_CONFIG_MONGODB_ADMINUSERNAME: daimomadmin
        ME_CONFIG_MONGODB_ADMINPASSWORD: password
      networks:
      - scrapy_net  
networks:
  scrapy_net:
    name: scrapy
    driver: bridge
    
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ³ Container/138. gerapy+scrapyd+mongoçˆ¬èŸ²æ•´å¥—æµç¨‹/" />
        </entry>
        <entry>
            <title>
                115. .net core æ‰“åŒ…dockerfile
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ³ Container/115. .net core æ‰“åŒ…dockerfile/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;ä»Šå¤©æ‰çŸ¥é“vistual studio çš„ç¥å¥‡åœ°æ–¹ï¼Œ&lt;br /&gt;
ç›´æ¥æ»‘é¼ æŒ‰ä¸€æŒ‰ï¼Œdockerfileå°±è‡ªå‹•ç”¢ç”Ÿäº†ï¼Œ&lt;br /&gt;
ä¹Ÿä¸ç”¨å¯«ï¼Œä¸éä¸æ˜¯vs codeçš„ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;FROM mcr.microsoft.com/dotnet/aspnet:3.1 AS base
RUN apt-get update -y &amp;amp;&amp;amp; apt-get install -y libc6-dev libgdiplus libx11-dev &amp;amp;&amp;amp; apt-get clean &amp;amp;&amp;amp; ln -s /usr/lib/libgdiplus.so /usr/lib/gdiplus.dll
WORKDIR /app
EXPOSE 80
EXPOSE 443

FROM mcr.microsoft.com/dotnet/sdk:3.1 AS build
WORKDIR /src
COPY ./**/*.csproj ./
# RUN pwd &amp;amp;&amp;amp; ls -ahl
RUN for file in $(ls *.csproj); do mkdir -p ./${file%.*}/ &amp;amp;&amp;amp; mv $file ./${file%.*}/; done
# RUN pwd &amp;amp;&amp;amp; ls SystemManageService.Backend -ahl
RUN dotnet restore SystemManageService.Backend/SystemManageService.Backend.csproj

COPY . .
RUN dotnet build SystemManageService.Backend/SystemManageService.Backend.csproj -c Release -o /app/build



FROM build AS publish
RUN dotnet publish SystemManageService.Backend/SystemManageService.Backend.csproj -c Release -o /app/publish



FROM base AS final
WORKDIR /app
COPY --from=publish /app/publish .
RUN ls

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šçš„é‡é»åœ¨é€™å…©æ®µï¼Œå–å¾—å°ˆæ¡ˆå…§æ‰€æœ‰çš„csprojï¼Œç„¶å¾Œä¸Ÿé€²å»buildçš„imageè£é¢ã€‚&lt;br /&gt;
ä½†æ˜¯ï¼Œé€™æ¨£ä¸¦ä¸æœƒæ ¹æ“šè³‡æ–™å¤¾æ”¾åˆ°å…¶ä»–ç‰¹å®šçš„åœ°æ–¹ï¼Œ&lt;br /&gt;
æ‰€ä»¥æ‰æœ‰for fileå»ºç«‹è³‡æ–™å¤¾è·Ÿç§»å‹•æª”æ¡ˆã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;COPY ./**/*.csproj ./
# RUN pwd &amp;amp;&amp;amp; ls -ahl
RUN for file in $(ls *.csproj); do mkdir -p ./${file%.*}/ &amp;amp;&amp;amp; mv $file ./${file%.*}/; done
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¬¬ä¸€è¡Œé‡é»ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FROM mcr.microsoft.com/dotnet/aspnet:3.1 AS base
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤imageä¸èƒ½æ‹¿æ‰ï¼Œä¸€å®šè¦æœ‰ä¸€å€‹baseçš„ï¼Œ&lt;br /&gt;
ä¸ç„¶åœ¨é–‹ç™¼çš„æ™‚å€™ï¼Œæ¯æ¬¡éƒ½æœƒé‡buildä¸€æ¬¡image&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.tencent.com/developer/article/1624727&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;.NET Core Docker å†ä¹Ÿä¸ç”¨é€å€‹ COPY csproj æª”æ¡ˆå•¦ï¼&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ³ Container/115. .net core æ‰“åŒ…dockerfile/" />
        </entry>
        <entry>
            <title>
                112. pyenchant &amp; opencc error fix
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ³ Container/112. pyenchant &amp; opencc error fix/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;æ–°å…¬å¸çš„ç¬¬ä¸€å€‹dockerfileå°±æ’ç‰†ï¼Œ&lt;br /&gt;
è«åçš„éŒ¯èª¤ï¼Œè£äº†é‚„æ˜¯éä¸äº†ï¼Œ&lt;br /&gt;
å¯«é€™å€‹ç¨‹å¼çš„èªªä¹Ÿæ²’ç”¨éï¼Œä»–å€‘éƒ½æ˜¯ç”¨æœ¬æ©Ÿè·‘AIã€‚&lt;br /&gt;
åªå¥½è‡ªå·±äº‚æäº†..&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;debugæ–¹å¼ï¼Œéƒ½æ˜¯ç›´æ¥å»ç¿»pythonçš„ç¨‹å¼ç¢¼çœ‹è£é¢çš„å…§å®¹ã€‚&lt;br /&gt;
é€™å…©å€‹å¤§éƒ¨åˆ†éƒ½ç”¨ ctypes.util.find_library  å»æ‰¾libraryã€‚&lt;br /&gt;
ç„¶å¾Œç¨‹å¼å…§éƒ½æœ‰å¯«é¡å¤–æ¢ä»¶ï¼Œç•¶find_libraryæ‰¾ä¸åˆ°æ™‚ï¼Œ&lt;br /&gt;
å¯ä»¥å¾ç’°å¢ƒè®Šæ•¸å–å€¼ã€‚&lt;br /&gt;
æ‰€ä»¥ä¸‹é¢éƒ½æ˜¯ä½¿ç”¨ç’°å¢ƒè®Šæ•¸çš„æ–¹å¼ï¼Œè®“packageèƒ½å¤ å–å¾—libraryã€‚&lt;/p&gt;
&lt;h3 id=&quot;python-debug&quot; tabindex=&quot;-1&quot;&gt;python debugæ™‚çš„å‚™å¿˜äº‹é …&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;python3 package çš„ä½ç½®åœ¨ /usr/local/lib/python3.10/site-packages&lt;/li&gt;
&lt;li&gt;find_libraryï¼Œæ ¹æ“šåŒäº‹çš„èªªæ³•ï¼Œæ‡‰è©²æ˜¯æŠ“pathçš„è·¯å¾‘ä¸‹å»åšæœå°‹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç„¶å¾Œé–‹å§‹çœ‹codeå§ã€‚&lt;/p&gt;
&lt;h3 id=&quot;alpine-linux-enchant&quot; tabindex=&quot;-1&quot;&gt;alpine linuxå®‰è£enchant&lt;/h3&gt;
&lt;p&gt;è§£æ±º  &#39;enchant&#39; C library was not found&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ImportError: The &#39;enchant&#39; C library was not found and maybe needs to be installed.
See  https://pyenchant.github.io/pyenchant/install.html
for details

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…¶å¯¦æœ‰å®‰è£ py3-enchant å°±å¥½äº†ï¼Œ&lt;br /&gt;
å¾ŒçºŒæ˜¯å› ç‚ºæ‰¾ä¸åˆ°libraryæ‰æœƒå™´éŒ¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apk add py3-enchant aspell aspell-en
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥è¨­å®šä¸€ä¸‹ç’°å¢ƒè®Šæ•¸ï¼Œæ”¶å·¥ã€‚&lt;br /&gt;
ä¸‹é¢ç¨‹å¼æ˜¯dockerfileç”¨çš„ï¼Œå¦‚æœè¦æ¸¬è©¦å°±æŠŠenvæ”¹æˆexportå§&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ENV PYENCHANT_LIBRARY_PATH=/usr/lib/libenchant-2.so.2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://github.com/pyenchant/pyenchant/issues/265&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Cannot find Enchant C library on Apple Silicon&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;alpine-linux-opencc&quot; tabindex=&quot;-1&quot;&gt;alpine linux å®‰è£opencc&lt;/h3&gt;
&lt;p&gt;è§£æ±º libopencc.so.1 : No such file&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Traceback (most recent call last):
  File &amp;quot;/usr/local/app/Speech_control.py&amp;quot;, line 3, in &amp;lt;module&amp;gt;
    from opencc import OpenCC
  File &amp;quot;/usr/local/lib/python3.10/site-packages/opencc.py&amp;quot;, line 24, in &amp;lt;module&amp;gt;
    libopencc = CDLL(&#39;libopencc.so.1&#39;, use_errno=True)
  File &amp;quot;/usr/local/lib/python3.10/ctypes/__init__.py&amp;quot;, line 374, in __init__
    self._handle = _dlopen(self._name, mode)
OSError: Error loading shared library libopencc.so.1: No such file or directory
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%B3%20Container/blog.112.fig-1.jpg&quot; alt=&quot;blog.112.fig-1.jpg&quot; /&gt;&lt;br /&gt;
å› ç‚ºopenccåœ¨ repositoryçš„testingä¸Šé¢ï¼Œ&lt;br /&gt;
ç”¨ä¸‹é¢çš„æ–¹æ³•è£&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apk add opencc --repository=http://dl-cdn.alpinelinux.org/alpine/edge/testing/

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¥½äº†å¾Œè¨­å®šç’°å¢ƒè®Šæ•¸(é€™æ˜¯dockerfileç”¨çš„)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ENV LIBOPENCC=/usr/lib/libopencc.so.1.1
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;dockerfile&quot; tabindex=&quot;-1&quot;&gt;å®Œæ•´dockerfile&lt;/h3&gt;
&lt;p&gt;é€™å€‹alpine linux , buildå‡ºä¾† 181.73MB&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FROM python:alpine3.16
ENV PATH &amp;quot;$PATH:/usr/local/bin&amp;quot;
WORKDIR /usr/local/app
RUN apk update &amp;amp;&amp;amp; apk add py3-enchant aspell aspell-en  &amp;amp;&amp;amp; apk add opencc --repository=http://dl-cdn.alpinelinux.org/alpine/edge/testing/
ENV LIBOPENCC=/usr/lib/libopencc.so.1.1
ENV PYENCHANT_LIBRARY_PATH=/usr/lib/libenchant-2.so.2
COPY ./Chatbot_Speech /usr/local/app
RUN pip3 install --upgrade pip
RUN pip3 install --no-cache-dir -r requirements.txt
ENTRYPOINT [&amp;quot;python&amp;quot;, &amp;quot;Speech.py&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”¨ubuntu ,build å‡ºä¾† 511.74MBï¼Œ&lt;br /&gt;
æœ¬ä¾†æ˜¯6xxï¼Œå¾Œä¾†æ¸…äº†ä¸€ä¸‹cacheï¼Œç¸®æ¸›ä¸€ä¸‹æ­¥é©Ÿå¾Œï¼Œæ‰è®Šæˆ511MB&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FROM ubuntu:20.04
ENV PATH &amp;quot;$PATH:/usr/local/bin&amp;quot;
WORKDIR /usr/local/app
COPY ./Chatbot_Speech /usr/local/app
RUN apt-get update &amp;amp;&amp;amp; apt-get install -y enchant &amp;amp;&amp;amp; apt-get install -y  python3.6 python3-pip &amp;amp;&amp;amp; apt-get clean &amp;amp;&amp;amp; rm -rf /var/lib/apt/lists/*
RUN pip3 install --upgrade pip
RUN pip3 install --no-cache-dir -r requirements.txt 
ENTRYPOINT [&amp;quot;python3&amp;quot;, &amp;quot;Speech.py&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10246952&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; æœ€ä½³åŒ– Dockerfile - ç²¾ç°¡ image&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ³ Container/112. pyenchant &amp; opencc error fix/" />
        </entry>
        <entry>
            <title>
                0.Container MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ³ Container/0.Container MOC/</id>
            <content type="html">
                &lt;h1 id=&quot;docker-debug&quot; tabindex=&quot;-1&quot;&gt;Docker Debug&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%B3%20Container/29.Dockerfile%20echo%20something/&quot;&gt;29.Dockerfile echo something&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%B3%20Container/152.%20%E7%A1%AC%E7%A2%9F%E7%A9%BA%E9%96%93%E4%B8%8D%E8%B6%B3%EF%BC%8C%E7%84%A1%E6%B3%95%E9%80%B2%E5%85%A5%E5%AE%B9%E5%99%A8/&quot;&gt;152. ç¡¬ç¢Ÿç©ºé–“ä¸è¶³ï¼Œç„¡æ³•é€²å…¥å®¹å™¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%B3%20Container/168.%20Docker%20build%E5%A4%B1%E6%95%97%E8%B7%B3%E5%87%BAkilled/&quot;&gt;168. Docker buildå¤±æ•—è·³å‡ºkilled&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;dockerfile&quot; tabindex=&quot;-1&quot;&gt;Dockerfile&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%B3%20Container/32.%20nuxtJS%20%E7%9A%84%20Dockerfile/&quot;&gt;32. nuxtJS çš„ Dockerfile&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%B3%20Container/112.%20pyenchant%20&amp;%20opencc%20error%20fix/&quot;&gt;112. pyenchant &amp;amp; opencc error fix&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%B3%20Container/115.%20.net%20core%20%E6%89%93%E5%8C%85dockerfile/&quot;&gt;115. .net core æ‰“åŒ…dockerfile&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%B3%20Container/138.%20gerapy+scrapyd+mongo%E7%88%AC%E8%9F%B2%E6%95%B4%E5%A5%97%E6%B5%81%E7%A8%8B/&quot;&gt;138. gerapy+scrapyd+mongoçˆ¬èŸ²æ•´å¥—æµç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%B3%20Container/170.%20Docker%E5%95%93%E7%94%A8GPU/&quot;&gt;170. Dockerå•“ç”¨GPU&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ³ Container/0.Container MOC/" />
        </entry>
        <entry>
            <title>
                php exec ssh ç™¼ç”Ÿ Host key verification failed éŒ¯èª¤
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/php exec ssh ç™¼ç”Ÿ Host key verification failed éŒ¯èª¤/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å‰å¹¾å¤©ä¸€ç›´åœ¨æ‰¾phpçš„execå‘ï¼Œ&lt;br /&gt;
æœ€å¾Œçµ‚æ–¼è§£äº†ï¼Œ&lt;br /&gt;
è¨˜éŒ„ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æ­£æ–‡&lt;br /&gt;
é¦–å…ˆä¾†æ®µcodeï¼Œ&lt;br /&gt;
é€™æ®µçš„ç”¨é€”æ˜¯è¦æŠŠ æª”æ¡ˆå¾A è¤‡è£½åˆ° B ï¼Œ&lt;br /&gt;
å¦‚æœç›´æ¥åœ¨AåŸ·è¡Œ scp çš„æŒ‡ä»¤ï¼Œæ˜¯æ­£å¸¸çš„ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
exec(&amp;quot;scp -i /var/www/.ssh/id_rsa -r /var/www/html/WebService/upload/tmp/fe8abe8e88fb3a2d88cc17a45a7575b1.png www-data@10.7.0.17:/var/www/html/tmp/ 2&amp;gt;&amp;amp;1&amp;quot;, $output, $return_var);
print_r($output);
echo &amp;quot;return&amp;quot; .$return_var;
echo &amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
exec(&amp;quot;ssh -i /var/www/.ssh/id_rsa www-data@10.7.0.17 2&amp;gt;&amp;amp;1&amp;quot;, $output,$return_var);
print_r($output);
echo &amp;quot;return:&amp;quot;.$return_var;
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æ®µç¨‹å¼ï¼Œæœ‰é¡å¤–åŠ ä¸Š 2&amp;gt;&amp;amp;1  é€™æ˜¯å°‡éŒ¯èª¤å°å‡ºä¾†çš„æ–¹å¼&lt;/p&gt;
&lt;blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;ä½¿ç”¨ 2&amp;gt;&amp;amp;1, å‘½ä»¤å°±æœƒè¼¸å‡ºshellåŸ·è¡Œæ™‚çš„éŒ¯èª¤åˆ°$outputè®Šé‡, è¼¸å‡ºè©²è®Šé‡å³å¯åˆ†æã€‚&lt;br /&gt;
å‚™è¨»: execæœ‰3å€‹åƒæ•¸ï¼Œç¬¬ä¸€å€‹æ˜¯è¦åŸ·è¡Œçš„å‘½ä»¤ï¼Œç¬¬äºŒå€‹æ˜¯åƒæ•¸æ˜¯ä¸€å€‹æ•¸çµ„ï¼Œæ•¸çµ„çš„å€¼æ˜¯ç”±ç¬¬ä¸€å€‹å‘½ä»¤åŸ·è¡Œå¾Œç”Ÿæˆçš„ï¼Œç¬¬ä¸‰å€‹åƒæ•¸åŸ·è¡Œçš„ç‹€æ…‹ï¼Œ0è¡¨ç¤ºæˆåŠŸï¼Œå…¶ä»–éƒ½è¡¨ç¤ºå¤±æ•—ã€‚&lt;/p&gt;
&lt;p&gt;(ref. &lt;a href=&quot;https://blog.csdn.net/zy112289/article/details/52671373&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://blog.csdn.net/zy112289/article/details/52671373&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œçµ‚æ–¼æœ‰éŒ¯èª¤è¨Šæ¯äº†ï¼Œé€™å€‹éŒ¯èª¤å»è®“æˆ‘å¾ˆæ…Œ....&lt;br /&gt;
Host key verification failed&lt;/p&gt;
&lt;p&gt;æŸ¥äº†ä¸€ä¸‹æ˜¯é©—è­‰çš„éŒ¯èª¤ï¼Œéƒ½èªªåŸºæœ¬ä¸Šå°±æ˜¯åˆªé™¤ known_host å°±å¥½äº†ã€‚&lt;br /&gt;
ä½†åˆªäº†ä¸»æ©Ÿã€æœ¬æ©Ÿéƒ½ä¸€æ¨£&lt;br /&gt;
(ref. &lt;a href=&quot;https://blog.csdn.net/iteye_19045/article/details/103704924&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://blog.csdn.net/iteye_19045/article/details/103704924&lt;/a&gt;)ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨find å»å°‹æ‰¾æ‰€æœ‰çš„*.pubæª”æ¡ˆï¼Œæ ¹æ“šè£¡é¢çš„å…§å®¹åšä¿®æ”¹ï¼Œä¸¦åœ¨ä¸»æ©ŸåŠæœ¬æ©ŸåŠ ä¸Šæ¬Šé™&lt;br /&gt;
(ref. &lt;a href=&quot;https://xenby.com/b/220-%E6%95%99%E5%AD%B8-%E7%94%A2%E7%94%9Fssh-key%E4%B8%A6%E4%B8%94%E9%80%8F%E9%81%8Ekey%E9%80%B2%E8%A1%8C%E5%85%8D%E5%AF%86%E7%A2%BC%E7%99%BB%E5%85%A5&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://xenby.com/b/220-æ•™å­¸-ç”¢ç”Ÿssh-keyä¸¦ä¸”é€ékeyé€²è¡Œå…å¯†ç¢¼ç™»å…¥&lt;/a&gt;)&lt;br /&gt;
/var/www/.ssh/id_rsaï¼Œæœ‰åƒç…§ä¹‹å‰ä¸»æ©Ÿè¨­å®šï¼Œæ¬Šé™è¨­å®šæˆ www-dataï¼ˆæ­¤æ™‚æˆ‘æ²’æ³¨æ„åˆ°ï¼Œå¦ä¸€å€‹é—œéµé»ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è§£æ±ºæ–¹æ¡ˆ&lt;br /&gt;
1.å…ˆç™»å…¥æœ€é«˜æ¬Šé™&lt;br /&gt;
sudo -i&lt;br /&gt;
2.åˆ‡æ›æˆwww-data&lt;br /&gt;
su www-data&lt;br /&gt;
3.å…ˆé€£ç·š&lt;br /&gt;
ssh 10.7.0.17&lt;/p&gt;
&lt;p&gt;é‡æ¸…åŸå› &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸€é–‹å§‹æˆ‘ä»¥ç‚ºåªè¦æ˜¯ä½¿ç”¨è€…å¸³è™Ÿï¼Œéƒ½æ‡‰è©²æœƒåœ¨ homeåº•ä¸‹æœ‰ä½¿ç”¨è€…çš„è³‡æ–™å¤¾ï¼Œä½†ä¸çŸ¥é“www-dataï¼Œ&lt;br /&gt;
ä¸æœƒå»ºç«‹é€™å€‹è³‡æ–™å¤¾ï¼Œé è¨­æˆªå– /var/www/.sshçš„ id_rsa&lt;/li&gt;
&lt;li&gt;exec å¯èƒ½è®€ä¸åˆ° /var/www/.ssh/id_rsa çš„æª”æ¡ˆ&lt;/li&gt;
&lt;li&gt;sshçš„æ©Ÿåˆ¶æ˜¯é€™æ¨£çš„ï¼Œå‡è¨­Aè¦é€£ç·šåˆ°Bï¼Œè¦é€£ç·šçš„è©±ï¼Œé ˆå°‡ Açš„ .pub é‡‘é‘°ï¼Œè¤‡è£½åˆ°Bçš„ authorized_keysã€‚&lt;br /&gt;
ç¬¬ä¸€æ¬¡é€²å…¥æ™‚ï¼Œæœƒå°‡Aé‡‘é‘°è¨˜æ†¶å†Bçš„known_hostä¸Šï¼Œè®“æ—¥å¾ŒAå¯ä»¥å¿«é€Ÿé€£ç·šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œåªè¦é€£ç·šéä¸€æ¬¡ï¼Œå°±æœƒè¨˜æ†¶ç›®å‰çš„é‡‘é‘°åˆ°ä¸»æ©Ÿä¸Šï¼Œæ—¥å¾Œå°±èƒ½å¤ ç›´æ¥ä½¿ç”¨IPé€£ç·š&lt;br /&gt;
ç¨‹å¼æœƒåƒä»¥ä¸‹ï¼Œä¸å†éœ€è¦-i ï¼Œé è¨­å°±æœƒæŠ“id_rsaä¾†ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
&amp;lt;?php
exec(&amp;quot;scp -r /var/www/html/WebService/upload/tmp/fe8abe8e88fb3a2d88cc17a45a7575b1.png 10.7.0.17:/var/www/html/tmp/ 2&amp;gt;&amp;amp;1&amp;quot;, $output, $return_var);
print_r($output);
echo &amp;quot;return&amp;quot; .$return_var;
echo &amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
exec(&amp;quot;ssh  10.7.0.17 2&amp;gt;&amp;amp;1&amp;quot;, $output,$return_var);
print_r($output);
echo &amp;quot;return:&amp;quot;.$return_var;
?&amp;gt;

&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/php exec ssh ç™¼ç”Ÿ Host key verification failed éŒ¯èª¤/" />
        </entry>
        <entry>
            <title>
                93. shellscriptè§£æ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/93. shellscriptè§£æ/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;#!/bin/bash
F=&amp;quot;proxy-linux-amd64.tar.gz&amp;quot;
set -e
if [ -e /tmp/proxy ]; then
    rm -rf /tmp/proxy
fi
mkdir /tmp/proxy
cd /tmp/proxy

echo -e &amp;quot;&#92;n&amp;gt;&amp;gt;&amp;gt; downloading ... $F&#92;n&amp;quot;
manual=&amp;quot;https://snail.gitee.io/proxy/manual/&amp;quot;
LAST_VERSION=$(curl --silent &amp;quot;https://mirrors.host900.com/https://api.github.com/repos/snail007/goproxy/releases/latest&amp;quot; | grep -Po &#39;&amp;quot;tag_name&amp;quot;:&amp;quot;&#92;K.*?(?=&amp;quot;)&#39;)
wget  -t 1 &amp;quot;https://mirrors.host900.com/https://github.com/snail007/goproxy/releases/download/${LAST_VERSION}/$F&amp;quot;

echo -e &amp;quot;&amp;gt;&amp;gt;&amp;gt; installing ... &#92;n&amp;quot;
# &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#install&quot;&gt;#install&lt;/a&gt; proxy
tar zxvf $F &amp;gt;/dev/null
set +e
killall -9 proxy &amp;gt;/dev/null 2&amp;gt;&amp;amp;1
set -e
cp -f proxy /usr/bin/
chmod +x /usr/bin/proxy
if [ ! -e /etc/proxy ]; then
    mkdir /etc/proxy
    cp blocked /etc/proxy
    cp direct  /etc/proxy
fi
if [ ! -e /etc/proxy/proxy.crt ]; then
    cd /etc/proxy/
    proxy keygen -C proxy &amp;gt;/dev/null 2&amp;gt;&amp;amp;1 
fi
rm -rf /tmp/proxy
version=`proxy --version 2&amp;gt;&amp;amp;1`
echo  -e &amp;quot;&amp;gt;&amp;gt;&amp;gt; install done, thanks for using snail007/goproxy $version&#92;n&amp;quot;
echo  -e &amp;quot;&amp;gt;&amp;gt;&amp;gt; install path /usr/bin/proxy&#92;n&amp;quot;
echo  -e &amp;quot;&amp;gt;&amp;gt;&amp;gt; configuration path /etc/proxy&#92;n&amp;quot;
echo  -e &amp;quot;&amp;gt;&amp;gt;&amp;gt; uninstall just exec : rm /usr/bin/proxy &amp;amp;&amp;amp; rm -rf /etc/proxy&#92;n&amp;quot;
echo  -e &amp;quot;&amp;gt;&amp;gt;&amp;gt; How to using? Please visit : $manual&#92;n&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¹¾å€‹ä¸å¸¸ç”¨åˆ°çš„æŒ‡ä»¤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;tar :è§£å£“ç¸®&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;/dev/null    ï¼Œé€™å€‹åœ¨linuxä¸Šé¢è¡¨ç¤º é»‘æ´ï¼Œä¸åšä»»ä½•è™•ç†ã€‚&lt;br /&gt;
æ‰€ä»¥ tar zxvf &lt;mjx-container class=&quot;MathJax&quot; jax=&quot;SVG&quot; style=&quot;direction: ltr; position: relative;&quot;&gt;&lt;svg style=&quot;overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;30.139ex&quot; height=&quot;2.262ex&quot; role=&quot;img&quot; focusable=&quot;false&quot; viewBox=&quot;0 -750 13321.6 1000&quot; aria-hidden=&quot;true&quot;&gt;&lt;g stroke=&quot;currentColor&quot; fill=&quot;currentColor&quot; stroke-width=&quot;0&quot; transform=&quot;scale(1,-1)&quot;&gt;&lt;g data-mml-node=&quot;math&quot;&gt;&lt;g data-mml-node=&quot;mi&quot;&gt;&lt;path data-c=&quot;1D439&quot; d=&quot;M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mo&quot; transform=&quot;translate(1026.8,0)&quot;&gt;&lt;path data-c=&quot;3E&quot; d=&quot;M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;TeXAtom&quot; data-mjx-texclass=&quot;ORD&quot; transform=&quot;translate(2082.6,0)&quot;&gt;&lt;g data-mml-node=&quot;mo&quot;&gt;&lt;path data-c=&quot;2F&quot; d=&quot;M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(2582.6,0)&quot;&gt;&lt;path data-c=&quot;1D451&quot; d=&quot;M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(3102.6,0)&quot;&gt;&lt;path data-c=&quot;1D452&quot; d=&quot;M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(3568.6,0)&quot;&gt;&lt;path data-c=&quot;1D463&quot; d=&quot;M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;TeXAtom&quot; data-mjx-texclass=&quot;ORD&quot; transform=&quot;translate(4053.6,0)&quot;&gt;&lt;g data-mml-node=&quot;mo&quot;&gt;&lt;path data-c=&quot;2F&quot; d=&quot;M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(4553.6,0)&quot;&gt;&lt;path data-c=&quot;1D45B&quot; d=&quot;M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(5153.6,0)&quot;&gt;&lt;path data-c=&quot;1D462&quot; d=&quot;M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(5725.6,0)&quot;&gt;&lt;path data-c=&quot;1D459&quot; d=&quot;M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(6023.6,0)&quot;&gt;&lt;path data-c=&quot;1D459&quot; d=&quot;M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(6321.6,0)&quot;&gt;&lt;text data-variant=&quot;normal&quot; transform=&quot;scale(1,-1)&quot; font-size=&quot;884px&quot; font-family=&quot;serif&quot;&gt;è¡¨&lt;/text&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(7321.6,0)&quot;&gt;&lt;text data-variant=&quot;normal&quot; transform=&quot;scale(1,-1)&quot; font-size=&quot;884px&quot; font-family=&quot;serif&quot;&gt;ç¤º&lt;/text&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(8321.6,0)&quot;&gt;&lt;text data-variant=&quot;normal&quot; transform=&quot;scale(1,-1)&quot; font-size=&quot;884px&quot; font-family=&quot;serif&quot;&gt;èªª&lt;/text&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(9321.6,0)&quot;&gt;&lt;text data-variant=&quot;italic&quot; transform=&quot;scale(1,-1)&quot; font-size=&quot;884px&quot; font-family=&quot;serif&quot; font-style=&quot;italic&quot;&gt;ï¼Œ&lt;/text&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(10321.6,0)&quot;&gt;&lt;text data-variant=&quot;normal&quot; transform=&quot;scale(1,-1)&quot; font-size=&quot;884px&quot; font-family=&quot;serif&quot;&gt;è§£&lt;/text&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(11321.6,0)&quot;&gt;&lt;text data-variant=&quot;normal&quot; transform=&quot;scale(1,-1)&quot; font-size=&quot;884px&quot; font-family=&quot;serif&quot;&gt;å£“&lt;/text&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mi&quot; transform=&quot;translate(12321.6,0)&quot;&gt;&lt;text data-variant=&quot;normal&quot; transform=&quot;scale(1,-1)&quot; font-size=&quot;884px&quot; font-family=&quot;serif&quot;&gt;ç¸®&lt;/text&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;&lt;mjx-assistive-mml unselectable=&quot;on&quot; display=&quot;inline&quot; style=&quot;top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mrow data-mjx-texclass=&quot;ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow data-mjx-texclass=&quot;ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;è¡¨&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;ç¤º&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;èªª&lt;/mi&gt;&lt;mi&gt;ï¼Œ&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;è§£&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;å£“&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;ç¸®&lt;/mi&gt;&lt;/math&gt;&lt;/mjx-assistive-mml&gt;&lt;/mjx-container&gt;Fçš„æª”æ¡ˆï¼Œä½†ä¸å°å‡ºä»»ä½•çš„è¨Šæ¯&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;set -e  åœ¨ &amp;quot;setÂ -e&amp;quot;ä¹‹å¾Œå‡ºç¾çš„ä»£ç¢¼ï¼Œä¸€æ—¦å‡ºç¾äº†è¿”å›å€¼éé›¶ï¼Œæ•´å€‹è…³æœ¬å°±æœƒç«‹å³é€€å‡ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;set +e åœ¨ &amp;quot;set +e&amp;quot;ä¹‹å¾Œå‡ºç¾çš„ä»£ç¢¼ï¼Œä¸€æ—¦å‡ºç¾äº†è¿”å›å€¼é0ï¼Œè…³æœ¬é‚„æ˜¯æœƒç¹¼çºŒåŸ·è¡Œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;if -e ...åˆ¤æ–·æ­¤ç›®æ¨™æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨å›true&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://www.ltsplus.com/linux/dev-null-2-and-1-meanning&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;â€œ&amp;gt; /dev/null 2&amp;gt;&amp;amp;1â€ çš„æ„æ€&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://blog.csdn.net/xiaofei125145/article/details/39345331&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; å­¸ç¿’ç­†è¨˜ï¼š shell ä¸­çš„ set -e ï¼Œ set +e ç”¨æ³•&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://unix.stackexchange.com/questions/127743/what-does-if-e-name-mean-where-name-is-a-path-to-a-directory&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;What does &amp;quot;if [ -e $name ]&amp;quot; mean? Where $name is a path to a directory&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/93. shellscriptè§£æ/" />
        </entry>
        <entry>
            <title>
                65. Linux command - grep
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/65. Linux command - grep/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;ç”¨é€”&quot; tabindex=&quot;-1&quot;&gt;ç”¨é€”&lt;/h3&gt;
&lt;p&gt;é€šå¸¸æ˜¯ç”¨åœ¨æŸäº›æŒ‡ä»¤å¾Œçš„è™•ç†ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ä»¥å‰çš„è©±ï¼Œé€šå¸¸æ˜¯æŠŠæŒ‡ä»¤åŸ·è¡Œå®Œå¾Œï¼Œ&lt;br /&gt;
å†å°‡å…§å®¹è²¼å»excelåšè™•ç†&lt;/p&gt;
&lt;p&gt;é€™é‚Šä¹Ÿå¾ˆå¸¸ç”¨åˆ°pipe  ï¼Œ&lt;/p&gt;
&lt;p&gt;ç°¡å–®çš„ä¾‹å­ï¼Œè¦æ‰¾å‡ºé€™å€‹è³‡æ–™å¤¾å…§æœ‰å¤šå°‘æª”æ¡ˆã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ls | wc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœƒæœ‰ä¸‰å€‹å€¼ï¼Œ æ›è¡Œæ•¸ã€å­—æ•¸ã€å­—å…ƒæ•¸&lt;/p&gt;
&lt;p&gt;ä½†å¦‚æœè¦é‡å° å‰¯æª”åæ˜¯ jpgçš„è©±ï¼Œ&lt;br /&gt;
å°±å¿…é ˆè¦ç”¨grep åœ¨åšåŠ ç¸½&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ls | grep -c &#92;.jpg
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœåªå–®ç´”åšåŠ ç¸½çš„è©±ï¼Œå¾Œé¢å¿…é ˆçµ¦å€‹è¦åŠ ç¸½çš„æ±è¥¿ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ls | grep -c .
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¾Œé¢çš„åƒæ•¸ç‚º æ­£å‰‡è¡¨ç¤ºæ³•&lt;/p&gt;
&lt;p&gt;æ“·å–æ™‚ï¼Œç„¡è¦–å¤§å°å¯«&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;grep -i &amp;quot;Abc&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.gtwang.org/linux/linux-io-input-output-redirection-operators/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux I/O è¼¸å…¥èˆ‡è¼¸å‡ºé‡æ–°å°å‘ï¼ŒåŸºç¤æ¦‚å¿µæ•™å­¸&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.gtwang.org/linux/linux-wc-command-tutorial-examples/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux ä½¿ç”¨ wc æŒ‡ä»¤è¨ˆç®—å­—æ•¸ã€è¡Œæ•¸æ•™å­¸èˆ‡ç¯„ä¾‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.runoob.com/linux/linux-comm-grep.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux grep å‘½ä»¤&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.gtwang.org/linux/linux-grep-command-tutorial-examples/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux åŒ¹é…æ–‡å­— grep æŒ‡ä»¤ç”¨æ³•æ•™å­¸èˆ‡ç¯„ä¾‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/65. Linux command - grep/" />
        </entry>
        <entry>
            <title>
                63.alpine linux apk ERROR unable to select packages
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/63.alpine linux apk ERROR unable to select packages/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;é€™å¥½åƒæ˜¯åœ¨æŸ¥å•é¡Œçš„æ™‚å€™ç¢°åˆ°çš„ï¼Œ&lt;br /&gt;
å› ç‚ºæŸäº›å¥‡æ€ªçš„ç¶²è·¯å•é¡Œï¼Œ&lt;br /&gt;
å°è‡´å¿…é ˆæŠ“å°åŒ…æŸ¥è©¢ï¼Œç„¶å¾Œåˆå› ç‚ºåœ¨GKEçš„å…§ç¶²ï¼Œ&lt;br /&gt;
ä¸èƒ½åœ¨æœ¬æ©Ÿæ’ˆ.&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;è¦å®‰è£ä¸€å€‹linuxé¡ä¼¼fiddlerçš„è»Ÿé«”ï¼Œ&lt;br /&gt;
æœå°‹alpine liunx çš„ repositoryæœ‰æ‰¾åˆ°ï¼Œ&lt;br /&gt;
ä½†ä¸€ç›´ç„¡æ³•å®‰è£ã€‚&lt;br /&gt;
æœƒå‡ºç¾&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ERROR: unable to select packages:
  mitmproxy (no such package):
    required by: world[mitmproxy]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¾Œä¾†æ‰ç™¼ç¾ï¼Œä»–çš„repositoryæ˜¯ æ¸¬è©¦çš„&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%A7%20Linux/63.fig-1.jpg&quot; alt=&quot;63.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å®‰è£æ™‚ï¼Œè¦æŒ‡å®š repositoryçš„ä½ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apk add mitmproxy --repository=http://dl-cdn.alpinelinux.org/alpine/edge/testing/
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.hasanaltin.com/error-unable-to-select-packages-error-on-alpine-linux/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ERROR: unable to select packages error on Alpine Linux&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/62218240/how-to-add-a-edge-testing-package-to-alpine-linux&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How to add a edge/testing package to Alpine Linux?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://pkgs.alpinelinux.org/packages&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;alpine Linux - package search&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://wiki.alpinelinux.org/wiki/Enable_Community_Repository&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;alpine Linux - Enable Community Repository&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/63.alpine linux apk ERROR unable to select packages/" />
        </entry>
        <entry>
            <title>
                6. ç·¨è­¯ffmpeg ç¡¬é«”åŠ é€Ÿçš„å‘
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/6. ç·¨è­¯ffmpeg ç¡¬é«”åŠ é€Ÿçš„å‘/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘çš„æ¡ˆå­..è¦å¹«åŒä»æffmpegçš„æ©Ÿå™¨ï¼Œå¦‚æœæ²’æœ‰ä½¿ç”¨é¡¯å¡åŠ é€Ÿæ˜¯å€‹å¾ˆæ„‰å¿«çš„äº‹æƒ…&lt;br /&gt;
ä½†æ‰¯åˆ°é¡¯å¡å°±æ»¿æ»¿çš„å‘äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç’°å¢ƒï¼šGKEï¼Œé–‹å•ŸGPUç¯€é»ï¼Œè©³ç´°çš„ä½¿ç”¨æ–¹æ³•å¯åƒè€ƒä¹‹å‰å¯«éçš„ GKEä½¿ç”¨GPU&lt;br /&gt;
ç’°å¢ƒè¨­å®šé‚£éƒ¨åˆ†ï¼Œæœ‰é–‹å·¥å–®å»å•googleï¼Œä»–å€‘æœ‰èªªè¦æ”¹æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;1.ç·¨è­¯æ™‚æ‰¾ä¸åˆ° libnpp&lt;br /&gt;
ERROR: libnpp not found&lt;/p&gt;
&lt;p&gt;å®‰è£ CUDA Toolkit&lt;br /&gt;
ref.&lt;br /&gt;
&lt;a href=&quot;https://www.pugetsystems.com/labs/hpc/How-to-install-CUDA-9-2-on-Ubuntu-18-04-1184/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How to install CUDA 9.2 on Ubuntu 18.04&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://developer.nvidia.com/cuda-downloads?target_os=Linux&amp;amp;target_arch=x86_64&amp;amp;target_distro=Ubuntu&amp;amp;target_version=1804&amp;amp;target_type=runfilelocal&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;CUDA Toolkit 11.2 Downloads&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;wget &lt;a href=&quot;https://developer.download.nvidia.com/compute/cuda/11.2.0/local_installers/cuda_11.2.0_460.27.04_linux.run&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://developer.download.nvidia.com/compute/cuda/11.2.0/local_installers/cuda_11.2.0_460.27.04_linux.run&lt;/a&gt;&lt;br /&gt;
sudo sh cuda_11.2.0_460.27.04_linux.run&lt;/p&gt;
&lt;p&gt;å®‰è£æ™‚ï¼Œä¸è¦å¦å¤–è£é©…å‹•ï¼Œåªè£cuda&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;åƒæ•¸è¨­å®šç·¨ç¢¼å…è¨±png,å‡ºç¾éŒ¯èª¤&lt;br /&gt;
--enable-decoder=png --enable-encoder=png&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Disabled png_decoder because not all dependencies are satisfied: zlib&lt;/p&gt;
&lt;p&gt;éœ€è¦å…ˆå®‰è£ zlib&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://stackoverflow.com/questions/11040847/ffmpeg-png-watermark-issue&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ffmpeg &amp;amp; png watermark issue&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apt-get install zlib1g-dev
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;ç·¨è­¯å®Œæˆå¾Œï¼ŒåŸ·è¡Œç™¼ç”ŸéŒ¯èª¤ï¼Œæ‰¾ä¸åˆ°libnpp&lt;br /&gt;
ffmpeg: error while loading shared libraries: libnppig.so.11: cannot open shared object file: No such file or directory&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://superuser.com/questions/1246209/libnppig-so-8-0-missing-ffmpeg&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;libnppig.so.8.0 Missing FFmpeg&lt;/a&gt;&lt;br /&gt;
è¨­å®šåƒæ•¸&lt;br /&gt;
export LD_LIBRARY_PATH=/usr/local/cuda-11.2/targets/x86_64-linux/lib&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;é©…å‹•ä¸æ”¯æ´&lt;br /&gt;
Driver does not support the required nvenc API version. Required: 11.0 Found: 9.0&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The minimum required Nvidia driver for nvenc is 455.28 or newer&lt;br /&gt;
Error initializing output stream 0:0 -- Error while opening encoder for output stream &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#0&quot;&gt;#0&lt;/a&gt;:0 - maybe incorrect parameters such as bit_rate, rate, width or height&lt;/p&gt;
&lt;p&gt;åˆ‡åˆ° nv-codec-headers çš„è³‡æ–™å¤¾åº•ä¸‹ï¼Œåˆ‡æ›åˆ†æ”¯&lt;br /&gt;
git checkout sdk/9.0&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://blog.csdn.net/qq_23282479/article/details/107579032&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[è¨˜éŒ„ä¸€å€‹bug]é—œæ–¼é‹è¡Œffmpeg with cudaå‡ºéŒ¯å•é¡Œï¼šDriver does not support the required nvenc API version..... [å·²è§£æ±º|è¨˜éŒ„ä¸€å€‹bug]é—œæ–¼é‹è¡Œffmpeg with cudaå‡ºéŒ¯å•é¡Œï¼šDriver does not support the required nvenc API version..... [å·²è§£æ±º]&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;ä½¿ç”¨æµ®æ°´å°è½‰æª”å‡ºç¾éŒ¯èª¤&lt;br /&gt;
Impossible to convert between the formats supported by the filter &#39;graph 0 input from stream 0:0&#39; and the filter &#39;auto_scaler_0&#39;&lt;br /&gt;
Error reinitializing filters!&lt;br /&gt;
Failed to inject frame into filter network: Function not implemented&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¹‹å‰å¯«çš„&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ffmpeg -hwaccel cuvid -y -i 49805.mp4 -i logo.png &#92;
-filter_complex &amp;quot;[0]scale=&#39;min(1280,iw)&#39;:-1[bg];[1][bg]scale2ref=w=&#39;iw*15/100&#39;:h=&#39;iw*15/100*166/446&#39;[wm][vid];[vid][wm]overlay=10:10&amp;quot; &#92;
-c:v h264_nvenc ezio.mp4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœƒç™¼ç”Ÿä¸Šé¢çš„éŒ¯èª¤(auto_scaler_0)ï¼Œä½†åªè¦å°‡ cuvidæ”¹æˆ nvdec å°±æ­£å¸¸äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ffmpeg -hwaccel nvdec -y -i 49805.mp4 -i logo.png &#92;
-filter_complex &amp;quot;[0]scale=&#39;min(1280,iw)&#39;:-1[bg];[1][bg]scale2ref=w=&#39;iw*15/100&#39;:h=&#39;iw*15/100*166/446&#39;[wm][vid];[vid][wm]overlay=10:10&amp;quot; &#92;
-c:v h264_nvenc ezio.mp4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://forums.developer.nvidia.com/t/filter-complex-through-cuda-hevc-cuvid-with-ffmpeg-input-4k-hevc-help-needed/70894/5&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Filter complex through CUDA hevc_cuvid with FFMPEG input 4k hevc, help needed&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;
&lt;p&gt;è½‰ç¢¼æ™‚æŸ¥è©¢ è©³ç´°çš„logè¨˜éŒ„&lt;br /&gt;
åœ¨ffmpegçš„å¾Œé¢åŠ ä¸Š -loglevel debug&lt;br /&gt;
ref. &lt;a href=&quot;http://hk.uwenku.com/question/p-kdwwpile-bz.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;FFMPEGçš„é»˜èªåƒç´ æ ¼å¼å°‡åœ–åƒå †æ£§ç·¨ç¢¼ç‚ºé›»å½±&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ffmpeg å¸¸ç”¨æŒ‡ä»¤&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ffmpeg -hwaccels  æŸ¥è©¢èƒ½ç”¨çš„ç¡¬é«”åŠ é€Ÿ&lt;br /&gt;
ffmpeg -codecs | grep cuvid  æŸ¥çœ‹ffmpegæ”¯æŒçš„cuvidçš„ç·¨ç¢¼æ ¼å¼&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;http://notes.maxwi.com/2017/03/01/ubuntu-compile-ffmpeg-with-cuvid-nvenc-npp/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Ubuntu 16.04ä¸‹ç·¨è­¯ffmpegæ”¯æŒCUDAä¸‹çš„cuvid vnencå’ŒNPP&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://m.yisu.com/zixun/7438.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨GPUç¡¬ä»¶åŠ é€ŸFFmpegè¦–é »è½‰ç¢¼åŠæ’å‘&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä»–åƒè€ƒé …ç›®&lt;br /&gt;
ref. &lt;a href=&quot;https://arnon.dk/matching-sm-architectures-arch-and-gencode-for-various-nvidia-cards/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Matching CUDA arch and CUDA gencode for various NVIDIA architectures&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://blog.csdn.net/qq_29350001/article/details/72625866&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;FFmpegå†å­¸ç¿’ -- Linux å®‰è£èªªæ˜(åƒæ•¸èªªæ˜)&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.jianshu.com/p/eae199a4cce0&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åœ¨k8sä¸­èª¿ç”¨NVIDIA-GPU&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://github.com/nightseas/gpgpu_applications/blob/master/docker/ffmpeg/Dockerfile#L24&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åœ¨k8sä¸­èª¿ç”¨NVIDIA-GPU(Dockerfile)&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/6. ç·¨è­¯ffmpeg ç¡¬é«”åŠ é€Ÿçš„å‘/" />
        </entry>
        <entry>
            <title>
                51.curl ç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/51.curl ç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘åœ¨Kç¶²è·¯æ¶æ§‹ï¼Œæœ‰äº›æ±è¥¿æœ‰é»æ¦‚å¿µäº†ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ™‚ä¾†çœ‹é€™å¼µåœ–çµ‚æ–¼ç­è§£ä¸€é»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%A7%20Linux/51.fig-1.png&quot; alt=&quot;51.fig-1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://blog.cloudflare.com/a-question-of-timing/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;A Question of Timing&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…ˆä¾†çœ‹é€™å¼µåœ–ï¼Œ&lt;br /&gt;
æœ‰å¹¾å€‹é—œéµå­—ç¸®å¯«å¿…é ˆè¦å…ˆçŸ¥é“&lt;br /&gt;
SYN ï¼š åŒæ­¥åºåˆ—è™Ÿ&lt;br /&gt;
ACK ï¼š è¦æ±‚å›æ‡‰&lt;br /&gt;
FIN   ï¼šçµæŸ&lt;br /&gt;
SEQ  ï¼š åºåˆ—è™Ÿ&lt;/p&gt;
&lt;p&gt;é€™é‚Šç°¡å–®è¬›ï¼Œè¦æ›´è©³ç´°çš„å…§å®¹ï¼Œå»ºè­°å»çœ‹ä¸€ä¸‹&lt;a href=&quot;https://notfalse.net/7/three-way-handshake&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;TCP ä¸‰å‘äº¤æ¡ (Three-way Handshake)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨é€™å¼µåœ–è£¡é¢æ²’æœ‰SEQé€™å€‹ï¼Œå› ç‚ºæ²’ç•«å‡ºä¾†ï¼Œåœ¨SYNçš„æ™‚å€™ï¼Œå°±æœƒåŒ…å«SEQåœ¨è£¡é¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;æµç¨‹ç°¡å–®èªªæ˜¯é€™æ¨£çš„ï¼ŒTCPæ˜¯æœ‰é †åºæ€§çš„ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;clinet è©¢å•DNS server ï¼Œç¶²åŸŸèˆ‡IPçš„å°æ‡‰&lt;/li&gt;
&lt;li&gt;client ç™¼å‡ºè«‹æ±‚&lt;/li&gt;
&lt;li&gt;server å›æ‡‰&lt;/li&gt;
&lt;li&gt;client å›æ‡‰ï¼Œæˆ‘çŸ¥é“ä½ å›äº†ã€‚&lt;/li&gt;
&lt;li&gt;server é–‹å§‹å»ºç«‹sslæ†‘è­‰&lt;/li&gt;
&lt;li&gt;client ç™¼å‡ºå…§å®¹è«‹æ±‚&lt;/li&gt;
&lt;li&gt;server å›æ‡‰å…§å®¹&lt;/li&gt;
&lt;li&gt;çµæŸ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¥½äº†ï¼Œå†ä¾†æ‰æ˜¯è¬›curl ï¼Œ&lt;br /&gt;
å…ˆå»ºç«‹ä¸€å€‹ txtæª”ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&#92;n
 # DNS è§£ææ™‚é–“ï¼Œä¹Ÿå°±æ˜¯æŸ¥è©¢åˆ° IP çš„æ™‚é–“&#92;n
 time_namelookup: %{time_namelookup}&#92;n
 # TCP é€£ç·šæ™‚é–“ï¼Œå°±æ˜¯ TCP ä¸‰é …äº¤æ¡çš„æ™‚é–“&#92;n
 time_connect: %{time_connect}&#92;n
 # SSL é€£ç·šçš„æ™‚é–“&#92;n
 time_appconnect: %{time_appconnect}&#92;n
 # å¾é–‹å§‹åˆ°æœ€å¾Œä¸€å€‹è«‹æ±‚çš„æ™‚é–“ï¼Œå¦‚æœç¶²é æœ‰è·³è½‰å°±æœƒæœ‰æ™‚é–“&#92;n
 time_redirect: %{time_redirect}&#92;n
 # å¾é–‹å§‹åˆ°éŸ¿æ‡‰é–‹å§‹çš„æ™‚é–“&#92;n
 time_pretransfer: %{time_pretransfer}&#92;n
 # å¾é–‹å§‹åˆ°éŸ¿æ‡‰é–‹å§‹å‚³è¼¸çš„æ™‚é–“&#92;n
 time_starttransfer: %{time_starttransfer}&#92;n
 ----------&#92;n
 # æ•´é«”æ™‚é–“&#92;n
 time_total: %{time_total}&#92;n
&#92;n

&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;curl -w @curl-format.txt -o /dev/null https://daimom3020.blogspot.com/
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šè¦æ³¨æ„ï¼Œ @curl-format.txt é€™é‚Šä¸èƒ½ä½¿ç”¨è·¯å¾‘æ–¹å¼å»æ‰¾æª”æ¡ˆã€‚å¦‚æœæ€•æ”¹å¤©æ‰¾ä¸åˆ°æª”æ¡ˆçš„è©±ï¼Œ&lt;br /&gt;
curl å¯ä»¥æ”¹æˆä¸‹é¢çš„æŒ‡ä»¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -o /dev/null https://daimom3020.blogspot.com/ -w &amp;quot;                   
 # DNS è§£ææ™‚é–“ï¼Œä¹Ÿå°±æ˜¯æŸ¥è©¢åˆ° IP çš„æ™‚é–“
 time_namelookup: %{time_namelookup}
 # TCP é€£ç·šæ™‚é–“ï¼Œå°±æ˜¯ TCP ä¸‰é …äº¤æ¡çš„æ™‚é–“
 time_connect: %{time_connect}
 # SSL é€£ç·šçš„æ™‚é–“
 time_appconnect: %{time_appconnect}
 # å¾é–‹å§‹åˆ°æœ€å¾Œä¸€å€‹è«‹æ±‚çš„æ™‚é–“ï¼Œå¦‚æœç¶²é æœ‰è·³è½‰å°±æœƒæœ‰æ™‚é–“
 time_redirect: %{time_redirect}
 # å¾é–‹å§‹åˆ°éŸ¿æ‡‰é–‹å§‹çš„æ™‚é–“
 time_pretransfer: %{time_pretransfer}
 # å¾é–‹å§‹åˆ°éŸ¿æ‡‰é–‹å§‹å‚³è¼¸çš„æ™‚é–“
 time_starttransfer: %{time_starttransfer}
 ----------
 # æ•´é«”æ™‚é–“
 time_total: %{time_total}
&#92;n&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­é…ä¸Šæ–¹çš„åœ–ç‰‡ä¾†çœ‹ï¼Œ&lt;br /&gt;
é€™é‚Šé¡¯ç¤ºçš„æ™‚é–“æ˜¯ç´¯åŠ çš„ï¼Œå¦‚æœè¦ç®—å‡ºå€é–“çš„æ™‚é–“ï¼Œ&lt;br /&gt;
éœ€è¦è‡ªè¡Œåšç›¸æ¸›ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œ&lt;br /&gt;
è¦çŸ¥é“serverè™•ç†è³‡æ–™çš„æ™‚é–“å¤šé•·ï¼Œ&lt;br /&gt;
å¯ä½¿ç”¨ time_starttransfer - time_pretransfer ï¼Œ&lt;br /&gt;
å°±å¯å¾—çŸ¥serverè™•ç†è³‡æ–™çš„æ™‚é–“ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.clarence.tw/2019/05/01/curl-details-tcp-ssl-connection-time/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;CURL è©³ç´°è³‡æ–™åŒ…å« TCP èˆ‡ SSL é€£ç·šæ™‚é–“&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/weifangan/article/details/80741981&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;CURL -w åƒæ•¸è©³è§£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://man.linuxde.net/curl&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;curlå‘½ä»¤&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.howtogeek.com/439199/15-special-characters-you-need-to-know-for-bash/&quot; title=&quot;15 Special Characters You Need to Know for Bash&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;15 Special Characters You Need to Know for Bash&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://begin4learn.gitbooks.io/begin-to-learn-linux/content/Command/Command_T_symbol.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Command symbol ç¬¦è™Ÿ_Linux&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.tencent.com/developer/article/2147101?from=15425&amp;amp;areaSource=102001.2&amp;amp;traceId=yoo0SjU9fE6zKa1DI8qyZ&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;curl æ‰€æœ‰åƒæ•¸ä»‹ç´¹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;é©—è­‰ç¶²ç«™æ˜¯å¦ç‚ºhttp2 ï¼Œ&lt;br /&gt;
ç°¡å–®èªªæ˜&lt;br /&gt;
-v  é¡¯ç¤ºå‘¼å«çš„æ­¥é©Ÿ&lt;br /&gt;
-s Silentæ¨¡å¼ã€‚ä¸è¼¸å‡ºä»»å‹™å…§å®¹&lt;br /&gt;
-o æŒ‡å®šè¼¸å‡ºç›®éŒ„&lt;/p&gt;
&lt;p&gt;åªç”¨ -s çš„è©±ï¼Œé‚„æ˜¯æœƒè¼¸å‡ºå…§å®¹ã€‚&lt;br /&gt;
åªç”¨ -oçš„è©±ï¼Œä¸æœƒè¼¸å‡ºå…§å®¹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;	curl https://www.cloudflare.com  --http2 -vso /dev/null
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ˜¯çš„è©±ï¼Œæœƒå‡ºç¾ using http2&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%A7%20Linux/51.fig-2.jpg&quot; alt=&quot;51.fig-2.jpg&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/51.curl ç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                49.npm èˆ‡ yarn æ¯”è¼ƒ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/49.npm èˆ‡ yarn æ¯”è¼ƒ/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å›å‚³å€¼&lt;/th&gt;
&lt;th&gt;æ–¹æ³•åç¨±&lt;/th&gt;
&lt;th&gt;èªªæ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;npm install&lt;/td&gt;
&lt;td&gt;yarn install&lt;/td&gt;
&lt;td&gt;å®‰è£ json.package æ‰€æœ‰ä¾è³´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;npm install [package]&lt;/td&gt;
&lt;td&gt;(N/A)&lt;/td&gt;
&lt;td&gt;Yarnä¸æ”¯æ´ç›´æ¥å®‰è£å¥—ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;npm install --save [package]&lt;/td&gt;
&lt;td&gt;yarn add [paakage]&lt;/td&gt;
&lt;td&gt;å„²å­˜åœ¨ json.packageä¸­çš„dependencies&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;npm install --save-dev [package]&lt;/td&gt;
&lt;td&gt;yarn add [paakage] --dev&lt;/td&gt;
&lt;td&gt;å„²å­˜åœ¨ json.packageä¸­çš„devDependencies&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;npm install --global [package]&lt;/td&gt;
&lt;td&gt;yarn global add [package]&lt;/td&gt;
&lt;td&gt;å®‰è£åœ¨é›»è…¦å…¨åŸŸä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;npm uninstall [package]&lt;/td&gt;
&lt;td&gt;(N/A)&lt;/td&gt;
&lt;td&gt;Yarnä¸æ”¯æ´ç›´æ¥å®‰è£èˆ‡ç§»é™¤å¥—ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;npm uninstall --save [package]&lt;/td&gt;
&lt;td&gt;yarn remove [package]&lt;/td&gt;
&lt;td&gt;ç§»é™¤dependenciesæŸå¥—ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;npm uninstall --save-dev [package]&lt;/td&gt;
&lt;td&gt;yarn remove [package]&lt;/td&gt;
&lt;td&gt;ç§»é™¤devDependenciesæŸå¥—ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;rm -rf node_modules &amp;amp;&amp;amp; npm install&lt;/td&gt;
&lt;td&gt;yarn upgrade&lt;/td&gt;
&lt;td&gt;æ›´æ–°node_modules&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10191745&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç”¨Yarnå–ä»£npmåŠ é€Ÿé–‹ç™¼&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/49.npm èˆ‡ yarn æ¯”è¼ƒ/" />
        </entry>
        <entry>
            <title>
                48.SSHç„¡æ³•é€£ç·šï¼ŒREMOTE HOST IDENTIFICATION HAS CHANGED
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/48.SSHç„¡æ³•é€£ç·šï¼ŒREMOTE HOST IDENTIFICATION HAS CHANGED/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å‡ºç¾ä¸‹åœ–çš„éŒ¯èª¤ï¼Œ&lt;br /&gt;
[[48.fig-1.jpg]]&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä¸€èˆ¬éƒ½æ˜¯ç”¨æ–‡å­—ç·¨è¼¯å™¨é–‹å•Ÿ /root/.ssh/known_hosts&lt;br /&gt;
å°‡èˆŠ10.7.10.48 çš„keyåˆªé™¤ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½†é€™æ¬¡ç¢°åˆ°æ²’æœ‰æ¬Šé™ï¼Œåªèƒ½ä¸‹æŒ‡ä»¤åˆªé™¤äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;ssh-keygen -R 10.7.10.48
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/48.SSHç„¡æ³•é€£ç·šï¼ŒREMOTE HOST IDENTIFICATION HAS CHANGED/" />
        </entry>
        <entry>
            <title>
                33. centos 7å®‰è£redis æ”¹port
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/33. centos 7å®‰è£redis æ”¹port/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æœ€ç°¡å–®åœ°å®‰è£æ–¹å¼ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;yum install redis
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;
&lt;p&gt;ç·¨è¼¯ /etc/redis.conf&lt;br /&gt;
æ‰¾åˆ° port 6379 ï¼Œå°‡å®ƒæ”¹ç‚º port 8090&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é‡å•Ÿæœå‹™  sudo systemctl restart redis&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç™¼ç¾æœå‹™ç„¡æ³•å•Ÿå‹•(fig.1)ï¼ŒæŸ¥log(fig.2)ï¼Œç™¼ç¾æ²’æœ‰æ¬Šé™ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;[[33.fig-1.jpg]]&lt;/p&gt;
&lt;p&gt;[[33.fig-2.jpg]]&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;selinuxçš„å•é¡Œï¼Œè¦éº»é—œæ‰ï¼Œè¦éº»æ–°å¢port&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sudo: semanage: command not found

å®‰è£
yum install policycoreutils-python
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾ŒåŸ·è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo semanage port -a -t redis_port_t -p tcp 8090
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/53009361/redis-creating-server-tcp-listening-socket-6388-bind-permission-denied&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Redis: Creating Server TCP listening socket *:6388: bind: Permission denied&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.opencli.com/linux/fix-semanage-command-not-found&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è§£æ±º semanage command not found&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;é‡é–‹redisã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sudo systemctl restart redis
sudo systemctl status redis
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://blog.yowko.com/install-redis-error/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®‰è£ Redis æ™‚é‡åˆ°çš„éŒ¯èª¤æ’é™¤&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/33. centos 7å®‰è£redis æ”¹port/" />
        </entry>
        <entry>
            <title>
                173. Linuxæ®­å±ç¨‹å¼
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/173. Linuxæ®­å±ç¨‹å¼/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;çœ‹æ–‡ç« çœ‹åˆ°ä¸€ç¯‡è©³è§£ï¼ŒTOPæŒ‡ä»¤ï¼Œé‡æ–°æŠŠlinuxçš„topç†è§£ä¸€éã€‚&lt;br /&gt;
ç„¶å¾Œçœ‹åˆ°ä¸€å€‹æ€ªåè© zombie ï¼Œé€™æ˜¯æˆ‘ç†è§£çš„æ„æ€å—ï¼ï¼Ÿ&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç°¡å–®èªªæœ‰é»åƒæ˜¯windows çš„æ‡‰ç”¨ç¨‹å¼ï¼Œè¦æ­»ä¸æ­»ï¼Œå¡åœ¨é‚£é‚Šç•¶æ‰çš„æƒ…æ³ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸€å€‹processéƒ½æœƒæœ‰ä¸€å€‹parent processï¼Œ&lt;br /&gt;
ç•¶child processè™•æ–¼çµæŸèˆ‡å°šæœªçµæŸä¸­é–“æ™‚æœƒç™¼ç”Ÿã€‚&lt;br /&gt;
è©³ç´°ï¼Œè«‹åƒè€ƒ&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10302966&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Day 17: æ®­å±èˆ‡å­¤å…’&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;top é¡¯ç¤ºPPID&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŸ·è¡Œ top&lt;/li&gt;
&lt;li&gt;æŒ‰ä¸‹&lt;code&gt;f&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é¸æ“‡éœ€è¦çš„æ¬„ä½ï¼ŒæŒ‰&lt;code&gt;d&lt;/code&gt; æˆ– &lt;code&gt;space&lt;/code&gt; é¸æ“‡&lt;/li&gt;
&lt;li&gt;æŒ‰ä¸‹&lt;code&gt;â†’&lt;/code&gt; éµç›¤çš„æ–¹å‘éµï¼Œç„¶å¾ŒæŒ‰&lt;code&gt;ä¸Šä¸‹éµ&lt;/code&gt;å¯ä»¥èª¿æ•´é †åº&lt;/li&gt;
&lt;li&gt;æŒ‰&lt;code&gt;q&lt;/code&gt;é›¢é–‹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%A7%20Linux/173.fig-1.jpg&quot; alt=&quot;173.fig-1.jpg&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/173. Linuxæ®­å±ç¨‹å¼/" />
        </entry>
        <entry>
            <title>
                171. linux topæŒ‡ä»¤è©³è§£
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/171. linux topæŒ‡ä»¤è©³è§£/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å”¸&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å”¸&lt;/h1&gt;
&lt;p&gt;linuxå¸¸ç”¨ top ï¼Œçœ‹ç›®å‰osè£é¢å“ªå€‹ç¨‹å¼è³‡æºåƒæ¯”è¼ƒå…‡ï¼Œ&lt;br /&gt;
ä½†æ¯æ¬¡éƒ½æ˜¯åªçœ‹å›ºå®šå¹¾å€‹æ¬„ä½ï¼Œ&lt;br /&gt;
æœ€è¿‘å‰›å¥½å–µåˆ°å®Œæ•´çš„èªªæ˜ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä¸€èˆ¬topæœƒé•·é€™æ¨£&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%A7%20Linux/171.fig-1.jpg&quot; alt=&quot;171.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;ç¬¬ä¸€è¡Œ&quot; tabindex=&quot;-1&quot;&gt;ç¬¬ä¸€è¡Œ&lt;/h3&gt;
&lt;p&gt;top&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;15:40:37&lt;/th&gt;
&lt;th&gt;ç›®å‰æ™‚é–“&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;up 6 days&lt;/td&gt;
&lt;td&gt;å·²é–‹æ©Ÿæ™‚é–“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3 users&lt;/td&gt;
&lt;td&gt;ç›®å‰ç™»å…¥çš„ä½¿ç”¨è€…æ•¸é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;load average&lt;/td&gt;
&lt;td&gt;1 min,5 min,15minçš„ç³»çµ±ç“¶å‡è² è¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;ç¬¬äºŒè¡Œ&quot; tabindex=&quot;-1&quot;&gt;ç¬¬äºŒè¡Œ&lt;/h3&gt;
&lt;p&gt;Tasks&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;419 total&lt;/th&gt;
&lt;th&gt;ç¸½è™•ç†ç¨‹åº&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1 running&lt;/td&gt;
&lt;td&gt;åŸ·è¡Œä¸­çš„ç¨‹å¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;418 sleeping&lt;/td&gt;
&lt;td&gt;ç¡çœ ä¸­çš„ç¨‹å¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0 stopped&lt;/td&gt;
&lt;td&gt;åœæ­¢ä¸­çš„ç¨‹å¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0 zombie&lt;/td&gt;
&lt;td&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/173.%20Linux%E6%AE%AD%E5%B1%8D%E7%A8%8B%E5%BC%8F/&quot;&gt;173. Linuxæ®­å±ç¨‹å¼&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;ç¬¬ä¸‰è¡Œ&quot; tabindex=&quot;-1&quot;&gt;ç¬¬ä¸‰è¡Œ&lt;/h3&gt;
&lt;p&gt;%Cpu(s):&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;0.2 us&lt;/th&gt;
&lt;th&gt;ä½¿ç”¨è€…ä½”ç”¨çš„CPU&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0.1 sy&lt;/td&gt;
&lt;td&gt;æ ¸å¿ƒç©ºé–“ä½”ç”¨çš„CPU&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.0 ni&lt;/td&gt;
&lt;td&gt;æ”¹è®Šéå„ªå…ˆé †åºçš„ç¨‹å¼ä½”ç”¨çš„CPU&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;99.7 id&lt;/td&gt;
&lt;td&gt;é–’ç½®çš„CPU&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.0 wa&lt;/td&gt;
&lt;td&gt;IOç­‰å¾…ä½”ç”¨çš„CPU&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.0 hi&lt;/td&gt;
&lt;td&gt;ç¡¬é«”ä¸­æ–·(Hardware IRQ)ä½”ç”¨Cçš„PU&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.0 si&lt;/td&gt;
&lt;td&gt;è»Ÿé«”ä¸­æ–·(Software IRQ)ä½”ç”¨çš„CPU&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.0 st&lt;/td&gt;
&lt;td&gt;å·å–æ™‚é–“(Steal Time)ä½”ç”¨çš„CPU&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Hardware IRQ : ç¡¬é«”ä¸­æ–·æ˜¯å¾å¤–éƒ¨è£ç½®ï¼ˆå¦‚ç£ç¢Ÿæ§è£½å™¨ã€ç¶²è·¯å¡ã€éµç›¤æ§è£½å™¨ã€å¤–éƒ¨è¨ˆæ™‚å™¨ã€ç¡¬é«”æ„Ÿæ‡‰å™¨ç­‰ï¼‰ç™¼é€åˆ°è™•ç†å™¨çš„é›»å­è­¦å ±è¨Šè™Ÿ&lt;/p&gt;
&lt;p&gt;ref .  &lt;a href=&quot;https://blog.ycrash.io/2020/11/28/hardware-interrupt-time-hi-time-in-top/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Hardware Interrupt time â€“ â€˜hiâ€™ time in top&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Software IROï¼šè»Ÿé«”ä¸­æ–·å¾ç¨‹å¼å¼•ç™¼çš„ä¸­æ–·è¡Œçˆ²&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://blog.ycrash.io/2020/11/28/software-interrupt-time-si-time-in-top/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Software Interrupt time â€“ â€˜siâ€™ time in top&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Steal CPU Time ï¼šè™›æ“¬æ©Ÿå™¨çš„CPUåœ¨è™›æ“¬æ©Ÿç›£è­·ç¨‹å¼æ­£åœ¨è™•ç†å…¶ä»–è™›æ“¬æ©Ÿå™¨æ™‚ï¼Œç­‰å¾…å¯¦éš›CPUçš„æ™‚é–“ç™¾åˆ†æ¯”ã€‚&lt;/p&gt;
&lt;p&gt;ref.  &lt;a href=&quot;https://blog.ycrash.io/2020/11/28/steal-cpu-time-st-time-in-top/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Steal CPU time â€“ â€˜stâ€™ time in top&lt;br /&gt;
ç«Šå– CPU æ™‚é–“ â€“ é ‚éƒ¨çš„ã€Œstã€æ™‚é–“&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;ç¬¬å››è¡Œ&quot; tabindex=&quot;-1&quot;&gt;ç¬¬å››è¡Œ&lt;/h3&gt;
&lt;p&gt;MiB Mem&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;64207.4 total&lt;/th&gt;
&lt;th&gt;ç‰©ç†è¨˜æ†¶é«”ç¸½é‡&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;7866.7 free&lt;/td&gt;
&lt;td&gt;å¯ç”¨è¨˜æ†¶é«”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16649.0 used&lt;/td&gt;
&lt;td&gt;å·²ä½¿ç”¨è¨˜æ†¶é«”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;39691.6 buff/cache&lt;/td&gt;
&lt;td&gt;ç·©å­˜çš„è¨˜æ†¶é«”é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;ç¬¬äº”è¡Œ&quot; tabindex=&quot;-1&quot;&gt;ç¬¬äº”è¡Œ&lt;/h3&gt;
&lt;p&gt;MiB Swap&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;2048.0 total&lt;/th&gt;
&lt;th&gt;è™›æ“¬è¨˜æ†¶é«”ç¸½é‡&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2048.0 free&lt;/td&gt;
&lt;td&gt;å¯ç”¨è™›æ“¬è¨˜æ†¶é«”ç¸½é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.0 used&lt;/td&gt;
&lt;td&gt;å·²ä½¿ç”¨è™›æ“¬è¨˜æ†¶é«”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;46765.3.0 avail Mem&lt;/td&gt;
&lt;td&gt;å¯ç”¨è¨˜æ†¶é«”[free+(buff/cache)]&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è£œå…… Linuxçš„è¨ˆç®—æ–¹å¼è·Ÿwindowsçš„ä¸ä¸€æ¨£ï¼Œ&lt;br /&gt;
ç•¶ ã€å¯ä»¥è¢«æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨ï¼Œä½†è¢«æš«æ™‚å€Ÿå»åšåˆ¥çš„ç”¨é€”ã€ï¼Œ&lt;br /&gt;
åœ¨Linuxè£é¢ä¹Ÿæ˜¯é¡¯ç¤ºç‚ºusedã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¦æŸ¥ç›®å‰è¨˜æ†¶é«”ä½¿ç”¨é‡å¯ä»¥æ”¹ç”¨&lt;code&gt;htop&lt;/code&gt;æˆ–&lt;code&gt;free -m&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ref . &lt;a href=&quot;https://blog.gtwang.org/linux/linux-cache-memory-linux/&quot; title=&quot;Linux çš„è¨˜æ†¶é«”å¿«å–ï¼ˆCache Memoryï¼‰åŠŸèƒ½ï¼šLinux ç³»çµ±æŠŠè¨˜æ†¶é«”ç”¨å…‰äº†ï¼Ÿ&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux çš„è¨˜æ†¶é«”å¿«å–ï¼ˆCache Memoryï¼‰åŠŸèƒ½ï¼šLinux ç³»çµ±æŠŠè¨˜æ†¶é«”ç”¨å…‰äº†ï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;ç¬¬ä¸ƒè¡Œ&quot; tabindex=&quot;-1&quot;&gt;ç¬¬ä¸ƒè¡Œ&lt;/h3&gt;
&lt;p&gt;é è¨­çš„æ¬„ä½åç¨±&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;PID&lt;/code&gt;: åŸ·è¡Œä»»å‹™çš„ Process ID&lt;/li&gt;
&lt;li&gt;&lt;code&gt;USER&lt;/code&gt;: åŸ·è¡Œä»»å‹™çš„ä½¿ç”¨è€…åç¨±&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PR&lt;/code&gt;: ä»»å‹™çš„å„ªå…ˆåº¦ (Priority)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NI&lt;/code&gt;: ä»»å‹™çš„ Nice Valueï¼Œè² çš„å€¼ä»£è¡¨å„ªå…ˆåº¦é«˜ï¼Œæ­£çš„å€¼ä»£è¡¨å„ªå…ˆåº¦ä½&lt;/li&gt;
&lt;li&gt;&lt;code&gt;VIRT&lt;/code&gt;: ç¸½å…±ç”¨åˆ°å¤šå°‘ kB è™›æ“¬è¨˜æ†¶é«” (Virtual Memory)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RES&lt;/code&gt;: å¯¦é«”è¨˜æ†¶é«” (Resident Size) å¤§å° kB&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SHR&lt;/code&gt;: ç¸½å…±ç”¨åˆ°å¤šå°‘ kB çš„å…±äº«è¨˜æ†¶é«” (Shared Memory)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;S&lt;/code&gt;: ç‹€æ…‹ (Status)
&lt;ul&gt;
&lt;li&gt;R ä»£è¡¨åŸ·è¡Œä¸­&lt;/li&gt;
&lt;li&gt;D ä»£è¡¨ä¸å¯ä¸­æ–·ç¡çœ  (ä¸å¯è¢« signal æ‰“æ–·é€šå¸¸åœ¨ç­‰ I/O)&lt;/li&gt;
&lt;li&gt;S ä»£è¡¨ç¡çœ  (å¯è¢«å–šé†’)&lt;/li&gt;
&lt;li&gt;T ä¸­æ–·ä¸­æˆ–åœæ­¢ï¼Œå¯èƒ½æ˜¯è¢«Â &lt;code&gt;SIGSTOP&lt;/code&gt;Â æˆ–Â &lt;code&gt;SIGTSTP&lt;/code&gt;Â åœæ­¢ï¼Œæˆ–æ˜¯è¢« degubber ä¸­æ–· (ptrace)&lt;/li&gt;
&lt;li&gt;Z ä»£è¡¨æ®­å±ï¼Œé€šå¸¸ç™¼ç”Ÿåœ¨ Child å·²ç¶“åŸ·è¡Œå®Œï¼Œç­‰å¾… Parent çµæŸæˆ–å›æ”¶&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;%CPU&lt;/code&gt;: ä½”ç”¨åˆ°å¤šå°‘ CPU %ï¼Œæ³¨æ„åˆ°ä¸€å€‹æ ¸å¿ƒæ˜¯ 100%ï¼Œæ‰€ä»¥å¤šæ ¸å¿ƒæ˜¯å¯ä»¥æ“é 100% çš„&lt;/li&gt;
&lt;li&gt;&lt;code&gt;%MEM&lt;/code&gt;: ä½”ç”¨åˆ°å¤šå°‘å…¨éƒ¨è¨˜æ†¶é«”å¤šå°‘æ¯”ä¾‹&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TIME+&lt;/code&gt;: ç¨‹å¼å·²ç¶“åŸ·è¡Œå¤šå°‘æ™‚é–“ï¼Œå–®ä½1/100ç§’&lt;/li&gt;
&lt;li&gt;&lt;code&gt;COMMAND&lt;/code&gt;: ä»»å‹™çš„æŒ‡ä»¤åç¨±&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;éé è¨­çš„æ¬„ä½åç¨±ï¼Œ&lt;br /&gt;
å«å‡ºä¾†çš„æ–¹å¼ç‚º &lt;code&gt;f&lt;/code&gt; -&amp;gt; é¸æ“‡æ¬„ä½(&lt;code&gt;space&lt;/code&gt;)  -&amp;gt; é›¢é–‹(&lt;code&gt;q&lt;/code&gt;)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;PPID&lt;/code&gt;: åŸ·è¡Œä»»å‹™çš„ Process IDçš„çˆ¶è¦ª ï¼ˆåŸå› åƒè€ƒ&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/173.%20Linux%E6%AE%AD%E5%B1%8D%E7%A8%8B%E5%BC%8F/&quot;&gt;173. Linuxæ®­å±ç¨‹å¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;UID&lt;/code&gt;:åŸ·è¡Œç¨‹å¼çš„ä½¿ç”¨è€…ID&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RUID&lt;/code&gt;: çœŸæ­£çš„ä½¿ç”¨è€…ID&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RUSER&lt;/code&gt;: çœŸæ­£çš„ä½¿ç”¨è€…&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SUID&lt;/code&gt;: æš«å­˜ä½¿ç”¨è€…ID&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SUSER&lt;/code&gt;: æš«å­˜ä½¿ç”¨è€…åç¨±&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GID&lt;/code&gt;: ç¾¤çµ„ID&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GROUP&lt;/code&gt;: ç¾¤çµ„åç¨±&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PGRP&lt;/code&gt;: Process Group Id&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TTY&lt;/code&gt;: æ§åˆ¶çµ‚ç«¯çš„åç¨±&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TPGID&lt;/code&gt;: Tty Process Group Id&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SID&lt;/code&gt;:  session ID ï¼ˆä¸€å€‹loginè£é¢çš„æ‰€æœ‰process)ï¼Œæœ‰é»åƒ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/134.%20%E9%97%9C%E9%96%89ssh%E9%80%A3%E7%B7%9A%E5%BE%8C%EF%BC%8C%E4%BB%8D%E5%8F%AF%E5%9F%B7%E8%A1%8C%E7%A8%8B%E5%BC%8F/&quot;&gt;134. é—œé–‰sshé€£ç·šå¾Œï¼Œä»å¯åŸ·è¡Œç¨‹å¼&lt;/a&gt;è£é¢çš„screen&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nTH&lt;/code&gt;:  èˆ‡ä¸€å€‹é€²ç¨‹é—œè¯çš„åŸ·è¡Œç·’æ•¸é‡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;p&lt;/code&gt;: æœ€å¾Œä½¿ç”¨çš„CPU&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TIME&lt;/code&gt;: ç¨‹å¼å·²ç¶“åŸ·è¡Œå¤šå°‘æ™‚é–“ï¼Œå–®ä½ 1ç§’&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SWAP&lt;/code&gt;: ç•¶å‰è¢«ç§»åˆ°äº¤æ›å€çš„è¨˜æ†¶é«”å¤§å°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CODE&lt;/code&gt;: ç›®å‰ç”¨æ–¼åŸ·è¡Œç¨‹å¼ç¢¼ç¢¼çš„ç‰©ç†è¨˜æ†¶é«”&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DATA&lt;/code&gt;:ä¸€å€‹ç¨‹å¼ä¿ç•™çš„ç§æœ‰è¨˜æ†¶é«”é‡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nMaj&lt;/code&gt;:å·²ç™¼ç”Ÿçš„ä¸»è¦åˆ†é éŒ¯èª¤æ¬¡æ•¸&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nMin&lt;/code&gt;:å·²ç™¼ç”Ÿçš„æ¬¡è¦åˆ†é éŒ¯èª¤æ¬¡æ•¸&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nDRT&lt;/code&gt;: ï¼ˆå·²æ£„ç”¨ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WCHAN&lt;/code&gt;: é¡¯ç¤ºäº†æ¯å€‹é€²ç¨‹æˆ–åŸ·è¡Œç·’ç›®å‰æ­£åœ¨ç­‰å¾…çš„å…§æ ¸å‡½æ•¸æˆ–äº‹ä»¶çš„åç¨±æˆ–æŒ‡é‡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Flags&lt;/code&gt;:ç›®å‰ä»»å‹™çš„æ’ç¨‹æ¨™èªŒï¼Œä»¥åå…­é€²è£½è¡¨ç¤ºï¼Œä¸¦ä¸”å»æ‰äº†é›¶&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CGROUPS&lt;/code&gt;:è¡¨ç¤ºç¨‹å¼æ‰€åœ¨çš„æ§åˆ¶çµ„çš„åç¨±&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SUPGIDS&lt;/code&gt;:è¡¨ç¤ºé€²ç¨‹æ‰€åœ¨çš„çˆ¶æ§åˆ¶çµ„çš„ ID&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SUPGRPS&lt;/code&gt;:è¡¨ç¤ºç¨‹å¼æ‰€åœ¨çš„çˆ¶æ§åˆ¶çµ„çš„åç¨±&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TGID&lt;/code&gt;:  Thread Group Id&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OOMa&lt;/code&gt;: ç”¨ä¾†èª¿æ•´æ¯å€‹é€²ç¨‹çš„ OOMS å€¼ï¼Œä»¥å½±éŸ¿å…¶è¢«çµ‚æ­¢çš„æ©Ÿç‡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OOMs&lt;/code&gt;: è¨˜æ†¶é«”åˆ†æ•¸ï¼Œè©•ä¼°é€²ç¨‹æˆ–ä»»å‹™å°å…§å­˜éœ€æ±‚çš„æ•¸å€¼&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ENVIRON&lt;/code&gt;: é¡¯ç¤ºæ‰€æœ‰çš„ç’°å¢ƒè®Šæ•¸&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vMj&lt;/code&gt;: ä¸»è¦åˆ†é éŒ¯èª¤è¨ˆæ•¸å¢é‡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vMn&lt;/code&gt;: æ¬¡è¦åˆ†é éŒ¯èª¤è¨ˆæ•¸å¢é‡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;USED&lt;/code&gt;: è¨˜æ†¶é«” Res+Swap Size&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nsIPC&lt;/code&gt;: IPC å‘½åç©ºé–“ï¼Œç”¨æ–¼éš”é›¢é€²ç¨‹é–“é€šè¨Šè³‡æºï¼Œç¢ºä¿å®ƒå€‘åœ¨ä¸åŒçš„å‘½åç©ºé–“ä¸­äº’ä¸å¹²æ“¾&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nsMNT&lt;/code&gt;: MNT å‘½åç©ºé–“ï¼Œç”¨æ–¼éš”é›¢å’Œç®¡ç†ä¸åŒå‘½åç©ºé–“ä¸­çš„æª”æ¡ˆç³»çµ±æ›è¼‰é»è³‡è¨Š&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nsNET&lt;/code&gt;: NET å‘½åç©ºé–“ï¼Œç”¨æ–¼éš”é›¢å’Œç®¡ç†ä¸åŒå‘½åç©ºé–“ä¸­çš„ç¶²çµ¡è³‡æºå’Œç¶²çµ¡è¨­ç½®&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nsPID&lt;/code&gt;: PID å‘½åç©ºé–“ï¼Œç”¨æ–¼éš”é›¢ä¸åŒå‘½åç©ºé–“ä¸­çš„é€²ç¨‹è­˜åˆ¥è™Ÿï¼Œç¢ºä¿å®ƒå€‘åœ¨å„è‡ªçš„å‘½åç©ºé–“ä¸­å…·æœ‰å”¯ä¸€çš„ PID&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nsUSER&lt;/code&gt;:USER å‘½åç©ºé–“ï¼Œç”¨æ–¼éš”é›¢ä¸åŒå‘½åç©ºé–“ä¸­çš„ç”¨æˆ¶å’Œç”¨æˆ¶è¨±å¯æ¬Šï¼Œç¢ºä¿å®ƒå€‘åœ¨å„è‡ªçš„å‘½åç©ºé–“ä¸­å…·æœ‰ç¨ç«‹çš„ç”¨æˆ¶èº«ä»½å’Œæ¬Šé™&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nsUTS&lt;/code&gt;:UTS (UNIX Time-sharing System)å‘½åç©ºé–“ï¼Œç”¨æ–¼éš”é›¢ä¸åŒå‘½åç©ºé–“ä¸­çš„ä¸»æ©Ÿåå’ŒåŸŸåè¨­ç½®ï¼Œç¢ºä¿å®ƒå€‘åœ¨å„è‡ªçš„å‘½åç©ºé–“ä¸­å…·æœ‰ç¨ç«‹çš„çµ„æ…‹&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LXC&lt;/code&gt;: LXC(Linux Containers)å®¹å™¨åç¨±&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RSan&lt;/code&gt;: ä»£è¡¨ä¸€å€‹é€²ç¨‹æˆ–ä»»å‹™æ­£åœ¨ä½¿ç”¨çš„åŒ¿åå…§å­˜çš„å¤§å°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RSfd&lt;/code&gt;: ä»£è¡¨ä¸€å€‹é€²ç¨‹æˆ–ä»»å‹™æ­£åœ¨ä½¿ç”¨çš„æª”æ¡ˆå…§å­˜çš„å¤§å°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RSlk&lt;/code&gt;: ä»£è¡¨ä¸€å€‹é€²ç¨‹æˆ–ä»»å‹™æ­£åœ¨ä½¿ç”¨çš„å·²é–å®šé é¢çš„å¤§å°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RSsh&lt;/code&gt;: ä»£è¡¨ä¸€å€‹é€²ç¨‹æˆ–ä»»å‹™æ­£åœ¨ä½¿ç”¨çš„å…±äº«å…§å­˜çš„å¤§å°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CGNAME&lt;/code&gt;: æ§åˆ¶çµ„åç¨±ï¼Œç”¨æ–¼æ¨™è­˜å’Œç®¡ç†ç›¸é—œçš„é€²ç¨‹æˆ–è³‡æºçš„åˆ†çµ„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NU&lt;/code&gt;: &amp;quot;æœ€å¾Œå·²çŸ¥çš„ NUMA ç¯€é»&amp;quot;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://xie.infoq.cn/article/92ce399000f46e5d308b3d935&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è¨˜æ†¶é«”éƒ½å»å“ªäº†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.1ju.org/linux/top&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;topå‘½ä»¤è©³è§£ç¤ºä¾‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://tigercosmos.xyz/post/2020/04/unix/top-usage/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Unix/Linux TOP æŒ‡ä»¤ä½¿ç”¨è©³è§£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://manpages.ubuntu.com/manpages/lunar/en/man1/top.1.html#3.%20fields%20/%20columns&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ubntu-top&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.hy-star.com.tw/tech/linux/process/process.html#session&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;LInuxä¸­çš„process&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/171. linux topæŒ‡ä»¤è©³è§£/" />
        </entry>
        <entry>
            <title>
                165. Linuxç¶²è·¯è¿½è¹¤å·¥å…·- MTR
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/165. Linuxç¶²è·¯è¿½è¹¤å·¥å…·- MTR/</id>
            <content type="html">
                &lt;h2 id=&quot;mtr&quot; tabindex=&quot;-1&quot;&gt;mtr&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;MTR åœ¨ä¸€é–‹å§‹æœƒé‡å°æŒ‡å®šçš„ä¸»æ©Ÿï¼Œä»¥Â &lt;code&gt;traceroute&lt;/code&gt;Â æ‰¾å‡ºä¸­é–“çš„æ¯ä¸€å€‹ç¶²è·¯ç¯€é»ï¼ˆé–˜é“å™¨ã€è·¯ç”±å™¨ã€æ©‹æ¥å™¨ç­‰ï¼‰ï¼Œç„¶å¾Œä½¿ç”¨Â &lt;code&gt;ping&lt;/code&gt;Â å»æª¢æŸ¥æ¯ä¸€å€‹ç¯€é»çš„ç¶²è·¯é€£ç·šç‹€æ³&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è£œå……ï¼Œ&lt;code&gt;traceroute -P -t 1935 &amp;lt;ip&amp;gt;&lt;/code&gt; å¯é€éæŒ‡å®športæ¸¬è©¦é€£ç·š&lt;/p&gt;
&lt;h3 id=&quot;å®‰è£æ–¹å¼&quot; tabindex=&quot;-1&quot;&gt;å®‰è£æ–¹å¼&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;# Debian/Ubuntu
sudo apt install mtr

# RHEL/CentOS/Fedora
sudo yum install mtr

# MAC
brew install mtr

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;MACå®‰è£å¾Œï¼Œç„¡æ³•åŸ·è¡Œï¼Œå› çˆ²å®‰è£çš„è·¯å¾‘æ˜¯åœ¨ /usr/local/sbinåº•ä¸‹ï¼Œ&lt;br /&gt;
æ‰¾å°‹è‡ªå·±çš„shell&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/163.Shell%E7%9A%84%E5%8D%80%E5%88%A5%E5%8F%8A%E6%9F%A5%E8%A9%A2/&quot;&gt;163.Shellçš„å€åˆ¥åŠæŸ¥è©¢&lt;/a&gt;ï¼Œå¢åŠ æŒ‡å®šè·¯å¾‘&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;vim ~/.bash_profile 
export PATH=$PATH:/usr/local/sbin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ sudo åŸ·è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo mtr -c 5 -wbr https://daimom.vercel.app &amp;gt; output.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%A7%20Linux/165.fig-1.jpg&quot; alt=&quot;165.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;åƒæ•¸ä»‹ç´¹&quot; tabindex=&quot;-1&quot;&gt;åƒæ•¸ä»‹ç´¹&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
mtr -h æä¾›å¹«åŠ©å‘½ä»¤ 

mtr -v é¡¯ç¤ºmtrçš„ç‰ˆæœ¬è³‡è¨Š 

mtr -r ä»¥å ±å‘Šæ¨¡å¼é¡¯ç¤º

mtr -s ç”¨ä¾†æŒ‡å®špingå°åŒ…çš„å¤§å° 

mtr -n no-dnsä¸å°IPåœ°å€åšåŸŸåè§£æ 

mtr -a ä¾†è¨­å®šå‚³é€å°åŒ…çš„IPåœ°å€ é€™å€‹å°ä¸€å€‹ä¸»æ©Ÿç”±å¤šå€‹IPåœ°å€æ˜¯æœ‰ç”¨çš„ 

mtr -i ä½¿ç”¨é€™å€‹åƒæ•¸ä¾†è¨­å®šICMPè¿”å›ä¹‹é–“çš„è¦æ±‚é»˜èªæ˜¯1ç§’ 

mtr -4 IPv4 

mtr -6 IPv6

mtr -c è¨­å®šæ¯ç§’å‚³é€å°åŒ…çš„æ•¸é‡

mtr -T ä½¿ç”¨TCPé€£ç·š

mtr -P æŒ‡å®šport

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ•¸æ“šæ‰€ä»£è¡¨çš„æ„æ€&lt;br /&gt;
ä»¥ä¸‹æ˜¯å„å€‹è‹±æ–‡å­—æ¯æ‰€ä»£è¡¨çš„æ¬„ä½ï¼š&lt;br /&gt;
RTT (Round Trip Time) äº¦å¯ç¨±ç‚ºå¾€è¿”æ™‚é–“&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;L&lt;/code&gt;ï¼šå°åŒ…éºå¤±ç‡ï¼ˆLoss ratioï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;D&lt;/code&gt;ï¼šå°åŒ…éºå¤±æ•¸ï¼ˆDropped packetsï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;R&lt;/code&gt;ï¼šå°åŒ…æ¥æ”¶æ•¸ï¼ˆReceived packetsï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;S&lt;/code&gt;ï¼šå°åŒ…ç™¼é€æ•¸ï¼ˆSent Packetsï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;N&lt;/code&gt;ï¼šæœ€æ–°çš„ RTTï¼ˆNewest RTTï¼Œå–®ä½ç‚º msï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;B&lt;/code&gt;ï¼šæœ€ä½³çš„ RTTï¼ˆMin/Best RTTï¼Œå–®ä½ç‚º msï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;A&lt;/code&gt;ï¼šå¹³å‡çš„ RTTï¼ˆAverage RTTï¼Œå–®ä½ç‚º msï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;W&lt;/code&gt;ï¼šæœ€å·®çš„ RTTï¼ˆMax/Worst RTTï¼Œå–®ä½ç‚º msï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;V&lt;/code&gt;ï¼šæ¨™æº–å·®ï¼ˆStandard Deviationï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;G&lt;/code&gt;ï¼šå¹¾ä½•å¹³å‡ï¼ˆGeometric Meanï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;J&lt;/code&gt;ï¼šç›®å‰çš„ Jitter å€¼ï¼ˆCurrent Jitterï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;M&lt;/code&gt;ï¼šå¹³å‡çš„ Jitter å€¼ï¼ˆJitter Mean/Avg.ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;X&lt;/code&gt;ï¼šæœ€å·®çš„ Jitter å€¼ï¼ˆWorst Jitterï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;I&lt;/code&gt;ï¼šInterarrival Jitter&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cjkuo.net/linux_mtr/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;MTR è¿½è¹¤ç¶²è·¯ç¯€é»&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.gtwang.org/linux/mtr-linux-network-diagnostic-tool/&quot; title=&quot;MTRï¼šLinux ç¶²è·¯è¨ºæ–·å·¥å…·ä½¿ç”¨æ•™å­¸&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;MTRï¼šLinux ç¶²è·¯è¨ºæ–·å·¥å…·ä½¿ç”¨æ•™å­¸&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://what-a-good-day.blogspot.com/2019/02/mac-mtr.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;mac å®‰è£ mtr&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/165. Linuxç¶²è·¯è¿½è¹¤å·¥å…·- MTR/" />
        </entry>
        <entry>
            <title>
                163.Shellçš„å€åˆ¥åŠæŸ¥è©¢
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/163.Shellçš„å€åˆ¥åŠæŸ¥è©¢/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;åœ¨æ¸¬è©¦gcloudå®‰è£å¾Œï¼Œé‚„æ˜¯æ‰¾ä¸åˆ°gcloud command ï¼Œ&lt;br /&gt;
æ–¼æ˜¯é–‹å§‹äº†æª¢æŸ¥ä¹‹è·¯ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç†Ÿlinuxçš„æ‡‰è©²éƒ½çŸ¥é“shåªæ˜¯å€‹ä»£ç¨±ï¼Œä½ çš„shæ˜¯bash ã€ zsh æˆ– dashï¼Œ&lt;br /&gt;
éƒ½æœ‰å¯èƒ½ã€‚&lt;br /&gt;
æ‰€ä»¥åˆ¤æ–·ä½ çš„shæ˜¯å“ªä¸€ç¨®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo $SHELL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œä½ çš„shæœƒæ±ºå®šä½ çš„è¨­å®šæª”åç¨±æ˜¯å“ªä¸€å€‹ã€‚&lt;br /&gt;
ä¾‹å¦‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bash =&amp;gt; ~/.bashrc
zsh =&amp;gt;  ~/.zshrc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœæŒ‡ä»¤æ–°å¢å¾Œï¼Œä¸æƒ³é‡å•“Terminalçš„è©±ï¼Œ&lt;br /&gt;
å¯ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤ï¼Œå°‡è¢«æŒ‡å®šç›®éŒ„çš„bashè®€å…¥ç›®å‰çš„ç’°å¢ƒä¸­ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;source ~/.bashrc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/31037279/gcloud-command-not-found-while-installing-google-cloud-sdk&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud command not found - while installing Google Cloud SDK&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/163.Shellçš„å€åˆ¥åŠæŸ¥è©¢/" />
        </entry>
        <entry>
            <title>
                16.dustise sleep æ¸¬è©¦å·¥å…·ç°¡ä»‹
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/16.dustise sleep æ¸¬è©¦å·¥å…·ç°¡ä»‹/</id>
            <content type="html">
                &lt;h2 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰å°±æœ‰ç”¨é dustise/sleep ï¼Œç”¨for è¿´åœˆä¾†æ‰“ ç¶²å€åšæ¸¬è©¦ï¼Œ&lt;br /&gt;
ä»Šå¤©æƒ³èªªé‚£è£¡é¢çš„httpåˆ°åº•æ˜¯å“ªä¸€å¥—å·¥å…·ï¼Œæ‰ç™¼ç¾åŸä¾†è£¡é¢æœ‰é‚£éº¼å¤šçš„å·¥å…·èƒ½ç”¨ã€‚&lt;br /&gt;
2021.03.18æ›´æ–°ï¼šåˆæ‰¾åˆ°äº†å¹¾æ¬¾ä¸éŒ¯ç”¨çš„å·¥å…·ï¼ŒåŒæ­¥å¢åŠ &lt;/p&gt;
&lt;h2 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h2&gt;
&lt;p&gt;è£¡é¢çš„å·¥å…·åˆ—è¡¨ï¼Œå¯ä»¥åƒè€ƒä»–çš„&lt;a href=&quot;https://github.com/fleeto/sleep&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;git&lt;/a&gt;ï¼Œ&lt;br /&gt;
ç„¶å¾Œæˆ‘å€‘çœ‹åˆ°ä»–çš„dockerfile,è£¡é¢æœ‰&lt;br /&gt;
bind-tools curl wrk vim&lt;br /&gt;
tcptraceroute iptables httpie bash&lt;br /&gt;
tini apache2-utils stress-ng strace&lt;br /&gt;
é€™æ¬¡æœƒæŠ“å¹¾å€‹è¨˜éŒ„ä¸€ä¸‹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;bind-tools&lt;br /&gt;
å®‰è£nslookupç”¨ï¼Œå¯æŸ¥è©¢åŸŸå&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;      nslookup tw.yahho.com    &lt;/code&gt;&lt;br /&gt;
2. curl&lt;br /&gt;
å–å¾—ç¶²é è³‡æ–™&lt;br /&gt;
&lt;code&gt;      curl ifconfig.me    &lt;/code&gt;&lt;br /&gt;
åƒæ•¸å¾ˆå¤šï¼Œé€šå¸¸æœƒä½¿ç”¨postmanå°‡è¦æˆªå–çš„è³‡æ–™è½‰æˆcurlï¼Œå†åˆ°commandåšæ¸¬è©¦ã€‚&lt;br /&gt;
å¦‚æœåªæ˜¯è¦ç°¡å–®æ¸¬è©¦ï¼Œå¯ä»¥åŠ ä¸Š -v çœ‹è©³ç´°å…§å®¹&lt;br /&gt;
3. wrk&lt;br /&gt;
æ¨¡æ“¬å¤šäººä¾†ç¶²ç«™æ™‚çš„æ•ˆèƒ½ï¼Œæœ‰é»åƒå£“åŠ›æ¸¬è©¦å·¥å…·ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  wrk -t12 -c400 -d30s -T30s --latency http://localhost/productpage
  # -t12 ç”¨ 12 å€‹ç·šç¨‹
  # -c400 æ¨¡æ“¬ 400 å€‹ä½µç™¼é€£æ¥
  # -d30s æŒçºŒ 30 ç§’
  # -T30s è¨­å®šè¶…é 30 ç§’å°±ç®—é€£æ¥è¶…æ™‚
  # --latency éŸ¿æ‡‰æ™‚é–“çš„åˆ†ä½ˆæƒ…æ³
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;[16.fig-1.jpg&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Latency: éŸ¿æ‡‰æ™‚é–“&lt;/li&gt;
&lt;li&gt;Req/Sec: æ¯å€‹ç·šç¨‹æ¯ç§’é˜çš„å®Œæˆçš„è«‹æ±‚æ•¸&lt;/li&gt;
&lt;li&gt;Avg: å¹³å‡å€¼&lt;/li&gt;
&lt;li&gt;Stdev (Standard Deviation): å³æ¨™æº–åå·®ï¼Œæ˜¯çµ±è¨ˆå­¸çš„ä¸€å€‹åè©ï¼Œé€™è£¡è¡¨ç¤ºè«‹æ±‚éŸ¿æ‡‰æ™‚é–“çš„é›¢æ•£ç¨‹åº¦ï¼Œå€¼è¶Šå¤§ä»£è¡¨è«‹æ±‚éŸ¿æ‡‰æ™‚é–“çš„å·®è·è¶Šå¤§ï¼Œç³»çµ±çš„éŸ¿æ‡‰ç´„ä¸ç©©å®šã€‚&lt;/li&gt;
&lt;li&gt;Max: æœ€å¤§å€¼&lt;/li&gt;
&lt;li&gt;+/- Stdev: æ­£è² ä¸€å€‹æ¨™æº–å·®ä½”æ¯”&lt;/li&gt;
&lt;li&gt;Latency Distribution: 50% åœ¨ 3.23s ä»¥å…§å®Œæˆ / 99% åœ¨ 22.27s ä»¥å…§å®Œæˆ&lt;/li&gt;
&lt;li&gt;Socket errors: åˆ†ç‚º é€£æ¥éŒ¯èª¤, è®€å–éŒ¯èª¤, å¯«å…¥éŒ¯èª¤, è¶…æ™‚éŒ¯èª¤&lt;/li&gt;
&lt;li&gt;Requests/sec: æ¯ç§’è«‹æ±‚æ•¸é‡ï¼Œä¹Ÿå°±æ˜¯ä¸¦ç™¼èƒ½åŠ›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ›´è©³ç´°çš„èªªæ˜ï¼Œè«‹åƒè€ƒï¼š&lt;a href=&quot;https://mgleon08.github.io/blog/2018/04/09/http-benchmark/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;HTTP Benchmark å·¥å…· Wrk&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;
&lt;p&gt;vim&lt;br /&gt;
æ–‡å­—ç·¨è¼¯å™¨ï¼Œå°±ä¸ä»‹ç´¹äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;tcptraceroute&lt;br /&gt;
è·¯ç”±è¿½è¹¤å™¨ï¼Œè¿½è¹¤ç¶²è·¯æ­»åœ¨å“ªä¸€å±¤&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;  traceroute tw.yahoo.com
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;
&lt;p&gt;iptables&lt;br /&gt;
è·¯ç”±è¡¨&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;httpie&lt;br /&gt;
ä¹‹å‰ä½¿ç”¨&lt;br /&gt;
for i in &lt;code&gt;seq 20&lt;/code&gt;;do http --body &lt;a href=&quot;http://ipaddress/api/v1/Health/health&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;http://ipaddress/api/v1/Health/health&lt;/a&gt;; done;&lt;br /&gt;
æ‰“ç¶²å€çš„æŒ‡ä»¤ã€‚&lt;br /&gt;
httpie æ˜¯ä¸€å€‹ HTTP çš„å‘½ä»¤è¡Œå®¢æˆ¶ç«¯ã€‚å…¶ç›®æ¨™æ˜¯è®“ CLI å’Œ web æœå‹™ä¹‹é–“çš„äº¤äº’å„˜å¯èƒ½çš„äººæ€§åŒ–ã€‚&lt;br /&gt;
æƒ³ç”¨ä¾†å–ä»£wget ,curl ç­‰åŠŸèƒ½ï¼Œç„¶å¾Œç•«é¢æ¯”è¼ƒç¾è§€ï¼Œå¦‚æœå›ä¾†çš„æ˜¯jsonï¼Œé‚£å·®ç•°æœƒæ›´å¤§ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;[[16.fig-2.jpg]]&lt;/p&gt;
&lt;p&gt;ä¸‹è¼‰&lt;br /&gt;
http --download &lt;a href=&quot;http://example.org/file&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;example.org/file&lt;/a&gt;&lt;br /&gt;
åªçœ‹header&lt;br /&gt;
http -h &lt;a href=&quot;http://ipaddress/productpage&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;http://ipaddress/productpage&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://tonydeng.github.io/2015/07/10/httpie-howto/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;HTTPie:è¶…çˆ½çš„HTTPå‘½ä»¤è¡Œå®¢æˆ¶ç«¯&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://keelii.com/2018/09/03/HTTPie/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;HTTPie å®˜æ–¹æ–‡æª”ä¸­æ–‡ç¿»è­¯ç‰ˆ&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;åŒå ´åŠ è¨»&lt;/p&gt;
&lt;p&gt;jid&lt;br /&gt;
&lt;a href=&quot;https://github.com/simeji/jid&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://github.com/simeji/jid&lt;/a&gt;&lt;br /&gt;
jq&lt;br /&gt;
&lt;a href=&quot;https://stedolan.github.io/jq/manual/#Basicfilters&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://stedolan.github.io/jq/manual/#Basicfilters&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;hey&lt;br /&gt;
&lt;a href=&quot;https://github.com/rakyll/hey&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://github.com/rakyll/hey&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;e.g.  åŠ ä¸Š method ,content/type ,dataraw&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hey -z 3m -q 10 -c 3 -m POST -T &#39;application/json&#39; -d &#39;{ &amp;quot;method&amp;quot;: &amp;quot;GetUrlForWard&amp;quot;,  &amp;quot;host&amp;quot;: &amp;quot;landing500023.com&amp;quot;}&#39; https://landing500023.com/query.php
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/16.dustise sleep æ¸¬è©¦å·¥å…·ç°¡ä»‹/" />
        </entry>
        <entry>
            <title>
                134. é—œé–‰sshé€£ç·šå¾Œï¼Œä»å¯åŸ·è¡Œç¨‹å¼
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/134. é—œé–‰sshé€£ç·šå¾Œï¼Œä»å¯åŸ·è¡Œç¨‹å¼/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;æ€éº¼æœ€è¿‘éƒ½åœ¨æshell scripté˜¿..&lt;br /&gt;
é€™æ¬¡æ˜¯è¦æŠŠgceçš„åœ–ç‰‡æ¬åˆ°gcsä¸Šé¢ï¼Œ&lt;br /&gt;
ç¸½è¨ˆæœ‰ä¸‰è¬å¤šå¼µï¼Œä¸€èˆ¬åŸ·è¡Œæ™‚ï¼Œå¦‚æœç¢°åˆ°sshæ–·ç·šï¼ŒåŸ·è¡Œå°±å¤±æ•—äº†ï¼Œ&lt;br /&gt;
æ‰€ä»¥è¦è®“ä»–å°±ç®—sshæ–·ç·šï¼Œä¹Ÿä»æœƒåŸ·è¡Œ&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç›®å‰æœ‰å…©ç¨®æ–¹å¼&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;nohup&lt;br /&gt;
ç®—æ˜¯æœ€ç°¡å–®ï¼Œå®¹æ˜“ç”¨çš„æ–¹å¼ï¼Œç›´æ¥ åœ¨å¾Œé¢æ¥commandå°±èƒ½ç”¨äº†ï¼Œ&lt;br /&gt;
ä½†æˆ‘ç¦®æ‹œäº”æ›ç€ï¼Œç„¶å¾Œç¦®æ‹œä¸€å›ä¾†çœ‹ï¼Œç™¼ç¾ç¨‹å¼æ›äº†ï¼Œcpué‚„é£†åˆ°100ï¼Œ&lt;br /&gt;
å°±ç®—ç”¨ æŒ‡ä»¤æ‰¾åˆ°pidå¾Œï¼Œå¼·åˆ¶åˆªé™¤ï¼Œé‚„æ˜¯æœ‰commandåœ¨åŸ·è¡Œï¼Œæœ€å¾Œåªèƒ½é‡é–‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;	ps -aux | grep &amp;quot;copyfile.sh&amp;quot;
	kill -9 &amp;lt;PID&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://noter.tw/3946/ssh-%E9%81%A0%E7%AB%AF%E7%99%BB%E5%87%BA%E5%BE%8C%E7%B9%BC%E7%BA%8C%E5%9F%B7%E8%A1%8C/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SSH é ç«¯ç™»å‡ºå¾Œç¹¼çºŒåŸ·è¡Œ&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;screen&lt;br /&gt;
yumç›´æ¥æœå°‹æœƒæ‰¾ä¸åˆ°packageï¼Œéœ€è¦å…ˆé¡å¤–å®‰è£epel-release&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;yum install epel-release
yum install screen
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨æ–¹å¼&lt;/p&gt;
&lt;p&gt;å…ˆå»ºç«‹ä¸€å€‹screen&lt;br /&gt;
å¯æŒ‡å®šåç¨±&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;screen -S &amp;lt;name&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨screenè£é¢ï¼ŒåŸ·è¡Œç¨‹å¼ï¼Œé›¢é–‹æ™‚æŒ‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ctrl+a -&amp;gt; ctrlï¼ˆä¸æ”¾ï¼‰+d
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŸ¥çœ‹ç›®å‰æœ‰å“ªäº› screen&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;screen -ls
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%A7%20Linux/134.fig-1.jpg&quot; alt=&quot;134.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å›åˆ°å‰›å‰›çš„screenï¼Œå¯ä»¥ä¸Šé¢æŒ‡ä»¤çœ‹åˆ°é€™å€‹screençš„idæ˜¯58245ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;screen -r 58245
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.twblogs.net/a/5db3ccc2bd9eee310da06d04&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ã€Linuxã€‘screenè§£æ±ºé€€å‡ºçµ‚ç«¯æœƒè©±çµæŸå•é¡Œ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://intone.cc/2018/07/%e5%ad%b8%e6%9c%83%e4%bd%bf%e7%94%a8screen%e4%b8%8d%e5%86%8d%e6%80%95ssh%e4%b8%ad%e6%96%b7-linux%ef%bc%88centos-7%ef%bc%89/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å­¸æœƒä½¿ç”¨Screen,ä¸å†æ€•SSHä¸­æ–· Linuxï¼ˆCentos 7ï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/134. é—œé–‰sshé€£ç·šå¾Œï¼Œä»å¯åŸ·è¡Œç¨‹å¼/" />
        </entry>
        <entry>
            <title>
                133. shell scriptå­—ä¸²è™•ç†
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/133. shell scriptå­—ä¸²è™•ç†/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;shell scriptçš„å­—ä¸²è™•ç†ï¼ŒåŸæœ¬ä»¥çˆ²åªèƒ½ç”¨grep è·Ÿ awk èµ°pipelineä¾†ç”¨ï¼Œ&lt;br /&gt;
åŸä¾†é‚„èƒ½ç›´æ¥é€é${} ä¾†è™•ç†ï¼Œshell scriptçš„æ°´å¥½æ·±é˜¿...&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä¾†å€‹ä¾‹å­ï¼Œ&lt;br /&gt;
æœ‰å€‹tag å« dev_1.1.23 ï¼Œæˆ‘åªè¦å¾Œé¢çš„ç‰ˆè™Ÿå°±å¥½ï¼Œè©²æ€éº¼åšã€‚&lt;/p&gt;
&lt;p&gt;æœ¬ä¾†åšæ³•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;#!/bin/bash
set -x
abc=&amp;quot;dev_1.1.23&amp;quot;
echo $abc|grep -o &#39;&#92;d.&#92;d.&#92;d.&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ©ç”¨ grep å–å€¼ï¼Œä¸¦åªé¡¯ç¤ºç¬¦åˆæ­£å‰‡çš„å­—ä¸²ï¼Œ æ‰€ä»¥è¦ç”¨ -o&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.1.23&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœæ”¹ç”¨${}çš„æ–‡å­—éè²ªå©ªå·¦åˆªé™¤&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;#!/bin/bash
set -x
abc=&amp;quot;dev_1.1.23&amp;quot;
echo ${abc#*_}
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;1.1.23&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%A7%20Linux/133.fig-1.jpg&quot; alt=&quot;133.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é™¤äº†å·¦åˆªé™¤ï¼Œä¹Ÿèƒ½åšåˆ°å³åˆªé™¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# å°æ¯”å°å·¦
## å¤§æ¯”å°å·¦
% å°æ¯”å°å³
%% å¤§æ¯”å°å³
* ç”¨ä¾†æ¯”å°ç„¶å¾Œåˆªé™¤

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ps.&lt;br /&gt;
set -x æ˜¯å±¬æ–¼xtraceçš„æ‡‰ç”¨ï¼Œç”¨ä¾†é™¤éŒ¯çš„ã€‚&lt;br /&gt;
ä¹Ÿå¯ä»¥åœ¨åŸ·è¡Œçš„æ™‚å€™ï¼ŒåŠ ä¸Š bash -x &lt;a href=&quot;http://curl.sh/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;curl.sh&lt;/a&gt; ï¼Œ&lt;br /&gt;
é€™æ¨£ä½¿ç”¨&lt;br /&gt;
è©³ç´°åƒè€ƒ&lt;a href=&quot;https://hackmd.io/@seterrychen/rkZINBjKH&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Shell scriptå‰è¨€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.sunxidong.com/449.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux Shell æŒ‡ä»¤ç¢¼ä¸­ ${} ç”¨æ³•&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/133. shell scriptå­—ä¸²è™•ç†/" />
        </entry>
        <entry>
            <title>
                132. shell script é›™å¼•è™Ÿèˆ‡å–®å¼•è™Ÿ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/132. shell script é›™å¼•è™Ÿèˆ‡å–®å¼•è™Ÿ/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘å¯«CI/CDï¼Œç¢°åˆ°ä¸€å †shell scriptçš„æŒ‡ä»¤ï¼Œ&lt;br /&gt;
ä»¥å‰éƒ½æ˜¯try errorä¸€è·¯è©¦éå»çš„ï¼Œ&lt;br /&gt;
æ²’ç¢°åˆ°ä»€éº¼å¤ªå¤§å•é¡Œï¼Œç›´åˆ°ç¾åœ¨é‚£ä¸€é•·ä¸²ï¼Œæˆ‘æ‰çµ‚æ–¼ç™¼ç˜‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;ç°¡å–®èªªæ³•&quot; tabindex=&quot;-1&quot;&gt;ç°¡å–®èªªæ³•&lt;/h3&gt;
&lt;p&gt;shell scriptçš„ å–®å¼•è™Ÿ ã€ &#39; ã€æ‹¬èµ·ä¾†çš„å­—ï¼Œ&lt;br /&gt;
æœƒä¿ç•™å¼•è™Ÿå…§æ¯å€‹å­—å…ƒï¼Œå°±æ˜¯èªªè£é¢çš„è®Šæ•¸ä¸æœƒè®Šã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;abc=&amp;quot;a&amp;quot;
echo &#39;$abc&#39;;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°±æ˜¯å°å‡º&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$abc&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è€Œé›™å¼•è™Ÿ ã€ &amp;quot; ã€ æ‹¬èµ·ä¾†çš„å­—ï¼Œ&lt;br /&gt;
ä¸æœƒä¿ç•™å¼•è™Ÿå…§çš„å­—å…ƒï¼Œå°±æ˜¯èªªè£é¢çš„è®Šæ•¸æœƒè·Ÿç€è®Š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;abc=a
echo &amp;quot;$abc&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°å‡º&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;a&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥çœ‹èµ·ä¾†æœƒåƒé€™æ¨£&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%A7%20Linux/132.fig-1.jpg&quot; alt=&quot;132.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœè®Šæˆå–®å¼•è™ŸåŒ…é›™å¼•è™Ÿï¼Œæˆ–æ˜¯ é›™å¼•è™ŸåŒ…å–®å¼•è™Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;echo &#39;&amp;quot;$abc&amp;quot;&#39;
echo &amp;quot;&#39;$abc&#39;&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;$abc&lt;br /&gt;
&#39;a&#39;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;è©³ç´°èªªæ³•&quot; tabindex=&quot;-1&quot;&gt;è©³ç´°èªªæ³•&lt;/h3&gt;
&lt;p&gt;å–®å¼•è™Ÿï¼š&lt;br /&gt;
shell å°‡é€å­—è§£é‡‹å–®å¼•è™Ÿå…§çš„å°é–‰æ–‡å­—ï¼Œä¸¦ä¸”ä¸æœƒæ’å…¥ä»»ä½•å…§å®¹ï¼ŒåŒ…æ‹¬è®Šæ•¸ã€åå¼•è™Ÿã€æŸäº› &#92; è½‰ç¾©ç¬¦ç­‰ï¼Œæ‰€æœ‰å­—å…ƒéƒ½æœƒç¶­æŒåŸå§‹å­—é¢æ„ç¾©&lt;/p&gt;
&lt;p&gt;é›™å¼•è™Ÿï¼š&lt;br /&gt;
å…è¨± shell è§£é‡‹ç¾å…ƒç¬¦è™Ÿ ( $ )ã€åå¼•è™Ÿ ( ` )ã€åæ–œæ§“ ( &#92; ) å’Œé©šå˜†è™Ÿ (ï¼ï¼‰ï¼Œ é€™äº›å­—å…ƒèˆ‡é›™å¼•è™Ÿä¸€èµ·ä½¿ç”¨æ™‚å…·æœ‰ç‰¹æ®Šå«ç¾©ï¼Œä¸¦ä¸”åœ¨é¡¯ç¤ºä¹‹å‰å°å…¶é€²è¡Œè©•ä¼°&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://officeguide.cc/bash-tutorial-quoted-strings-and-special-characters/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; Bash ç¨‹å¼è¨­è¨ˆæ•™å­¸èˆ‡ç¯„ä¾‹ï¼šå–®å¼•è™Ÿã€é›™å¼•è™Ÿã€è·³è„«å­—å…ƒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.51cto.com/article/685657.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;çµ‚æ–¼çŸ¥é“ Shell ä¸­å–®å¼•è™Ÿé›™å¼•è™Ÿçš„å€åˆ¥äº†&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;p.s ä¸Šé¢å®£å‘Šçš„ abc å«åšæœ¬åœ°è®Šæ•¸(local variable)ï¼Œ&lt;br /&gt;
å¦‚æœç”¨ä¸Šäº†export å‰‡æ˜¯ ç’°å¢ƒè®Šæ•¸(environment variable)&lt;/p&gt;
&lt;p&gt;å¸¸è¦‹è®Šæ•¸éŒ¯èª¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;A = B #=è™Ÿå‰å¾Œä¸èƒ½æœ‰ç©ºæ ¼
1A=B &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è®Šé‡åç¨±ä¸èƒ½ä»¥æ•¸å­—é–‹é ­&quot;&gt;#è®Šé‡åç¨±ä¸èƒ½ä»¥æ•¸å­—é–‹é ­&lt;/a&gt;
$A=B &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è®Šé‡çš„åç¨±è£¡æœ‰&quot;&gt;#è®Šé‡çš„åç¨±è£¡æœ‰&lt;/a&gt;$
a=B  &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é€™è·Ÿa&quot;&gt;#é€™è·Ÿa&lt;/a&gt;=bæ˜¯ä¸åŒçš„
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://jasonblog.github.io/note/shell/2315.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; shellåä¸‰å•ä¹‹5:å•var=value åœ¨exportå‰å¾Œçš„å·®åœ¨å“ª?&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/132. shell script é›™å¼•è™Ÿèˆ‡å–®å¼•è™Ÿ/" />
        </entry>
        <entry>
            <title>
                116. å®‰è£linux server åŸºæœ¬è¨­å®š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/116. å®‰è£linux server åŸºæœ¬è¨­å®š/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;å¥½ä¹…æ²’å¼„ubuntuäº†ï¼Œæœ‰äº›é è¨­è¦è¨­å®šçš„æ±è¥¿ï¼Œ&lt;br /&gt;
é‚„çœŸçš„ä¹…æ²’ç”¨å°±å¿˜è¨˜ï¼Œ&lt;br /&gt;
ç­†è¨˜ç­†è¨˜ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;æ–°å¢ä½¿ç”¨è€…&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;sudo useradd it
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä¿®æ”¹å¯†ç¢¼&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;sudo passwd it
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://blog.gtwang.org/linux/linux-useradd-command-tutorial-examples/&quot; title=&quot;Linux æ–°å¢ä½¿ç”¨è€… useradd æŒ‡ä»¤ç”¨æ³•æ•™å­¸èˆ‡ç¯„ä¾‹&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux æ–°å¢ä½¿ç”¨è€… useradd æŒ‡ä»¤ç”¨æ³•æ•™å­¸èˆ‡ç¯„ä¾‹&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŒ‡å®šå¸³è™Ÿï¼Œè¼¸å…¥sudoå…å¯†ç¢¼&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;quot;username ALL=(ALL) NOPASSWD: ALL&amp;quot; &amp;gt; /etc/sudoers.d/username
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10270945?sc=hot&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç¬¬8ç« ï¼šç®¡ç†æœ¬åœ°ç«¯ä¸»æ©Ÿä¹‹ä½¿ç”¨è€…èˆ‡ç¾¤çµ„(äºŒ)&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ›´æ”¹å›ºå®šipï¼Œä¿®æ”¹è£é¢çš„æª”æ¡ˆ *.network-manager-all.yaml&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;cd /etc/netplan/

&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;network:  
  version: 2  
  renderer: NetworkManager  
  ethernets:  
    ens33:  
      dhcp4: no  
      addresses: [192.168.103.231/24]  
      gateway4: 192.168.0.1  
      nameservers:  
        addresses: [8.8.8.8,8.8.4.4]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®Œæˆå¾Œï¼Œå…ˆæ¸¬è©¦&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo netplan try
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.ruyut.com/2021/12/ubuntu-ip.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[Ubuntu] è¨­å®šå›ºå®šip&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€èˆ¬ä½¿ç”¨è€…åŸ·è¡Œdocker&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;sudo usermod -a -G docker ${USER}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŸ·è¡Œå®Œå¾Œï¼Œéœ€é‡æ–°ç™»å…¥&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/116. å®‰è£linux server åŸºæœ¬è¨­å®š/" />
        </entry>
        <entry>
            <title>
                114. alpine linux å®£å‘Šè®Šæ•¸,error bad variable name
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/114. alpine linux å®£å‘Šè®Šæ•¸,error bad variable name/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;é ­ä¸€æ¬¡ç¢°åˆ°é€™ç¨®å‘ï¼Œ&lt;br /&gt;
æˆ‘linuxæœ‰å¾…åŠ å¼· ï¼ˆå“­&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å…ˆçœ‹åŸ·è¡Œçµæœï¼Œ&lt;br /&gt;
è®Šæ•¸å¾Œé¢ä¸èƒ½æ¥ç©ºæ ¼ï¼Œä¸ç„¶æœƒå‡ºç¾éŒ¯èª¤ã€‚&lt;br /&gt;
ç­‰è™Ÿå¾Œé¢ä¹Ÿä¸èƒ½æ¥ç©ºæ ¼ï¼Œä¸ç„¶æœƒå‡ºç¾éŒ¯èª¤ã€‚&lt;br /&gt;
å¹³å¸¸ç¨‹å¼å¯«å¤ªé †ï¼Œéƒ½ç¿’æ…£æŒ‰ç©ºæ ¼äº†ï¼Œ&lt;br /&gt;
çµæœ....&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/ # export ab = &amp;quot;hello world&amp;quot;
sh: export: : bad variable name
/ # EXPORT ab = &amp;quot;hello world&amp;quot;
sh: EXPORT: not found
/ # export ab=&amp;quot;helloworld&amp;quot;
/ # echo $ab
helloworld
/ # export ab = &amp;quot;helloworld&amp;quot;
sh: export: : bad variable name
/ # export ab =&amp;quot;helloworld&amp;quot;
sh: export: : bad variable name
/ # export ab= &amp;quot;helloworld&amp;quot;
/ # echo $ab
helloworlda
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/114. alpine linux å®£å‘Šè®Šæ•¸,error bad variable name/" />
        </entry>
        <entry>
            <title>
                108. linux shell é€²éšæŒ‡ä»¤
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/108. linux shell é€²éšæŒ‡ä»¤/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;æˆ‘ä¹Ÿä¸çŸ¥é“é€™ç®—ä¸ç®—é€²éšï¼Ÿ&lt;br /&gt;
ä½†å¹³å¸¸æˆ‘æ‡‰è©²ä¸æœƒç”¨ï¼Œæœ¬æ–‡æœ‰&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¨ˆç®—æŸå€‹é–‹é ­çš„tagæ•¸é‡æœ‰å¤šå°‘&lt;/li&gt;
&lt;li&gt;forè¿´åœˆçš„è³‡æ–™å¯«åˆ°æ–‡å­—æª”&lt;/li&gt;
&lt;li&gt;å–å¾—æª”æ¡ˆè©³ç´°æ™‚é–“&lt;/li&gt;
&lt;li&gt;å–å¾—æª”æ¡ˆåˆ—è¡¨å¾Œåˆªé™¤&lt;/li&gt;
&lt;li&gt;xargs åƒæ•¸&lt;/li&gt;
&lt;li&gt;åªé¡¯ç¤ºè³‡æ–™å¤¾&lt;/li&gt;
&lt;li&gt;åªé¡¯ç¤ºæª”æ¡ˆ&lt;/li&gt;
&lt;li&gt;lsåƒæ•¸&lt;/li&gt;
&lt;li&gt;è¨ˆç®—ç›®éŒ„åº•ä¸‹çš„æª”æ¡ˆæ•¸&lt;/li&gt;
&lt;li&gt;æŸ¥è©¢ä½¿ç”¨è€…&lt;/li&gt;
&lt;li&gt;æ¶ˆè€—æœ€å¤šCPUçš„process&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;tag&quot; tabindex=&quot;-1&quot;&gt;è¨ˆç®—æŸå€‹é–‹é ­çš„tagæ•¸é‡æœ‰å¤šå°‘&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;for tag in $(git tag --sort -version:refname -l &amp;quot;1.1.*&amp;quot;); do
  echo $tag;
  let i++
done
echo $i;
unset i;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;for&quot; tabindex=&quot;-1&quot;&gt;forè¿´åœˆçš„è³‡æ–™å¯«åˆ°æ–‡å­—æª”&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;for i in {20221201..20221202}
do
  for j in {00..01}
  do
      echo &amp;quot;mkdir $i$j&amp;quot; 
  done
done  &amp;gt; 1.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;å–å¾—æª”æ¡ˆè©³ç´°æ™‚é–“&quot; tabindex=&quot;-1&quot;&gt;å–å¾—æª”æ¡ˆè©³ç´°æ™‚é–“&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;ls --full-time | sort -k6
or
stat file.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;å–å¾—æª”æ¡ˆåˆ—è¡¨å¾Œåˆªé™¤&quot; tabindex=&quot;-1&quot;&gt;å–å¾—æª”æ¡ˆåˆ—è¡¨å¾Œåˆªé™¤&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;ls | grep 4793877c | xargs -p rm -f
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;xargs&quot; tabindex=&quot;-1&quot;&gt;xargs åƒæ•¸&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;-I {} å°‡æŒ‡ä»¤å¸¶åˆ°å¾Œé¢çš„{}åŸ·è¡Œ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;ls nfs | head -10 | xargs -t -I {} ls nfs/{}
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;-t   é¡¯ç¤ºåŸ·è¡Œçš„æŒ‡ä»¤&lt;br /&gt;
-p åŸ·è¡Œå‰çš„ç¢ºèª&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.gtwang.org/linux/xargs-command-examples-in-linux-unix/&quot; title=&quot;Linux ç³»çµ± xargs æŒ‡ä»¤ç¯„ä¾‹èˆ‡æ•™å­¸&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux ç³»çµ± xargs æŒ‡ä»¤ç¯„ä¾‹èˆ‡æ•™å­¸&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.runoob.com/linux/linux-comm-xargs.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux xargs å‘½ä»¤&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;åªé¡¯ç¤ºè³‡æ–™å¤¾&quot; tabindex=&quot;-1&quot;&gt;åªé¡¯ç¤ºè³‡æ–™å¤¾&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;ls -l | grep
{ &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#d&quot;&gt;#d&lt;/a&gt;}
   # åˆ©ç”¨è©³ç´°è³‡è¨Šï¼Œåˆ¤æ–·é–‹é ­æ˜¯ä¸æ˜¯ d(directory)
ls -d */
ls -F | grep &#92;/$  # æª”æ¡ˆåç¨±çš„æœ€å¾Œå¦‚æœæœ‰/è¡¨ç¤ºæ˜¯folder
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;åªé¡¯ç¤ºæª”æ¡ˆ&quot; tabindex=&quot;-1&quot;&gt;åªé¡¯ç¤ºæª”æ¡ˆ&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;ls -F /etc | grep -v &#39;/$&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;ls&quot; tabindex=&quot;-1&quot;&gt;lsåƒæ•¸&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;-l  é¡¯ç¤ºæª”æ¡ˆèˆ‡ç›®éŒ„çš„è©³ç´°è³‡è¨Š&lt;br /&gt;
-a é¡¯ç¤ºéš±è—çš„æª”æ¡ˆèˆ‡ç›®éŒ„&lt;br /&gt;
-h è¼¸å‡ºçš„è³‡è¨Šä»¥æ¯”è¼ƒå®¹æ˜“é–±è®€çš„æ ¼å¼å‘ˆç¾&lt;br /&gt;
-F æª”æ¡ˆåç¨±çš„å¾Œé¢åŠ ä¸Šæª”æ¡ˆé¡å‹çš„æ¨™ç¤ºå­—å…ƒ&lt;br /&gt;
-r æª”æ¡ˆçš„åˆ—è¡¨ä»¥åå‘çš„æ’åºåˆ—å‡º&lt;br /&gt;
-R ç”¨éè¿´çš„æ–¹å¼åˆ—å‡ºæ‰€æœ‰å­ç›®éŒ„çš„æª”æ¡ˆ&lt;br /&gt;
-S æª”æ¡ˆä¾ç…§æª”æ¡ˆçš„å¤§å°ä¾†æ’åº&lt;br /&gt;
-d åªåˆ—å‡ºç›®éŒ„ï¼Œå¾Œé¢ä¸åŠ ä¸Š*/   ç„¡æ³•é¡¯ç¤º&lt;br /&gt;
--full-time é¡¯ç¤ºå®Œæ•´æ™‚é–“&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;è¨ˆç®—ç›®éŒ„åº•ä¸‹çš„æª”æ¡ˆæ•¸&quot; tabindex=&quot;-1&quot;&gt;è¨ˆç®—ç›®éŒ„åº•ä¸‹çš„æª”æ¡ˆæ•¸&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;Â find ./ -type f -name *.*| wc -l
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;find [obj_directory] [-type f] [-name filename]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;findåƒæ•¸èªªæ˜ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;obj_directoryï¼šè¦æœå°‹çš„è·¯å¾‘&lt;br /&gt;
-typeï¼šè¦æœå°‹çš„é¡å‹ï¼Œf=æª”æ¡ˆï¼Œd=ç›®éŒ„&lt;br /&gt;
-inameï¼šä¸å€åˆ†å¤§å°å¯«&lt;br /&gt;
-nameï¼šå¾Œé¢æ¥æª”åï¼Œå¯åŠ è¬ç”¨å­—å…ƒ(*)ï¼Œæœå°‹é¡ä¼¼æª”åçš„æª”æ¡ˆ&lt;/p&gt;
&lt;p&gt;wc [-l]&lt;br /&gt;
&lt;strong&gt;wcåƒæ•¸èªªæ˜ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;-c: çµ±è¨ˆä½å…ƒçµ„æ•¸&lt;br /&gt;
-lï¼šçµ±è¨ˆè¡Œæ•¸&lt;br /&gt;
-mï¼šçµ±è¨ˆå­—å…ƒæ•¸ã€‚ä¸èƒ½èˆ‡Â -c ä¸€èµ·ä½¿ç”¨ã€‚&lt;br /&gt;
-wÂ çµ±è¨ˆå­—æ•¸ã€‚ä¸€å€‹å­—è¢«å®šç¾©ç‚ºç”±ç©ºç™½ã€è·³æ ¼æˆ–æ›è¡Œå­—å…ƒåˆ†éš”çš„å­—ä¸²ã€‚&lt;br /&gt;
-LÂ åˆ—å°æœ€é•·è¡Œçš„é•·åº¦ã€‚&lt;br /&gt;
-helpÂ é¡¯ç¤ºèª¬æ˜è³‡è¨Šã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://yosia.net/article/181&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; [Linux] è¨ˆç®—ç›®éŒ„åº•ä¸‹çš„æª”æ¡ˆæ•¸&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;æŸ¥æ‰€æœ‰ä½¿ç”¨è€…&quot; tabindex=&quot;-1&quot;&gt;æŸ¥æ‰€æœ‰ä½¿ç”¨è€…&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;cat /etc/passwd | awk -F: &#39;{print $1}&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://devconnected.com/how-to-list-users-and-groups-on-linux/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; How To List Users and Groups on Linux&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;åˆªé™¤ä½¿ç”¨è€…&quot; tabindex=&quot;-1&quot;&gt;åˆªé™¤ä½¿ç”¨è€…&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;userdel -r &amp;lt;userID&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://medium.com/%E4%B8%80%E5%80%8B%E5%B0%8F%E5%B0%8F%E5%B7%A5%E7%A8%8B%E5%B8%AB%E7%9A%84%E9%9A%A8%E6%89%8B%E7%AD%86%E8%A8%98/gcp-%E9%81%87%E5%88%B0permission-denied-publickey-%E6%80%8E%E9%BA%BC%E8%BE%A6-e41e26ebdf47&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; [GCP]é‡åˆ°permission denied (publickey)æ€éº¼è¾¦ï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.gtwang.org/linux/linux-ls-command-tutorial/&quot; title=&quot;Linux çš„ ls æŒ‡ä»¤æ•™å­¸èˆ‡å¸¸ç”¨ç¯„ä¾‹æ•´ç†&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux çš„ ls æŒ‡ä»¤æ•™å­¸èˆ‡å¸¸ç”¨ç¯„ä¾‹æ•´ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.hy-star.com.tw/tech/linux/pipe/pipe.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç®¡ç·š/é‡æ–°å°å‘&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;linux&quot; tabindex=&quot;-1&quot;&gt;linuxä½•æ™‚å®‰è£&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;stat / | awk &#39;/Birth: /{print $2 &amp;quot; &amp;quot; substr($3,1,5)}&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://linuxiac.com/how-to-find-linux-os-installation-date/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux Installation Date: How to Discover Your Systemâ€™s Age&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;condition&quot; tabindex=&quot;-1&quot;&gt;conditionæ¢ä»¶åˆ¤æ–·&lt;/h3&gt;
&lt;p id=&quot;bdeaee&quot;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;    if [[ !  -d &amp;quot;$1&amp;quot; ]]; then
        mkdir -p &amp;quot;$1&amp;quot;
    fi
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ å…©å€‹ &lt;code&gt;[[&lt;/code&gt; æˆ– ä¸€å€‹ &lt;code&gt;[&lt;/code&gt; ï¼Œ&lt;br /&gt;
ä»£è¡¨çš„æ„æ€å·®ä¸å¤šï¼Œåªæ˜¯å…©å€‹ &lt;code&gt;[&lt;/code&gt; ç®—æ˜¯æ–°ç‰ˆç”¨æ³•ï¼Œ&lt;br /&gt;
ä»–å¯ä»¥å¤šåšå­—ä¸²çš„æ¯”è¼ƒæ“ä½œ&lt;code&gt;== , != ,=~ &lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-d&lt;/code&gt; æ˜¯ä¸€å€‹æ¢ä»¶æ¸¬è©¦æ¨™èªŒï¼Œæª¢æŸ¥æ˜¯å¦ç‚ºç›®éŒ„&lt;br /&gt;
å…¶ä»–çš„ç›¸ä¼¼çš„æ¨™èªŒå¦‚ä¸‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-d&lt;/code&gt; ï¼Œç”¨æ–¼æª¢æŸ¥æŒ‡å®šè·¯å¾‘æ˜¯å¦ç‚ºç›®éŒ„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-f&lt;/code&gt;ï¼šæª¢æŸ¥æŒ‡å®šè·¯å¾‘æ˜¯å¦ç‚ºæ™®é€šæª”æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-x&lt;/code&gt;ï¼šæª¢æŸ¥æª”æ¡ˆæ˜¯å¦å¯åŸ·è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-r&lt;/code&gt;ï¼šæª¢æŸ¥æª”æ¡ˆæ˜¯å¦å¯è®€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-w&lt;/code&gt;ï¼šæª¢æŸ¥æª”æ¡ˆæ˜¯å¦å¯å¯«ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-s&lt;/code&gt;ï¼šæª¢æŸ¥æª”æ¡ˆæ˜¯å¦å­˜åœ¨ä¸”å¤§å°ä¸ç‚ºé›¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-e&lt;/code&gt;ï¼šæª¢æŸ¥æª”æ¡ˆæ˜¯å¦å­˜åœ¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;function&quot; tabindex=&quot;-1&quot;&gt;function å»ºç«‹&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;function bindmount() {
    if [[ !  -d &amp;quot;$1&amp;quot; ]]; then
        mkdir -p &amp;quot;$1&amp;quot;
    fi

    chown -R :100 &amp;quot;$1&amp;quot; &amp;quot;$2&amp;quot;
	mount --bind &amp;quot;$1&amp;quot; &amp;quot;$2&amp;quot;
}

bindmount &amp;quot;/home/mike/upload&amp;quot; &amp;quot;/home/bms/mike&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‚³åƒæ•¸é€²å»æ™‚ï¼Œè¨˜å¾—åœ¨å¾Œé¢åŠ ä¸Š&lt;code&gt;&amp;quot;&lt;/code&gt; é›™å¼•è™Ÿï¼ŒåŒ…èµ·ä¾†ï¼Œ&lt;br /&gt;
é¿å…ä¸­é–“æœ‰ç‰¹åˆ¥çš„å­—å…ƒå°è‡´ï¼Œè¼¸å…¥å¤±æ•—ã€‚&lt;/p&gt;
&lt;p&gt;ç¨å¾®æä¸€ä¸‹ï¼Œmount --bind å‰é¢æ˜¯ä¾†æº ï¼Œå¾Œé¢æ˜¯ç›®çš„ã€‚&lt;br /&gt;
æˆ‘ä¸å¤ªæ‡‚GPTçš„å›ç­”&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%90%A7%20Linux/108.fig-1.png&quot; alt=&quot;108.fig-1.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;cpu-process&quot; tabindex=&quot;-1&quot;&gt;æ¶ˆè€—æœ€å¤šCPUçš„process&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;ps H -eo pid,pcpu | sort -nk2 | tail   
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°æ‡‰çš„æœå‹™åç¨±&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ps aux | fgrep &amp;lt;PID&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/108. linux shell é€²éšæŒ‡ä»¤/" />
        </entry>
        <entry>
            <title>
                0.Linux MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ§ Linux/0.Linux MOC/</id>
            <content type="html">
                &lt;h1 id=&quot;basic&quot; tabindex=&quot;-1&quot;&gt;basic&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/132.%20shell%20script%20%E9%9B%99%E5%BC%95%E8%99%9F%E8%88%87%E5%96%AE%E5%BC%95%E8%99%9F/&quot;&gt;132. shell script é›™å¼•è™Ÿèˆ‡å–®å¼•è™Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/133.%20shell%20script%E5%AD%97%E4%B8%B2%E8%99%95%E7%90%86/&quot;&gt;133. shell scriptå­—ä¸²è™•ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/163.Shell%E7%9A%84%E5%8D%80%E5%88%A5%E5%8F%8A%E6%9F%A5%E8%A9%A2/&quot;&gt;163.Shellçš„å€åˆ¥åŠæŸ¥è©¢&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;setting&quot; tabindex=&quot;-1&quot;&gt;Setting&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/33.%20centos%207%E5%AE%89%E8%A3%9Dredis%20%E6%94%B9port/&quot;&gt;33. centos 7å®‰è£redis æ”¹port&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/49.npm%20%E8%88%87%20yarn%20%E6%AF%94%E8%BC%83/&quot;&gt;49.npm èˆ‡ yarn æ¯”è¼ƒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/116.%20%E5%AE%89%E8%A3%9Dlinux%20server%20%E5%9F%BA%E6%9C%AC%E8%A8%AD%E5%AE%9A/&quot;&gt;116. å®‰è£linux server åŸºæœ¬è¨­å®š&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;tools&quot; tabindex=&quot;-1&quot;&gt;Tools&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/16.dustise%20sleep%20%E6%B8%AC%E8%A9%A6%E5%B7%A5%E5%85%B7%E7%B0%A1%E4%BB%8B/&quot;&gt;16.dustise sleep æ¸¬è©¦å·¥å…·ç°¡ä»‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/51.curl%20%E7%AD%86%E8%A8%98/&quot;&gt;51.curl ç­†è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/65.%20Linux%20command%20-%20grep/&quot;&gt;65. Linux command - grep&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/93.%20shellscript%E8%A7%A3%E6%9E%90/&quot;&gt;93. shellscriptè§£æ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/108.%20linux%20shell%20%E9%80%B2%E9%9A%8E%E6%8C%87%E4%BB%A4/&quot;&gt;108. linux shell é€²éšæŒ‡ä»¤&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/134.%20%E9%97%9C%E9%96%89ssh%E9%80%A3%E7%B7%9A%E5%BE%8C%EF%BC%8C%E4%BB%8D%E5%8F%AF%E5%9F%B7%E8%A1%8C%E7%A8%8B%E5%BC%8F/&quot;&gt;134. é—œé–‰sshé€£ç·šå¾Œï¼Œä»å¯åŸ·è¡Œç¨‹å¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/165.%20Linux%E7%B6%B2%E8%B7%AF%E8%BF%BD%E8%B9%A4%E5%B7%A5%E5%85%B7-%20MTR/&quot;&gt;165. Linuxç¶²è·¯è¿½è¹¤å·¥å…·- MTR&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/171.%20linux%20top%E6%8C%87%E4%BB%A4%E8%A9%B3%E8%A7%A3/&quot;&gt;171. linux topæŒ‡ä»¤è©³è§£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/173.%20Linux%E6%AE%AD%E5%B1%8D%E7%A8%8B%E5%BC%8F/&quot;&gt;173. Linuxæ®­å±ç¨‹å¼&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/php%20exec%20ssh%20%E7%99%BC%E7%94%9F%20Host%20key%20verification%20failed%20%E9%8C%AF%E8%AA%A4/&quot;&gt;php exec ssh ç™¼ç”Ÿ Host key verification failed éŒ¯èª¤&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/114.%20alpine%20linux%20%E5%AE%A3%E5%91%8A%E8%AE%8A%E6%95%B8,error%20bad%20variable%20name/&quot;&gt;114. alpine linux å®£å‘Šè®Šæ•¸,error bad variable name&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/48.SSH%E7%84%A1%E6%B3%95%E9%80%A3%E7%B7%9A%EF%BC%8CREMOTE%20HOST%20IDENTIFICATION%20HAS%20CHANGED/&quot;&gt;48.SSHç„¡æ³•é€£ç·šï¼ŒREMOTE HOST IDENTIFICATION HAS CHANGED&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/63.alpine%20linux%20apk%20ERROR%20unable%20to%20select%20packages/&quot;&gt;linuxå®‰è£æ¸¬è©¦package&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ§ Linux/0.Linux MOC/" />
        </entry>
        <entry>
            <title>
                é¼ é¬šç®¡è¼¸å…¥æ³•
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ Mac/é¼ é¬šç®¡è¼¸å…¥æ³•/</id>
            <content type="html">
                &lt;ol&gt;
&lt;li&gt;å®‰è£ RIME&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;brew install --cask squirrel
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®‰è£å®Œå¾Œéœ€è¦ç™»å‡ºå†ç™»å…¥&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;ä¸‹è¼‰æœ€æ–°çš„æª”æ¡ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;https://github.com/Ponpon55837/Squirrel/releases
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;macçš„è©±ï¼Œå…ˆå¢åŠ é¼ é¬šç®¡çš„è¼¸å…¥æ³•ï¼ˆåœ¨ç°¡é«”ä¸­æ–‡å…§ï¼‰ï¼Œå†é–‹å•“ä»–çš„ç”¨æˆ¶è¨­å®š&lt;/li&gt;
&lt;li&gt;å°‡(3)çš„å…§å®¹å…¨éƒ¨åˆªé™¤å¾Œï¼Œå°‡(2)çš„æª”æ¡ˆè²¼åˆ°ä¸Šé¢&lt;/li&gt;
&lt;li&gt;ç„¶å¾Œé»ã€é‡æ–°éƒ¨ç½²ã€&lt;/li&gt;
&lt;li&gt;squirrel.custom.yaml ä¿®æ”¹ä¸»é¡Œæˆ–é¡è‰²&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ Mac/é¼ é¬šç®¡è¼¸å…¥æ³•/" />
        </entry>
        <entry>
            <title>
                æ°¸ä¹…åˆ¥å alias
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ Mac/æ°¸ä¹…åˆ¥å alias/</id>
            <content type="html">
                &lt;p&gt;ä¿®æ”¹è·¯å¾‘ ~/.zshrc&lt;br /&gt;
ç„¶å¾Œè¼¸å…¥è¦æ–°å¢çš„alias.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alias tf=&amp;quot;terraform&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ Mac/æ°¸ä¹…åˆ¥å alias/" />
        </entry>
        <entry>
            <title>
                iTerm2å®‰è£
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ Mac/iTerm2å®‰è£/</id>
            <content type="html">
                &lt;h1 id=&quot;2024-05-27&quot; tabindex=&quot;-1&quot;&gt;2024/05/27 æ›´æ–°&lt;/h1&gt;
&lt;p&gt;æ›äº†ä¸€å°mac miniï¼Œ&lt;br /&gt;
æ±è¥¿è¦é‡è£ï¼Œç„¶å¾Œç™¼ç¾ï¼Œæˆ‘æŒ‡ä»¤éƒ½éæ™‚äº†ï¼Œé †ä¾¿é‡æ–°æ•´ç†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®‰è£ Homebrew&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;   /bin/bash -c &amp;quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å®‰è£iTerm2&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;brew install --cask iterm2   
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;
&lt;p&gt;å¥—ç”¨é…è‰²&lt;br /&gt;
åˆ°&lt;a href=&quot;http://iterm2colorschemes.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;iterm2 color schemes&lt;/a&gt; é¸æ“‡å–œæ­¡çš„é…è‰²å¾Œimportã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8D%8E%20Mac/iTerm2-1.png&quot; alt=&quot;iTerm2-1.png&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8D%8E%20Mac/iTerm2-2.png&quot; alt=&quot;iTerm2-2.png&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®‰è£ZSH&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;   brew install zsh zsh-completions
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;å°‡é è¨­çµ‚ç«¯æ©Ÿæ”¹çˆ²ZSH&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sudo sh -c &amp;quot;echo $(which zsh) &amp;gt;&amp;gt; /etc/shells&amp;quot;
chsh -s $(which zsh)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;å®‰è£ Oh My ZSH&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sh -c &amp;quot;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;7&quot;&gt;
&lt;li&gt;å¥—ç”¨ä¸»é¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;open ~/.zshrc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰¾é—œéµå­—ï¼Œ SH_THEME=&lt;br /&gt;
ä¿®æ”¹æˆ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ZSH_THEME=&amp;quot;agnoster&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;8&quot;&gt;
&lt;li&gt;
&lt;p&gt;å®‰è£ powerline font&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;brew install --cask font-sauce-code-pro-nerd-font
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åƒè€ƒä¸Šé¢åœ–ç‰‡ï¼Œæ”¹é¸æ“‡Textï¼Œä¿®æ”¹å­—é«”ï¼Œå­—é«”åç¨±ç‚º &lt;code&gt;SauceCodePro Nerd Ford&lt;/code&gt;&lt;br /&gt;
å¦‚æœè¦æ‰¾å…¶ä»–å­—é«”çš„è©±ï¼Œæœå°‹é—œéµå­—&lt;code&gt;Nerd&lt;/code&gt;&lt;br /&gt;
&lt;code&gt;brew search --cask nerd&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¿®æ”¹å­—é«”ï¼Œä¸ç„¶æœ‰äº‚ç¢¼ï¼ˆå·²æ£„ç”¨ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;# clone è¤‡è£½  
git clone https://github.com/powerline/fonts.git --depth=1  
# install å®‰è£  
cd fonts  
./install.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¥—ç”¨å­—é«”&lt;br /&gt;
iTerm â†’ Preferences â†’ Profiles â†’ Text â†’ Change Fontâ†’ Meslo&lt;/p&gt;
&lt;ol start=&quot;9&quot;&gt;
&lt;li&gt;ç¨‹å¼ç¢¼é«˜äº®&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;brew install zsh-syntax-highlighting
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œä¿®æ”¹è¨­å®š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;open ~/.zshrc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¨­å®šæª”æœ€å¾ŒåŠ ä¸Š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# For zsh syntax-highlighting
source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/statementdog-engineering/prettify-your-zsh-command-line-prompt-3ca2acc967f&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è¶…ç°¡å–®ï¼ååˆ†é˜æ‰“é€ æ¼‚äº®åˆå¥½ç”¨çš„ zsh command line ç’°å¢ƒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/@hazelwu/%E7%94%A8oh-my-zsh%E6%8A%8Aiterm%E8%AE%8A%E7%BE%8E%E7%BE%8E-8a18daa8eac&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç”¨Oh My ZshæŠŠiTermè®Šç¾ç¾&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://spreered.medium.com/%E5%AE%A2%E8%A3%BD%E6%88%91%E7%9A%84-cli-%E7%B5%82%E6%96%BC%E7%A8%8D%E5%BE%AE%E6%90%9E%E6%87%82-iterm-zsh-d3feed27f664&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®¢è£½æˆ‘çš„ CLI â€” çµ‚æ–¼ç¨å¾®ææ‡‚ iTerm + ZSH&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ Mac/iTerm2å®‰è£/" />
        </entry>
        <entry>
            <title>
                iTerm2-Powerlevel10kè¨­å®š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ Mac/iTerm2-Powerlevel10kè¨­å®š/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æˆ‘è¨˜å¾—ä»¥å‰æˆ‘çš„iTermæœ€å¾Œé¢æœ‰é¡¯ç¤ºæ™‚é–“ï¼Œ&lt;br /&gt;
ä½†ç›®å‰ç”¨çš„æ²’æœ‰ï¼Œ&lt;br /&gt;
äº‚æ‰¾äº†ä¸€ä¸‹ï¼Œç™¼ç¾ä¸€å€‹ç°¡å–®pluginï¼Œä¸åƒ&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8D%8E%20Mac/iTerm2%E5%AE%89%E8%A3%9D/&quot;&gt;iTerm2å®‰è£&lt;/a&gt;ï¼Œ&lt;br /&gt;
éœ€è¦è‡ªå·±æ‰‹å‹•è£å­—é«”ã€‚&lt;/p&gt;
&lt;h1 id=&quot;å…§å®¹&quot; tabindex=&quot;-1&quot;&gt;å…§å®¹&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;å®‰è£å¥½iTerm2å¾Œï¼Œåƒè€ƒ&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8D%8E%20Mac/iTerm2%E5%AE%89%E8%A3%9D/&quot;&gt;iTerm2å®‰è£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å®‰è£ zshä¸»é¡Œ  &lt;a href=&quot;https://github.com/romkatv/powerlevel10k&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Powerlevel10k&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;git clone --depth=1 https://github.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;è¨­å®šzsh theme&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;ZSH_THEME=&amp;quot;powerlevel10k/powerlevel10k&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;é–‹å•Ÿè¨­å®šç•«é¢&lt;br /&gt;
å¯ä»¥é¸æ“‡é‡é–‹iTerm2 æˆ–æ˜¯ åŸ·è¡ŒæŒ‡ä»¤&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;p10k configure
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ä¾†å°±çœ‹ä»–çš„èªªæ˜é¸æ“‡ä½ æƒ³è¦çš„è¨­å®šã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯æˆ‘ç›®å‰çš„ç•«é¢&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8D%8E%20Mac/iTerm2-3.png&quot; alt=&quot;iTerm2-3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æœ€å¾Œä¸€é …ï¼Œé¸æ“‡è¦ä¸è¦é–‹å•Ÿ &lt;a href=&quot;https://github.com/romkatv/powerlevel10k?tab=readme-ov-file#instant-prompt&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Instant Prompt&lt;/a&gt;&lt;br /&gt;
æ ¹æ“šæ–‡ç« èªªæ³•ï¼Œå¯ä»¥æ¶ˆé™¤å•Ÿå‹•æ™‚é–“éé•·çš„æƒ…æ³ï¼ˆå¦‚æœä½ çš„å¥—ä»¶å¾ˆå¤šæ™‚ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘é¸æ“‡é—œæ‰ï¼Œæ²’å•¥å·®åˆ¥ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæƒ³å†é‡æ–°è¨­å®šåƒæ•¸çš„è©±ï¼Œå†åŸ·è¡Œä¸€æ¬¡æŒ‡ä»¤ &lt;code&gt;p10k configure&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.onejar99.com/terminal-iterm2-zsh-powerlevel10k/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è®“ macOS çš„ Terminal åˆæ½®åˆå¯¦ç”¨ï¼šæ‰‹æŠŠæ‰‹è¨­å®šæ•™å­¸ iTerm2 + oh-my-zsh + Powerlevel10k&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;æ•…éšœæ’é™¤&quot; tabindex=&quot;-1&quot;&gt;æ•…éšœæ’é™¤&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æˆ‘è¼¸å…¥ä»»ä½•æŒ‡ä»¤ï¼Œéƒ½æœƒè·³å‡ºéŒ¯èª¤&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;prompt_context:2: command not found: prompt_segment&lt;br /&gt;
é–‹å•Ÿ &lt;code&gt;~/.zshrc&lt;/code&gt; ï¼Œå°‹æ‰¾é—œéµå­— &lt;code&gt;prompt_segment&lt;/code&gt;ï¼Œ&lt;br /&gt;
æŠŠé‚£æ•´å€‹functionç äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://github.com/Powerlevel9k/powerlevel9k/issues/423&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;prompt_context:2: command not found: prompt_segment&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ Mac/iTerm2-Powerlevel10kè¨­å®š/" />
        </entry>
        <entry>
            <title>
                0.ï¼­AC MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ Mac/0.ï¼­AC MOC/</id>
            <content type="html">
                &lt;h1 id=&quot;å®‰è£äº‹é …&quot; tabindex=&quot;-1&quot;&gt;å®‰è£äº‹é …&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8D%8E%20Mac/iTerm2%E5%AE%89%E8%A3%9D/&quot;&gt;iTerm2å®‰è£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8D%8E%20Mac/%E9%BC%A0%E9%AC%9A%E7%AE%A1%E8%BC%B8%E5%85%A5%E6%B3%95/&quot;&gt;é¼ é¬šç®¡è¼¸å…¥æ³•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://mcbopomofo.openvanilla.org/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å°éº¥æ³¨éŸ³è¼¸å…¥æ³•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.mediaatelier.com/CheatSheet/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;cheatSheet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://free.com.tw/hidden-bar/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;hidden Bar&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.kocpc.com.tw/archives/280072&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Xnip&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;ä¹‹å¾Œå¯ä»¥è©¦è©¦çœ‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;s&gt;&lt;a href=&quot;https://free.com.tw/vchewing/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¨æ³¨éŸ³è¼¸å…¥æ³•&lt;/a&gt;&lt;/s&gt; ï¼ˆå°éº¥çœŸçš„å¥½ç”¨ï¼Œè³‡æºåˆåƒä¸å…‡ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://free.com.tw/amphetamine/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Amphetamine&lt;/a&gt; (é€²éšèƒ½æºç¯€ç´„æ¨¡å¼)&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;mac&quot; tabindex=&quot;-1&quot;&gt;MAC è»Ÿé«”&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;64.macç”¨çš„fiddlerï¼ŒWhistle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://iina.io/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;iina(å½±ç‰‡æ’­æ”¾)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;s&gt;&lt;a href=&quot;https://evernote.com/intl/zh-tw/products/skitch&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;skitch(æˆªåœ–)&lt;/a&gt;&lt;/s&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://apps.apple.com/tw/app/xnip-screenshot-annotation/id1221250572?mt=12&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;xnip(æˆªåœ–)&lt;/a&gt;&lt;br /&gt;
ç°¡å–®æˆªåœ–ç”¨&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://shottr.cc/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;shotter(å¤šåŠŸèƒ½æˆªåœ–)&lt;/a&gt;&lt;br /&gt;
ç›®å‰éƒ½æ”¹ç”¨é€™å¥—äº†&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.coconut-flavour.com/coconutbattery/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;coconutbattery(æŸ¥è©¢iosè£ç½®é›»æ± )&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://apps.apple.com/tw/app/hidden-bar/id1452453066?mt=12&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;hiddenbar&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://applealmond.com/posts/97644&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Rectangleï¼ˆè¦–çª—ç®¡ç†)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;mac-1&quot; tabindex=&quot;-1&quot;&gt;MACæ“ä½œ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;macåœ¨terminalé–‹å•“finder&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8D%8E%20Mac/%E6%B0%B8%E4%B9%85%E5%88%A5%E5%90%8D%20alias/&quot;&gt;æ°¸ä¹…åˆ¥å alias&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;macé–‹å•“éš±è—æª”æ¡ˆï¼š&lt;code&gt;Shift+Command+ .&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ Mac/0.ï¼­AC MOC/" />
        </entry>
        <entry>
            <title>
                99. nginxçš„é™¤éŒ¯ç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸŒ Network/99. nginxçš„é™¤éŒ¯ç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æˆ‘ä¸€ç›´å°nginxä¸å¤ªç†Ÿï¼Œ&lt;br /&gt;
ç›®å‰ä¹Ÿåªåˆ°äº†æœƒç”¨ï¼Œå¤§éƒ¨åˆ†çš„æŒ‡ä»¤çœ‹å¾—æ‡‚ã€‚&lt;br /&gt;
ä½†æ¹Šåœ¨ä¸€èµ·ï¼Œé‚„æ˜¯è¦æŸ¥ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;é€™æ¬¡çš„éŒ¯èª¤å°±ç™¼ç”Ÿåœ¨æˆ‘ä»¥ç‚ºçš„å•é¡Œä¸Š&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;åˆå¤šäº†ä¸€å€‹æ–°æœå‹™è¦æ¶è¨­ï¼Œ&lt;br /&gt;
æ‰€ä»¥æƒ³ç•¶ç„¶ï¼Œæ±è¥¿åˆä¸Ÿåˆ°æˆ‘é€™ä¾†äº†ã€‚&lt;br /&gt;
é€™æ¬¡è·Ÿä»¥å‰çš„æ¯”è¼ƒä¸ä¸€æ¨£ï¼Œé€™æ¬¡æ˜¯ä¸€å€‹å…¨æ–°çš„æœå‹™ã€‚&lt;br /&gt;
æ‰€ä»¥ä¹‹å‰çš„è‡ªå‹•ä½ˆç½²ã€yamlã€nginxè¨­å®šæª”é€šé€šé‡ä¾†ã€‚&lt;br /&gt;
é›–ç„¶èªªæ˜¯é‡ä¾†ï¼Œä½†ä¹Ÿåªæ˜¯è¤‡è£½è²¼ä¸Šæ”¹ä¸€æ”¹ï¼Œç„¶å¾Œå°±ç‚¸äº†XDDDD&lt;/p&gt;
&lt;p&gt;æˆ‘è¤‡è£½ä¹‹å‰çš„è¨­å®šæª”åƒé€™å€‹æ¨£å­ã€‚ä¸­é–“åˆªé™¤äº†å¾ˆå¤šæ±è¥¿ï¼Œ&lt;br /&gt;
è«‹ä¸è¦ç…§æŠ„ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server_tokens off;
log_format  client  &#39;$remote_addr - $remote_user [$time_local] , &#39;
                  &#39;http-host: &amp;quot;$http_host&amp;quot; , URL: &amp;quot;$request&amp;quot;  , request-status : &amp;quot;$status&amp;quot;  ,   &#39;
                  &#39;body-byte: $body_bytes_sent  ,http-referer: &amp;quot;$http_referer&amp;quot;  ,&#39;
                  &#39;user-agent: &amp;quot;$http_user_agent&amp;quot; , X-Forwarded-For : &amp;quot;$http_x_forwarded_for&amp;quot; ,  &#39;
                  &#39; request-time: &amp;quot;$request_time&amp;quot;  , response_time : &amp;quot;$upstream_response_time&amp;quot;  &#39;;

client_max_body_size 100m;
gzip on;
gzip_min_length 1k;
gzip_buffers 4 16k;
gzip_comp_level 5;
gzip_types text/plain text/css application/x-javascript application/javascript application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;

# GCP HTTP(S) LoadBalancer will add Via, but nginx check it to disable compress by default...
gzip_proxied any;
gzip_vary on;

server {
    listen 80 default_server;
    listen [::]:80 default_server;
    access_log  /dev/stdout   client;
      error_log /dev/stderr;
        
    index index.html index.htm;
    location = /favicon.ico { access_log off; log_not_found off; }
    location = /robots.txt  { access_log off; log_not_found off; }
      

    location /api/socket.io/ {
        proxy_pass http://rd5-api;
        proxy_set_header Host $host;
        proxy_set_header token $rd5_token;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        # proxy_set_header X-NginX-Proxy true;
        proxy_set_header X-Real-IP $remote_addr;
        # proxy_set_header via &#39;proxy_pass/token-proxy ws&#39;;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection &amp;quot;Upgrade&amp;quot;;
        proxy_read_timeout 1d;
        
    }

    location /50x.html {
        root /usr/share/nginx/html/frontend-client/;
        internal;
    }
    location /healthz {
        access_log off;
        return 200 &#39;ok&#39;;
    }

    location / {
        error_page 418 = @fjysdz;
        recursive_error_pages on;

        if ($host = &#39;yb-test.fjysdz.cn&#39;) {
           return 418;
        }
        rewrite &amp;quot;^(.*)&#92;$&amp;quot; $1 permanent; # å»é™¤urlå°¾éƒ¨é‡è¤‡æ–œç·š
        root /usr/share/nginx/html/frontend-client/$dir;
        add_header via frontend-proxy;
        try_files $uri $uri/ /index.html /index.htm =404;
    }



}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œå°±å‡ºç¾éŒ¯èª¤äº†&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;quot;server_tokens&amp;quot; directive is not allowed here&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ç™¾æ€ä¸å¾—å…¶è§£ï¼Œæˆ‘æ˜æ˜æ˜¯ç…§æŠ„çš„æ€éº¼æœƒéŒ¯ã€‚&lt;br /&gt;
å¾Œä¾†å°‡server_tokensæ¬é€²å» server çš„å€å¡Šå…§ï¼Œå¥½äº†èƒ½è·‘äº†ã€‚&lt;br /&gt;
ä½†åˆçˆ†å‡º&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;quot;log_format&amp;quot; directive is not allowed here&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘åˆåªå¥½åœ¨æœ€å¤–å±¤åŠ ä¸Šhttp {}  ï¼Œä½†å¿ƒä¸­ä¸€ç›´æœ‰ä¸€å€‹ç–‘å•ï¼Œ&lt;br /&gt;
ç‚ºä»€éº¼æœƒå¤±æ•—ï¼ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æœ€å¾Œè®Šæˆé€™æ¨£&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
events {
     worker_connections 1024;
}
http {

log_format  client  &#39;$remote_addr - $remote_user [$time_local] , &#39;
                  &#39;http-host: &amp;quot;$http_host&amp;quot; , URL: &amp;quot;$request&amp;quot;  , request-status : &amp;quot;$status&amp;quot;  ,   &#39;
                  &#39;body-byte: $body_bytes_sent  ,http-referer: &amp;quot;$http_referer&amp;quot;  ,&#39;
                  &#39;user-agent: &amp;quot;$http_user_agent&amp;quot; , X-Forwarded-For : &amp;quot;$http_x_forwarded_for&amp;quot; ,  &#39;
                  &#39; request-time: &amp;quot;$request_time&amp;quot;  , response_time : &amp;quot;$upstream_response_time&amp;quot;  &#39;;

client_max_body_size 100m;
gzip on;
gzip_min_length 1k;
gzip_buffers 4 16k;
gzip_comp_level 5;
gzip_types text/plain text/css application/x-javascript application/javascript application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;

# GCP HTTP(S) LoadBalancer will add Via, but nginx check it to disable compress by default...
gzip_proxied any;
gzip_vary on;

server {

    server_tokens off;
    listen 80 default_server;
    listen [::]:80 default_server;
    access_log  /dev/stdout   client;
      error_log /dev/stderr;
        
    index index.html index.htm;
    location = /favicon.ico { access_log off; log_not_found off; }
    location = /robots.txt  { access_log off; log_not_found off; }
      
    location /conf/domain {
       access_log off;
        default_type application/json;
        add_header &#39;Access-Control-Allow-Origin&#39; &#39;*&#39;;
        add_header &#39;Access-Control-Allow-Methods&#39; &#39;GET&#39;;
        return 200 &#39;{&amp;quot;domain&amp;quot;:&amp;quot;500015&amp;quot;, &amp;quot;site&amp;quot;: &amp;quot;porn1&amp;quot; ,&amp;quot;cdn&amp;quot;:&amp;quot;x-cdn-yb&amp;quot;}&#39;;
    }

    # frontend-client
    error_page 404 /404.html;
    error_page 500 502 503 504 /50x.html;
    location /404.html {
        root /usr/share/nginx/html/frontend-client/;
        internal;
    }
    location /50x.html {
        root /usr/share/nginx/html/frontend-client/;
        internal;
    }
    location /healthz {
        access_log off;
        return 200 &#39;ok&#39;;
    }

    location / {
        rewrite &amp;quot;^(.*)&#92;$&amp;quot; $1 permanent; # å»é™¤urlå°¾éƒ¨é‡è¤‡æ–œç·š
        root /usr/share/nginx/html/$dir;
        add_header via frontend-proxy;
        try_files $uri $uri/ /index.html /index.htm =404;
    }


}


}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è·‘æ˜¯èƒ½æ­£å¸¸è·‘äº†ï¼Œä½†é é¢è¼‰å…¥ä¸€ç›´å‡ºå•é¡Œï¼Œ&lt;br /&gt;
å› ç‚ºnginx logæ­£å¸¸äº†ï¼Œå°±è¯çµ¡å‰ç«¯åŒä»å¹«çœ‹ä¸€ä¸‹ã€‚&lt;br /&gt;
ä»–èªªå¾ä¼ºæœå™¨å–å¾—çš„css context-typeæœ‰å•é¡Œã€‚&lt;br /&gt;
æŸ¥äº†ä¸€ä¸‹ï¼Œåˆç™¼ç¾ä¸€å€‹æ±è¥¿æ²’å¸¶ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;include /etc/nginx/mime.types;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚ºä»€éº¼ä¸€å€‹èƒ½è·‘ä¸€å€‹ä¸èƒ½è·‘ï¼Ÿï¼Ÿï¼Ÿ&lt;br /&gt;
æœ€å¾Œç™¼ç¾ä¸€å€‹é‡é»ã€‚&lt;/p&gt;
&lt;h3 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h3&gt;
&lt;p&gt;Nginx çš„è¨­å®šæª”é è¨­çš„ä½ç½®æ˜¯&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;/etc/nginx/nginx.conf&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç„¶å¾Œï¼Œé€™å€‹æª”æ¡ˆè£¡é¢æœƒå…ˆå¯«å¥½é è¨­çš„è¨­å®šã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;user  nginx;
worker_processes  auto;

error_log  /var/log/nginx/error.log notice;
pid        /var/run/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &amp;quot;$request&amp;quot; &#39;
                      &#39;$status $body_bytes_sent &amp;quot;$http_referer&amp;quot; &#39;
                      &#39;&amp;quot;$http_user_agent&amp;quot; &amp;quot;$http_x_forwarded_for&amp;quot;&#39;;

    access_log  /var/log/nginx/access.log  main;

    sendfile        on;
    &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#tcp_nopush&quot;&gt;#tcp_nopush&lt;/a&gt;     on;

    keepalive_timeout  65;

    &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#gzip&quot;&gt;#gzip&lt;/a&gt;  on;

    include /etc/nginx/conf.d/*.conf;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥èƒ½è·‘çš„æœå‹™ï¼Œæ˜¯å› ç‚ºä»–çš„è¨­å®šæª”æ”¾åœ¨ conf.d è£¡é¢ï¼Œ&lt;br /&gt;
æ‰€ä»¥æ˜¯å¾ nginx.confè¼‰å…¥ /etc/nginx/conf.d/*.conf çš„è¨­å®šã€‚&lt;/p&gt;
&lt;p&gt;è€Œä¸èƒ½è·‘çš„æœå‹™ï¼Œæˆ‘æ˜¯å°‡è¨­å®šæª”ç›´æ¥è¦†è“‹ /etc/nginx/nginx.conf  ï¼Œ&lt;br /&gt;
æ‰€ä»¥ä¸Šé¢é‚£ä¸€äº›è¨­å®šæˆ‘éƒ½æ²’å¯«åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.796t.com/content/1546357704.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;nginxä¸­CSSé‡å®šå‘è§£ææœ‰å•é¡Œâ€”â€”mime.typeè©³è§£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/188358/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Nginxç­†è¨˜ï¼ˆäºŒï¼‰NginxåŸºç¤&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸŒ Network/99. nginxçš„é™¤éŒ¯ç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                92. proxy ä»£ç†
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸŒ Network/92. proxy ä»£ç†/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä»£ç†ä¼ºæœå™¨ï¼Œä»¥å‰æœ€å¸¸ç”¨éçš„æ‡‰è©²æ˜¯Hinetçš„proxyï¼Œ&lt;br /&gt;
åœ¨ä»¥å‰ç¶²è·¯ä¸å¿«çš„æ™‚å€™ï¼Œæœ‰æ™‚æœƒæ›prxoyï¼Œä¾†è®“ç€è¦½é€Ÿåº¦è®Šå¿«ã€‚&lt;br /&gt;
proxyçš„ç”¨é€”ä¸»è¦ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå°‡userçš„è«‹æ±‚é€éprxoyå»è·Ÿç¶²ç«™å–å¾—è³‡æ–™ï¼Œå†å›çµ¦userã€‚&lt;/p&gt;
&lt;p&gt;ä½†proxyåˆ†æˆå¾ˆå¤šç¨®..ä¸‹é¢ç°¡å–®èªªæ˜&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;HTTPä»£ç†&lt;br /&gt;
ä¸»è¦ç”¨æ–¼å­˜å–ç¶²é ï¼Œä¸€èˆ¬æœ‰å…§å®¹éæ¿¾å’Œå¿«å–åŠŸèƒ½ï¼ˆå°‡HTTPè«‹æ±‚è½‰ç™¼åˆ°æ‰€éœ€çš„HTTPä¼ºæœå™¨ï¼‰ã€‚&lt;br /&gt;
userä½¿ç”¨æ–¹æ³•ï¼Œæ˜¯ç€è¦½å™¨æ›httpä»£ç†ä¼ºæœå™¨å¾Œï¼Œå»ç€è¦½ç¶²é &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;TCPä»£ç†&lt;br /&gt;
ä¼ºæœå™¨ç«¯å¯¦ä½œè½‰ç™¼TCPè«‹æ±‚ï¼Œç•¶è¨ªå•æœ¬æ©Ÿçš„portæ™‚ï¼Œæœƒè½‰åˆ°æŒ‡å®šipçš„portä¸Š&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;UDPä»£ç†&lt;br /&gt;
ä¼ºæœå™¨ç«¯å¯¦ä½œè½‰ç™¼UDPè«‹æ±‚ï¼Œç•¶è¨ªå•æœ¬æ©Ÿçš„portæ™‚ï¼Œæœƒè½‰åˆ°æŒ‡å®šipçš„portä¸Š&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…§ç¶²ç©¿é€&lt;br /&gt;
å°‡å…§ç¶²æœå‹™æä¾›çµ¦å¤–éƒ¨åšä½¿ç”¨, Ngrok,frp&lt;br /&gt;
ï¼Œç•¶è«‹æ±‚é€£åˆ°å¤–ç¶²serverçš„å›ºå®športæ™‚ï¼Œè½‰ç™¼åˆ°å…§ç¶²æœå‹™çš„portä¸Šã€‚&lt;br /&gt;
ï¼ˆéœ€åœ¨æä¾›æœå‹™çš„å…§ç¶²serveråŠå¤–ç¶²çš„serveråˆ†åˆ¥è¨­å®šï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SOCKSä»£ç†&lt;br /&gt;
åªæ˜¯å–®ç´”å‚³éå°åŒ…ï¼Œä¸é—œå¿ƒå…·é«”å”å®šå’Œç”¨æ³•ï¼Œæ‰€ä»¥é€Ÿåº¦å¿«å¾ˆå¤šï¼ˆæ›´ä½çš„å”å®šï¼ŒSOCKS5èƒ½è™•ç†udp protocol)ã€‚&lt;br /&gt;
ç¬¬äº”å±¤å”å®šï¼Œæ•…èƒ½è™•ç†HTTPï¼ŒHTTPSï¼ŒPOP3ï¼ŒSMTPå’ŒFTPã€‚&lt;br /&gt;
userç°¡æ˜“ä½¿ç”¨æ–¹æ³•ï¼šä½¿ç”¨ ssh tunnel é€£åˆ°å…§éƒ¨ä¸»æ©Ÿã€‚&lt;br /&gt;
(æ¯”è¼ƒåä¼ºæœå™¨ç«¯å»ºè¨­ï¼Œéœ€é¡å¤–çš„è»Ÿé«”é€ésockså”å®šé€£å…¥)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SSä»£ç†&lt;br /&gt;
Shadowsocksï¼ŒåŸºæ–¼SOCKS5ä»£ç†æ–¹å¼çš„åŠ å¯†å”å®š&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref.&lt;br /&gt;
1. &lt;a href=&quot;https://zh.wikipedia.org/zh-tw/SOCKS&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SOCKS&lt;/a&gt;&lt;br /&gt;
2. &lt;a href=&quot;https://zh.wikipedia.org/zh-tw/%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä»£ç†ä¼ºæœå™¨&lt;/a&gt;&lt;br /&gt;
3. &lt;a href=&quot;https://www.netadmin.com.tw/netadmin/zh-tw/technology/E76819FB28CC4C3D99D3A6C37B6BD3F4&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¯¦æˆ°frpå…§ç¶²ç©¿é€ã€€å…§éƒ¨ä¸»æ©Ÿä¹Ÿèƒ½å°å¤–æœå‹™&lt;/a&gt;&lt;br /&gt;
4. &lt;a href=&quot;https://www.easyatm.com.tw/wiki/SOCKS5%E4%BB%A3%E7%90%86&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SOCKS5ä»£ç†&lt;/a&gt;&lt;br /&gt;
5. &lt;a href=&quot;https://yangxikun.com/http/2017/09/16/http-proxy.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Golangå‹•æ‰‹å¯«ä¸€å€‹Http Proxy&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;é¡Œå¤–è©±è£œå……ï¼š&lt;/p&gt;
&lt;h2 id=&quot;æ­£å‘ä»£ç†ï¼š&quot; tabindex=&quot;-1&quot;&gt;æ­£å‘ä»£ç†ï¼š&lt;/h2&gt;
&lt;p&gt;ä»£ç†ç”¨æˆ¶ç«¯ï¼Œè®“ä¼ºæœå™¨ä¸çŸ¥é“ç”¨æˆ¶çš„IP&lt;/p&gt;
&lt;h2 id=&quot;åå‘ä»£ç†ï¼š&quot; tabindex=&quot;-1&quot;&gt;åå‘ä»£ç†ï¼š&lt;/h2&gt;
&lt;p&gt;ä»£ç†ä¼ºæœå™¨ç«¯ï¼Œè®“ç”¨æˆ¶ä¸çŸ¥é“ä¼ºæœå™¨ç«¯çš„IP&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://www.pressplay.cc/author/28A3631456F0C5949514CAD4CB43150D&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç”¨äººé¡èªè¨€è·Ÿä½ èªªç”šéº¼æ˜¯æ­£å‘ä»£ç†(Forward Proxy)å’Œåå‘ä»£ç†(Reverse Proxy)&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸŒ Network/92. proxy ä»£ç†/" />
        </entry>
        <entry>
            <title>
                182. Fortigate è¨­å®š å…§éƒ¨æœå‹™è² è¼‰å¹³è¡¡
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸŒ Network/182. Fortigate è¨­å®š å…§éƒ¨æœå‹™è² è¼‰å¹³è¡¡/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;&lt;em&gt;&amp;amp;(&lt;/em&gt;&amp;amp;%(%^&amp;amp;&lt;em&gt;%@#$%^((&amp;amp;^%&lt;/em&gt; ä¸€é€£ä¸²æ¶ˆéŸ³ï¼Œ&lt;br /&gt;
èªªéæˆ‘åªæœƒç°¡æ˜“çš„ç¶²è·¯ç®¡ç†ï¼Œç„¶å¾Œç¾åœ¨å«æˆ‘æé€™å€‹ï¼Œ&lt;br /&gt;
ç›®å‰æ˜¯ç¬¬äºŒæ¬¡ï¼Œå†ä¾†ä¸€æ¬¡ï¼Œç›´æ¥ç•¢æ¥­å¥½äº†ã€‚&lt;br /&gt;
ç›´æ¥å»æ”¹å®¢æˆ¶çš„é˜²ç«ç‰†è¨­å®šæ˜¯ä½ ç˜‹äº†ï¼Œé‚„æ˜¯æˆ‘ç˜‹äº†ã€‚&lt;br /&gt;
å¼„ä¸å¥½ç¶²è·¯å…¨æ–·èª°è² è²¬ï¼ï¼Ÿ&lt;br /&gt;
é‚„æ˜¯ä½ èªçˆ²ç¶²è·¯å¾ˆç°¡å–®ï¼Œé‚£ä½ ä»–é¦¬çš„æ€éº¼ä¸è‡ªå·±æã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;è¦é”æˆçš„ç›®æ¨™ï¼Œuserå‘¼å«ä¸€å€‹ipç¶²å€ï¼Œæœƒè‡ªå‹•è½‰åˆ°å…¶ä»–çš„ä¼ºæœå™¨ä¸Šé¢ ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦åƒè€ƒfortigateå®˜ç¶²èªªæ˜ï¼Œ&lt;a href=&quot;https://docs.fortinet.com/document/fortigate/6.2.15/cookbook/713497/virtual-server&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Virtual server&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¸¬è©¦ä½¿ç”¨çš„FortiOSç‰ˆæœ¬ç‚º 7.2.5&lt;/p&gt;
&lt;h4 id=&quot;ç°¡ç•¥èªªæ˜&quot; tabindex=&quot;-1&quot;&gt;ç°¡ç•¥èªªæ˜&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;æ‰“é–‹ Virtual server&lt;br /&gt;
å¦‚æœæ²’çœ‹åˆ°ï¼Œéœ€åˆ° System -&amp;gt; Feature Visibility é–‹å•“ Additional Featuresåº•ä¸‹çš„  Load Balance&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/182-fig.1.png&quot; alt=&quot;182-fig.1.png&quot; /&gt;&lt;/li&gt;
&lt;li&gt;æ–°å¢Virtual Server&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/182-fig.2.png&quot; alt=&quot;182-fig.2.png&quot; /&gt;&lt;/li&gt;
&lt;li&gt;æ–°å¢Firewall Policy&lt;br /&gt;
å•é¡Œé»åœ¨ Inspection Mode ï¼Œé¸æ“‡ Flow-basedçš„è©±ï¼Œæœƒæ‰¾ä¸åˆ°ä½ å‰›å‰›è¨­å®šçš„virtual serverï¼Œå¿…éœ€è¨­å®šProxy-basedæ‰æœ‰&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/182-fig.3.png&quot; alt=&quot;182-fig.3.png&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/182-fig.4.png&quot; alt=&quot;182-fig.4.png&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;troubleshoting&quot; tabindex=&quot;-1&quot;&gt;troubleshoting&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;æ¸¬è©¦çµæœè·Ÿæ²’èµ°virtual serverä¸ä¸€æ¨£ï¼Ÿ&lt;br /&gt;
æª¢æŸ¥çœ‹çœ‹ virtual server çš„ Persistence æœ‰æ²’æœ‰è¨­å®š HTTP Cookie&lt;/li&gt;
&lt;li&gt;å‘¼å«apiï¼Œç™¼ç¾å‘¼å«çš„éƒ½æ˜¯åŒä¸€å€‹ip&lt;br /&gt;
æª¢æŸ¥ä¸€ä¸‹ Load Balancing method æ˜¯ä¸æ˜¯è¨­å®šæˆ Staticï¼Œä¸Šé¢è¨­å®šå°±è¨­éŒ¯äº†ï¼Œå°è‡´å›ºå®šåªæ‰“åŒä¸€å€‹ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/182-fig.5.png&quot; alt=&quot;182-fig.5.png&quot; /&gt;&lt;/li&gt;
&lt;li&gt;Firewall Policyçš„ Inspection Mode æ²’å‡ºç¾é¸é …&lt;br /&gt;
é€™å¡Šæ¯”è¼ƒä¸ç¢ºå®šï¼Œä½†æˆ‘æ˜¯å…ˆåˆ° System -&amp;gt; Feature Visibility é–‹å•“ Security Featuresåº•ä¸‹çš„  Zero Trust Network Accesså¾Œï¼Œæ‰çªç„¶è·‘å‡ºä¾†ï¼Œä½†æˆ‘æŠŠä»–é—œæ‰ï¼Œä¹Ÿæ²’æœ‰æ¶ˆå¤±...&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://docs.fortinet.com/document/fortigate/6.2.15/cookbook/713497/virtual-server&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Virtual server&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸŒ Network/182. Fortigate è¨­å®š å…§éƒ¨æœå‹™è² è¼‰å¹³è¡¡/" />
        </entry>
        <entry>
            <title>
                176. Nginx cheat sheet
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸŒ Network/176. Nginx cheat sheet/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;é©—è­‰nginxçš„http2é–‹å•“æ–¹å¼æ™‚ï¼Œ&lt;br /&gt;
æ‰çªç„¶é©šè¦ºæˆ‘éœ€è¦ä¸€å€‹nginx cheat sheet&lt;br /&gt;
ä¸ç„¶æ€éº¼å–®ç´”å›å€‹ç‹€æ…‹éƒ½ä¸çŸ¥é“å»å“ªæŠ„&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h4 id=&quot;response-200&quot; tabindex=&quot;-1&quot;&gt;response 200&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;location / {
    add_header Content-Type text/plain;
    return 200 &#39;Hey James,Say Hello Nginx&#39;;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;è‡ªç°½æ†‘è­‰&quot; tabindex=&quot;-1&quot;&gt;è‡ªç°½æ†‘è­‰&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout example.key -out example.crt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨ Common Nameæ™‚ï¼Œè¨˜å¾—è¼¸å…¥ä½ ç›®å‰é›»è…¦çš„ipï¼Œ&lt;br /&gt;
ç”¢ç”Ÿå®Œå¾Œï¼Œæ›è¼‰å°æ‡‰çš„volumeåˆ°nginxè£é¢ã€‚&lt;br /&gt;
æ›´æ”¹configã€‚&lt;/p&gt;
&lt;p&gt;docker-compose.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;
version: &#39;3.8&#39;
services:
  nginx-lb:
    container_name: nginx
    image: nginx
    pull_policy: if_not_present
    restart: always
    volumes:
      - ./certs:/etc/ssl
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./proxy.conf:/etc/nginx/conf.d/proxy.conf
    ports:
      - 443:443
      - 80:80
    networks:
      - internal
networks:
  internal:
    name: internal
    driver: bridge
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;proxy.conf(æŸå€‹nginxç‰ˆæœ¬å¾Œ http2é–‹å•“çš„æ–¹å¼è¦æ”¹ç”¨ä¸‹é¢çš„æ–¹å¼)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server {
    listen       443 ssl;
    server_name  192.168.1.106;
    http2 on;

    ssl_certificate           /etc/ssl/example.crt;
    ssl_certificate_key       /etc/ssl/example.key;
    ssl_protocols             TLSv1.3 TLSv1.2;
    ssl_prefer_server_ciphers on;
    ssl_ecdh_curve            X25519:secp521r1:secp384r1;
    ssl_ciphers               TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;
    ssl_session_cache         shared:TLS:2m;
    ssl_buffer_size           4k;

	location / {
	    add_header Content-Type text/plain;
	    return 200 &#39;Hey James,Say Hello Nginx&#39;;
	}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;proxy-pass&quot; tabindex=&quot;-1&quot;&gt;Proxy_pass&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;proxy_pass url&lt;/code&gt;Â ä¸­åŒ…å«è·¯å¾‘æ™‚ï¼Œçµå°¾çš„Â &lt;code&gt;/&lt;/code&gt;Â æœ€å¥½åŒÂ &lt;code&gt;location&lt;/code&gt;Â åŒ¹é…è¦å‰‡ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://xuexb.github.io/learn-nginx/example/proxy_pass.html#url-%E5%8F%AA%E6%98%AF-host&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;proxy_pass url åå‘ä»£ç†çš„å‘&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸŒ Network/176. Nginx cheat sheet/" />
        </entry>
        <entry>
            <title>
                169. Nginxçš„è² è¼‰å¹³è¡¡
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸŒ Network/169. Nginxçš„è² è¼‰å¹³è¡¡/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å”¸&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å”¸&lt;/h1&gt;
&lt;p&gt;é›–ç„¶çŸ¥é“nginxæ‡‰è©²å¯ä»¥åšåˆ°è² è¼‰å¹³è¡¡ï¼Œ&lt;br /&gt;
ä½†å¾ä¾†æ²’å¼„éï¼Œ&lt;br /&gt;
æŸ¥äº†ä¸€ä¸‹ï¼Œé‚„æŒºç°¡å–®çš„ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä¸»è¦æœ‰å››ç¨®æ¨¡å¼ï¼Œ&lt;br /&gt;
éƒ½æ˜¯å¯«åœ¨upstreamåº•ä¸‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¼ªè©¢(Round Robin) ï¼šä»€éº¼éƒ½ä¸è¦å¯«ï¼Œé è¨­çš„æ–¹æ³•&lt;/li&gt;
&lt;li&gt;æœ€å°‘é€£æ¥(least_conn)ï¼šæœƒè½‰ç™¼åˆ°ä¼ºæœå™¨é€£æ¥æ•¸æœ€å°‘çš„é‚£è‡º&lt;/li&gt;
&lt;li&gt;ipåœ°å€é›œæ¹Š(ip_hash)ï¼šä½¿ç”¨è€…æœƒé€£åˆ°ç‰¹å®šçš„ä¼ºæœå™¨ä¸Š&lt;/li&gt;
&lt;li&gt;æ¬Šé‡åŠƒåˆ†(weight)ï¼šæ ¹æ“šæ¬Šé‡æ¯”ä¾‹åˆ‡æ›ä¼ºæœå™¨ï¼Œé€™ç¨®å¯«æ³•è·Ÿä¸Šé¢çš„ä¸‰ç¨®ä¸ä¸€æ¨£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.cnblogs.com/felixzh/p/9047021.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Nginxè² è¼‰å¹³è¡¡çš„4ç¨®æ–¹å¼ ï¼šè¼ªè©¢-Round Robin ã€Ipåœ°å€-ip_hashã€æœ€å°‘é€£æ¥-least_connã€åŠ æ¬Š-weight=n&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;config.conf&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;upstream yolox-brand {
    least_conn;
    server yolox-brand-1:8080;
    server yolox-brand-2:8080;
}

server {
    listen       80;
    server_name  192.168.1.79;

    location / {
        proxy_pass         http://yolox-brand;
        proxy_redirect     off;
        proxy_set_header   Host $host;
        proxy_set_header   X-Real-IP $remote_addr;
        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Host $server_name;
        
        proxy_hide_header  &#39;Access-Control-Allow-Origin&#39;;
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Methods &#39;GET, POST, OPTIONS&#39;;
        add_header Access-Control-Allow-Headers &#39;DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization&#39;;

        if ($request_method = &#39;OPTIONS&#39;) {
            return 204;
        }
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œï¼Œdocker-compose.yamlå¦‚ä¸‹ï¼Œ&lt;br /&gt;
è¦æ³¨æ„åˆ¥æŠŠconfigæª”å¡éŒ¯åœ°æ–¹äº†ï¼Œä¸ç„¶æœƒç¢°åˆ° &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8C%90%20Network/99.%20nginx%E7%9A%84%E9%99%A4%E9%8C%AF%E7%AD%86%E8%A8%98/&quot;&gt;99. nginxçš„é™¤éŒ¯ç­†è¨˜&lt;/a&gt;çš„éŒ¯èª¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;version: &#39;3.8&#39;
services:
  python-1:
    container_name: yolox-brand-1
    image: busybox
    pull_policy: if_not_present
    restart: always
    networks:
      - internal
  python-2:
    container_name: yolox-brand-2
    image: busybox
    pull_policy: if_not_present
    restart: always
    networks:
      - internal
  nginx-lb:
    container_name: nginx
    image: nginx
    pull_policy: if_not_present
    restart: always
    volumes:
      - ./proxy.conf:/etc/nginx/conf.d/proxy.conf
    ports:
      - 80:80
    networks:
      - internal
networks:
  internal:
    name: internal
    driver: bridge
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è£œå……ï¼Œ&lt;code&gt;proxy_pass url&lt;/code&gt;Â ä¸­åŒ…å«è·¯å¾‘æ™‚ï¼Œçµå°¾çš„Â &lt;code&gt;/&lt;/code&gt;Â æœ€å¥½åŒÂ &lt;code&gt;location&lt;/code&gt;Â åŒ¹é…è¦å‰‡ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://xuexb.github.io/learn-nginx/example/proxy_pass.html#url-%E5%8C%85%E5%90%AB%E8%B7%AF%E5%BE%84&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;proxy_pass url åå‘ä»£ç†çš„å‘&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸŒ Network/169. Nginxçš„è² è¼‰å¹³è¡¡/" />
        </entry>
        <entry>
            <title>
                106. zyxel èˆ‡ fortigate å»ºç«‹VPN é»å°é»é€šé“
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸŒ Network/106. zyxel èˆ‡ fortigate å»ºç«‹VPN é»å°é»é€šé“/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ›å…¬å¸å¾Œï¼ŒDevOpsé‚„è¦å…¼ç¶²ç®¡ï¼Œ&lt;br /&gt;
ç„¶å¾Œï¼Œåœ¨è¾¦å…¬å®¤é‚„è¦é€£vpnæ‰èƒ½é€£åˆ°devçš„é–‹ç™¼ç’°å¢ƒï¼ˆï¼Ÿ&lt;br /&gt;
æˆ‘å¾ˆæ‡¶ï¼Œç‚ºä»€éº¼è¦é€™æ¨£å°æˆ‘ï¼Œ&lt;br /&gt;
æ‰€ä»¥...å°±æ”¹äº†å§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-1.png&quot; alt=&quot;106.fig-1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é è¨ˆå®Œæˆçš„æ¶æ§‹åœ–å¦‚ä¸Š&lt;/p&gt;
&lt;p&gt;æœ‰å¹¾å€‹åœ°æ–¹çš„å‘å¾ˆæ·±ï¼Œ&lt;br /&gt;
å»ºè­°éƒ½å…ˆæŸ¥ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ¬¡åšçš„æ˜¯site to site VPNé€£ç·š&lt;/p&gt;
&lt;h3 id=&quot;1&quot; tabindex=&quot;-1&quot;&gt;1. æª¢æŸ¥å°çƒé¾œè·Ÿé˜²ç«ç‰†çš„é€£ç·šæ–¹å¼&lt;/h3&gt;
&lt;p&gt;å› çˆ²æœ‰ç”³è«‹å›ºå®šipï¼Œä½†æœ¬ä¾†æ˜¯é€éå°çƒé¾œé€£åˆ°å¤–ç¶²ï¼Œ&lt;br /&gt;
å¾Œä¾†ä¸€æŸ¥æ‰ç™¼ç¾æ‡‰è©²æ˜¯è¦è®“Firewallè‡ªå·±æ“æœ‰å¯¦é«”ipæ‰å°ã€‚&lt;br /&gt;
ä¸ç”¨å†é€éFWã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å¹¾ç¨®è§£æ³•ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å°çƒé¾œæ”¹bridge mode ï¼ˆç¶²è·¯ä¸Šçœ‹åˆ°çš„éƒ½é€™ç¨®å±…å¤šï¼‰&lt;/li&gt;
&lt;li&gt;å°çƒé¾œæ”¹æµ®å‹•ipæ’¥æ¥ï¼Œç„¶å¾Œå†FWä¸Šä½¿ç”¨å›ºå®šip æ’¥æ¥æ–¹å¼ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é‡é»æ˜¯è¦è®“é˜²ç«ç‰†æœ‰ç›´æ¥çš„å°å¤–ipï¼Œç’°å¢ƒä¸Šæœƒæ¯”è¼ƒå–®ç´”ã€‚&lt;br /&gt;
æˆ‘ä¹‹å‰çš„ç’°å¢ƒï¼Œå°çƒé¾œé€£åˆ°Zyxel æ˜¯192.168.1.X ï¼Œ&lt;br /&gt;
ç„¶å¾Œå°çƒé¾œæ¥é˜²ç«ç‰†èµ°wan portï¼Œä½†åˆ°å…§éƒ¨çš„æ©Ÿå™¨ipä¹Ÿæ˜¯192.168.1.Xï¼Œ&lt;/p&gt;
&lt;h3 id=&quot;2-ip-sec&quot; tabindex=&quot;-1&quot;&gt;2.è¨­å®š ipSec&lt;/h3&gt;
&lt;p&gt;é€™é‚Šè¨­å®šçš„æ–¹å¼ç¶²è·¯ä¸Šå¾ˆå¤šç¨®ï¼Œå¯ä»¥å…ˆçœ‹ä¸€ä¸‹ &lt;a href=&quot;https://community.zyxel.com/tw/discussion/13794/nebula-x-firewall-%E8%88%87fortigate%E5%BB%BA%E7%AB%8Bipsec%E7%AB%99%E5%88%B0%E7%AB%99site-to-site-vpn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; [Nebula x Firewall]èˆ‡Fortigateå»ºç«‹IPSecç«™åˆ°ç«™site-to-site VPN&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é—œéµé»åœ¨ï¼ŒPhase 1ã€Phase 2è·Ÿé‡‘é‘°çš„è¨­å®šä¸€å®šè¦å…©è‡ºä¸€æ¨£ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘åœ¨é€£ç·šçš„æ™‚å€™ï¼Œä¸€ç›´ç¢°åˆ°ZyXel é€£vpnæ™‚ ä¸€ç›´timeoutï¼Œ&lt;br /&gt;
æœ€å¾Œæ˜¯åœ¨æ”¹å®Œ 1 çš„æ¶æ§‹ä»¥å¾Œï¼Œä¸€æ•´å€‹é›¨éå¤©æ™´&lt;/p&gt;
&lt;p&gt;Zyxelçš„IPsecè¨­å®š&lt;br /&gt;
æœ¬åœ°çš„ipè·Ÿé ç«¯çš„ipè¦åˆ†æ¸…æ¥š&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-2.png&quot; alt=&quot;106.fig-2.png&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-3.png&quot; alt=&quot;106.fig-3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;fortigateçš„IPsecé€šé“ è¨­å®š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-4.jpg&quot; alt=&quot;106.fig-4.jpg&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-5.jpg&quot; alt=&quot;106.fig-5.jpg&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-6.jpg&quot; alt=&quot;106.fig-6.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œæª¢æŸ¥é€£ç·šæœ‰æ²’æœ‰é€šï¼Œ&lt;br /&gt;
å…©é‚Šéƒ½è¦è¨­å®šå¥½ï¼Œæ‰æœƒé€šã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-6-2.jpg&quot; alt=&quot;106.fig-6-2.jpg&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;3&quot; tabindex=&quot;-1&quot;&gt;3. è¨­å®šè·¯ç”±&lt;/h3&gt;
&lt;p&gt;æˆ‘çœ‹çš„ç¶²è·¯ä¸Šçš„æ•™å­¸ï¼Œä»–å€‘æ˜¯ä¸€è¨­å®šå¥½å¾Œï¼Œå°±é€£çš„é€šäº†ã€‚&lt;br /&gt;
ä½†æˆ‘æ€éº¼é€£å°±æ˜¯ä¸é€šã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç”¨tracertçœ‹è·¯ç”±ï¼Œæ˜¯åªè·‘åˆ°192.168.1.1 (Zyxel FWä¸Š)ï¼Œå°±æ²’åœ¨å¾€ä¸‹äº†ã€‚æ–¼æ˜¯å…ˆå¼„å€‹ï¼ˆZyXel )ç­–ç•¥è·¯ç”±ï¼Œçœ‹è½‰ä¸è½‰çš„éå»ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-7.jpg&quot; alt=&quot;106.fig-7.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;fortigateçš„é˜²ç«ç‰†ç­–ç•¥åŠè·¯ç”±ï¼Œé˜²ç«ç‰†è¨˜å¾—ä¸èƒ½é–‹NATã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-11.jpg&quot; alt=&quot;106.fig-11.jpg&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-12.jpg&quot; alt=&quot;106.fig-12.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;fortigateä¸Šé¢æª¢æŸ¥çš„æ–¹å¼æœ‰å…©ç¨®&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ’ˆå°åŒ…ï¼Œç„¶å¾Œç”¨wiresharkçœ‹&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-8.jpg&quot; alt=&quot;106.fig-8.jpg&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-9.jpg&quot; alt=&quot;106.fig-9.jpg&quot; /&gt;&lt;/li&gt;
&lt;li&gt;åˆ°fortigateçš„ CLIæ§åˆ¶æª¯ä¸‹æŒ‡ä»¤æŸ¥(é€™å€‹æ¯”è¼ƒå¿«)&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;diag debug reset
diag debug flow filter clear
diagnose sniffer packet any &amp;quot;host 192.168.103.221 and icmp&amp;quot; 4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­£å¸¸çš„è©±ï¼Œæœƒåƒé€™æ¨£æœ‰å›æ‡‰&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%8C%90%20Network/106.fig-10.jpg&quot; alt=&quot;106.fig-10.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ç•¶æ™‚ç¢°åˆ°çš„æ˜¯æœ‰æµé‡æ‰“åˆ° fortigateçš„æ©Ÿå™¨ä¸Šï¼Œä½†æ²’æœ‰è½‰éå»ï¼Œ&lt;br /&gt;
æ‰€ä»¥è·¯ç”±è·Ÿé˜²ç«ç‰†&lt;/p&gt;
&lt;h3 id=&quot;çµèª&quot; tabindex=&quot;-1&quot;&gt;çµèª&lt;/h3&gt;
&lt;p&gt;èŠ±äº†æˆ‘ä¸‰å¤©çš„æ™‚é–“ï¼Œæˆ‘çœŸçš„åªæ˜¯å€‹åŠåŠå­çš„ç¶²ç®¡ï¼Œç¶²è·¯æˆ‘ä¸ç†Ÿé˜¿  å—šå—š...(â•¥ï¹â•¥)&lt;br /&gt;
è®“æˆ‘æ‡·å¿µèµ·ä»¥å‰ç•¶MISæ™‚çš„é˜²ç«ç‰†è¨­å®šï¼Œéƒ½æ˜¯å» å•†å¹«æˆ‘å€‘è¨­å®šçš„ï¼Œæˆ‘å€‘åªè¦ç¨å¾®çŸ¥é“ä¸€äº›ç®¡ç†å°±å¥½ï¼Œæ„Ÿè¬ShareTech ã€‚è€é—†ï¼ï¼å¦‚æœä¸‹æ¬¡æ¡è³¼æ™‚ï¼Œæˆ‘é‚„åœ¨çš„è©±ï¼Œæˆ‘è¦æ›å» å•†å•Šå•Šå•Šã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.ichiayi.com/tech/fortigate_tips&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æœ‰é—œ FortiGate é˜²ç«ç‰†ç›¸é—œè¨­å®š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://community.zyxel.com/tw/discussion/13794/nebula-x-firewall-%E8%88%87fortigate%E5%BB%BA%E7%AB%8Bipsec%E7%AB%99%E5%88%B0%E7%AB%99site-to-site-vpn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; [Nebula x Firewall]èˆ‡Fortigateå»ºç«‹IPSecç«™åˆ°ç«™site-to-site VPN&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸŒ Network/106. zyxel èˆ‡ fortigate å»ºç«‹VPN é»å°é»é€šé“/" />
        </entry>
        <entry>
            <title>
                102. OSIä¸ƒå±¤
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸŒ Network/102. OSIä¸ƒå±¤/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å› ç‚ºä¸€ç›´èƒŒä¸èµ·ä¾† OSIä¸ƒå±¤ï¼Œä¸Šç¶²æŸ¥äº†ä¸‹ç™¼ç¾é‚„çœŸçš„æœ‰äººç™¼æ˜äº†å£è¨£&lt;br /&gt;
OSIç”±æœ€ä¸Šå±¤å¾€ä¸‹&lt;br /&gt;
All People Seem To Need Domino&#39;s Pizza&lt;br /&gt;
ï¼ˆæ‰€æœ‰çš„äººçœ‹ä¾†éƒ½éœ€è¦é”ç¾æ¨‚æ¯”è–©)&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Application ï¼šæ‡‰ç”¨å±¤&lt;br /&gt;
ä¸»è¦åŠŸèƒ½æ˜¯è™•ç†æ‡‰ç”¨ç¨‹å¼ï¼Œé€²è€Œæä¾›ä½¿ç”¨è€…ç¶²è·¯æ‡‰ç”¨æœå‹™ï¼Œ&lt;br /&gt;
é€éé€šè¨Šå”å®š(DHCPã€FTPã€HTTP...)å’Œè³‡æ–™æ“ä½œï¼Œå°‡è³‡è¨Šæ•´åˆèµ·ä¾†ï¼Œæä¾›çµ¦ä½¿ç”¨è€…é€²è¡Œæ“ä½œ&lt;/li&gt;
&lt;li&gt;Presentation ï¼šå±•ç¤ºå±¤&lt;br /&gt;
å±•ç¤ºå±¤ä¸»è¦è² è²¬è½‰è­¯ã€åŠ å¯†å’Œå£“ç¸®è³‡æ–™&lt;/li&gt;
&lt;li&gt;Session ï¼šæœƒè­°å±¤&lt;br /&gt;
æœƒè­°å±¤ä¸»è¦è² è²¬å»ºç«‹ç¶²çµ¡é€£ç·šï¼Œç­‰åˆ°è³‡æ–™å‚³è¼¸çµæŸæ™‚ï¼Œå†å°‡é€£ç·šä¸­æ–·ã€‚&lt;/li&gt;
&lt;li&gt;Transport ï¼šå‚³è¼¸å±¤&lt;br /&gt;
å‚³è¼¸å±¤çš„ä¸»è¦ç”¨é€”æ˜¯ï¼Œå”åŠ©OSIå‰ä¸‰å±¤èˆ‡OSIå¾Œä¸‰å±¤é€²è¡Œæºé€šï¼Œå‚³è¼¸å±¤ä¹Ÿè² è²¬è™•ç†æµé‡æ§åˆ¶å’ŒéŒ¯èª¤æ§åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;Network ï¼šç¶²è·¯å±¤&lt;br /&gt;
ç¶²è·¯å±¤æ˜¯é‡å°ä½æ–¼ä¸åŒç¶²è·¯(WAN)çš„å…©å€‹è£ç½®ï¼Œä¿ƒé€²å…©è€…ä¹‹é–“çš„è³‡æ–™å‚³è¼¸ã€‚&lt;br /&gt;
(è·¯ç”±å™¨åŠLayer 3äº¤æ›å™¨å³å±¬æ–¼ç¬¬ä¸‰å±¤çš„ç¶²è·¯è¨­å‚™ï¼Œä¸»è¦ä»¥IPä½œç‚ºè³‡æ–™å‚³è¼¸ä¾æ“š)&lt;/li&gt;
&lt;li&gt;Data Linkï¼šè³‡æ–™é€£çµå±¤&lt;br /&gt;
è³‡æ–™é€£çµå±¤æ˜¯é‡å°ä½æ–¼ç›¸åŒç¶²è·¯(LAN)çš„å…©å€‹è£ç½®ï¼Œä¿ƒé€²å…©è€…ä¹‹é–“çš„è³‡æ–™å‚³è¼¸ã€‚&lt;br /&gt;
(ç¶²è·¯äº¤æ›å™¨ï¼ˆSwitchï¼‰æ˜¯é€™å€‹å±¤ç´šå¸¸è¦‹çš„è¨­å‚™ï¼Œä¸»è¦åœ¨å€åŸŸç¶²è·¯ä¸Šé‹ä½œï¼Œèƒ½ä¾æ“šMACä½å€ï¼Œå°‡ç¶²è·¯è³‡æ–™å‚³é€åˆ°ç›®çš„ä¸»æ©Ÿä¸Šã€‚)&lt;/li&gt;
&lt;li&gt;Physicalï¼šå¯¦é«”å±¤&lt;br /&gt;
å¯¦é«”å±¤ä¸»è¦æ˜¯ç”¨ä¾†å®šç¾©è¨­å‚™è£ç½®ä¹‹é–“ä½å…ƒè³‡æ–™å‚³è¼¸ï¼Œä¹Ÿå°±æ˜¯é€éç‰©ç†ç·šæé€£æ¥è‡³å…¶ä»–å¯¦é«”è¨­å‚™ï¼Œå‚³é0å’Œ1çš„æ•¸ä½è¨Šè™Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://vocus.cc/article/618c7853fd8978000108c4d5&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;OSI ä¸ƒå±¤æ¶æ§‹&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://www.ithome.com.tw/tech/47085&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä»€éº¼æ˜¯OSIçš„7å±¤æ¶æ§‹ï¼Ÿ&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/ğŸŒ Network/102. OSIä¸ƒå±¤/" />
        </entry>
        <entry>
            <title>
                0.Network MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸŒ Network/0.Network MOC/</id>
            <content type="html">
                &lt;h1 id=&quot;åŸºç¤&quot; tabindex=&quot;-1&quot;&gt;åŸºç¤&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8C%90%20Network/92.%20proxy%20%E4%BB%A3%E7%90%86/&quot;&gt;92. proxy ä»£ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8C%90%20Network/102.%20OSI%E4%B8%83%E5%B1%A4/&quot;&gt;102. OSIä¸ƒå±¤&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;nginx&quot; tabindex=&quot;-1&quot;&gt;Nginx&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8C%90%20Network/169.%20Nginx%E7%9A%84%E8%B2%A0%E8%BC%89%E5%B9%B3%E8%A1%A1/&quot;&gt;169. Nginxçš„è² è¼‰å¹³è¡¡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8C%90%20Network/176.%20Nginx%20cheat%20sheet/&quot;&gt;176. Nginx cheat sheet&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8C%90%20Network/99.%20nginx%E7%9A%84%E9%99%A4%E9%8C%AF%E7%AD%86%E8%A8%98/&quot;&gt;99. nginxçš„é™¤éŒ¯ç­†è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8C%90%20Network/106.%20zyxel%20%E8%88%87%20fortigate%20%E5%BB%BA%E7%AB%8BVPN%20%E9%BB%9E%E5%B0%8D%E9%BB%9E%E9%80%9A%E9%81%93/&quot;&gt;106. zyxel èˆ‡ fortigate å»ºç«‹VPN é»å°é»é€šé“&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸŒ Network/0.Network MOC/" />
        </entry>
        <entry>
            <title>
                160.Obsidianç™¼ä½ˆç¶²ç«™
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ†’ SideProject/160.Obsidianç™¼ä½ˆç¶²ç«™/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å› ç‚ºè¢«googleçš„blogæäº†ä¸€æ³¢ï¼ˆåŸå› è«‹çœ‹&lt;a href=&quot;https://daimom3020.blogspot.com/2023/07/blog-post.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é€™&lt;/a&gt; ï¼‰ï¼Œ&lt;br /&gt;
è®“æˆ‘çµ‚æ–¼ä¸‹å®šæ±ºå¿ƒç ”ç©¶ mdè½‰htmlçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ç™¼ä½ˆæ–¹å¼&quot; tabindex=&quot;-1&quot;&gt;ç™¼ä½ˆæ–¹å¼&lt;/h1&gt;
&lt;p&gt;å¾Obsidianç™¼ä½ˆä¸»è¦æœ‰å¹¾ç¨®æ–¹æ³•ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®˜æ–¹æä¾› ï¼Œæ¯å€‹æœˆ8ç¾é‡‘ï¼Œè©³æƒ…åƒè€ƒ &lt;a href=&quot;https://obsidian.md/publish&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é€™è£&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;jekyll ï¼Œä¹Ÿæœ‰äººæ˜¯ç”¨é€™å€‹æ›ä¸Šå»çš„ï¼Œæ ¼å¼ç¨å¾®æ”¹ä¸€ä¸‹ï¼Œç„¶å¾Œåœ¨githubä¸Šé¢æ”¹ä¸€ä¸‹è¨­å®šï¼Œpushä¸Šå»å°±æœƒè‡ªå‹•éƒ¨ç½²äº†ï¼Œæ”¹å¤©å†ç”¨å¦ä¸€ç¯‡ä»‹ç´¹ï¼Œå› ç‚ºè¦æ”¹è¨±å¤šæ±è¥¿ï¼Œæˆ‘å°±æ²’ç”¨é€™ç¨®äº†&lt;/li&gt;
&lt;li&gt;Obsidiançš„ç¬¬ä¸‰æ–¹plugin , Digital Garden ï¼Œæœ¬ç¯‡å°±æ˜¯é€éé€™å¥—ä¾†ç™¼ä½ˆç¶²ç«™ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;åŸæ–‡é€£çµï¼š &lt;a href=&quot;https://dg-docs.ole.dev/getting-started/01-getting-started/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Digital Garden-Get start&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å…ˆåœ¨obsidianå®‰è£ digital Garden&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.1.jpg&quot; alt=&quot;160-fig.1.jpg&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.2.jpg&quot; alt=&quot;160-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸€å€‹&lt;a href=&quot;https://daimom.github.io/github.com&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Github&lt;/a&gt;å¸³è™Ÿã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”³è«‹ &lt;a href=&quot;https://vercel.com/signup&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Vercel&lt;/a&gt;ï¼Œç”¨githubå¸³è™Ÿç™»å…¥ã€‚&lt;br /&gt;
å¦‚æœè¦ç”¨&lt;a href=&quot;https://www.netlify.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Netlify&lt;/a&gt;æ‡‰è©²ä¹Ÿå¯ä»¥ï¼Œ&lt;br /&gt;
é€™å…©å€‹ç¶²ç«™éƒ½æ˜¯ç›´æ¥ç”¨å­åŸŸåä½œçˆ²ä½ çš„ç¶²ç«™åç¨±ï¼Œ&lt;br /&gt;
githubä»¥å‰ä¹Ÿæœ‰ï¼Œä½†ç¾åœ¨å·²ç¶“æ”¹æ‰äº†ã€‚&lt;br /&gt;
(è¨˜å¾—åœ¨é€™é‚Šï¼Œæœƒå•ä½ è¦çµ¦Vercelå“ªå€‹repostoryçš„æ¬Šé™ï¼Œå¯ä»¥å…¨çµ¦ï¼Œä¹‹å¾Œå†åˆ°github çš„è¨­å®šæŒ‡å®šrepostoryå°±å¥½)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ‰“é–‹ä½œè€…çš„&lt;a href=&quot;https://github.com/oleeskild/digitalgarden&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;repository &lt;/a&gt;ï¼ŒæŒ‰ä¸‹ä¸‹é¢çš„éƒ¨ç½²æŒ‰éˆ•ï¼Œæœƒåˆ°Verceléƒ¨ç½²ä¸€å€‹ç¶²ç«™ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.3.jpg&quot; alt=&quot;160-fig.3.jpg&quot; /&gt;&lt;br /&gt;
å¦‚æœä½ ç†Ÿgitçš„è©±ï¼Œä¹Ÿå¯ä»¥ç›´æ¥cloneé‚£å€‹repositoryï¼Œ&lt;br /&gt;
å†è‡ªå·±åˆ°vercelæˆ–Netlifyéƒ¨ç½²ä¸Šå»ä¹Ÿå¯ä»¥ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³è¦å†æœ¬æ©Ÿæ¸¬è©¦é–‹å•“çš„è©±ï¼Œ&lt;br /&gt;
cloneé€™å€‹å°ˆæ¡ˆå¾Œï¼ŒåŸ·è¡Œä¸‹é¢ç¨‹å¼ï¼Œæ³¨æ„éœ€å…ˆå®‰è£&lt;a href=&quot;https://nodejs.org/zh-tw/download&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;nodejs&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;npm install
npm run build
npm run start
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;å†ä¾†éœ€å»ºç«‹github tokenï¼Œé€™æ˜¯ç‚ºäº†è®“Vercelå¯ä»¥è®€å–åˆ°ä½ çš„repostoryã€‚&lt;br /&gt;
é–‹å•“&lt;a href=&quot;https://github.com/settings/tokens/new?scopes=repo&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;github token&lt;/a&gt;ï¼Œå–å€‹åå­—ã€å»ºç«‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h5 id=&quot;github-token&quot; tabindex=&quot;-1&quot;&gt;å»ºç«‹github token&lt;/h5&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.4.jpg&quot; alt=&quot;160-fig.4.jpg&quot; /&gt;&lt;br /&gt;
Expiration ï¼šåˆ°æœŸå¤©æ•¸ï¼Œå¦‚æœä¸æƒ³ä¸€ç›´æ”¹çš„è©±ï¼Œå°±è¨­å®šæ²’æœ‰æœŸé™ã€‚&lt;br /&gt;
ä¸‹é¢ç´…æ¡†æ˜¯å¿…é ˆè¦æœ‰çš„æ¬Šé™ã€‚&lt;/p&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;
&lt;p&gt;æ‰“é–‹ä½ çš„obsidiançš„Digital Gardenè¨­å®š&lt;br /&gt;
åœ¨å››å€‹æ–¹å¡Šè£é¢è¼¸å…¥ä½ çš„è³‡è¨Š&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.5.jpg&quot; alt=&quot;160-fig.5.jpg&quot; /&gt;&lt;br /&gt;
Github Repo Nameï¼š å‰é¢æ‰€æ–°å¢çš„repostoryçš„åç¨±&lt;br /&gt;
Github UserNameï¼šä½ çš„å¸³è™Ÿåç¨±&lt;br /&gt;
Github Tokenï¼šæ­¥é©Ÿ5å»ºç«‹çš„è³‡æ–™&lt;br /&gt;
BaseUrl ï¼šå¦‚æœä½ å‰›å‰›å·²ç¶“åˆæ­¥åœ¨Vercelå»ºç«‹ä¸€å€‹ç¶²ç«™çš„è©±ï¼Œæ‡‰è©²å°±æœƒçœ‹åˆ°ä½ çš„ç¶²å€ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.6.jpg&quot; alt=&quot;160-fig.6.jpg&quot; /&gt;&lt;br /&gt;
æˆ‘é€™é‚Šæœ‰å…©å€‹domainï¼Œå‰é¢çš„&lt;a href=&quot;http://daimom.vercel.app/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;http://daimom.vercel.app&lt;/a&gt;  æ˜¯å¾Œä¾†è‡ªå®šçš„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç™¼ä½ˆ&lt;br /&gt;
å…ˆåˆ°ä½ è¦è¨­æˆé¦–é çš„æ–‡ç« ä¸Šé¢ï¼Œè¨­å®š&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;dg-publish: true
dg-home: true
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;dg-publish ï¼šè¡¨ç¤ºç™¼ä½ˆ&lt;br /&gt;
dg-homeï¼šè¡¨ç¤ºè¨­çˆ²é¦–é &lt;/p&gt;
&lt;p&gt;å†ä¾†ä½ æœ‰å…©ç¨®æ–¹æ³•å¯ä»¥ç™¼ä½ˆï¼Œå«å‡ºObsidiançš„å‘½ä»¤é¢æ¿&lt;br /&gt;
Winï¼š CTRL+P&lt;br /&gt;
Macï¼šCmd+P&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.7.jpg&quot; alt=&quot;160-fig.7.jpg&quot; /&gt;&lt;br /&gt;
å…ˆè¼¸å…¥dgï¼Œç„¶å¾Œæœƒçœ‹åˆ° &lt;code&gt;Digital Garden: Publish Single Note&lt;/code&gt;&lt;br /&gt;
åŸ·è¡Œå¾Œå°±æœƒç™¼ä½ˆåˆ°Vercelã€‚&lt;/p&gt;
&lt;p&gt;æˆ–æ˜¯ GUIç•«é¢&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.8.jpg&quot; alt=&quot;160-fig.8.jpg&quot; /&gt;&lt;br /&gt;
æŒ‰ä¸‹ &lt;code&gt;Publish unpublished Note&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&quot;8&quot;&gt;
&lt;li&gt;å»ºç½®&lt;br /&gt;
å¦‚æœä½ é€Ÿåº¦å¤ å¿«ï¼Œåˆ‡åˆ°Vercelçš„ç¶²ç«™ï¼Œæœƒçœ‹åˆ°Deploymentæ­£åœ¨åŸ·è¡Œçš„ç•«é¢ï¼Œæˆ–æ˜¯å·²ç¶“åŸ·è¡Œå®Œæˆçš„ç•«é¢ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.9.jpg&quot; alt=&quot;160-fig.9.jpg&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;q-and-amp-a&quot; tabindex=&quot;-1&quot;&gt;Q&amp;amp;A&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;åˆ‡æ›ä¸»é¡Œçš„æ™‚å€™ï¼Œæœ‰æ™‚å€™æœƒæ²’æœ‰æ›´æ”¹ï¼Œæ­¤æ™‚è«‹æŒ‰ä¸‹ è¨­å®šçš„ Update site çš„Manage site TemplateæŒ‰éˆ•ï¼Œä»–æœƒå¹«ä½ å»ºç«‹PRã€‚ ref. &lt;a href=&quot;https://dg-docs.ole.dev/getting-started/06-updating-the-template/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Updating the template&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ä¸»é¡Œæ”¹å¾—åªæœ‰é¡è‰²è·Ÿå­—é«”å¤§å°ï¼Œå¦‚æœè¦å³é‚Šçš„è·¯å¾‘åœ–å¯ä»¥åˆ°è¨­å®šæ‰“é–‹ &lt;code&gt;Show local graph for notes&lt;/code&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.10.jpg&quot; alt=&quot;160-fig.10.jpg&quot; /&gt;&lt;br /&gt;
æ›´å¤šçš„è¨­å®šï¼Œè«‹åƒè€ƒ&lt;a href=&quot;https://dg-docs.ole.dev/getting-started/03-note-settings/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Note settings&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æœ¬ç¯‡çš„themeæ˜¯ &lt;code&gt;Rmaki&lt;/code&gt; ï¼Œä¸€äº›å°è¨­å®šæ˜¯æˆ‘æ”¹cssè·Ÿjsæ”¹å‡ºä¾†çš„ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœè¦æ•´æ‰¹åŠ å…¥ç™¼ä½ˆçš„yamlï¼Œå¯ä»¥è€ƒæ…®ä½¿ç”¨ &lt;a href=&quot;https://github.com/chhoumann/MetaEdit&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;MetaEdit&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å°‡Vercelçš„æ¬Šé™é™ç¸®ç‰¹å®šrepostoryï¼Œå…ˆåˆ°githubçš„å€‹äººè¨­å®šç•«é¢ï¼Œæ‰¾åˆ° Application&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.11.jpg&quot; alt=&quot;160-fig.11.jpg&quot; /&gt;&lt;br /&gt;
æŒ‰ä¸‹Configure&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/160-fig.12.jpg&quot; alt=&quot;160-fig.12.jpg&quot; /&gt;&lt;br /&gt;
å¾åŸå…ˆçš„All repostoriesæ”¹æˆ Only select repositoriesï¼Œ&lt;br /&gt;
æœ€å¾ŒæŒ‡å®šä½ çš„repositoryå³å¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://dg-docs.ole.dev/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Digital Garden Doc&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://fengrin.me/posts/2022-12-19-publish-your-website-free-use-your-local-note-obsidian-gitHub-netlify&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å…è²»ç›´æ¥æŠŠç­†è¨˜ç™¼ä½ˆæˆç¶²ç«™:Obsidian + GitHub + Netlify&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://notes.oldwinter.top/obsidian-%E7%9B%AE%E5%89%8D%E6%9C%80%E5%AE%8C%E7%BE%8E%E7%9A%84%E5%85%8D%E8%B4%B9%E5%8F%91%E5%B8%83%E6%96%B9%E6%A1%88-%E6%B8%90%E8%BF%9B%E5%BC%8F%E6%95%99%E7%A8%8B&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;obsidian ç›®å‰æœ€å®Œç¾çš„å…è²»ç™¼ä½ˆæ–¹æ¡ˆ - æ¼¸é€²å¼æ•™å­¸&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ†’ SideProject/160.Obsidianç™¼ä½ˆç¶²ç«™/" />
        </entry>
        <entry>
            <title>
                125. Google sheet Query
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/ğŸ†’ SideProject/125. Google sheet Query/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;ä»Šå¤©æ”¶åˆ°å€‹æ¶ˆæ¯ï¼Œèªªè¦çµ¦user hostsçš„æª”æ¡ˆï¼Œ&lt;br /&gt;
è£é¢å…§å®¹è¦åŒ…å«ç›®å‰çš„dnsè·Ÿipçš„å°æ‡‰ï¼Œ&lt;br /&gt;
ä½†æˆ‘æ—¥å¾Œä¸æƒ³æ‰‹å‹•æ›´æ–°é˜¿...&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h2 id=&quot;é–‹å§‹ç™¼æƒ³&quot; tabindex=&quot;-1&quot;&gt;é–‹å§‹ç™¼æƒ³&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æœ¬ä¾†æ˜¯æƒ³ç”¨if ï¼Œå–®ç¨åˆ¤æ–·ä¸€å€‹æ¬„ä½æ˜¯ä¸æ˜¯ç¬¦åˆè¦å‰‡ã€‚&lt;br /&gt;
ä½†é€™æ¨£æœƒæœ‰å€‹å•é¡Œï¼Œç•¶è³‡æ–™è®Šå‹•æ™‚ï¼Œå°±å¿…é ˆæ‰‹å‹•æ‹‰å…¬å¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥åˆ°ä¸€å€‹&lt;a href=&quot;https://vocus.cc/article/6162ebdafd89780001c6fb8b&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;importrange&lt;/a&gt;çš„å‡½æ•¸ï¼Œå¯ä»¥æ•´æ‰¹åŒ¯å…¥è³‡æ–™ï¼Œ&lt;br /&gt;
ä½†é€™æ¨£æˆ‘é‚„æ˜¯è¦åˆ†ææˆªå–ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨æŸ¥è³‡æ–™éç¨‹ä¸­ï¼Œç™¼ç¾queryå‡½æ•¸ï¼Œèƒ½å¤ æ•´å€‹sheetæœå°‹ ï¼Œ&lt;br /&gt;
å°±åƒSQLèªæ³•ä¸€æ¨£ï¼Œå°±æ±ºå®šæ˜¯ä½ äº†ï¼ï¼ï¼&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;å¯¦ä½œ&quot; tabindex=&quot;-1&quot;&gt;å¯¦ä½œ&lt;/h2&gt;
&lt;p&gt;QUERYä½¿ç”¨ æ¬„ä½çš„åšé—œéµå­—ï¼Œ&lt;br /&gt;
ä¸éåªæœ‰åŸºæœ¬çš„æŸ¥è©¢åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;=query(Prod!4:1010,&amp;quot;select D,E,G where G=&#39;Y&#39; order by E desc&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%F0%9F%86%92%20SideProject/125-fig.1.jpg&quot; alt=&quot;125-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ¯”è¼ƒç‰¹åˆ¥çš„æ‡‰è©²æ˜¯&lt;br /&gt;
whereè£é¢çš„ æ–‡å­—æœå°‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Where A contains &#39;Ezio&#39;      æŸ¥è©¢åŒ…å«Ezioçš„å­—
Where A starts with &#39;Ezio&#39;   æŸ¥è©¢Ezioé–‹é ­çš„å­—
Where A ends with &#39;Ezio&#39;     æŸ¥è©¢Ezioçµå°¾çš„å­—
Where A like &#39;%Ezio&#39;         è·ŸSQLçš„likeå·®ä¸å¤šæ„æ€
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ³¨æ„ï¼Œlike å¾Œé¢æ¥ % æ˜¯ ä»»æ„å­—å…ƒ  ,  å¦‚æœæ¥ _ å°±æ˜¯ä¸€å€‹å­—å…ƒ&lt;/p&gt;
&lt;p&gt;å¤šäº†ä¸€äº›mysql çš„èªæ³•&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select A,B limit 3       åªå–3è¡Œçš„è³‡æ–™
select A,B offset 3      è·³é3è¡Œï¼Œé–‹å§‹å–è³‡æ–™
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‚„æœ‰ä¸€å€‹ç‰¹åˆ¥çš„ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select A,B SKIPPING 2     æ¯éš”2è¡ŒæŠ“ä¸€æ¬¡è³‡æ–™
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…¶ä»–ç›¸ä¼¼çš„å°±&lt;br /&gt;
èšåˆå‡½æ•¸  SUM()ã€AVG()ã€COUNT()ã€MAX()ã€MIN()&lt;br /&gt;
æ’åº order by&lt;br /&gt;
å¦å¤–é‚„æ”¯æ´ PIVOT&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://vocus.cc/mrsheet/606b50b8fd897800011eba1d&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;QUERY å‡½å¼å¤§è§£æï¼ˆä¸€ï¼‰ï¼šåŸºæœ¬åŸç†èˆ‡ SELECT&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/ğŸ†’ SideProject/125. Google sheet Query/" />
        </entry>
        <entry>
            <title>
                89. istio å¸¸è¦‹ç‹€æ…‹ç¢¼
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/89. istio å¸¸è¦‹ç‹€æ…‹ç¢¼/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘ç”¨istioåµæ¸¬ï¼Œå¸¸ç¢°åˆ°æŸå€‹æœå‹™ç‹€æ…‹æœƒæ‰åˆ°80%ä»¥ä¸‹ï¼Œ&lt;br /&gt;
é‚£æ™‚éƒ½æœ‰çœ‹åˆ°APMçš„ç¨‹å¼å ±éŒ¯ï¼Œä½†æ²’äººåæ‡‰ï¼Œæœ€è¿‘æœ‰æ¬¡ç™¼ç”Ÿåœ¨ä¸Šç­æ™‚é–“ï¼Œ&lt;br /&gt;
é¦¬ä¸Šè¯çµ¡åŒäº‹çœ‹ä»–çš„æœå‹™æœ‰æ²’æœ‰æ­£å¸¸ï¼Œ&lt;br /&gt;
æœ€å¾Œä¸€è·¯è¿½ï¼Œ&lt;br /&gt;
ç™¼ç¾ç‹€æ…‹ç¢¼æ˜¯å› 503 DC ï¼Œå°é€™å€‹é—œéµå­—æœ‰å°è±¡ï¼Œä½†å¸¸æœƒå¿˜è¨˜ä»–çš„å…¨åã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/89-fig.1.png&quot; alt=&quot;89-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹åˆ—ç‚ºenvoyå¸¸è¦‹ç¸®å¯«æ¯”å°&lt;/p&gt;
&lt;p&gt;HTTP and TCP&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UH&lt;/strong&gt;: No healthy upstream hosts in upstream cluster in addition to 503 response code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UF&lt;/strong&gt;: Upstream connection failure in addition to 503 response code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UO&lt;/strong&gt;: Upstream overflow (&lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/circuit_breaking#arch-overview-circuit-break&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;circuit breaking&lt;/a&gt;) in addition to 503 response code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;NR&lt;/strong&gt;: NoÂ &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/http/http_routing#arch-overview-http-routing&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;route configured&lt;/a&gt;Â for a given request in addition to 404 response code, or no matching filter chain for a downstream connection.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;URX&lt;/strong&gt;: The request was rejected because theÂ &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-field-config-route-v3-retrypolicy-num-retries&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;upstream retry limit (HTTP)&lt;/a&gt;Â orÂ &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-max-connect-attempts&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;maximum connect attempts (TCP)&lt;/a&gt;Â was reached.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;NC&lt;/strong&gt;: Upstream cluster not found.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;DT&lt;/strong&gt;: When a request or connection exceededÂ &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/core/v3/protocol.proto#envoy-v3-api-field-config-core-v3-httpprotocoloptions-max-connection-duration&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;max_connection_duration&lt;/a&gt;Â orÂ &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-max-downstream-connection-duration&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;max_downstream_connection_duration&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;HTTP only&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;DC&lt;/strong&gt;: Downstream connection termination.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;LH&lt;/strong&gt;: Local service failedÂ &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/health_checking#arch-overview-health-checking&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;health check request&lt;/a&gt;Â in addition to 503 response code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UT&lt;/strong&gt;: Upstream request timeout in addition to 504 response code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;LR&lt;/strong&gt;: Connection local reset in addition to 503 response code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UR&lt;/strong&gt;: Upstream remote reset in addition to 503 response code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UC&lt;/strong&gt;: Upstream connection termination in addition to 503 response code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;DI&lt;/strong&gt;: The request processing was delayed for a period specified viaÂ &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/configuration/http/http_filters/fault_filter#config-http-filters-fault-injection&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;fault injection&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;FI&lt;/strong&gt;: The request was aborted with a response code specified viaÂ &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/configuration/http/http_filters/fault_filter#config-http-filters-fault-injection&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;fault injection&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;RL&lt;/strong&gt;: The request was ratelimited locally by theÂ &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/configuration/http/http_filters/rate_limit_filter#config-http-filters-rate-limit&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;HTTP rate limit filter&lt;/a&gt;Â in addition to 429 response code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UAEX&lt;/strong&gt;: The request was denied by the external authorization service.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;RLSE&lt;/strong&gt;: The request was rejected because there was an error in rate limit service.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;IH&lt;/strong&gt;: The request was rejected because it set an invalid value for aÂ &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/http/router/v3/router.proto#envoy-v3-api-field-extensions-filters-http-router-v3-router-strict-check-headers&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;strictly-checked header&lt;/a&gt;Â in addition to 400 response code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;SI&lt;/strong&gt;: Stream idle timeout in addition to 408 response code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;DPE&lt;/strong&gt;: The downstream request had an HTTP protocol error.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UPE&lt;/strong&gt;: The upstream response had an HTTP protocol error.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UMSDR&lt;/strong&gt;: The upstream request reached max stream duration.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;OM&lt;/strong&gt;: Overload Manager terminated the request.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;DF&lt;/strong&gt;: The request was terminated due to DNS resolution failure.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/configuration/observability/access_log/usage#command-operators&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;envoy Access logging&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://www.cnblogs.com/xuliang666/p/12089915.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;istioä¹‹envoyå¸¸è¦‹è¡“èªåŠç‹€æ…‹ç¢¼&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/89. istio å¸¸è¦‹ç‹€æ…‹ç¢¼/" />
        </entry>
        <entry>
            <title>
                75. istio virtual service å¸¸ç”¨åƒæ•¸
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/75. istio virtual service å¸¸ç”¨åƒæ•¸/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ‰äº›æ±è¥¿å¶çˆ¾æœƒç”¨ï¼Œä½†ç¢°åˆ°æ™‚å°±å¿˜äº†æ€éº¼å¯«ï¼Œ&lt;br /&gt;
é‚„è¦å›å»ç¿»ä¸€ä¸‹ï¼Œ&lt;br /&gt;
æ­¤ç¯‡åŒ…å«&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;set/remove header&lt;/li&gt;
&lt;li&gt;match header host æ­£è¦è¡¨ç¤º&lt;/li&gt;
&lt;li&gt;fault å›å‚³ç‰¹å®šç‹€æ…‹&lt;/li&gt;
&lt;li&gt;allow cors&lt;/li&gt;
&lt;li&gt;rewrite&lt;/li&gt;
&lt;li&gt;match uri æ­£è¦è¡¨ç¤º&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;ç•¶åŒä¸€å€‹virtual serviceå…§ï¼Œæœ‰å¤šå€‹match uriæ™‚ï¼Œå„ªå…ˆé †åºï¼Œæ˜¯ç”±ä¸Šåˆ°ä¸‹ã€‚&lt;br /&gt;
ã€€&lt;br /&gt;
ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;match:
	- uri:
			prefix : /api
	- uri:
		    prefix: /api/video		
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æ¨£æ˜¯æ°¸é åˆ°ä¸äº† /api/videoçš„&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;set/remove header&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;add or modify header&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;spec:
  http:
    - name: api
      headers:
        request:
          set:
            x-forward-for: 127.0.0.1
      match:
        - uri:
            prefix: /api
      
      route:
        - destination:
            host: reverse-proxy.abc.svc.cluster.local
            port:
              number: 80
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;remove header&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;spec:
  http:
    - name: api
      headers:
        request:
          remove:
            - x-forward-for
      match:
        - uri:
            prefix: /api
      
      route:
        - destination:
            host: reverse-proxy.abc.svc.cluster.local
            port:
              number: 80
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;match header host&lt;br /&gt;
ç•¶ header hostæœ‰å°æ‡‰åˆ° é€™å…©å€‹ domainå…¶ä¸­ä¸€å€‹çš„è©±ï¼Œ&lt;br /&gt;
å‰‡è½‰åˆ°å°æ‡‰çš„è·¯å¾‘&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;http:
  - match:
      - headers:
          Host:
            regex: (api.asia.com|api.american.com)
        uri:
          prefix: /api-v2
    rewrite:
      uri: /api
    route:
      - destination:
          host: reverse-proxy.abc.svc.cluster.local
          port:
            number: 80
        weight: 100
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¬¦åˆæ­£å‰‡çš„çš†é€²å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
hosts:
  - &#39;*&#39;
gateways:
  - istio-system/istio-gateway-external
  - istio-system/istio-gateway-internal
http:
  - match:
      - headers:
          Host:
            regex: sxqa2.?&#92;.777.+&#92;.com
    route:
      - destination:
          host: video-admin-api-primary
          port:
            number: 80
        weight: 100
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;fault&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç•¶è·¯å¾‘æœ‰å€’åˆ° api/v1/abcæ™‚ï¼Œç›´æ¥å›å‚³ 487çš„éŒ¯èª¤ç¢¼ã€‚&lt;br /&gt;
ï¼ˆé€™å…¶å¯¦æ˜¯æ‹¿ä¾†æ¨¡æ“¬éŒ¯èª¤ç”¨çš„ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http:
  - fault:
      abort:
        httpStatus: 487
        percentage:
          value: 100
    match:
      - uri:
          prefix: /api/v1/abc
    name: fault
    route:
      - destination:
          host: reverse-proxy.abc.svc.cluster.local
          port:
            number: 80
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;allow cors&lt;br /&gt;
é–‹å•Ÿ corsçš„å…è¨±ç¯„åœ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;http:
  - corsPolicy:
      allowHeaders:
        - &#39;*&#39;
      allowOrigin:
        - &#39;*&#39;
    match:
      - uri:
          prefix: /api
    name: filedownload
    route:
      - destination:
          host:  reverse-proxy.abc.svc.cluster.local
          port:
            number: 80
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;rewrite&lt;br /&gt;
è¦†å¯«æœ¬ä¾†çš„uri&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;http:
  - match:
      - uri:
          prefix: /apmapi
    name: api
    rewrite:
      uri: /api
    route:
      - destination:
          host: reverse-proxy.abc.svc.cluster.local
          port:
            number: 80
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åœ¨apiä¹‹å¾Œçš„é€šé€šé€²å»ï¼Œä½†é€™ç¨®å°±ç„¡æ³•ä½¿ç”¨rewriteäº†ã€‚&lt;br /&gt;
å› ç‚ºæœƒå°‡uriå…¨éƒ¨å–ä»£æ‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http:
  - match:
      - uri:
          regex: ^/api/.*
    route:
      - destination:
          host: yabo-api-qa-primary
          port:
            number: 80
        weight: 100
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/75. istio virtual service å¸¸ç”¨åƒæ•¸/" />
        </entry>
        <entry>
            <title>
                73. istio sidecar æ³¨å…¥è¦å‰‡
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/73. istio sidecar æ³¨å…¥è¦å‰‡/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å› ç‚ºdrone çš„ kubernetes Runnerçš„é—œä¿‚ï¼Œ&lt;br /&gt;
å°è‡´æˆ‘æœ‰ä¸€å€‹nsè¦é è¨­å–æ¶ˆistio injectï¼Œ&lt;br /&gt;
ä½†æŸäº›ç‰¹å®šçš„podè¦æ³¨å…¥å°±å¤±æ•—äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å…ˆä¾†çœ‹ä¸€å¼µå®˜æ–¹åšçš„è¡¨(1)ï¼Œ&lt;br /&gt;
å…¶å¯¦å°±å¾ˆå¥½è§£é‡‹ç‚ºä»€éº¼ä¸æœƒæ³¨å…¥äº†ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;namespaceSelector match&lt;/th&gt;
&lt;th&gt;default policy&lt;/th&gt;
&lt;th&gt;Pod override annotation &lt;a href=&quot;http://sidecar.istio.io/inject&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;sidecar.istio.io/inject&lt;/a&gt;&lt;/th&gt;
&lt;th&gt;Sidecar injected?&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;enabled&lt;/td&gt;
&lt;td&gt;true (default)&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;enabled&lt;/td&gt;
&lt;td&gt;false&lt;/td&gt;
&lt;td&gt;no&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;disabled&lt;/td&gt;
&lt;td&gt;true&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;disabled&lt;/td&gt;
&lt;td&gt;false (default)&lt;/td&gt;
&lt;td&gt;no&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;no&lt;/td&gt;
&lt;td&gt;enabled&lt;/td&gt;
&lt;td&gt;true (default)&lt;/td&gt;
&lt;td&gt;no&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;no&lt;/td&gt;
&lt;td&gt;enabled&lt;/td&gt;
&lt;td&gt;false&lt;/td&gt;
&lt;td&gt;no&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;no&lt;/td&gt;
&lt;td&gt;disabled&lt;/td&gt;
&lt;td&gt;true&lt;/td&gt;
&lt;td&gt;no&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;no&lt;/td&gt;
&lt;td&gt;disabled&lt;/td&gt;
&lt;td&gt;false (default)&lt;/td&gt;
&lt;td&gt;no&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å„æ¬„ä½è§£é‡‹ï¼Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;namespaceSelector matchï¼šå„namespaceçš„ istio-injectæ˜¯ enableæˆ– disable&lt;/li&gt;
&lt;li&gt;default policyï¼š é€™å€‹é è¨­éƒ½æ˜¯enableï¼Œè¦æŸ¥çœ‹ä½¿ç”¨commandæˆ–åˆ°configmapæŸ¥çœ‹ istio-sidecar-injector&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n istio-system get configmap istio-sidecar-injector -o jsonpath=&#39;{.data.config}&#39; | grep policy:

&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Pod override annotation ï¼š ç›´æ¥æŒ‡å®špodæœƒä¸æœƒæ³¨å…¥çš„ annotation&lt;/li&gt;
&lt;li&gt;Sidecar injected ï¼šçµæœ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;çµè«–ï¼Œ&lt;br /&gt;
namespaceåªè¦æ˜¯ disabledçš„ï¼Œé€šé€šä¸æœƒinject sidecar&lt;/p&gt;
&lt;h3 id=&quot;æŒ‡ä»¤ç¯‡&quot; tabindex=&quot;-1&quot;&gt;æŒ‡ä»¤ç¯‡&lt;/h3&gt;
&lt;p&gt;namespace&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;### æŸ¥çœ‹nsçš„label
kc get namespace --show-labels

### æ–°å¢ä¿®æ”¹ istio-injection
kubectl label namespace &amp;lt;my-namespace&amp;gt; istio-injection=enabled --overwrite

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å–®ç¨æŒ‡å®šdeployæ›è¼‰sidecar&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  apiVersion: apps/v1
  kind: Deployment
  metadata:
	name: grafana
	namespace: istio-system
  spec:
	replicas: 1
	selector:
	  matchLabels:
		app: websocketclient
	template:
	  metadata:
		creationTimestamp: null
		labels:
		  app: websocketclient
		  sidecar.istio.io/inject: &#39;true&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
1. &lt;a href=&quot;https://istio.io/latest/docs/ops/configuration/mesh/injection-concepts/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Automatic Sidecar Injection&lt;/a&gt;&lt;br /&gt;
2. &lt;a href=&quot;https://istio.io/latest/zh/docs/ops/common-problems/injection/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Sidecar è‡ªå‹•æ³¨å…¥å•é¡Œ&lt;/a&gt;&lt;br /&gt;
3. &lt;a href=&quot;https://morpheushuang.medium.com/istio-automatic-sidecar-injection-543-4981ae7375f7&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é—œæ–¼Istio Automatic Sidecar Injectioné‚£æª”äº‹&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/73. istio sidecar æ³¨å…¥è¦å‰‡/" />
        </entry>
        <entry>
            <title>
                7. Istioå®‰è£åŠä½¿ç”¨
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/7. Istioå®‰è£åŠä½¿ç”¨/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;k8sé‚„æ²’æ‘¸å¾ˆç†Ÿï¼Œæ–°çš„æ±è¥¿å°±éä¾†äº†ã€‚&lt;br /&gt;
é€™æ¬¡æ˜¯server meshæ¶æ§‹...&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å‰å€‹å·¥ä½œé‚„æ²’çµæŸï¼Œæ–°çš„æ±è¥¿å°±ä¾†äº†ã€‚&lt;br /&gt;
é€™æ¬¡æIstioï¼Œç•¶ç„¶å¯ä»¥åœ¨æ±è¥¿éƒ½å»ºç«‹å®Œå¾Œï¼Œå†é–‹å§‹ç©ã€‚&lt;br /&gt;
ä½†é€™æ¨£å°±æœƒè®Šæˆè¦æŠŠèˆŠçš„podç æ‰é‡æ–°å»ºç«‹äº†ã€‚&lt;/p&gt;
&lt;h2 id=&quot;istio&quot; tabindex=&quot;-1&quot;&gt;Istio çŸ¥è­˜åœ–è­œ&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/servicemesher/istio-knowledge-map/master/png/istio-knowledge-map.png&quot; alt=&quot;image&quot; /&gt;&lt;br /&gt;
ref.&lt;a href=&quot;https://github.com/servicemesher/istio-knowledge-map&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istio Knowledge Map&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;å®‰è£å‰&quot; tabindex=&quot;-1&quot;&gt;å®‰è£å‰&lt;/h2&gt;
&lt;p&gt;æœ‰æŸ¥åˆ°è¦å®‰è£istio æœ‰æœ€ä½çš„è³‡æºé™åˆ¶ï¼Œä½†æ²’çœ‹åˆ°æœ‰æ˜ç¢ºçš„æŒ‡å®šã€‚&lt;br /&gt;
ç›®å‰æ¸¬è©¦GKEçš„æ©Ÿå™¨  è¨­æˆ cpu 1 ram 2G æœƒç™¼ç”Ÿ timeoutçš„éŒ¯èª¤ï¼Œ&lt;br /&gt;
æ”¹æˆ cpu 2,ram 4G å‰‡ç„¡æ­¤ç‹€æ³ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/7.fig-4.jpg&quot; alt=&quot;7.fig-4.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://stackoverflow.com/questions/64373346/istioctl-install-fails-with-multiple-timeouts&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;istioctl install fails with multiple timeouts&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;æ©Ÿå™¨å¤§å°è¨­å®š&quot; tabindex=&quot;-1&quot;&gt;æ©Ÿå™¨å¤§å°è¨­å®š&lt;/h2&gt;
&lt;p&gt;ä¸»è¦çš„ç¯€é»å€åŸŸï¼Œcpuå‰‡æœƒåƒåˆ° 900 mCPUï¼Œè¨˜æ†¶é«” 2.75G&lt;br /&gt;
é‚„æ²’å®‰è£ kiali,jaeger,prometheus...ç­‰ï¼Œ&lt;br /&gt;
é–‹æ©Ÿå™¨å¤§å°æ™‚ï¼Œéœ€ç‰¹åˆ¥æ³¨æ„ã€‚&lt;/p&gt;
&lt;h2 id=&quot;é–‹å§‹å®‰è£&quot; tabindex=&quot;-1&quot;&gt;é–‹å§‹å®‰è£&lt;/h2&gt;
&lt;p&gt;é€™æ¬¡è¦å®‰è£åœ¨GKEä¸Šï¼Œæ­¤æ¬¡å®‰è£çš„é…ç½®æ˜¯ minimalç‰ˆï¼Œ&lt;br /&gt;
å„ç‰ˆæœ¬çš„å·®ç•°ï¼Œä¸è¦çœ‹ä¸­æ–‡çš„ï¼Œæ²’æœ‰æ›´æ–°ã€‚å¦‚æœè¦çœ‹åŸç†å¯ä»¥çœ‹ã€‚&lt;br /&gt;
è«‹åƒè€ƒ &lt;a href=&quot;https://istio.io/latest/docs/setup/additional-setup/config-profiles/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Installation Configuration Profiles&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; curl -L https://istio.io/downloadIstio | sh -
 cd istio-1.8.1
 export PATH=$PWD/bin:$PATH
 istioctl install
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;ç§»é™¤å®‰è£&quot; tabindex=&quot;-1&quot;&gt;ç§»é™¤å®‰è£&lt;/h2&gt;
&lt;p&gt;1.20æŒ‡ä»¤æ›´æ”¹ç‚º  &lt;code&gt;istioctl uninstall -y --purge&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;istioctl x uninstall --purge&lt;/code&gt;&lt;br /&gt;
(æ³¨æ„ purgeæœƒæŠŠå…±ç”¨çš„æ±è¥¿é€šé€šåˆªå…‰å…‰ï¼Œä¸ä½¿ç”¨purgeä¹Ÿå¯åˆªé™¤ï¼Œä½†æœƒç•™ä¸‹ deploymentä»¥åŠ service)&lt;br /&gt;
istioctl x uninstall -f /Users/ezio_liu/Documents/k8s/Sample-Yaml/istio-sample-newingeressway.yaml   ï¼ˆç•¶åˆå®‰è£çš„yaml)&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://istio.io/latest/docs/setup/getting-started/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Getting Started&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://istio.io/latest/docs/setup/install/istioctl/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Uninstall Istio&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;å®‰è£å¥—ä»¶&quot; tabindex=&quot;-1&quot;&gt;å®‰è£å¥—ä»¶&lt;/h2&gt;
&lt;p&gt;åœ¨åŸç›®éŒ„ä¸‹åŸ·è¡Œ&lt;/p&gt;
&lt;p&gt;kubectl apply -f samples/addons&lt;br /&gt;
ç¬¬ä¸€æ¬¡åŸ·è¡Œå®Œå¯èƒ½æœƒæœ‰éŒ¯èª¤ï¼Œå¯ä»¥åœ¨åŸ·è¡Œä¸€æ¬¡ã€‚&lt;br /&gt;
å› åŸ·è¡Œå»ºç½®çš„æ©Ÿå™¨ï¼Œæœƒæœ‰æ™‚é–“å·®ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://github.com/istio/istio/tree/release-1.8/samples/addons&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Telemetry Addons&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;namespace-istio&quot; tabindex=&quot;-1&quot;&gt;åœ¨namespaceä¸Šé¢ æ¤å…¥ istio&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;kubectl label namespaces auto istio-injection=enabled
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ¬ä¾†æƒ³ä½¿ç”¨è‡ªå‹•æ¤å…¥ï¼Œå°±æ˜¯é€£é€™è¡Œä¹Ÿä¸ç”¨æ‰“ã€‚&lt;br /&gt;
ä½†æ˜¯ æœ‰äº› k8sç‰ˆæœ¬ï¼Œæœ¬èº«æœƒç¦æ­¢é€™å€‹è¡Œç‚ºï¼Œéœ€è¦çš„è©±è¦å¦è¡Œæ‰“é–‹ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://istio.io/latest/docs/setup/additional-setup/sidecar-injection/#automatic-sidecar-injection&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Automatic sidecar injection&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ™‚å¯å»ºç«‹ä¸€å€‹pod ï¼Œå°±å¯çœ‹åˆ°è£¡é¢å¤šäº†ä¸€å€‹ container&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/7.%20fig-1.jpg&quot; alt=&quot;7. fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæ¤å…¥sidecarå¤±æ•—ï¼Œå‡ºç¾&lt;br /&gt;
Internal error occurred: failed calling webhook &amp;quot;&lt;a href=&quot;http://sidecar-injector.istio.io/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;sidecar-injector.istio.io&lt;/a&gt;&amp;quot;: Post &lt;a href=&quot;https://istiod.istio-system.svc/inject?timeout=30s:&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://istiod.istio-system.svc:443/inject?timeout=30s:&lt;/a&gt; context deadline exceeded&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/7.fig-5.jpg&quot; alt=&quot;7.fig-5.jpg&quot; /&gt;&lt;br /&gt;
éœ€é–‹å•ŸGKEçš„masteré˜²ç«ç‰†è¦å‰‡ï¼Œå¢åŠ  tcp:15017 çš„ port&lt;br /&gt;
(é¡Œå¤–è©±ï¼Œå¦‚æœè¦ä½¿ç”¨kialiçš„è©±ï¼Œè«‹é–‹å•Ÿ tcp: 8080 çš„ portï¼Œä¸ç„¶ä½ æœƒçœ‹kialiä¸€ç›´åœ¨è½‰åœˆåœˆ)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/7.fig-6.jpg&quot; alt=&quot;7.fig-6.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä¸çŸ¥é“è¦è¨­å®šå“ªå€‹é˜²ç«ç‰†è¦å‰‡ï¼Œå¯ä¸‹æŒ‡ä»¤å°‹æ‰¾&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute firewall-rules list --filter=&amp;quot;name~gke-${CLUSTER_NAME}-[0-9a-z]*-master&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…¶ä¸­çš„ ${CLUSTER_NAME} éœ€æ”¹ç‚ºä½ è¦å°‹æ‰¾çš„å¢é›†åç¨±&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute firewall-rules update &amp;lt;firewall-rule-name&amp;gt; --allow tcp:10250,tcp:443,tcp:15017,tcp:8080
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://istio.io/latest/docs/setup/platform-setup/gke/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Google Kubernetes Engine&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;é–‹å•Ÿå¥—ä»¶&quot; tabindex=&quot;-1&quot;&gt;é–‹å•Ÿå¥—ä»¶&lt;/h2&gt;
&lt;p&gt;æˆ‘æ˜¯ä½¿ç”¨GKEï¼ŒåŸæœ¬ä»¥ç‚ºè¦èƒ½å¤ é€£åˆ°å…§éƒ¨çš„æœå‹™ï¼Œéƒ½è¦èµ°å¤–éƒ¨ip&lt;br /&gt;
ä»Šå¤©åœ¨äº‚é»çš„æ™‚å€™ï¼Œé»åˆ°äº†é€™å€‹åœ°æ–¹ï¼Œå°‡é‚£è¡ŒæŒ‡ä»¤è¤‡è£½ï¼Œåœ¨æœ¬æ©ŸåŸ·è¡Œã€‚&lt;br /&gt;
å‰ææ˜¯ä½ çš„gcloudè¦æœ‰èªè­‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/7.%20fig-2.jpg&quot; alt=&quot;7. fig-2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä»–å°±èƒ½å¤ é€éé€šè¨ŠåŸ è½‰ç™¼çš„æ–¹å¼å­˜å–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/7.%20fig-3.jpg&quot; alt=&quot;7. fig-3.jpg&quot; /&gt;&lt;br /&gt;
ç”±(fig.3) å¯ä»¥çœ‹åˆ°ï¼Œä»–å°‡æœ¬æ©Ÿçš„8080å°åˆ°äº†serviceå…§çš„20001ï¼Œ&lt;br /&gt;
æ‰€ä»¥ç›´æ¥é–‹å•Ÿç¶²é æŒ‡å‘ localhost:8080 å°±å¯ä»¥çœ‹åˆ°è©²ç¶²é çš„å…§å®¹äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ä½ˆç½²æ™‚ç”±ä¸Šå¾€ä¸‹é–‹å§‹ä½ˆç½²&quot; tabindex=&quot;-1&quot;&gt;ä½ˆç½²æ™‚ç”±ä¸Šå¾€ä¸‹é–‹å§‹ä½ˆç½²&lt;/h1&gt;
&lt;h2 id=&quot;destination-rule&quot; tabindex=&quot;-1&quot;&gt;DestinationRule&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: localgo
  namespace: auto
spec:
  host: localgo
  trafficPolicy:
    loadBalancer:
      simple: LEAST_CONN
  subsets:
    - name: Localgov1
      labels:
        version: v1
    - name: v2
      labels:
        version: v2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://istio.io/latest/docs/reference/config/networking/destination-rule/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Destination Rule&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åƒæ•¸èªªæ˜&lt;br /&gt;
trafficPolicyå…§çš„ loadBalancer:&lt;br /&gt;
ä»£è¡¨çš„æ˜¯å¹¾ç¨®æµé‡åˆ†ç™¼æ–¹å¼ï¼š&lt;br /&gt;
â€¢Round_Robinï¼š è¼ªè©¢æ¼”ç®—æ³•ï¼Œé¡§åæ€ç¾©è«‹æ±‚å°‡æœƒä¾æ¬¡ç™¼çµ¦æ¯ä¸€å€‹ä¾‹é …ï¼Œä¾†å…±åŒåˆ†æ“”æ‰€æœ‰çš„è«‹æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;â€¢Randomï¼š éš¨æ©Ÿæ¼”ç®—æ³•ï¼Œå°‡æ‰€æœ‰çš„è«‹æ±‚éš¨æ©Ÿåˆ†ç™¼çµ¦å¥åº·çš„ä¾‹é …&lt;/p&gt;
&lt;p&gt;â€¢Least_Conn: æœ€å°é€£ç·šæ•¸ï¼Œåœ¨æ‰€æœ‰å¥åº·çš„ä¾‹é …ä¸­ä»»é¸å…©å€‹ï¼Œå°‡è«‹æ±‚ç™¼çµ¦é€£ç·šæ•¸è¼ƒå°çš„é‚£ä¸€å€‹ä¾‹é …ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.mdeditor.tw/pl/2AOq/zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;idouè€å¸«æ•™ä½ å­¸Istio 19 : Istio æµé‡æ²»ç†åŠŸèƒ½åŸç†èˆ‡å¯¦æˆ°&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;virtual-service&quot; tabindex=&quot;-1&quot;&gt;VirtualService&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: localgo-vs
  namespace: auto
spec:
  hosts:
  - &amp;quot;*&amp;quot;
  gateways:
    - istio-ingressgateway
  http:
  - name: &amp;quot;route-v1&amp;quot;
    route:
    - destination:
        port:
          number: 80
        host: localgo.auto.svc.cluster.local    &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é€™è£¡å°±æ˜¯æŒ‡å‘ä½ çœŸæ­£æœå‹™&quot;&gt;#é€™è£¡å°±æ˜¯æŒ‡å‘ä½ çœŸæ­£æœå‹™&lt;/a&gt; service çš„åç¨±å–”
        subset: Localgov1   &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é€™è£¡æŒ‡çš„æ˜¯DestinationRuleçš„subset&quot;&gt;#é€™è£¡æŒ‡çš„æ˜¯DestinationRuleçš„subset&lt;/a&gt;.name
      weight: 80
    - destination:
        port:
          number: 80
        host: localgo.auto.svc.cluster.local
        # ä¸Šé¢ destionation ä¸‹é¢çš„ host åç¨±æœƒé€™éº¼é•·ï¼Œé€™æ˜¯ k8s å…§éƒ¨å¯¦éš› dns å…¨åï¼Œå¦‚æœéœ€è¦è·¨ namspace å­˜å–ï¼Œå°±éœ€è¦ç”¨é€™æ¨£çš„å…¨åæ–¹å¼æŒ‡å®šã€‚
        # {service name}.{namespace}.svc.cluster.local é€™å°±æ˜¯å®ƒçš„è¦å‰‡
        subset: v2
      weight: 20
      corsPolicy:  ##é™åˆ¶
        allowOrigin:    &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#å…è¨±æ‰€æœ‰ä¾†æº&quot;&gt;#å…è¨±æ‰€æœ‰ä¾†æº&lt;/a&gt;
          - &#39;*&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;corsPolicy æœ‰ä»¥ä¸‹çš„é¸é …&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;allowOrigins&lt;/li&gt;
&lt;li&gt;allowMethods&lt;/li&gt;
&lt;li&gt;allowHeaders&lt;/li&gt;
&lt;li&gt;exposeHeaders&lt;/li&gt;
&lt;li&gt;maxAge&lt;/li&gt;
&lt;li&gt;allowCredentials&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;weight å‰‡æ˜¯ç”¨ä¾†åšæµé‡åˆ†é…ç”¨çš„&lt;br /&gt;
åŒä¸€å€‹routeå…§ï¼Œç›¸åŠ å¿…é ˆ =100&lt;/p&gt;
&lt;p&gt;è©³ç´°èªªæ˜ï¼Œåƒè€ƒä¸‹é¢é€£çµ&lt;br /&gt;
ref.&lt;br /&gt;
&lt;a href=&quot;https://istio.io/latest/zh/docs/reference/config/networking/virtual-service/#CorsPolicy&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;CorsPolicyç´°é …è¨­å®š&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œåœ¨ é€™é‚Šé‚„æœ‰å¦ä¸€ç¨®æ˜¯ matchçš„ç”¨æ³•ï¼Œ&lt;br /&gt;
è™›æ“¬æœå‹™ä¸­å®šç¾©çš„ç¬¬ä¸€æ¢è¦å‰‡æœ‰æœ€é«˜å„ªå…ˆç´šï¼Œ&lt;br /&gt;
ç•¶ç¬¬ä¸€å€‹æ²’æœ‰matchåˆ°ç›¸å°æ‡‰çš„è¦å‰‡æ™‚ï¼Œ&lt;br /&gt;
å‰‡ç¹¼çºŒå¾€ä¸‹åŸ·è¡Œã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: localgo-vs
  namespace: auto
spec:
  hosts:
  - &amp;quot;*&amp;quot;
  gateways:
    - istio-ingressgateway
  http:
  - name: &amp;quot;route-v1&amp;quot;
    match:
    - uri:
        prefix: /reviews
    route:
    - destination:
        port:
          number: 80
        host: localgo.auto.svc.cluster.local    &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é€™è£¡å°±æ˜¯æŒ‡å‘ä½ çœŸæ­£æœå‹™&quot;&gt;#é€™è£¡å°±æ˜¯æŒ‡å‘ä½ çœŸæ­£æœå‹™&lt;/a&gt; service çš„åç¨±å–”
        subset: Localgov1   &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é€™è£¡æŒ‡çš„æ˜¯DestinationRuleçš„subset&quot;&gt;#é€™è£¡æŒ‡çš„æ˜¯DestinationRuleçš„subset&lt;/a&gt;.name
  - name: &amp;quot;route-v3&amp;quot;
    match:
      - uri:
          prefix: /Player
    route:
     - destination:
        port:
          number: 80
        host: localgo.auto.svc.cluster.local    &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é€™è£¡å°±æ˜¯æŒ‡å‘ä½ çœŸæ­£æœå‹™&quot;&gt;#é€™è£¡å°±æ˜¯æŒ‡å‘ä½ çœŸæ­£æœå‹™&lt;/a&gt; service çš„åç¨±å–”
        subset: Localgov1   &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é€™è£¡æŒ‡çš„æ˜¯DestinationRuleçš„subset&quot;&gt;#é€™è£¡æŒ‡çš„æ˜¯DestinationRuleçš„subset&lt;/a&gt;.name       
  - name: &amp;quot;route-v2&amp;quot;
    route:
    - destination:
        port:
          number: 80
        host: localgo.auto.svc.cluster.local
        # ä¸Šé¢ destionation ä¸‹é¢çš„ host åç¨±æœƒé€™éº¼é•·ï¼Œé€™æ˜¯ k8s å…§éƒ¨å¯¦éš› dns å…¨åï¼Œå¦‚æœéœ€è¦è·¨ namspace å­˜å–ï¼Œå°±éœ€è¦ç”¨é€™æ¨£çš„å…¨åæ–¹å¼æŒ‡å®šã€‚
        # {service name}.{namespace}.svc.cluster.local é€™å°±æ˜¯å®ƒçš„è¦å‰‡
        subset: v2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;match ä¸‹é¢çš„ç”¨æ³•&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;exact (å®Œå…¨åŒ¹é…)&lt;/li&gt;
&lt;li&gt;prefix  (åªæœ‰å‰ç¶´)&lt;/li&gt;
&lt;li&gt;regex (æ­£è¦è¡¨ç¤ºæ³•)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸Šé¢é‚£æ®µçš„è¦å‰‡ç‚ºï¼Œç•¶ç¶²å€é€²ä¾†å¾Œï¼Œå¦‚æœç¶²åŸŸçš„å¾Œé¢ä¸æ˜¯reviewsçš„è©±ï¼Œ&lt;br /&gt;
å‰‡å¾€ä¸‹åŸ·è¡Œåˆ°route-v3ï¼Œå¦‚æœç¶²å€ç‚º Playerçš„è©±ï¼Œå‰‡åŸ·è¡Œä¸‹é¢çš„è·¯ç”±&lt;br /&gt;
ref.&lt;br /&gt;
&lt;a href=&quot;https://istio.io/latest/docs/reference/config/networking/virtual-service/#StringMatch&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;StringMatch&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://istio.io/latest/zh/docs/concepts/traffic-management/#more-about-routing-rules&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è·¯ç”±è¦å‰‡&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10247889&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Day24 ä»€éº¼æ˜¯ istio virtual service?&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;gateway&quot; tabindex=&quot;-1&quot;&gt;gateway&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: networking.istio.io/v1beta1
kind: Gateway
metadata:
  name: istio-ingressgateway
  # é€™è£¡å°±æ˜¯å¡«å…¥kubectl get service -n istio-system æ‰€æŸ¥åˆ°çš„ istio-ingressgatewayï¼Œå¯¦å‹™ä¸Šå¦‚æœä½ æœ‰å¤šå€‹ ip ï¼Œå°±æœƒæœ‰å¤šå€‹ gateway ä»£ç†ï¼Œ
  # ç„¶å¾Œå°±è¦æè¿°å¤šå€‹ gateway å»ä½¿ç”¨ gateway ä»£ç†
  namespace: auto
spec:
  selector:
    istio: ingressgateway   # ä½¿ç”¨é»˜èªçš„æ§åˆ¶å™¨
  servers:
  - port: &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#åŠ å¯†å‚³è¼¸&quot;&gt;#åŠ å¯†å‚³è¼¸&lt;/a&gt;
      number: 443
      name: https
      protocol: HTTPS
    tls:
      mode: SIMPLE
      serverCertificate: /etc/istio/ingressgateway-certs/tls.crt &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è¨­å®šæ†‘è­‰è·¯å¾‘&quot;&gt;#è¨­å®šæ†‘è­‰è·¯å¾‘&lt;/a&gt;
      privateKey: /etc/istio/ingressgateway-certs/tls.key  &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è¨­å®šæ†‘è­‰è·¯å¾‘&quot;&gt;#è¨­å®šæ†‘è­‰è·¯å¾‘&lt;/a&gt;
    hosts:
     - &amp;quot;*&amp;quot; &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è©²æœå‹™å°æ‡‰domain&quot;&gt;#è©²æœå‹™å°æ‡‰domain&lt;/a&gt;
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
     - &amp;quot;*&amp;quot; &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è©²æœå‹™å°æ‡‰domain&quot;&gt;#è©²æœå‹™å°æ‡‰domain&lt;/a&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10247372&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;istio gateway æ˜¯ä»€éº¼ï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;ingressgateway&quot; tabindex=&quot;-1&quot;&gt;åŒä¸€å€‹å¢é›†å®‰è£å¤šå€‹ingressgateway&lt;/h3&gt;
&lt;p&gt;æ»¿æ»¿çš„å‘ï¼Œå¡äº†å…©å¤©æ‰æå®šã€‚&lt;/p&gt;
&lt;p&gt;é€™é‚Šè¦æ”¹ä½¿ç”¨operatorå®‰è£&lt;br /&gt;
æ‰€ä»¥å…ˆåˆå§‹åŒ–&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;istioctl operator init
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://istio.io/latest/docs/setup/install/operator/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istio Operator Install&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å†ä¾†è¨­å®šæ–°å¢çš„ ingressgateway&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kind: IstioOperator
apiVersion: install.istio.io/v1alpha1
metadata:
  annotations:
    install.istio.io/ignoreReconcile: &#39;true&#39;
  name: video-state
  namespace: istio-system
spec:
  addonComponents:
    istiocoredns:
      enabled: false
  components:
    base:
      enabled: true
    cni:
      enabled: false
    ingressGateways:
        - name: ingressgateway-private
          namespace: istio-system
          enabled: true
          k8s:
              env:
                - name: ISTIO_META_ROUTER_MODE
                  value: standard          
              hpaSpec:
                minReplicas: 2
              overlays:
                    - kind: HorizontalPodAutoscaler
                      name: ingressgateway-private
                      patches:
                        - path: metadata.labels.app
                          value: ingressgateway-private
                        - path: metadata.labels.istio
                          value: ingressgateway-private
                        - path: spec.scaleTargetRef.name
                          value: ingressgateway-private
                    - kind: Deployment
                      name: ingressgateway-private
                      patches:
                        - path: metadata.labels.app
                          value: ingressgateway-private
                        - path: metadata.labels.istio
                          value: ingressgateway-private
                        - path: spec.selector.matchLabels.app
                          value: ingressgateway-private
                        - path: spec.selector.matchLabels.istio
                          value: ingressgateway-private
                        - path: spec.template.metadata.labels.app
                          value: ingressgateway-private
                        - path: spec.template.metadata.labels.istio
                          value: ingressgateway-private
                    - kind: Service
                      name: ingressgateway-private
                      patches:
                        - path: metadata.labels.app
                          value: ingressgateway-private
                        - path: metadata.labels.istio
                          value: ingressgateway-private
                        - path: spec.selector.app
                          value: ingressgateway-private
                        - path: spec.selector.istio
                          value: ingressgateway-private
                    - kind: PodDisruptionBudget
                      name: ingressgateway-private
                      patches:
                        - path: metadata.name
                          value: ingressgateway-private
                        - path: metadata.labels.app
                          value: ingressgateway-private
                        - path: metadata.labels.istio
                          value: ingressgateway-private
                        - path: spec.selector.matchLabels.app
                          value: ingressgateway-private
                        - path: spec.selector.matchLabels.istio
                          value: ingressgateway-private
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…ˆä½¿ç”¨&lt;br /&gt;
istioctl manifest generate -f newingeressway.yaml&lt;br /&gt;
é å…ˆç·¨è­¯ä¸€ä¸‹ï¼Œçœ‹æœ‰æ²’æœ‰æˆåŠŸã€‚ istioctl manifestçš„åŸç†ï¼Œæœ‰é»åƒæ˜¯kustomizeï¼Œ&lt;br /&gt;
æœ‰ä¸€å€‹åŸºåº•ï¼Œå¾Œé¢çš„ç¨‹å¼éƒ½æ˜¯æ ¹æ“šé€™å€‹åŸºåº•å»ä¿®æ”¹è¦†è“‹ã€‚&lt;/p&gt;
&lt;p&gt;å®‰è£çš„è©±ï¼Œå‰‡æ˜¯ä½¿ç”¨&lt;br /&gt;
istioctl manifest install -f newingeressway.yaml&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://discuss.istio.io/t/multiple-ingress-controller-services-via-istiooperator/7620&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Multiple ingress controller services via IstioOperator?&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://github.com/istio/istio&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;istio&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;http://reader.epubee.com/books/mobile/f2/f2b61f60ba2d351d9bc7c69e933ab394/text00001.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istioå…¥é–€èˆ‡å¯¦æˆ°&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/7. Istioå®‰è£åŠä½¿ç”¨/" />
        </entry>
        <entry>
            <title>
                62. isito é¡åƒæµé‡
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/62. isito é¡åƒæµé‡/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘åœ¨æ¸¬è©¦ istioçš„é¡åƒæµé‡ï¼Œ&lt;br /&gt;
æƒ³è¦é‡å°èˆŠçš„ websocket åšé¡åƒå°‡æµé‡å°åˆ°æ–°ç‰ˆçš„websocketä¸Šé¢ã€‚&lt;/p&gt;
&lt;p&gt;å¯¦æ¸¬çš„çµæœï¼Œwebsocketä¸èƒ½ç”¨ã€‚&lt;br /&gt;
ä½†httpèƒ½å¤ ä½¿ç”¨ï¼Œé€™æ˜¯ç”±æ–¼ istioçš„é¡åƒæµé‡æ˜¯ ã€ fire and forgetã€&lt;/p&gt;
&lt;p&gt;ä½†websocket æ˜¯éœ€è¦äº¤æ¡å¾Œï¼Œæ‰èƒ½æŒçºŒé€²è¡Œä¸‹é¢çš„æ­¥é©Ÿã€‚&lt;br /&gt;
æ‰€ä»¥å°è‡´é€£ç·šç„¡æ³•å»ºç«‹ï¼Œä½† RESTfulçš„è«‹æ±‚ï¼Œæ˜¯æ²’å•é¡Œçš„ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæ±ºæ¢ä»¶ï¼Œ&lt;br /&gt;
2å€‹deploymentï¼Œåˆ†åˆ¥å« A è·Ÿ Bï¼Œ&lt;br /&gt;
label ä½¿ç”¨ versionï¼šv1  ä»¥åŠ version: v2 åšå€åˆ¥&lt;br /&gt;
1å€‹ service ï¼Œåˆ†åˆ¥æŒ‡åˆ°é€™2å€‹deployment&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: ws-qa
  namespace: istio
spec:
  hosts:
    - www.abc.com
    - yabo-ws-qa
  gateways:
    - istio-system/istio-gateway-external
    - istio-system/istio-gateway-internal     
  http:
  - match:
      - uri:
          regex: ^/ws/.*
    route:
      - destination:
          host: ws-qa
          subset: v1
          port:
            number: 80
        weight: 100
    mirror:
        host: ws-qa
        subset: v2
    mirrorPercentage: 
        value: 100.0
---
apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
 name: ws-qa
 namespace: istio
spec:
 host: ws-qa
 subsets:
 - labels:
     version: v1
   name: v1
 - labels:
     version: v2
   name: v2 		
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”¨ä»»ä¸€çš„å£“æ¸¬è»Ÿé«”ï¼Œå‘¼å«æœ¬ä¾†çš„ç¶²ç«™ï¼Œå°±æœƒå¾—åˆ°ä¸‹åœ–çš„æ•¸æ“šã€‚&lt;br /&gt;
v2æ˜¯é¡åƒæµé‡ï¼Œæµé‡éå»å¾Œå°±ä¸æœƒç®¡æ˜¯å¦å›æ‡‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/62-fig.1.jpg&quot; alt=&quot;62-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.servicemesher.com/istio-handbook/practice/traffic-shadow.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æµé‡é¡åƒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/latest/docs/tasks/traffic-management/mirroring/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Mirroring&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/62. isito é¡åƒæµé‡/" />
        </entry>
        <entry>
            <title>
                54. istio æ›è¼‰ECK kibana
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/54. istio æ›è¼‰ECK kibana/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æ­£å¸¸è¨­å®švsçš„æ™‚å€™ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- match:
    - uri:
        prefix: /
  name: kibana
  route:
    - destination:
        host: quickstart-kb-http.default.svc.cluster.local
        port:
          number: 5601
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœƒç™¼ç”ŸéŒ¯èª¤&lt;br /&gt;
upstream connect error or disconnect/reset before headers. reset reason: connection termination&lt;/p&gt;
&lt;p&gt;ä¸ç®¡æ€æ¨£æ”¹vsé‚„æ˜¯ä¸é€šï¼Œæœ€å¾Œæ˜¯è¦æŠŠkibanaçš„è¨­å®šæ”¹æ‰ï¼Œ&lt;/p&gt;
&lt;p&gt;å®Œæ•´çš„yamlå¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: kibana.k8s.elastic.co/v1
kind: Kibana
metadata:
  name: quickstart
spec:
  version: 7.15.0
  count: 1
  elasticsearchRef:
    name: quickstart
  http:
    tls:
      selfSignedCertificate:
        disabled: true
    service:
      spec:
        ports:
          - name: http
            port: 5601
            targetPort: 5601   
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‡é»åœ¨æ–¼ä¸€å®šè¦åŠ  http ä¸‹é¢çš„è¨­å®šã€‚&lt;/p&gt;
&lt;p&gt;selfSignedCertificate ï¼Œè«‹åƒè€ƒ[3]&lt;/p&gt;
&lt;p&gt;è£œå……ï¼š&lt;br /&gt;
[1] çš„é€£çµæœ‰æåˆ°&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    metadata:
      annotations:
        sidecar.istio.io/rewriteAppHTTPProbers: &amp;quot;true&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šè«‹åƒè€ƒ[2]&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/59643343/expose-kibana-eck-operator-via-istio-gateway-https-problem-error-503&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Expose kibana (eck operator) via istio gateway - https problem (Error 503)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/latest/zh/docs/ops/configuration/mesh/app-health-check/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istio æœå‹™çš„å¥åº·æª¢æŸ¥&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-kibana-http-configuration.html#k8s-kibana-http-publish&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;HTTP configuration&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/54. istio æ›è¼‰ECK kibana/" />
        </entry>
        <entry>
            <title>
                35. istio virtualService delegateä½¿ç”¨
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/35. istio virtualService delegateä½¿ç”¨/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æœƒç”¨åˆ°delegateçš„åŸå› ï¼Œæ˜¯ç‚ºäº†è¦è§£æ±ºåœ¨ç¶­è­·æ™‚ä¸Šçš„ç—›é»ã€‚&lt;br /&gt;
å› ç›®å‰ä½¿ç”¨flagger canaryï¼Œ&lt;br /&gt;
å°è‡´æ¯å€‹æœå‹™å°±ä¸€å€‹virtualService (ä¸‹é¢æœƒç”¨VSä»£æ›¿)ï¼Œ&lt;br /&gt;
è€Œå¤šå€‹æœå‹™æœƒå…±ç”¨ä¸€å€‹host ï¼Œå°è‡´åœ¨ç¶­è­·ä¸Šçš„å›°é›£ã€‚&lt;br /&gt;
è€Œä¸”åœ¨kialiä¸Šé¢æœƒå‡ºç¾è­¦å‘Š(fig.1)ï¼Œçœ‹äº†å¯¦åœ¨ç¤™çœ¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/35-fig.1.jpg&quot; alt=&quot;35-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ä½¿ç”¨delegateã€‚é€™æ¨£çš„è©±ï¼Œæµé‡æœƒå…ˆå°åˆ° delegate vsï¼Œä¹‹å¾Œæ‰æœƒæ ¹æ“špathåˆ°å„æœå‹™çš„vsã€‚&lt;/p&gt;
&lt;p&gt;delegate æœ‰å¹¾é»è¦æ³¨æ„ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸æ”¯æ´ regex&lt;/li&gt;
&lt;li&gt;åœ¨delegateä¸Šå¯«rewriteä¸æœƒè¢«è½‰å°ï¼Œè¦åœ¨å°éå»çš„vså¯«ã€‚&lt;/li&gt;
&lt;li&gt;ç›®å‰æ¸¬è©¦åªèƒ½åœ¨åŒä¸€å€‹namespaceä¸Šé¢ã€‚å¦‚æœä¸æ˜¯ç”¨è—ç¶ ä½ˆç½²è‡ªå®šç¾©çš„è©±ï¼Œåœ¨destination ä¸Šé¢ï¼Œå¯ä»¥ä½¿ç”¨å®Œæ•´çš„FQDNï¼Œæ˜¯å¯ä»¥åŸ·è¡Œçš„ã€‚(ä¾‹å¦‚: video-admin-primary.default.svc.cluster.local)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;VS delegate&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: control-dashboard
  namespace: default
spec:
  hosts:
  - &amp;quot;*&amp;quot;
  gateways:
    - istio-gateway-external.istio-system.svc.cluster.local
  http:
    - delegate:
        name: video-admin
        namespace: default
      match:
        - uri:
            prefix: /ezio
        - uri:
            prefix: /abc
        - uri:
            prefix: /api
      name: reviews-v2-routes
    - delegate:
        name: tw-frontend
        namespace: default
      match:
        - uri:
            prefix: /
      name: tw-frontend
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœå‹™çš„ vsï¼Œï¼ˆæ³¨æ„ï¼šæ­¤è™•çš„yamlæ˜¯ç”±flaggerè‡ªå‹•ç”¢ç”Ÿçš„ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kind: VirtualService
apiVersion: networking.istio.io/v1alpha3
metadata:
  name: video-admin
  namespace: default
spec:
  hosts: []
  http:
    - match:
        - uri:
            prefix: /api
        - uri:
            prefix: /abc
        - uri:
            prefix: /ezio
      rewrite:
        uri: /api
      route:
        - destination:
            host: video-admin-primary
          weight: 100
        - destination:
            host: video-admin-canary
          weight: 0

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ps. ä½¿ç”¨canaryçš„è©±ï¼Œåœ¨serviceä¸‹é¢åŠ ä¸Š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;delegation: true  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://docs.flagger.app/faq#how-does-flagger-interact-with-istio&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How does Flagger interact with Istio?&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: flagger.app/v1beta1
kind: Canary
metadata:
  name: example-api-qa-v2
  namespace: istio-example
spec:
  provider: istio
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: example-api-qa-v2
  autoscalerRef:
    apiVersion: autoscaling/v1
    kind: HorizontalPodAutoscaler
    name: example-api-qa-v2

  service:
    delegation: true    # use delegate
    name: example-api-qa-v2
    port: 80
    targetPort: 80
    portName: http
    portDiscovery: true

    trafficPolicy:
      tls:
        mode: DISABLE
    match:
      - uri:
          prefix: /api-v2
    rewrite:
      uri: /api
    timeout: 30s
  analysis:
    # analysis spend time  : interval * iterations 
    # æ™‚é–“é–“éš” (é»˜èª 60s)
    interval: 30s
    # å›æ»¾å‰çš„æœ€å¤§å¤±æ•—æŒ‡æ¨™æª¢æŸ¥æ¬¡æ•¸(å¯èƒ½å› ç‚ºæª¢æŸ¥æ™‚é–“å·®çš„é—œä¿‚ï¼Œè‡³å°‘æœƒæœ‰å…©æ¬¡å¤±æ•—)
    threshold: 5
    iterations: 1
    metrics:
      - name: request-success-rate
        thresholdRange:
          min: 99
        interval: 1m
      - name: request-duration
        thresholdRange:
          max: 500
        interval: 30s
    webhooks:
      - name: load-test-get
        type: pre-rollout
        url: http://flagger-loadtester.tools/
        timeout: 15s
        metadata:
          type: cmd
          cmd: &amp;quot;hey -z 1m -q 10 -c 2 http://example-api-qa-v2-canary.istio-example&amp;quot;
      - name: &amp;quot;notify&amp;quot;
        type: event
        url: http://webhook-api.tools/webhook/flagger
        timeout: 5s
        metadata:
          channel: &amp;quot;-1001429024676&amp;quot;
      - name: load-test
        type: rollout
        url: http://flagger-loadtester.tools/
        timeout: 5s
        metadata:
          type: cmd
          cmd: &amp;quot;hey -z 1m -q 10  http://example-api-qa-v2-canary.istio-example&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://istio.io/latest/docs/reference/config/networking/virtual-service/#Delegate&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;VS Delegate&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://istio.io/latest/docs/reference/config/networking/virtual-service/#HTTPMatchRequest&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;VS HTTPMatchRequest&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/35. istio virtualService delegateä½¿ç”¨/" />
        </entry>
        <entry>
            <title>
                34. istio operator å®‰è£æ–°çš„ ingress deployåŠservice
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/34. istio operator å®‰è£æ–°çš„ ingress deployåŠservice/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¸»ç®¡æŒ‘æˆ°DCå¤±æ•—ï¼Œè®Šæˆåˆè¦è®Šå›èˆŠçš„ç³»çµ±æ¶æ§‹ã€‚æšˆ...&lt;br /&gt;
ç”¨äº†istioæ˜¯ç‚ºäº†ä¸€å€‹ipæ‰“æ‰€æœ‰æœå‹™ï¼Œç¾åœ¨åˆè®Šå›å»ã€‚&lt;br /&gt;
æœå‹™è·Ÿ ip æ˜¯ä¸€å°ä¸€çš„å­˜åœ¨ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æœ€ç°¡å–®çš„å®‰è£æ–¹å¼ï¼Œå¯çœ‹å‰ä¸€ç¯‡ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/7.%20Istio%E5%AE%89%E8%A3%9D%E5%8F%8A%E4%BD%BF%E7%94%A8/&quot;&gt;7. Istioå®‰è£åŠä½¿ç”¨&lt;/a&gt;&lt;br /&gt;
ä»¥å‰æ–°å¢çš„æ™‚å€™ï¼Œéƒ½æœƒåŒæ™‚å®‰è£æœ€åŸå§‹çš„deploy ä»¥åŠ service(fig.1)ï¼Œ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/34.fig-1.jpg&quot; alt=&quot;34.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥åœ¨æ–°å¢æ–°çš„ingressgatewayçš„æ™‚å€™ï¼Œéœ€è¦å…ˆæŒ‡å®šåŸå§‹çš„istio-ingressgateway ç‚º enable:falseã€‚&lt;br /&gt;
é€™æ¨£åœ¨å®‰è£çš„æ™‚å€™ï¼Œæ‰ä¸æœƒåŒæ™‚å®‰è£ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kind: IstioOperator
apiVersion: install.istio.io/v1alpha1
metadata:
annotations:
  install.istio.io/ignoreReconcile: &#39;true&#39;
name: istio-external-test
namespace: istio-system
spec:
addonComponents:
  istiocoredns:
    enabled: false
components:
  base:
    enabled: true
  cni:
    enabled: false
  ingressGateways:
      - name: istio-ingressgateway     # 20210730æ–°å¢ï¼Œå¯å–æ¶ˆå–®ç¨ä½ˆç½²æ­¤yamlé‚„æœƒé¡å¤–è£ingress-gateway
        enabled: false
      - name: ingressgateway-external              
        namespace: istio-system
        enabled: true
        k8s:
          service:
        # loadBalancerIP è¦è·Ÿè‘—æ”¹ï¼Œæœ€å¥½å…ˆå°‡IPè¨­æˆéœæ…‹
            loadBalancerIP: 
            loadBalancerSourceRanges:
                # - 0.0.0.0/0   
                - 10.0.0.0/8
                - 172.16.0.0/12
                - 192.168.0.0/16 
          env:
            - name: ISTIO_META_ROUTER_MODE
              value: standard          
          hpaSpec:
            minReplicas: 1
          overlays:
                - kind: HorizontalPodAutoscaler
                  name: ingressgateway-external
                  patches:
                    - path: metadata.labels.app
                      value: ingressgateway-external
                    - path: metadata.labels.istio
                      value: ingressgateway-external
                    - path: spec.scaleTargetRef.name
                      value: ingressgateway-external
                - kind: Deployment
                  name: ingressgateway-external
                  patches:
                    - path: metadata.labels.app
                      value: ingressgateway-external
                    - path: metadata.labels.istio
                      value: ingressgateway-external
                    - path: spec.selector.matchLabels.app
                      value: ingressgateway-external
                    - path: spec.selector.matchLabels.istio
                      value: ingressgateway-external
                    - path: spec.template.metadata.labels.app
                      value: ingressgateway-external
                    - path: spec.template.metadata.labels.istio
                      value: ingressgateway-external
                - kind: Service
                  name: ingressgateway-external
                  patches:
                    - path: metadata.labels.app
                      value: ingressgateway-external
                    - path: metadata.labels.istio
                      value: ingressgateway-external
                    - path: spec.selector.app
                      value: ingressgateway-external
                    - path: spec.selector.istio
                      value: ingressgateway-external
                - kind: PodDisruptionBudget
                  name: ingressgateway-external
                  patches:
                    - path: metadata.name
                      value: ingressgateway-external
                    - path: metadata.labels.app
                      value: ingressgateway-external
                    - path: metadata.labels.istio
                      value: ingressgateway-external
                    - path: spec.selector.matchLabels.app
                      value: ingressgateway-external
                    - path: spec.selector.matchLabels.istio
                      value: ingressgateway-external
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/34. istio operator å®‰è£æ–°çš„ ingress deployåŠservice/" />
        </entry>
        <entry>
            <title>
                31.istio æŠ“èŸ²è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/31.istio æŠ“èŸ²è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ç‹€æ³å¾ˆå¥‡ç‰¹ï¼Œå¥‡ç‰¹åˆ°æˆ‘ä¸çŸ¥é“è©²å¾å“ªé‡Œæ‰¾ã€‚ç°¡å–®èªªå°±æ˜¯gatewayè£¡é¢æœ‰meshçš„è©±ï¼Œ&lt;br /&gt;
å°±æœƒæœ‰æ­¤å‘å‡ºç¾ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å…ˆèªªæ˜ä¸€ä¸‹ç’°å¢ƒï¼ŒDeployment  A çš„ VirtualService æœ‰è¨­å®š domain , &lt;a href=&quot;http://abc.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;abc.com&lt;/a&gt;&lt;br /&gt;
æ­¤æ™‚é€²å» Deploymentè£¡é¢çš„ pod ï¼Œ ä½¿ç”¨ curl å‘¼å«å¤–éƒ¨çš„ipï¼Œæœƒç™¼ç”Ÿ404çš„éŒ¯èª¤ã€‚&lt;br /&gt;
e.g.   curl -v 123.213.123.213 -H &amp;quot;Host:abc.com&amp;quot;&lt;br /&gt;
ä½†æ˜¯ï¼Œ&lt;a href=&quot;http://xn--hostabc-7w3kl56ffok94z.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¦‚æœHostä¸å¸¶abc.com&lt;/a&gt; ï¼Œæ”¹å¸¶ä»»æ„çš„ domainï¼Œå³å¯æ­£å¸¸åŸ·è¡Œã€‚&lt;/p&gt;
&lt;h2 id=&quot;é™¤éŒ¯éç¨‹&quot; tabindex=&quot;-1&quot;&gt;é™¤éŒ¯éç¨‹&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨tcpdump ï¼Œå°‡æ‰€æœ‰çš„å°åŒ…æ’ˆå‡ºï¼Œä½†ç™¼ç¾å¦‚æœ host å¸¶ &lt;a href=&quot;http://abc.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;abc.com&lt;/a&gt; ï¼Œæ²’æœ‰ä»»ä½•çš„å°åŒ…é€²å‡ºã€‚&lt;br /&gt;
ä½†å¸¶ä»»æ„ domain:  &lt;a href=&quot;http://def.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;def.com&lt;/a&gt; ï¼Œå‰‡æœƒæœ‰å°åŒ…é€²å‡ºã€‚æ•…é–‹å§‹æ‡·ç–‘æ˜¯ sidecarçš„æŸäº›æ©Ÿåˆ¶å°‡æµé‡å°åˆ°æœ¬æ©Ÿï¼Œ&lt;br /&gt;
ä»¥è‡³æ–¼å›å‚³404çš„éŒ¯èª¤ã€‚&lt;/p&gt;
&lt;p&gt;ç°¡æ˜“çš„tcpdumpä½¿ç”¨ï¼Œ&lt;br /&gt;
è©³ç´°ç”¨æ³•è«‹åƒè€ƒé€£çµ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  é‡å° host æ˜¯ 123.213.123.213 ä¸” port æ˜¯ 80 çš„å°åŒ…æˆªå–ï¼Œä¸¦å­˜å…¥demo2.pcapçš„æª”æ¡ˆ
  tcpdump host 123.213.123.213 and port 80 -w demo2.pcap
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†æ˜¯å¾podè£¡é¢çœ‹å°åŒ…ï¼Œæœƒæƒ³å“­ï¼Œæ‰€ä»¥é€²ä¸€æ­¥è¦æŠŠå°åŒ…çš„æª”æ¡ˆæ”¾åˆ°è‡ªå·±çš„æ©Ÿå™¨ä¸Šï¼Œå†ä½¿ç”¨wiresharkçœ‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  å°‡pod(api-beta-v2-primary-69797b47d6-bl6vf)ï¼Œè£¡é¢çš„æª”æ¡ˆ demo2.pcap è¤‡è£½åˆ°æœ¬æ©Ÿä¸Š
  kubectl cp api-beta-v2-primary-69797b47d6-bl6vf:/app/demo2.pcap -n istio ./demo2.pcap
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.jinnsblog.com/2020/09/linux-tcpdump-network-traffic-tutorial.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[Linux] Tcpdump æ“·å–å°åŒ…æŒ‡ä»¤ç¯„ä¾‹æ•™å­¸&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥è©¢outbound handler&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;  istioctl proxy-config route api-beta-v2-primary-69797b47d6-bl6vf -n istio
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çµ‚æ–¼æŸ¥åˆ°äº†ä¸€å€‹é—œéµï¼Œåœ¨æœ‰å•é¡Œdomainï¼Œä»–matchçš„pathæ˜¯å¦å¤–ä¸€å€‹virtualService(fig.1)ï¼Œæœ€å¾ŒæŸ¥åˆ°é‚£å€‹VirtualSerice ï¼Œåœ¨gatewayä¸Šé¢å¤šè¨­äº†ä¸€çµ„ meshï¼Œ&lt;br /&gt;
å°è‡´ä»–ä¸€ç›´åœ¨ç¶²æ ¼å…§ç¹ï¼Œæ‰€ä»¥æ‰æœƒ404ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/31.fig-1.jpg&quot; alt=&quot;31.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é¡å¤–è£œå……ï¼ŒæŸ¥è©¢ Inbound handler&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   istioctl proxy-config listener reviews-v1-54b8794ddf-jxksn
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ç›´æ¥ç”¨ istioctl pc ä¾†å–ä»£ proxy-config&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://jimmysong.io/blog/sidecar-injection-iptables-and-traffic-routing/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istio ä¸­çš„ Sidecar æ³¨å…¥åŠé€æ˜æµé‡åŠ«æŒéç¨‹è©³è§£&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/31.istio æŠ“èŸ²è¨˜/" />
        </entry>
        <entry>
            <title>
                30. istioçš„virtualservice matchæ¯”å°
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/30. istioçš„virtualservice matchæ¯”å°/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘å› ç‚ºæ–°çš„éœ€æ±‚ï¼Œå†åº¦è·Ÿistioçš„virtualserviceæ§“ä¸Šäº†ã€‚&lt;br /&gt;
é€™æ¬¡è¦åšçš„æ˜¯é‡å°domainå»è§£æç¶²å€ï¼Œhostä¸å†è‡ªå®šã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;è¸©åˆ°çš„å‘å¾ˆç‰¹åˆ¥ï¼Œæ ¹æ“šå®˜æ–¹æ–‡ä»¶ä¸Šå¯«çš„æ˜¯&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;For example, the following restricts the rule to match only requests where the URL path starts with /ratings/v2/ and the request contains a custom end-user header with value jason&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ–‡ç« çš„ç¯„ä¾‹å¦‚ä¸‹ï¼Œå®˜æ–¹æ–‡ä»¶æ˜¯èªªæ˜ç•¶url path ç¬¦åˆ /ratings/v2 è€Œä¸” headerè£¡é¢çš„end-userçš„å€¼ç‚º jason æ‰æœƒè½‰åˆ°æ­£ç¢ºçš„è·¯ç”±ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  apiVersion: networking.istio.io/v1beta1
  kind: VirtualService
  metadata:
  name: ratings-route
  spec:
  hosts:
  - ratings.prod.svc.cluster.local
  http:
  - match:
    - headers:
        end-user:
          exact: jason
      uri:
        prefix: &amp;quot;/ratings/v2/&amp;quot;
      ignoreUriCase: true
    route:
    - destination:
        host: ratings.prod.svc.cluster.local
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://istio.io/latest/docs/reference/config/networking/virtual-service/?_ga=2.150842550.1248538041.1620980160-699625840.1605505006#HTTPMatchRequest&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;HTTPMatchRequest&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å†ä¾†å°±æ˜¯æˆ‘è¸©å‘çš„åœ°æ–¹ï¼Œå› ç‚ºæˆ‘ä¸ç®¡æ€éº¼æ¸¬è©¦ï¼Œæ¸¬è©¦å‡ºä¾†çš„éƒ½æ˜¯ ã€æˆ–ã€ï¼Œ&lt;br /&gt;
ä¹Ÿå°±æ˜¯èªª ç•¶æµé‡é€²å…¥æ™‚ï¼Œ åªè¦ url path æ˜¯ /api ã€æˆ–ã€ header çš„Hostæ˜¯ ç¬¦åˆ qa2.777.+.comçš„æ­£å‰‡ï¼Œæ‰æœƒå°å»æ­£ç¢ºçš„è·¯ç”±ã€‚&lt;br /&gt;
è·Ÿå®˜æ–¹æ–‡ä»¶çš„è¬›æ³•è½å·®æœ‰é»å¤§ï¼Œå¾Œä¾†æ¸¬è©¦äº†è€åŠå¤©æ‰ç™¼ç¾ï¼Œé—œéµåœ¨ ã€ - ã€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ç¨‹å¼ï¼Œæ¢ä»¶æ˜¯ ã€æˆ–ã€ï¼Œå…©å€‹æ¢ä»¶å…¶ä¸­ä¸€å€‹ééƒ½æœƒå°åˆ°æ­£ç¢ºçš„è·¯ç”±&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;match:
  - headers:
      Host:
        regex: qa2&#92;.777.+&#92;.com
  - uri:
      prefix: /api
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸‹é¢çš„ç¨‹å¼ï¼Œæ¢ä»¶å¼ ã€è€Œä¸”ã€ ï¼Œå…©å€‹æ¢ä»¶éƒ½è¦ç¬¦åˆæ‰æœƒå°åˆ°æ­£ç¢ºçš„è·¯ç”±&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;match:
  - headers:
      Host:
        regex: qa2.?&#92;.777.+&#92;.com
    uri:
      prefix: /api
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ¬ä¾†é‚„æœ‰åœ¨æ¢è¨å¦ä¸€ç¨®æ–¹æ³•ï¼Œç›´æ¥åœ¨hostsä¸Šé¢åšåˆ¤æ–·(fig.1)ï¼Œ&lt;br /&gt;
ä½†æ˜¯æ¸¬è©¦å‡ºä¾†åªèƒ½é‡å° sub domainï¼Œå¦‚æœæŠŠè¬ç”¨å­—å…ƒæ”¾åœ¨å¾Œé¢ï¼Œé€£å­˜æª”éƒ½æœƒå‡ºéŒ¯æ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/30.fig-1.jpg&quot; alt=&quot;30.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hosts:
  - &amp;quot;*.777.com&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://github.com/istio/istio/issues/15456&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Support wildcard/regexp in VirtualService host&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-msg-config-route-v3-virtualhost&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;config.route.v3.VirtualHost&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/30. istioçš„virtualservice matchæ¯”å°/" />
        </entry>
        <entry>
            <title>
                23.istioçš„ prometheusæˆªå–GKE metrics
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/23.istioçš„ prometheusæˆªå–GKE metrics/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¸»è¦æ¶æ§‹å¼„å¾—å·®ä¸å¤šçš„ï¼Œä½¿ç”¨ istio åŠ ä¸Š drone çš„ è‡ªå‹•ä½ˆç½²ï¼Œ&lt;br /&gt;
å†é…åˆ flaggerçš„è—ç¶ ä½ˆç½²ï¼Œè—ç¶ ä½ˆç½²æ™‚ä½¿ç”¨telegramé€šçŸ¥ç›®å‰ä½ˆç½²é€²åº¦ã€‚&lt;br /&gt;
ï¼Œç¾åœ¨å‰©ä¸‹ç›£æ§é€™ä¸€å¡Šã€‚&lt;br /&gt;
ç„¶å¾Œï¼Œé˜¿ä¼¯ï¼Œå‡ºäº‹æ‹‰....&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä¸€é–‹å§‹æƒ³ä½¿ç”¨grafanaä¸Šé¢çš„æ¨£æ¿ï¼ŒåŸä»¥çˆ²åªè¦é€™æ¨£å°±å¥½ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://grafana.com/grafana/dashboards/8588&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;1. Kubernetes Deployment Statefulset Daemonset metrics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://grafana.com/grafana/dashboards/13105&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;1 Kubernetes for Prometheus Dashboard CN 20201209&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10224491&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Prometheus 2 - Deploy Grafana&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œç™¼ç¾æˆ‘æŠ“ä¸åˆ°è³‡æ–™ã€‚ç›´æ¥é€£ç·šè‡³Prometheusè£¡é¢æŸ¥è©¢ä¹Ÿæ²’æœ‰ï¼Œ&lt;br /&gt;
æ–¼æ˜¯æ–·å®šï¼Œæˆ‘æ ¹æœ¬æ²’æœ‰æ’ˆè³‡æ–™åˆ°Prometheusã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœç›´æ¥æ¶è¨­ä¸€å€‹æ–°çš„grafanaä¸ä½¿ç”¨istioçš„grafanaæœƒä¸æœƒæ¯”è¼ƒå¥½ï¼Ÿ&lt;br /&gt;
ä½†æ˜¯é€™æ¨£æœ¬ä¾†istioçš„grafana dashboard (Fig.1) å°±è¦è‡ªå·±å»ºç«‹äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/23-fig.1.jpg&quot; alt=&quot;23-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;kube-state-metrics&quot; tabindex=&quot;-1&quot;&gt;kube-state-metrics&lt;/h2&gt;
&lt;p&gt;æŸ¥äº†ä¸€äº›è³‡æ–™ï¼Œæœ€å¾Œæ‰¾åˆ°çš„æ–¹æ¡ˆæ˜¯å®‰è£ &lt;a href=&quot;https://github.com/kubernetes/kube-state-metrics&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kube-state-metrics&lt;/a&gt;&lt;br /&gt;
ä½†æ˜¯å…‰å®‰è£é‚„æ˜¯ä¸è¡Œï¼Œå¿…é ˆè¦è®“PrometheusæŠ“å¾—åˆ°è³‡æ–™æ‰è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å»ºè­°å…ˆå°‡yamlæª”æŠ“ä¸‹ä¾†ï¼Œå› ç‚ºæœ‰äº›åœ°æ–¹éœ€è¦æ›´æ”¹ã€‚&lt;br /&gt;
æ‰“é–‹ standard/service.yaml&lt;br /&gt;
åœ¨metadataåº•ä¸‹ åŠ ä¸Š   &lt;a href=&quot;http://prometheus.io/scrape:&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;prometheus.io/scrape:&lt;/a&gt; &#39;true&#39;&lt;br /&gt;
é€™æ˜¯è¦è®“prometheus å¯ä»¥è‡ªå‹•å¾—å»ç™¼ç¾æœå‹™&lt;/p&gt;
&lt;p&gt;metadataå®Œæ•´çš„yamlå¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;metadata:
  labels:
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/version: v1.9.8
  annotations:
      prometheus.io/scrape: &#39;true&#39;
  name: kube-state-metrics
  namespace: kube-system
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œï¼Œä½ˆç½²&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  kubectl apply -f standard
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;node-exporter&quot; tabindex=&quot;-1&quot;&gt;Node-Exporter&lt;/h2&gt;
&lt;p&gt;å¾Œä¾†æŸ¥äº†ä¸€ä¸‹ï¼Œé€™é‚Šçš„æŒ‡æ¨™è³‡æ–™å·²ç¶“åœ¨ cadvisor è£¡é¢äº†ï¼Œæ‰€ä»¥ä¸ç”¨åœ¨é¡å¤–åšã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://stackoverflow.com/questions/63741959/prometheus-node-exporter-issue-when-update-from-gke-1-15-to-1-16&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Prometheus (node_exporter) issue when update from GKE 1.15 to 1.16&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10225912&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Prometheus 5 - Node Exporter &amp;amp; Kube State Metrics&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.uj5u.com/qita/31194.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;prometheusï¼ˆä¹ï¼‰ æ”¶é›†kube-state-metricsæŒ‡æ¨™è³‡è¨Š&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/23.istioçš„ prometheusæˆªå–GKE metrics/" />
        </entry>
        <entry>
            <title>
                21. flagger è‡ªå‹•é‡‘çµ²é›€ä½ˆç½² for istio
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/21. flagger è‡ªå‹•é‡‘çµ²é›€ä½ˆç½² for istio/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ¬ä¾†è‡ªå‹•ä½ˆç½²é…ä¸Šistioéƒ½å¥½äº†ï¼Œ&lt;br /&gt;
ä½†åœ¨å¯¦éš›ä¸Šæ¸¬è©¦çš„æ™‚å€™ç™¼ç¾ï¼Œå¦‚æœä¸å°å…¥è‡ªå‹•è—ç¶ ä½ˆç½²æˆ–é‡‘çµ²é›€ä½ˆç½²çš„è©±ï¼Œ&lt;br /&gt;
åˆ°æ™‚é–‹ç™¼äººå“¡ç™¼ä½ˆç¨‹å¼æ™‚ï¼Œéœ€è¦æ›´æ”¹istio çš„ VirtualService ä»¥åŠ DestinationRuleã€‚&lt;br /&gt;
é™¤éç™¼ä½ˆçš„äººæ‡‚é€™äº›æ±è¥¿ï¼Œä¸ç„¶...æ”¹å£å°±...ï¼Œæ‰€ä»¥åªå¥½å…ˆç ”ç©¶flaggeräº†ã€‚æ¸›å°‘é–‹ç™¼äººå“¡ä½ˆç½²çš„know howï¼Œ&lt;br /&gt;
åªè¦git tag ï¼Œç„¶å¾Œã€ç­‰ã€  å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;ç°¡æ˜“æµç¨‹ä»‹ç´¹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç›®å‰æ­£åœ¨åŸ·è¡Œçš„deploy ç‚ºabc-primary ï¼Œç•¶æœ‰æ–°çš„deploy ä½ˆç½²åœ¨ abc æ™‚ï¼Œflaggerå•Ÿå‹•ï¼Œ&lt;br /&gt;
å…ˆå°‡æµé‡å¾ abc-primary è½‰åˆ° abc ï¼Œå› ç‚ºabc ç‚ºæ–°ç‰ˆæœ¬ã€‚&lt;br /&gt;
ç•¶æµé‡å…¨éƒ¨è½‰åˆ°abcå¾Œï¼Œå°‡ abc-primary åˆªé™¤ï¼Œä¸¦ä½ˆç½²æˆæ–°çš„ç‰ˆæœ¬ã€‚&lt;br /&gt;
ç•¶abc-primaryä½ˆç½²å®Œå¾Œï¼Œå†å°‡ æµé‡å¾ abc è½‰å› abc-primaryï¼Œ&lt;br /&gt;
ç­‰å¾…å…¨éƒ¨æµé‡è½‰å›ä¾†å¾Œï¼Œå†å°‡abcçš„deployåˆªé™¤ã€‚&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å…ˆå®‰è£flagger&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;  kustomize build https://github.com/fluxcd/flagger/kustomize/istio?ref=main | kubectl apply -f -
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://docs.flagger.app/install/flagger-install-on-kubernetes&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Flagger Install on Kubernetes&lt;/a&gt;&lt;br /&gt;
3. ä½ˆç½²è² è¼‰æ¸¬è©¦æœå‹™ flagger-loadtester&lt;br /&gt;
å¦‚æœnamespaceè¦å…ˆå»ºç«‹test ï¼Œå¦‚æœä¸æƒ³ä½¿ç”¨é€™å€‹åç¨±ï¼Œè«‹ä¸‹è¼‰yamlæª”å¾Œä¿®æ”¹ kustomization.yaml çš„namespace&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/fluxcd/flagger/tree/main/kustomize/tester&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;flagger-loadtester&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  kubectl apply -k https://github.com/fluxcd/flagger//kustomize/tester?ref=main
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™è£é¢ä¸»è¦æ˜¯ä½¿ç”¨&lt;a href=&quot;https://github.com/rakyll/hey&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;hey&lt;/a&gt; ä½œçˆ²é€£ç·šæ¸¬è©¦çš„å·¥å…·ï¼Œ&lt;br /&gt;
åœ¨å¾Œé¢çš„webhookæœƒç”¨åˆ°æ­¤æœå‹™ã€‚&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;è¨­å®šCanary&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ­¤ç¯„ä¾‹ç‚ºABä½ˆç½²ï¼Œå¦æœ‰é‡‘çµ²é›€ä½ˆç½²ï¼Œè«‹åƒè€ƒ&lt;br /&gt;
spec åº•ä¸‹çš„åƒæ•¸ï¼Œ&lt;br /&gt;
- &lt;a href=&quot;http://targetref.name/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;targetRef.name&lt;/a&gt; æ˜¯ deployæœƒæˆªå–ç¾æœ‰çš„deployè¨­å®šï¼Œç¢ºèªåç¨±èˆ‡ç¾æœ‰çš„deployåç¨±ä¸€æ¨£&lt;br /&gt;
- &lt;a href=&quot;http://autoscalerref.name/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;autoscalerRef.name&lt;/a&gt; æ˜¯ HPAæœƒæˆªå–ç¾æœ‰çš„HPAè¨­å®šï¼Œç¢ºèªåç¨±èˆ‡ç¾æœ‰çš„HPAåç¨±ä¸€æ¨£ã€‚&lt;br /&gt;
- service.nameæ˜¯ serviceæœƒæˆªå–ç¾æœ‰çš„serviceè¨­å®šï¼Œç¢ºèªåç¨±èˆ‡ç¾æœ‰çš„serviceåç¨±ä¸€æ¨£ã€‚&lt;br /&gt;
- service.host éœ€æŒ‡å®šç›®å‰æœå‹™çš„domainï¼Œå¦‚æœç‚ºipåªèƒ½æœ‰ä¸€çµ„&lt;br /&gt;
- webhooks.metadata.cmd ï¼Œç¶²å€å¿…é ˆæ›´æ”¹æˆæœå‹™èƒ½å¤ è¨ªå•çš„ç¶²å€ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: flagger.app/v1beta1
kind: Canary
metadata:
name: video
namespace: sex-system
spec:
provider: istio
targetRef:
apiVersion: apps/v1
kind: Deployment
name: video-api
autoscalerRef:
apiVersion: autoscaling/v1
kind: HorizontalPodAutoscaler
name: video-api

service:
name: video-api
port: 80
targetPort: 80
portName: http
portDiscovery: true
gateways:
  - istio-gateway-external.istio-system.svc.cluster.local
  - istio-gateway-internal.istio-system.svc.cluster.local
  - mesh
hosts:
  - 123.123.123.123
trafficPolicy:
  tls:
    mode: DISABLE
match:
  - uri:
      prefix: /
rewrite:
  uri: /
timeout: 30s
analysis:
# analysis spend time  : interval * iterations
# æ™‚é–“é–“éš” (é»˜èª 60s)
interval: 30s
# å›æ»¾å‰çš„æœ€å¤§å¤±æ•—æŒ‡æ¨™æª¢æŸ¥æ¬¡æ•¸(å¯èƒ½å› ç‚ºæª¢æŸ¥æ™‚é–“å·®çš„é—œä¿‚ï¼Œè‡³å°‘æœƒæœ‰å…©æ¬¡å¤±æ•—)
threshold: 5
iterations: 1
metrics:
  - name: request-success-rate
    thresholdRange:
      min: 99
    interval: 1m
  - name: request-duration
    thresholdRange:
      max: 500
    interval: 30s
webhooks:
  - name: load-test-get
    type: pre-rollout
    url: http://flagger-loadtester.tools/
    timeout: 15s
    metadata:
      type: cmd
      cmd: &amp;quot;hey -z 1m -q 10 -c 2 http://video-api-canary.test/api/v1/Health/health&amp;quot;
  - name: &amp;quot;notify&amp;quot;
    type: event
    url: http://webhook-api.tools/webhook/flagger
    timeout: 5s
    metadata:
      channel: &amp;quot;-1023450&amp;quot;  
  - name: load-test
    type: rollout
    url: http://flagger-loadtester.tools/
    timeout: 5s
    metadata:
      type: cmd
      cmd: &amp;quot;hey -z 1m -q 10  http://video-api-canary.test/api/v1/Health/health&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯«å¥½canaryï¼Œç„¶å¾Œç›´æ¥ä½ˆç½²ã€‚&lt;br /&gt;
æ­¤æ™‚ï¼Œk8sæœƒæ ¹æ“šä½ çš„è¨­å®šï¼Œå»ºç«‹èµ· ä¸€äº›ç›¸é—œçš„serviceä»¥åŠ deployment ï¼Œ&lt;br /&gt;
ä¾‹å¦‚ï¼Œæœ¬ä¾†çš„deploymentã€serviceä»¥åŠ hpaçš„ åç¨±å« abc ï¼Œ&lt;br /&gt;
é‚£åŒæ™‚æœƒå»ºç«‹ abc-primary çš„deployment è·Ÿ hpaï¼Œ&lt;br /&gt;
ä»¥åŠ abc-canary ã€ abc-primary çš„ service  ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œå†istioä¸Šé¢ä¹Ÿæœƒè‡ªå‹•å»ºç«‹ VirtualService è·Ÿ DestinationRule&lt;br /&gt;
æ‰€ä»¥Canaryå¾ˆé‡è¦ã€å¾ˆé‡è¦ã€å¾ˆé‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://github.com/fluxcd/flagger/blob/main/artifacts/examples/istio-canary.yaml&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;flagger/artifacts/examples/istio-canary.yaml&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://docs.flagger.app/tutorials/istio-progressive-delivery#bootstrap&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istio Canary Deployments&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://docs.flagger.app/tutorials/istio-ab-testing#bootstrap&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istio A/B Testing&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;å¼•å…¥ grafana&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å› ç‚ºistioæœ¬èº«å°±æœ‰grafanaäº†ï¼Œæ‰€ä»¥æˆ‘ä¸æƒ³é‡è¤‡å®‰è£ï¼Œ&lt;br /&gt;
åˆ°ä»–å€‘çš„&lt;a href=&quot;https://github.com/fluxcd/flagger/tree/main/charts/grafana/dashboards&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;git&lt;/a&gt;&lt;br /&gt;
å°‡jsonæª”ä¸‹è¼‰ä¸‹ä¾†ï¼Œ&lt;br /&gt;
åˆ°grafanaåŒ¯å…¥json(fig.1)ï¼Œ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/21.fig-1.jpg&quot; alt=&quot;21.fig-1.jpg&quot; /&gt;&lt;br /&gt;
æ­¤æ™‚æœƒç™¼ç”ŸéŒ¯èª¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Template variables could not be initialized: Datasource named prometheus was not found
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŸå› æ˜¯åŸæœ¬çš„jsonæª”è£¡é¢çš„datasourceæ˜¯ prometheus&lt;br /&gt;
è€Œç›®å‰å®‰è£çš„æ˜¯ Promethus ï¼Œå°‡æœ¬ä¾†çš„jsonæ›´æ”¹å¾Œå†åŒ¯å…¥ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://medium.com/expedia-group-tech/flagger-monitor-your-canary-deployments-with-grafana-21b9dd58b10e&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Flagger - Monitor Your Canary Deployments with Grafana&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;ä½ˆç½²å¤±æ•—ï¼Œé‡æ–°ä½ˆç½²æ–¹å¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è—ç¶ ä½ˆç½²æˆ–é‡‘çµ²é›€ä½ˆç½²ä¸Šé¢æœ‰æåˆ°ï¼Œæœƒè‡ªå‹•æ–°å¢ä¸€å€‹deploymentï¼Œå†åŸæœ‰çš„åç¨±ä¸Šé¢åŠ ä¸Š-primaryï¼Œ&lt;br /&gt;
ç„¶å¾ŒåŸæœ‰çš„deploymenté‚„æœƒå­˜åœ¨ï¼Œä½†ä»–çš„podæœƒæ¸…é™¤ã€‚&lt;br /&gt;
ç•¶æœ‰æ–°çš„imageæ™‚ï¼Œæœƒè§¸ç™¼å‹•ä½œï¼Œåœ¨åŸæœ‰çš„deploymentä¸Šå°‡podç”¢ç”Ÿå‡ºä¾†ï¼Œ&lt;br /&gt;
ç„¶å¾Œé–‹å§‹åšæµé‡çš„å°è½‰ï¼Œä¸¦ç™¼ä½ˆæ–°ç‰ˆæœ¬ã€‚&lt;br /&gt;
ä½†åœ¨æ¸¬è©¦çš„æ™‚å€™ï¼Œå¦‚æœcanaryå¯«éŒ¯äº†ï¼Œæœƒå°è‡´ç™¼ä½ˆå¤±æ•—ã€‚&lt;br /&gt;
æ­¤æ™‚ä¿®æ”¹å®Œï¼Œé‡æ–°apply ï¼Œä¹Ÿæœƒå¡åœ¨Failçš„ç‹€æ…‹ï¼Œ&lt;br /&gt;
éœ€åˆ° åŸæœ¬çš„deployment å¢åŠ  ä¸‹é¢çš„ç¨‹å¼ï¼Œ&lt;br /&gt;
è®“canaryé‡æ–°è§¸ç™¼ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: apps/v1
kind: Deployment
spec:
  template:
    metadata:
      annotations:
        timestamp: &amp;quot;2020-03-10T14:24:48+0000&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://docs.flagger.app/faq#how-to-retry-a-failed-release&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How to retry a failed release&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;7&quot;&gt;
&lt;li&gt;ä½ˆç½²å¤±æ•—åŸå› &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç›®å‰æ¸¬è©¦ï¼Œ~æ¯æ¬¡ä¸€å®šæœƒè·³é€™å€‹å‡ºä¾†~ ï¼Œå·²è§£æ±ºã€‚å·®åˆ¥åªåœ¨æ¬¡æ•¸&lt;br /&gt;
Halt advancement no values found for istio metric request-success-rate probably video-api.sex-system is not receiving traffic: running query failed: no values found&lt;/p&gt;
&lt;p&gt;ç”¨curlæ‰“ ä¸æœƒç”¢ç”Ÿæ­¤éŒ¯èª¤ï¼Œ&lt;br /&gt;
interval æ™‚é–“å£“åœ¨30s ï¼Œæ­¤éŒ¯èª¤åªæœƒç™¼ç”Ÿ1æ¬¡&lt;br /&gt;
interval æ™‚é–“å£“åœ¨20s ï¼Œæ­¤éŒ¯èª¤æœƒç™¼ç”Ÿ2æ¬¡&lt;br /&gt;
thresholdï¼šå›æ»¾æœ€å¤§éŒ¯èª¤ç™¼ç”Ÿæ¬¡æ•¸ï¼Œè¨­æˆ5ï¼Œåªè¦å°æ–¼éŒ¯èª¤ç™¼ç”Ÿçš„æ¬¡æ•¸ï¼Œé‚„æ˜¯å¯ä»¥æˆåŠŸè‡ªå‹•ä½ˆç½²&lt;/p&gt;
&lt;p&gt;æœ‰æŸ¥åˆ°æœƒç™¼ç”Ÿé€™å€‹éŒ¯èª¤çš„åŸå› ï¼Œå¦‚æœåœ¨æµé‡å°è½‰æœŸé–“æ²’æœ‰æ”¶åˆ°æµé‡çš„è©±å°±æœƒç™¼ç”Ÿæ­¤éŒ¯èª¤ã€‚&lt;br /&gt;
æ‰€ä»¥è¦è§£æ±ºé€™å€‹éŒ¯èª¤ï¼Œè¦å† pre-rollout çš„æ™‚å€™ï¼Œå…ˆé€ä¸€äº›é€£ç·šéå»ã€‚&lt;br /&gt;
é€™æ¨£å°±ä¸æœƒæœ‰æ­¤éŒ¯èª¤ç™¼ç”Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://docs.flagger.app/usage/webhooks#load-testing&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Load Testing&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;8&quot;&gt;
&lt;li&gt;ç›£æ§æ–¹å¼&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥è©¢flaggerä½ˆç½²ç‹€æ…‹ï¼Œéœ€é¡å¤–å®‰è£&lt;a href=&quot;https://stedolan.github.io/jq/manual/#Basicfilters&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;jq&lt;/a&gt;ï¼ˆè§£æjsonçš„è»Ÿé«”)&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;    watch &amp;quot;kubectl -n istio-system logs deployment/flagger --tail=10 | jq &#39;.ts,.msg&#39;&amp;quot;
    æˆ–
    kubectl -n test describe canary/video-api | tail -20f
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;çœ‹æµé‡æ¯”é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;    watch kubectl get canaries -A
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;9&quot;&gt;
&lt;li&gt;webhookä¸»å‹•é€šçŸ¥&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åœ¨flaggerè£¡é¢ï¼Œæœ‰å¯¦ä½œwebhookï¼Œå¯ä»¥å°‡äº‹ä»¶çš„ç‹€æ…‹é€šçŸ¥çµ¦éœ€è¦çš„äººã€‚&lt;br /&gt;
å…§å»ºæœ‰ slack ã€discord ï¼Œ é€™æ®µæˆ‘æ²’å¯¦ä½œ ï¼Œçœ‹èµ·ä¾†åªè¦åŠ åƒæ•¸å³å¯ï¼Œ&lt;br /&gt;
è«‹åƒè€ƒ &lt;a href=&quot;https://docs.flagger.app/usage/alerting&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Alerting&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½†å› ç‚ºå…¬å¸æ”¿ç­–ï¼Œæˆ‘ä¸èƒ½ç”¨slackæ‰€ä»¥åªå¥½è‡ªå·±åštelegramäº†ï¼Œ&lt;br /&gt;
telegramåšæ©Ÿå™¨äººé‚„æŒºå¿«çš„ï¼Œæ”¹å¤©å†å¯«ä¸€ç¯‡é—œæ–¼telegramçš„ä½¿ç”¨æ–¹å¼ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;webhooks:
- name: &amp;quot;notify&amp;quot;
  type: event
  url: http://webhook-api-v2.test/webhook/flagger
  timeout: 5s
  metadata:
    some: &amp;quot;some message&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨canaryä¸Šé¢åŠ å…¥ä¸Šé¢çš„ç¨‹å¼ç¢¼ï¼Œç„¶å¾Œç•¶æœ‰äº‹ä»¶è§¸ç™¼æ™‚ï¼Œ&lt;br /&gt;
æœƒå›å‚³ä¸‹é¢çš„jsonæ ¼å¼ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ webhook-api-v2.test æ˜¯ä¸€å€‹æˆ‘è‡ªå·±å»ºç«‹åœ¨ namespce ï¼štest ï¼Œdeploymentï¼šwebhook-api-v2 çš„api&lt;/p&gt;
&lt;p&gt;webhookå…¶å¯¦å°±æ˜¯è‡ªå·±å»ºç«‹ä¸€å€‹apiçš„æ¥æ”¶æ©Ÿåˆ¶ï¼Œç•¶serverç«¯æœ‰è³‡æ–™æ™‚ï¼Œ&lt;br /&gt;
æœƒæ ¹æ“šä¸Šé¢çš„urlé€å‡ºjsonçµ¦ä½ ï¼Œæ­¤æ™‚è¦æ€éº¼åˆ©ç”¨ï¼Œå°±çœ‹å„è‡ªçš„éœ€æ±‚äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{
   &amp;quot;name&amp;quot;:&amp;quot;video&amp;quot;,
   &amp;quot;namespace&amp;quot;:&amp;quot;test&amp;quot;,
   &amp;quot;phase&amp;quot;:&amp;quot;Failed&amp;quot;,
   &amp;quot;metadata&amp;quot;:{
      &amp;quot;eventMessage&amp;quot;:&amp;quot;Canary failed! Scaling down abc.test&amp;quot;,
      &amp;quot;eventType&amp;quot;:&amp;quot;Warning&amp;quot;,
      &amp;quot;some&amp;quot;:&amp;quot;some message&amp;quot;,
      &amp;quot;timestamp&amp;quot;:&amp;quot;1616654792750&amp;quot;
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://studygolang.com/articles/15056&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;webhook æ˜¯ä»€éº¼ä»¥åŠå¦‚ä½•å‰µå»º&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://medium.com/@justinlee_78563/line-bot-%E7%B3%BB%E5%88%97%E6%96%87-%E4%BB%80%E9%BA%BC%E6%98%AF-webhook-d0ab0bb192be&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;LINE Bot ç³»åˆ—æ–‡ â€” ä»€éº¼æ˜¯ Webhook?&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h2&gt;
&lt;p&gt;æœ‰æ™‚æ–‡ç« æ¸¬è©¦æœ‰å•é¡Œçš„è©±ï¼Œå»ºè­°åˆ°ä»–å€‘çš„&lt;a href=&quot;https://github.com/fluxcd/flagger/tree/main/artifacts&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;git&lt;/a&gt;&lt;br /&gt;
æ‰¾ç›¸é—œçš„ç¯„ä¾‹ï¼Œåšæ¸¬è©¦ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://www.servicemesher.com/blog/automated-canary-deployments-with-flagger-and-istio/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åŸºæ–¼Flaggerå’ŒIstioå¯¦ç¾è‡ªå‹•åŒ–é‡‘çµ²é›€éƒ¨ç½²&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://wiki.shileizcc.com/confluence/pages/viewpage.action?pageId=84967496#Istio%E5%AE%9E%E8%B7%B5-%E8%87%AA%E5%8A%A8%E5%8C%96%E7%81%B0%E5%BA%A6%E5%8F%91%E5%B8%83&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istio å¯¦è¸&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://blog.51cto.com/zero01/2572820&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Service Mesh - Istioå¯¦æˆ°ç¯‡ï¼ˆä¸Šï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://medium.com/google-cloud/automated-canary-deployments-with-flagger-and-istio-ac747827f9d1&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Automated canary deployments with Flagger and Istio&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.niewx.cn/istio/2020/12/10/istio%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97%E4%B9%8B%E8%87%AA%E5%8A%A8%E5%8C%96%E7%81%B0%E5%BA%A6%E5%8F%91%E5%B8%83/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;istioå…¥é–€ç³»åˆ—ä¹‹è‡ªå‹•åŒ–ç°åº¦ç™¼ä½ˆ&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/21. flagger è‡ªå‹•é‡‘çµ²é›€ä½ˆç½² for istio/" />
        </entry>
        <entry>
            <title>
                20. è¨ªå•istio å…§éƒ¨è² è¼‰å¹³è¡¡ip
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/20. è¨ªå•istio å…§éƒ¨è² è¼‰å¹³è¡¡ip/</id>
            <content type="html">
                &lt;h2 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h2&gt;
&lt;h2 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h2&gt;
&lt;p&gt;è¦æŒ‡å®šå…§éƒ¨è² è¼‰å¹³è¡¡IPçš„è©±ï¼Œä¸€èˆ¬åœ¨svcä¸Šé¢æ˜¯åªè¦æŒ‡å®š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;metadata:
  annotations:
    cloud.google.com/load-balancer-type: &amp;quot;Internal&amp;quot;
spec:
    type: LoadBalancer    
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æ¨£åœ¨GKEä¸Šé¢å°±æœƒæŒ‡å®šæˆå…§éƒ¨è² è¼‰å¹³è¡¡ã€‚&lt;br /&gt;
ä½†åœ¨istioä¸Šé¢è¦æŒ‡å®šçš„è©±ï¼Œéœ€åœ¨k8såº•ä¸‹æ–°å¢ serviceAnnotations&lt;br /&gt;
åƒä¸‹é¢é€™æ¨£ï¼ˆé€™æ˜¯GKEçš„å¯«æ³•ï¼Œå…¶ä»–é›²ç«¯æ©Ÿå™¨è¨­å®šçš„æ–¹å¼æœƒä¸ä¸€æ¨£ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;k8s:
  serviceAnnotations:
    cloud.google.com/load-balancer-type: &amp;quot;Internal&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…¶ä»–çš„åƒæ•¸è«‹åƒè€ƒ istioå®‰è£åŠä½¿ç”¨ =&amp;gt; åŒä¸€å€‹å¢é›†å®‰è£å¤šå€‹ingressgateway&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/20.fig-1.jpg&quot; alt=&quot;20.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://medium.com/faun/setup-multiple-ingress-gateways-in-istio-52ad0dc7f99d&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Setup Multiple Ingress Gateways in Istio&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/61963659/how-can-i-add-service-annotation-in-istio-operator-patch&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How can I add service annotation in istio operator patch&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;virtual-service&quot; tabindex=&quot;-1&quot;&gt;VirtualServiceçš„å¯«æ³•&lt;/h3&gt;
&lt;p&gt;Gatewayçš„å¯«æ³•èˆ‡ä¹‹å‰çš„ä¸€è‡´ï¼Œ&lt;br /&gt;
æ¯”è¼ƒæœ‰å·®ç•°çš„æ˜¯VSçš„å¯«æ³•&lt;/p&gt;
&lt;p&gt;hosts éœ€è¨­å®šå…§éƒ¨ipï¼Œä¸èƒ½ä½¿ç”¨ &amp;quot;*&amp;quot;&lt;br /&gt;
gateways  éœ€å¢åŠ meshï¼Œè¡¨ç¤ºè·¯ç”±æ˜¯å¾ç¶²æ ¼å…§çš„æµé‡ä¾†çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸åœ¨gatewaysä¸Šé¢ï¼Œå¯«meshï¼Œæœƒç™¼ç”Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;503 upstream connect error or disconnect/reset before headers. reset reason local reset istio
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çš„éŒ¯èª¤ã€‚&lt;br /&gt;
æœƒç™¼ç¾é€™å€‹éŒ¯èª¤ï¼Œæ˜¯å› ç‚ºçœ‹äº†&lt;a href=&quot;https://kknews.cc/zh-tw/code/ja4r3ee.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istioå¯¦è¸é¿å‘æŒ‡å—ï¼š10 å¤§å¸¸è¦‹ç•°å¸¸ã€æœ€ä½³å¯¦è¸åŠè§£æ±ºæ–¹æ¡ˆ&lt;/a&gt;æ¸…æ¥šç¶²æ ¼å…§ï¼Œèˆ‡ç¶²æ ¼é‚Šç·£çš„å·®ç•°ï¼Œæ‰çŸ¥é“å¢åŠ æ­¤è¨­å®šã€‚&lt;/p&gt;
&lt;p&gt;æœ€å¾Œyamlå¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: vs-internal
  namespace: default
spec:
  hosts:
    - 10.4.0.37
  gateways:
    - mesh
    - istio-ingressgateway-internal.default.svc.cluster.local
  http:
    - corsPolicy:
        allowOrigin:
          - &#39;*&#39;
      match:
        - uri:
            exact: /api/v1/health
      name: route-v1
      route:
        - destination:
            host: abc.default.svc.cluster.local
            port:
              number: 80
          weight: 100
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://iter01.com/536043.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istio é‹ç¶­å¯¦æˆ°ç³»åˆ—ï¼ˆ3ï¼‰ï¼šè®“äººé ­å¤§çš„ã€ç„¡é ­æœå‹™ã€-ä¸‹&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.twblogs.net/a/5d3f73a9bd9eee51fbf92230?lang=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è¨˜ä¸€æ¬¡Istioé–“æ­‡503çš„å•é¡Œæ’æŸ¥&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/20. è¨ªå•istio å…§éƒ¨è² è¼‰å¹³è¡¡ip/" />
        </entry>
        <entry>
            <title>
                186. istioçš„Authorization policy(ç™½åå–®)
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/186. istioçš„Authorization policy(ç™½åå–®)/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ç¶“éä¸€å€‹æœˆçš„æ¬å®¶äº‹å®œï¼Œ&lt;br /&gt;
é€™ç¯‡æ‡‰è©²æ˜¯ç¬¬ä¸€ç¯‡ï¼Œä¹‹å¾Œé‚„æœ‰è¨±å¤šæ±è¥¿ï¼Œ&lt;br /&gt;
éƒ½æ˜¯é€™å€‹æœˆæ¬projectç¢°åˆ°çš„ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h4 id=&quot;ç›®çš„&quot; tabindex=&quot;-1&quot;&gt;ç›®çš„&lt;/h4&gt;
&lt;p&gt;åªè¦è¨­å®šç™½åå–®ï¼Œé™åˆ¶æŸäº›ipèƒ½é€²å…¥å°±å¥½ï¼Œ&lt;br /&gt;
å…¶ä»–ä¸ç”¨ã€‚&lt;/p&gt;
&lt;h4 id=&quot;network&quot; tabindex=&quot;-1&quot;&gt;å¯¦ä½œ-Network&lt;/h4&gt;
&lt;p&gt;é€™é‚Šä½¿ç”¨istio 1.20 ç‰ˆæœ¬ï¼Œé›–ç„¶gateway API å‰›å‡ºçˆï¼Œ&lt;br /&gt;
ä½†æˆ‘é‚„æ²’å»ç ”ç©¶ï¼Œæ‰€ä»¥ä¸‹é¢ç”¨çš„éƒ½é‚„æ˜¯ istio API&lt;/p&gt;
&lt;p&gt;é¦–å…ˆç¢ºèªä½ çš„LBé¡å‹ï¼Œ&lt;br /&gt;
ç›´é€£ï¼ˆNetwork)çš„è©±ï¼ŒåŸºæœ¬ä¸Šæ²’å¤ªå¤§å•é¡Œï¼Œç™½åå–®å¾ˆå¥½è¨­å®šã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é–‹å•“ &lt;code&gt;externalTrafficPolicy&amp;quot;:&amp;quot;Local&amp;quot;&lt;/code&gt;ï¼Œ&lt;br /&gt;
å…©ç¨®æ–¹æ³•&lt;/p&gt;
&lt;p&gt;a. æ‰‹å‹•æ”¹service&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;   kubectl patch svc istio-ingressgateway -n istio-system -p &#39;{&amp;quot;spec&amp;quot;:{&amp;quot;externalTrafficPolicy&amp;quot;:&amp;quot;Local&amp;quot;}}&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;b. åŠ åœ¨istioOperatorä¸Šé¢&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ingressGateways:
    - name: istio-ingressgateway    
      enabled: true
      k8s: 
        service:
          externalTrafficPolicy: Local
          loadBalancerSourceRanges:
              - 10.0.0.0/8
              - 172.16.0.0/12
              - 192.168.0.0/16
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Authorizationè¨­å®š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
  name: manage-ingress-policy
  namespace: istio-system
spec:
  selector:
    matchLabels:
      istio: ingressgateway
  action: ALLOW
  rules:
  - from:
    - source:
        ipBlocks:
          - &amp;quot;10.0.0.0/8&amp;quot;
          - &amp;quot;172.16.0.0/12&amp;quot;
          - &amp;quot;192.168.0.0/16&amp;quot;   
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆæ³¨æ„ï¼Œé€™é‚Šçš„Load Balancer TypeæŒ‡çš„æ˜¯Networkï¼Œæ²’é€éproxyçš„ï¼Œ&lt;br /&gt;
å¦‚æœæœ‰é–‹CDNï¼Œé‚£å°±æ˜¯istioèªªæ˜ä¸Šé¢çš„Load Balancer Type æ˜¯TCP Proxy)&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://istio.io/latest/docs/tasks/security/authorization/authz-ingress/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Ingress Access Control&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;proxy&quot; tabindex=&quot;-1&quot;&gt;å¯¦ä½œ-Proxy&lt;/h4&gt;
&lt;p&gt;é€™é‚Šçš„ç¶²è·¯èµ°æ³•æ˜¯ï¼Œæœ‰é€éCDNï¼Œæˆ–æ˜¯å…¶ä»–çš„prxoyä»£ç†é€£éä¾†çš„æœå‹™ã€‚&lt;br /&gt;
numTrustedProxies é€™å€‹çš„å€¼ï¼Œå–æ±ºæ–¼ä½ çš„èµ°æ³•éäº†å¹¾å±¤çš„proxyï¼Œ&lt;br /&gt;
æˆ‘åªæœ‰cdnè½‰å°åˆ°gkeä¸Šé¢çš„istio LB&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è¨­å®šæ–¹å¼&lt;/p&gt;
&lt;p&gt;a. åœ¨podä¸Šé¢æ–°å¢ anntations&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;  metadata:
    annotations:
      &amp;quot;proxy.istio.io/config&amp;quot;: &#39;{&amp;quot;gatewayTopology&amp;quot; : { &amp;quot;numTrustedProxies&amp;quot;: 1 } }&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;b. åœ¨istioOperatoræ–°å¢&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: install.istio.io/v1alpha1
kind: IstioOperator
spec:
  meshConfig:
    defaultConfig:
      gatewayTopology:
        numTrustedProxies: 1	
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Authorizationè¨­å®š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€™é‚Šæœ‰é»å‘ï¼Œæäº†ä¸€å¤©æ‰ææ¸…æ¥šã€‚&lt;br /&gt;
å¼·çƒˆå»ºè­°æŠŠistioçš„&lt;a href=&quot;https://istio.io/latest/docs/ops/configuration/traffic-management/network-topologies/#example-using-x-forwarded-for-capability-with-httpbin&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;httpbin&lt;/a&gt;è£èµ·ä¾†ï¼Œå¯¦éš›å»æ‰“ï¼Œ&lt;br /&gt;
ç„¶å¾Œä¸€é‚ŠæŸ¥çœ‹ingressgatewayçš„deploymentçš„logã€‚&lt;/p&gt;
&lt;p&gt;a. é™åˆ¶å…¨éƒ¨&lt;/p&gt;
&lt;p&gt;é€™æ˜¯ç¬¬ä¸€ç¨®æ–¹æ³•ï¼Œä½†é€™å€‹åªèƒ½é‡å°ã€å…¥å£ã€çš„ingressåšç™½åå–®é©—è­‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
 name: frontend-ingress-policy
 namespace: istio-system
spec:
 selector:
   matchLabels:
     app: ingressgateway-external
 action: ALLOW
 rules:
 - from:
   - source:
       remoteIpBlocks: 
         - &amp;quot;10.0.0.0/8&amp;quot;
         - &amp;quot;172.16.0.0/12&amp;quot;
         - &amp;quot;192.168.0.0/16&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;b. é‡å°å–®å€‹&lt;br /&gt;
å‡å¦‚æ²’æœ‰åœ¨å…¥å£çš„è©±ï¼Œç„¡æ³•ç…§ä¸Šé¢a.çš„æ–¹å¼æŠ“åˆ°è³‡æ–™ï¼Œ&lt;br /&gt;
æ‰€ä»¥åªèƒ½å¼·åˆ¶æŒ‡å®šåˆ¤æ–·headerã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://github.com/istio/istio/issues/30166&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Incorrect RemoteIP when Authorization Policy is applied to Injected Istio Proxy&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;écdnæ™‚ï¼Œåªèƒ½åˆ¤æ–·headerã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
  name: frontend-ingress-policy
spec:
  selector:
    matchLabels:
      group: frontend
  action: ALLOW
  rules:
    - when:
        - key: request.headers[X-Envoy-External-Address]
          values:
            - &amp;quot;10.*&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸éCDNï¼Œå‰‡å¯ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;      apiVersion: security.istio.io/v1
      kind: AuthorizationPolicy
      metadata:
        name: allowlist-frontend
      spec:
        selector:
          matchLabels:
            group: frontend
        action: ALLOW
        rules:
          - from:
            - source:
                remoteIpBlocks: 
                  - &amp;quot;59.127.129.63&amp;quot;
                  - &amp;quot;114.33.44.39&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://istio.io/latest/docs/ops/configuration/traffic-management/network-topologies/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Configuring Gateway Network Topology&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h4&gt;
&lt;h5 id=&quot;header&quot; tabindex=&quot;-1&quot;&gt;æŸ¥çœ‹è«‹æ±‚headerçš„æ–¹æ³•&lt;/h5&gt;
&lt;p&gt;å°‡domainç¶åœ¨vsä¸Šé¢ç›´æ¥å‘¼å«å³å¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
apiVersion: apps/v1
kind: Deployment
metadata:
  name: header-debugger
spec:
  replicas: 1
  selector:
    matchLabels:
      app: header-debugger
  template:
    metadata:
      labels:
        app: header-debugger
    spec:
      containers:
      - name: flask-server
        image: python:3.10-slim
        command: [&amp;quot;sh&amp;quot;, &amp;quot;-c&amp;quot;]
        args:
        - |
          pip install flask &amp;amp;&amp;amp; &#92;
          echo &#39;from flask import Flask, request
          app = Flask(__name__)
          @app.route(&amp;quot;/&amp;quot;)
          def index():
              return {k: v for k, v in request.headers.items()}
          app.run(host=&amp;quot;0.0.0.0&amp;quot;, port=8080)&#39; &amp;gt; app.py &amp;amp;&amp;amp; &#92;
          python app.py
        ports:
        - containerPort: 8080


---

apiVersion: v1
kind: Service
metadata:
  name: header-debugger
spec:
  selector:
    app: header-debugger
  ports:
  - port: 80
    targetPort: 8080

&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&quot;istio-operator-log&quot; tabindex=&quot;-1&quot;&gt;istioOperatorå¢åŠ log é–±è®€æ€§&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;spec:
  meshConfig:
    accessLogFile: /dev/stdout
    accessLogEncoding: JSON
    accessLogFormat: |
      {
        &amp;quot;protocol&amp;quot;: &amp;quot;%PROTOCOL%&amp;quot;,
        &amp;quot;upstream_service_time&amp;quot;: &amp;quot;%REQ(X-ENVOY-UPSTREAM_SERVICE_TIME)%&amp;quot;,
        &amp;quot;upstream_local_address&amp;quot;: &amp;quot;%UPSTREAM_LOCAL_ADDRESS%&amp;quot;,
        &amp;quot;duration&amp;quot;: &amp;quot;%DURATION%&amp;quot;,
        &amp;quot;upstream_transport_failure_reason&amp;quot;: &amp;quot;%UPSTREAM_TRANSPORT_FAILURE_REASON%&amp;quot;,
        &amp;quot;route_name&amp;quot;: &amp;quot;%ROUTE_NAME%&amp;quot;,
        &amp;quot;downstream_local_address&amp;quot;: &amp;quot;%DOWNSTREAM_LOCAL_ADDRESS%&amp;quot;,
        &amp;quot;user_agent&amp;quot;: &amp;quot;%REQ(USER-AGENT)%&amp;quot;,
        &amp;quot;response_code&amp;quot;: &amp;quot;%RESPONSE_CODE%&amp;quot;,
        &amp;quot;response_flags&amp;quot;: &amp;quot;%RESPONSE_FLAGS%&amp;quot;,
        &amp;quot;start_time&amp;quot;: &amp;quot;%START_TIME%&amp;quot;,
        &amp;quot;method&amp;quot;: &amp;quot;%REQ(:METHOD)%&amp;quot;,
        &amp;quot;request_id&amp;quot;: &amp;quot;%REQ(X-REQUEST-ID)%&amp;quot;,
        &amp;quot;upstream_host&amp;quot;: &amp;quot;%UPSTREAM_HOST%&amp;quot;,
        &amp;quot;x_forwarded_for&amp;quot;: &amp;quot;%REQ(X-FORWARDED-FOR)%&amp;quot;,
        &amp;quot;client_ip&amp;quot;: &amp;quot;%REQ(TRUE-Client-IP)%&amp;quot;,
        &amp;quot;requested_server_name&amp;quot;: &amp;quot;%REQUESTED_SERVER_NAME%&amp;quot;,
        &amp;quot;bytes_received&amp;quot;: &amp;quot;%BYTES_RECEIVED%&amp;quot;,
        &amp;quot;bytes_sent&amp;quot;: &amp;quot;%BYTES_SENT%&amp;quot;,
        &amp;quot;upstream_cluster&amp;quot;: &amp;quot;%UPSTREAM_CLUSTER%&amp;quot;,
        &amp;quot;downstream_remote_address&amp;quot;: &amp;quot;%DOWNSTREAM_REMOTE_ADDRESS%&amp;quot;,
        &amp;quot;authority&amp;quot;: &amp;quot;%REQ(:AUTHORITY)%&amp;quot;,
        &amp;quot;path&amp;quot;: &amp;quot;%REQ(X-ENVOY-ORIGINAL-PATH?:PATH)%&amp;quot;,
        &amp;quot;response_code_details&amp;quot;: &amp;quot;%RESPONSE_CODE_DETAILS%&amp;quot;
      }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://dev.to/aws-builders/understanding-istio-access-logs-2k5o&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Understanding Istio Access Logs&lt;/a&gt;&lt;/p&gt;
&lt;h5 id=&quot;authorization-policy&quot; tabindex=&quot;-1&quot;&gt;Authorization Policyè¦å‰‡&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;If there are any CUSTOM policies that match the request, evaluate and deny the request if the evaluation result is deny.
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœæœ‰ä»»ä½•ç¬¦åˆè«‹æ±‚çš„è‡ªè¨‚ç­–ç•¥ï¼Œå‰‡è©•ä¼°ä¸¦æ‹’çµ•è«‹æ±‚ï¼Œè‹¥è©•ä¼°çµæœç‚ºæ‹’çµ•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;If there are any DENY policies that match the request, deny the request.
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœæœ‰ç¬¦åˆè«‹æ±‚çš„ä»»ä½•æ‹’çµ•ç­–ç•¥ï¼Œå‰‡æ‹’çµ•è©²è«‹æ±‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;If there are no ALLOW policies for the workload, allow the request.
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœå·¥ä½œè² è¼‰æ²’æœ‰ä»»ä½•å…è¨±ç­–ç•¥ï¼Œå‰‡å…è¨±è©²è«‹æ±‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;If any of the ALLOW policies match the request, allow the request.
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœæœ‰ä»»ä½•å…è¨±ç­–ç•¥ç¬¦åˆè©²è«‹æ±‚ï¼Œå‰‡å…è¨±è©²è«‹æ±‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;Deny the request.
&lt;blockquote&gt;
&lt;p&gt;æ‹’çµ•è©²è«‹æ±‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://istio.io/latest/docs/reference/config/security/authorization-policy/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Authorization Policy&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;cloudflare&quot; tabindex=&quot;-1&quot;&gt;cloudflareè½‰ç™¼&lt;/h4&gt;
&lt;p&gt;ä¸Šé¢æœ‰æåˆ°ç”¨cloudflareçš„CDNæ™‚ï¼Œç™½åå–®æœƒè·Ÿç€è®Šï¼Œ&lt;br /&gt;
ä½†åœ¨é‚£ä¹‹å‰é‚„æœ‰å€‹æ±è¥¿è¦æ³¨æ„ï¼ŒCDNè½‰ç™¼æ™‚ï¼Œ&lt;br /&gt;
cloudflareå¯ä»¥æŒ‡å®šèµ°httpé‚„æ˜¯èµ°https&lt;br /&gt;
é€™å€‹æœƒå½±éŸ¿åˆ°istioçš„gatewayï¼Œæ˜¯é–‹80é‚„æ˜¯443ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/186-fig.1.jpg&quot; alt=&quot;186-fig.1.jpg&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/186. istioçš„Authorization policy(ç™½åå–®)/" />
        </entry>
        <entry>
            <title>
                18.istio Virtual Service è·¨namespaceè®€å– DestinationRule
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/18.istio Virtual Service è·¨namespaceè®€å– DestinationRule/</id>
            <content type="html">
                &lt;h2 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;å› ç‚ºåœ¨å¯« vsçš„match uriï¼Œæœ‰ç™¼ç”Ÿä¸€äº›å‘ï¼Œä½¿ç”¨äº†prefixå°è‡´å…¶ä»–çš„VSéƒ½å»æŠ“åˆ°å¦ä¸€å€‹VSçš„è·¯å¾‘ï¼Œ&lt;br /&gt;
æ–¼æ˜¯æƒ³è¦è®“æ‰€æœ‰çš„VSéƒ½ç”¨åŒä¸€å€‹VSï¼Œé¿å…æœªä¾†ç™¼ç”ŸåŒæ¨£çš„éŒ¯èª¤ï¼Œä¸å¥½æ‰¾åŸå› ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h2&gt;
&lt;p&gt;ç›®å‰çš„ç‹€æ³æ˜¯ Aæœå‹™åœ¨ A çš„namespaceä¸Šé¢ï¼Œ Bæœå‹™åœ¨ B çš„ namespaceä¸Šé¢ã€‚&lt;br /&gt;
æ­£å¸¸çš„æ–¹å¼ï¼Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/18.fig-1.jpg&quot; alt=&quot;18.fig-1.jpg&quot; /&gt;&lt;br /&gt;
VirtualService è·Ÿ DestinationRule éƒ½æœƒå„è‡ªåœ¨æ‰€å±¬æœå‹™ä¸Šé¢çš„ namespaceä¸Šé¢ã€‚&lt;br /&gt;
æ‰€ä»¥ï¼Œå¦‚æœæœ‰ ä¸‰å€‹æœå‹™ï¼Œå°±æœƒæœ‰ ä¸‰å€‹ VirtualService ï¼Œ&lt;br /&gt;
åŒæ™‚ match uriçš„prefixéƒ¨åˆ†ï¼Œä¹Ÿéƒ½å¯« /api /api2 /api3 çš„è©±ï¼Œå°±æœƒç™¼ç¾ï¼Œæœå‹™ä¸ç®¡æ€éº¼å‘¼å«éƒ½æ˜¯å‘¼å«åˆ°api&lt;br /&gt;
å…¶å¯¦é€™ä¹Ÿç®—æˆ‘ç™¼ç”Ÿçš„éŒ¯èª¤ï¼Œprefix æ˜¯åªé‡å°å‰é¢çš„å­—ä¸²ç¬¦åˆå°±éäº†ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://istio.io/latest/docs/reference/config/networking/virtual-service/#HTTPMatchRequest&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;HTTPMatchRequest&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½†é€™å€‹éŒ¯èª¤æœªä¾†ä¸çŸ¥é“æœ‰æ²’æœ‰è¾¦æ³•é¿å…ï¼Œæ˜¯ä¹Ÿèƒ½å¤ ä½¿ç”¨exact å®Œå…¨ç¬¦åˆçš„é—œéµå­—ä¾†é¿å…ä¸Šé¢çš„éŒ¯èª¤ç™¼ç”Ÿã€‚&lt;br /&gt;
ä½†æ­¤æ™‚æˆ‘å°±åœ¨æ€è€ƒï¼Œèƒ½ä¸èƒ½æœªä¾†éƒ½çµ±ä¸€ä½¿ç”¨ä¸€å€‹ VirtualService å°±å¥½ï¼Œ&lt;br /&gt;
é€™æ¨£ä¹Ÿæ–¹ä¾¿ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;éç¨‹ä¸­çš„è¡€æ·šï¼Œå°±ä¸ç´°èªªäº†ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰èƒ½åšåˆ°çš„æ˜¯ Aã€B å…±ç”¨ä¸€å€‹ VirtualServiceï¼Œæ­¤ VSåœ¨Açš„ namespaceä¸Šé¢ï¼Œ&lt;br /&gt;
ç„¶å¾Œ DestinationRule å‰‡åˆ†åˆ¥åœ¨Aã€B çš„namespaceä¸Šé¢å„æ¶è¨­ä¸€å€‹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœDRä¹Ÿæƒ³è¦å…±ç”¨çš„è©±ï¼Œæœƒç™¼ç”ŸéŒ¯èª¤ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  This subsetâ€™s labels are not found in any matching host
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;s&gt;æƒ³éä½¿ç”¨æŒ‡å®šçš„FQDNçš„labelï¼Œä¾†å¼·è¿«ä»–å»æŒ‡å®šçš„åœ°æ–¹æ‰¾deploymentï¼Œä½†å¤±æ•—äº†ã€‚&lt;br /&gt;
å¦‚æœæœ‰äººæœ‰çœ‹åˆ°æ–¹æ³•é‚„éº»ç…©å‘ŠçŸ¥ã€‚&lt;/s&gt;&lt;br /&gt;
å‰›åœ¨å¯«æ–‡ç« çš„æ™‚å€™ï¼Œæœ‰çœ‹åˆ°DR ä¹Ÿæœ‰exportTOçš„æŒ‡ä»¤ï¼Œ&lt;br /&gt;
æ‰€ä»¥æ‡‰è©²ä¹Ÿæ˜¯å¯ä»¥é€éexportTOçš„æ–¹æ³•ï¼Œä¾†å…±ç”¨åŒä¸€å€‹DRã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰çš„yamlå¯«æ³•å¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  exportTo:
    - &#39;*&#39;
  http:
    - match:
        - uri:
            prefix: /v2
      name: bale-api-v2
      rewrite:
        uri: /api
      route:
        - destination:
            host: bale-api.sex-system.svc.cluster.local
            port:
              number: 80
            subset: bale-api2
          weight: 80
        - destination:
            host: bale-api.sex-system.svc.cluster.local
            port:
              number: 80
            subset: bale-api
          weight: 20
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šåœ¨kialiæœƒçœ‹åˆ°è­¦å‘Š Subnet not found (Fig.1)ï¼Œä½†å¦‚æœç›´æ¥å¾Graphçœ‹æµé‡åˆ†ä½ˆçš„è©±ï¼Œæ˜¯æœ‰åœ¨åˆ†æµçš„ã€‚&lt;br /&gt;
é€™é‚Šè¦æ³¨æ„ï¼Œä¸€å®šè¦åŠ ä¸Š  exportTO ï¼Œå…è¨±è©²æœå‹™å¯ä»¥è·¨éé‚Šç•Œå»å°‹æ‰¾åˆ°DRã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;exportTO:
  - &#39;*&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://istio.io/latest/docs/reference/config/networking/virtual-service/#VirtualService&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;VirtualService&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://github.com/istio/istio/issues/15556&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Destination Rule is not applied to traffic from all namespaces it&#39;s exported to&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.cnblogs.com/charlieroro/p/13626429.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istio çš„é…ç½®åˆ†æ&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://blog.csdn.net/hxpjava1/article/details/108318645&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;VirtualServiceè³‡æºè©³è§£&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/18.istio Virtual Service è·¨namespaceè®€å– DestinationRule/" />
        </entry>
        <entry>
            <title>
                15.istioæœå‹™ç„¡æ³•è¨ªå•
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/15.istioæœå‹™ç„¡æ³•è¨ªå•/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä»Šå¤©ä¸Šç­å°±ç™¼ç¾é€™å€‹æƒ…æ³ï¼Œistioçš„æœå‹™ç„¡æ³•è¨ªå•ï¼Œä½†åŒä¸€å€‹å¢é›†çš„å¦ä¸€å€‹istioå»æ­£å¸¸ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;çœ‹äº‹ä»¶éŒ¯èª¤å¯«çš„æ˜¯&lt;br /&gt;
&lt;code&gt;Readiness probe failed: HTTP probe failed with statuscode: 503&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/15.fig-1.jpg&quot; alt=&quot;15.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;pod çš„ç‹€æ…‹æ˜¯running ï¼Œä½†istio-proxy å»æ˜¯ containers with unready status&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/15.fig-2.jpg&quot; alt=&quot;15.fig-2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ“šéŒ¯èª¤è¨Šæ¯éƒ½æ²’æ‰¾åˆ°ç›¸ç¬¦åˆçš„è³‡æ–™&lt;br /&gt;
ref.&lt;br /&gt;
&lt;a href=&quot;https://github.com/istio/istio/issues/23283&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Readiness probe failed: HTTP probe failed with statuscode: 503 &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#23283&quot;&gt;#23283&lt;/a&gt;&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç¾åœ¨çœ‹istio-proxyçš„æ—¥èªŒï¼Œä¸Šé¢å¯«çš„æ˜¯&lt;br /&gt;
Envoy proxy is NOT ready: config not received from Pilot (is Pilot running?)&lt;br /&gt;
é€™å€‹ä¼¼ä¹æ˜¯åŸå› ..&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æŸ¥çœ‹ç¶²æ ¼çš„ç‹€æ³&lt;br /&gt;
istioctl proxy-status&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/15.fig-3.jpg&quot; alt=&quot;15.fig-3.jpg&quot; /&gt;&lt;br /&gt;
æ‰€å±¬çš„ç¶²æ ¼LDSå¯« Never Ackonwledged&lt;br /&gt;
å„æ¬„ä½çš„æ„æ€å¦‚ä¸‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;LDSï¼ŒListener ç™¼ç¾æœå‹™ï¼šListener ç›£è½å™¨æ§åˆ¶ sidecar å•Ÿå‹•ç«¯å£ç›£è½ï¼ˆç›®å‰åªæ”¯æŒ TCP å”è­°ï¼‰ï¼Œä¸¦é…ç½® L3/L4 å±¤éæ¿¾å™¨ï¼Œç•¶ç¶²çµ¡é€£æ¥é”åˆ°å¾Œï¼Œé…ç½®å¥½çš„ç¶²çµ¡éæ¿¾å™¨å †æ£§é–‹å§‹è™•ç†å¾ŒçºŒäº‹ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;RDSï¼ŒRouter ç™¼ç¾æœå‹™ï¼šç”¨æ–¼ HTTP é€£æ¥ç®¡ç†éæ¿¾å™¨å‹•æ…‹ç²å–è·¯ç”±é…ç½®ï¼Œè·¯ç”±é…ç½®åŒ…å« HTTP é ­éƒ¨ä¿®æ”¹ï¼ˆå¢åŠ ã€åˆªé™¤  HTTP é ­éƒ¨éµå€¼ï¼‰ï¼Œvirtual hosts ï¼ˆè™›æ“¬ä¸»æ©Ÿï¼‰ï¼Œä»¥åŠ virtual hosts å®šç¾©çš„å„å€‹è·¯ç”±æ¢ç›®ã€‚&lt;/li&gt;
&lt;li&gt;CDSï¼ŒCluster ç™¼ç¾æœå‹™ï¼šç”¨æ–¼å‹•æ…‹ç²å– Cluster ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;EDSï¼ŒEndpoint ç™¼ç¾æœå‹™ï¼šç”¨æ–¼å‹•æ…‹ç¶­è­·ç«¯é»ä¿¡æ¯ï¼Œç«¯é»ä¿¡æ¯ä¸­é‚„åŒ…æ‹¬è² è¼‰å‡è¡¡æ¬Šé‡ã€é‡‘çµ²é›€ç‹€æ…‹ç­‰ï¼ŒåŸºæ–¼é€™äº›ä¿¡æ¯ï¼Œsidecar å¯ä»¥åšå‡ºæ™ºèƒ½çš„è² è¼‰å‡è¡¡æ±ºç­–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.servicemesher.com/istio-handbook/concepts/pilot.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Pilot&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;æŸ¥çœ‹podéŒ¯èª¤&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;Envoy proxy is NOT ready: config not received from Pilot (is Pilot running?): cds updates: 1 successful, 0 rejected; lds updates: 0 successful, 1 rejected
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä¸€ç›´ä»¥çˆ²é—œéµå­—æ˜¯æŸ¥å‰é¢çš„config not received from Pilot(is Pilot running?)&lt;br /&gt;
ä½†å¾Œä¾†é–‹äº†å·¥å–®æ‰¾äº†Googleå·¥ç¨‹å¸«ï¼Œä»–èªªé‡é»æ˜¯å¾Œé¢é‚£å¥  lds updates: 0 successful, 1 rejected&lt;/p&gt;
&lt;p&gt;ç„¶å¾ŒæŸ¥çœ‹ istiod logï¼Œå¯ä»¥çœ‹åˆ°ldsç‚ºä»€éº¼æœƒrejected&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;warn	ads	ADS:LDS: ACK ERROR router~10.131.1.19~istio-ingressgateway-794bbdb877-np94z.istio-system~istio-system.svc.cluster.local-994 Internal:Error adding/updating listener(s) 0.0.0.0_8443: Invalid path: /etc/istio/ingressgateway-certs/tls.crt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æ®µåœ¨podå‰›é–‹å§‹å»ºç«‹æ™‚ä¹Ÿæœ‰å‡ºç¾æ­¤éŒ¯èª¤ï¼Œçœ‹èµ·ä¾†æ˜¯httpsçš„æ†‘è­‰æœ‰å•é¡Œï¼Œ&lt;br /&gt;
æœ¬ä¾†ä½ˆç½²gatewayçš„yamlæª”åƒé€™æ¨£&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  apiVersion: networking.istio.io/v1beta1
kind: Gateway
metadata:
  name: istio-ingressgateway-video
  namespace: sex-system
spec:
  selector:
    istio: ingressgateway   # ä½¿ç”¨é»˜èªçš„æ§åˆ¶å™¨
  servers:
  - port: &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#åŠ å¯†å‚³è¼¸&quot;&gt;#åŠ å¯†å‚³è¼¸&lt;/a&gt;
      number: 443
      name: http
      protocol: HTTPS
    tls:
      mode: SIMPLE
      serverCertificate: /etc/istio/ingressgateway-certs/tls.crt &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è¨­å®šæ†‘è­‰è·¯å¾‘&quot;&gt;#è¨­å®šæ†‘è­‰è·¯å¾‘&lt;/a&gt;
      privateKey: /etc/istio/ingressgateway-certs/tls.key  &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è¨­å®šæ†‘è­‰è·¯å¾‘&quot;&gt;#è¨­å®šæ†‘è­‰è·¯å¾‘&lt;/a&gt;
    hosts:
      - &amp;quot;*&amp;quot; &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è©²æœå‹™å°æ‡‰domain&quot;&gt;#è©²æœå‹™å°æ‡‰domain&lt;/a&gt;
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
     - &amp;quot;*&amp;quot; &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è©²æœå‹™å°æ‡‰domain&quot;&gt;#è©²æœå‹™å°æ‡‰domain&lt;/a&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ†‘è­‰è·¯å¾‘æ˜¯ç›´æ¥æŒ‡å‘podè£¡é¢çš„è·¯å¾‘ï¼Œ&lt;br /&gt;
ä½†&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;googleå·¥ç¨‹å¸«èªª istio v1.6é–‹å§‹gatewayçš„tlså·²ç»ä¸æ”¯æ´file mountç±»çš„è®¾ç½®äº†(i.e. &lt;code&gt;privateKey&lt;/code&gt;, &lt;code&gt;serverCertificate&lt;/code&gt;). ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œè¦éº»è‡ªå·±å»ºç«‹ httpsçš„æ†‘è­‰ ï¼Œæˆ–è€…æ˜¯ä¹¾è„†ä¸è¦httpsã€‚&lt;br /&gt;
ï¼ˆref. &lt;a href=&quot;https://istio.io/v1.8/docs/tasks/traffic-management/ingress/secure-ingress/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Secure Gateways&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;è‡ªå·±å»ºç«‹æ†‘è­‰çš„è©±ï¼Œ&lt;br /&gt;
æ ¹æ“šä¸Šé¢çš„ç¶²å€ï¼Œç”¢ç”Ÿ crt è·Ÿ key ï¼Œç„¶å¾Œä½¿ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl create secret tls credential-httpbin -n istio-system --cert=./httpbin.com.crt --key=./httpbin.com.key
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å»ºç«‹sercretï¼Œæœ€å¾Œå†yamlå…§ç›´æ¥ä½¿ç”¨é€™å€‹sercretçš„name&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: networking.istio.io/v1beta1
kind: Gateway
metadata:
  name: istio-ingressgateway-custom
  namespace: rd7-video
spec:
  selector:
    istio: ingressgateway-private   # ä½¿ç”¨é»˜èªçš„æ§åˆ¶å™¨
  servers:
  - hosts:
      - httpbin.com
    port:
      name: httpbin
      number: 443
      protocol: HTTPS
    tls:
      credentialName: credential-httpbin
      mode: SIMPLE
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
     - &amp;quot;*&amp;quot; &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#è©²æœå‹™å°æ‡‰domain&quot;&gt;#è©²æœå‹™å°æ‡‰domain&lt;/a&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç›®å‰çœ‹èµ·ä¾†æ˜¯æœ‰ç›´æ¥è§£æ‰é€™å€‹å•é¡Œï¼Œ&lt;br /&gt;
å‰›å‰›æ›æ‰çš„podï¼Œæœ‰è®Šå›æ­£å¸¸çš„ç‹€æ…‹ã€‚&lt;br /&gt;
ä½†ç•¶åˆå…©å€‹podï¼Œä¸€å€‹æ´»ç€ï¼Œå¦ä¸€å€‹é™£äº¡ï¼Œé‚„ä¸çŸ¥é“çˆ²ä½•æœƒé€™æ¨£ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/15.istioæœå‹™ç„¡æ³•è¨ªå•/" />
        </entry>
        <entry>
            <title>
                14.istioå®‰è£æ™‚å›ºå®šip
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/14.istioå®‰è£æ™‚å›ºå®šip/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å¦‚æœåˆªé™¤GKEçš„ç¯€é»ï¼Œé‡å»ºæ–°çš„è©±ï¼Œå¿…é ˆè¦æŠŠistioç§»é™¤ï¼Œæ‰èƒ½å¤ ä½¿ç”¨ é·ç§»å·¥ä½œè² è¼‰åˆ°ä¸åŒnodeã€‚&lt;br /&gt;
ä½†å¦‚æœå·²ç¶“å°‡istioçš„ip ï¼Œç¶ä¸Šå›ºå®šçš„domainï¼Œä¸€æ—¦ç§»é™¤å°±å¿…é ˆè¦é‡æ–°ç¶å®šã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä»¥ä¸‹å…§å®¹éƒ½åœ¨GCPä¸Šé¢å¯¦ä½œ(istio ç‰ˆæœ¬ç‚º1.8.2)ã€‚ é¨°è¨Šé›²ä¸èƒ½é€™æ¨£ç©ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å…ˆå°‡IPè®Šæˆéœæ…‹ï¼Œè€Œä¸æ˜¯è‡¨æ™‚ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/14.fig-1.jpg&quot; alt=&quot;14.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å°‡ä¸‹é¢yamlå¦å­˜æˆæª”æ¡ˆ&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: install.istio.io/v1alpha1
kind: IstioOperator
spec:
  components:
    ingressGateways:
    - name: istio-ingressgateway
      enabled: true
      k8s:
        service:
          loadBalancerIP: 123.123.123.123
          loadBalancerSourceRanges:
          - 111.222.222.111/32
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è·ŸèˆŠç‰ˆçš„å·®ç•°åœ¨å¿…é ˆåŠ ä¸Šnameçš„åç¨±ï¼Œä¸ç„¶åœ¨manifest generate çš„æ™‚å€™æœƒç™¼ç”ŸéŒ¯èª¤&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;å®‰è£&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;istioctl install  -f value.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥å…ˆç”¢ç”Ÿyamlçœ‹å…§å®¹æ˜¯ä¸æ˜¯æœ‰è·Ÿæƒ³è±¡ä¸­çš„ä¸€æ¨£&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;istioctl manifest generate -f value.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://cloud.tencent.com/developer/article/1607842&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istio 1.5 éƒ¨ç½²æŒ‡å—ä¿®æ­£ç‰ˆ&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://istio.io/latest/docs/reference/config/istio.operator.v1alpha1/#ServiceSpec&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;IstioOperator Options&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/14.istioå®‰è£æ™‚å›ºå®šip/" />
        </entry>
        <entry>
            <title>
                11. istio èˆ‡ kiali
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/11. istio èˆ‡ kiali/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å¾istioæ‰¯åˆ°kialiï¼Œæ˜¯èªªkialiæ˜¯çœŸçš„å¥½ç”¨ï¼Œçœ‹æ±è¥¿æŒºç›´è¦ºå¾—ã€‚&lt;br /&gt;
ä½†æœ‰äº›è­¦å‘Šï¼Œè¦è§£èª¿å°±è¦ç…§ä»–çš„è¦ç¯„èµ°&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç¾åœ¨æœ€å¸¸ç¢°åˆ°çš„ï¼Œä¹Ÿé‚„æ²’è§£&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨GKEçš„ç§äººå¢é›†ï¼Œè«‹è¨˜å¾—è¦æŠŠ masterçš„é˜²ç«ç‰†è¦å‰‡ï¼Œé–‹å•Ÿ8080 ï¼Œä¸ç„¶æœƒç™¼ç”Ÿè®€å–æ™‚éœ€è¦ä¸€åˆ†é˜ï¼Œè³‡æ–™æ‰æœƒå‡ºç¾ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;No matching workload found for gateway selector in this namespace&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/11.fig-1.jpg&quot; alt=&quot;11.fig-1.jpg&quot; /&gt;&lt;br /&gt;
ç°¡å–®è¬›å°±æ˜¯ç›®å‰çš„namespaceæ²’æœ‰æ‰¾åˆ°ç›®å‰çš„ ingressgatewayï¼Œæœªä¾†å¯èƒ½æœƒç™¼ç”Ÿå•é¡Œ&lt;br /&gt;
ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kiali.io/documentation/v1.13/validations/#_no_matching_workload_found_for_gateway_selector_in_this_namespace&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;No matching workload found for gateway selector in this namespace&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;Port name must follow &amp;lt;protocol&amp;gt;[-suffix] form&lt;/code&gt;&lt;br /&gt;
serviceä¸Šçš„ port name å¿…é ˆè¦ç¬¦åˆæ ¼å¼ï¼Œ&lt;br /&gt;
æ ¼å¼å¿…é ˆç‚º &lt;code&gt;http-&lt;/code&gt; é€™æ¨£çš„&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
kind: Service
metadata:
  namespace: rd7-video
  labels:
    app: video-api-qa
  name: video-api
spec:
  ports:
  # éœ€éµç…§æ ¼å¼ å‰é¢ç‚º protocol å¾Œé¢ç‚º -suffix
  - name: &amp;quot;http-video&amp;quot;
    port: 80
  selector:
    app: video-api-qa
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kiali.io/documentation/v1.13/validations/#_port_name_must_follow_protocol_suffix_form&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Port name must follow &amp;lt;protocol&amp;gt;[-suffix] form&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;å¦å¤–ï¼Œå¦‚æœç·¨è¼¯configæœ‰éŒ¯æ™‚ï¼Œ&lt;br /&gt;
æŒ‰äº†SAVEæ²’æœ‰åæ‡‰ï¼ŒéŒ¯èª¤è¨Šæ¯å¯èƒ½åœ¨æœ€ä¸Šé¢ï¼Œè¦å°‡æ²è»¸å¾€ä¸Šæ‹‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kiali.io/documentation/v1.13/validations/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;v1.13 validation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;ç‚ºäº†kialiçš„å¥åº·åº¦ï¼Œæœ€å¥½æ˜¯åœ¨podä¸Šé¢å¯«å€‹ readinessProbeï¼ˆå°±ç·’æ¢é‡ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;readinessProbe:
  failureThreshold: 3
  initialDelaySeconds: 30
  periodSeconds: 10
  successThreshold: 1
  tcpSocket:
    port: 80
  timeoutSeconds: 1
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;kialiå¥åº·åº¦ æª¢æŸ¥ pod è®Šæˆ proxy unsynced&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%9B%B5%EF%B8%8F%20istio/11.fig-2.jpg&quot; alt=&quot;11.fig-2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kiali.io/documentation/latest/configuration/health/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;v1.28Health Configuration&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/xuliang666/p/12089915.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;istioä¹‹envoyå¸¸è¦‹è¡“èªåŠç‹€æ…‹ç¢¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kiali.io/documentation/latest/features/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kialiåœ–è¡¨èªªæ˜&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;virtualservice is pointing to a non-existent gateway&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/2113395/50571006-acd1b680-0dd9-11e9-9b34-db3f1bc95e08.png&quot; alt=&quot;fig.3&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å› ç‚ºgatewayä¸åœ¨åŒä¸€å±¤çš„namespaceä¸Šé¢ï¼Œæ‰€ä»¥è¦è¨­å®šåç¨±æ™‚ï¼Œ&lt;br /&gt;
è¦æ”¹ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gateways:
  - istio-ingressgateway-video.sex-system.svc.cluster.local
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/11. istio èˆ‡ kiali/" />
        </entry>
        <entry>
            <title>
                0.istio MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â›µï¸ istio/0.istio MOC/</id>
            <content type="html">
                &lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/73.%20istio%20sidecar%20%E6%B3%A8%E5%85%A5%E8%A6%8F%E5%89%87/&quot;&gt;73. istio sidecar æ³¨å…¥è¦å‰‡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/89.%20istio%20%E5%B8%B8%E8%A6%8B%E7%8B%80%E6%85%8B%E7%A2%BC/&quot;&gt;89. istio å¸¸è¦‹ç‹€æ…‹ç¢¼&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;å»ºç½®&quot; tabindex=&quot;-1&quot;&gt;å»ºç½®&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/7.%20Istio%E5%AE%89%E8%A3%9D%E5%8F%8A%E4%BD%BF%E7%94%A8/&quot;&gt;7. Istioå®‰è£åŠä½¿ç”¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/11.%20istio%20%E8%88%87%20kiali/&quot;&gt;11. istio èˆ‡ kiali&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/14.istio%E5%AE%89%E8%A3%9D%E6%99%82%E5%9B%BA%E5%AE%9Aip/&quot;&gt;14.istioå®‰è£æ™‚å›ºå®šip&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/20.%20%E8%A8%AA%E5%95%8Fistio%20%E5%85%A7%E9%83%A8%E8%B2%A0%E8%BC%89%E5%B9%B3%E8%A1%A1ip/&quot;&gt;20. è¨ªå•istio å…§éƒ¨è² è¼‰å¹³è¡¡ip&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/21.%20flagger%20%E8%87%AA%E5%8B%95%E9%87%91%E7%B5%B2%E9%9B%80%E4%BD%88%E7%BD%B2%20for%20istio/&quot;&gt;21. flagger è‡ªå‹•é‡‘çµ²é›€ä½ˆç½² for istio&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/23.istio%E7%9A%84%20prometheus%E6%88%AA%E5%8F%96GKE%20metrics/&quot;&gt;23.istioçš„ prometheusæˆªå–GKE metrics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/34.%20istio%20operator%20%E5%AE%89%E8%A3%9D%E6%96%B0%E7%9A%84%20ingress%20deploy%E5%8F%8Aservice/&quot;&gt;34. istio operator å®‰è£æ–°çš„ ingress deployåŠservice&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;199. istioä½¿ç”¨gatewayAPI&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;virtual-service&quot; tabindex=&quot;-1&quot;&gt;VirtualService&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/11.%20istio%20%E8%88%87%20kiali/&quot;&gt;11. istio èˆ‡ kiali&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/30.%20istio%E7%9A%84virtualservice%20match%E6%AF%94%E5%B0%8D/&quot;&gt;30. istioçš„virtualservice matchæ¯”å°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/35.%20istio%20virtualService%20delegate%E4%BD%BF%E7%94%A8/&quot;&gt;35. istio virtualService delegateä½¿ç”¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/54.%20istio%20%E6%8E%9B%E8%BC%89ECK%20kibana/&quot;&gt;54. istio æ›è¼‰ECK kibana&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/62.%20isito%20%E9%8F%A1%E5%83%8F%E6%B5%81%E9%87%8F/&quot;&gt;62. isito é¡åƒæµé‡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/75.%20istio%20virtual%20service%20%E5%B8%B8%E7%94%A8%E5%8F%83%E6%95%B8/&quot;&gt;75. istio virtual service å¸¸ç”¨åƒæ•¸&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/89.%20istio%20%E5%B8%B8%E8%A6%8B%E7%8B%80%E6%85%8B%E7%A2%BC/&quot;&gt;89. istio å¸¸è¦‹ç‹€æ…‹ç¢¼&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;authorization-policy&quot; tabindex=&quot;-1&quot;&gt;Authorization Policy&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/186.%20istio%E7%9A%84Authorization%20policy(%E7%99%BD%E5%90%8D%E5%96%AE)/&quot;&gt;186. istioçš„Authorization policy(ç™½åå–®)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/15.istio%E6%9C%8D%E5%8B%99%E7%84%A1%E6%B3%95%E8%A8%AA%E5%95%8F/&quot;&gt;15.istioæœå‹™ç„¡æ³•è¨ªå•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/18.istio%20Virtual%20Service%20%E8%B7%A8namespace%E8%AE%80%E5%8F%96%20DestinationRule/&quot;&gt;18.istio Virtual Service è·¨namespaceè®€å– DestinationRule&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/31.istio%20%E6%8A%93%E8%9F%B2%E8%A8%98/&quot;&gt;31.istio æŠ“èŸ²è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/â›µï¸ istio/0.istio MOC/" />
        </entry>
        <entry>
            <title>
                GCPè²»ç”¨
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/Price/GCPè²»ç”¨/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;GCPçš„è²»ç”¨ä¸»è¦åˆ†ä¸‰å¡Šï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ©Ÿå™¨è¦æ ¼çš„é–‹æ©Ÿè²»ç”¨&lt;br /&gt;
ç°¡å–®èªªå°±æ˜¯ï¼Œæ©Ÿå™¨é–‹æ©Ÿçš„è©±ç”¢ç”Ÿçš„è²»ç”¨ï¼Œä½†è¦æ³¨æ„çš„GCPä»–æœ‰çºŒç”¨æŠ˜æ‰£ï¼Œç•¶ä½ ç”¨è¶Šå¤šå°±èƒ½å¤ æ‰“æŠ˜ã€‚è€Œä¸”ä»–æœƒä¸»å‹•åˆä½µæœªæ»¿ä¸€å€‹æœˆæ©Ÿå™¨ï¼Œå†ä¸€èµ·ç®—è²»ç”¨ã€‚&lt;br /&gt;
ref.
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.cloud-ace.tw/google-cloud-platform/pricing/gcp-is-cheap-each-discount-plan-introduction/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; è½èªª GCP è²»ç”¨æœ€ä½ï¼Ÿå„ç¨®æŠ˜æ‰£æ–¹æ¡ˆå®Œæ•´èªªæ˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/compute/docs/sustained-use-discounts&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æŒçºŒä½¿ç”¨æŠ˜æ‰£&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¡¬ç¢Ÿçš„è²»ç”¨&lt;br /&gt;
æ©...å°±é–‹æ©Ÿå™¨æ™‚ï¼Œæ‰€éœ€è¦çš„ç¡¬ç¢Ÿç©ºé–“å¤§å°è²»ç”¨ï¼Œå°±ç®—ä½ æ©Ÿå™¨é—œæ©Ÿä¸€æ¨£ç…§ç®—ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://cloud.google.com/compute/disks-image-pricing#persistentdisk&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç£ç¢Ÿå’Œæ˜ åƒåƒ¹æ ¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ç¶²è·¯çš„è²»ç”¨&lt;br /&gt;
ä»¥ä¼ºæœå™¨çš„è§’åº¦ä¾†èªªï¼Œingress(æµé‡é€²ä¾†ï¼‰ä¸ç®—éŒ¢ï¼Œegressï¼ˆæµé‡å‡ºå»ï¼‰ç®—éŒ¢ã€‚&lt;br /&gt;
ä»¥ä½¿ç”¨è€…çš„è§’åº¦ä¾†èªªï¼Œä¸Šå‚³ä¸ç”¨éŒ¢ï¼Œä¸‹è¼‰è¦éŒ¢ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://blog.cloud-ace.tw/google-cloud-platform/pricing/gcp-price-estimate/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GCP å¦‚ä½•è¨ˆè²»ï¼Ÿå°±åƒæ°´é›»è²»ä¸€æ¨£&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;registry&quot; tabindex=&quot;-1&quot;&gt;Registry&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Artifact Registry&lt;/th&gt;
&lt;th&gt;Container Registry&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0.5GBä»¥ä¸‹å…è²»ï¼Œè¶…é0.5GBï¼Œæ¯GB 0.1 ç¾å…ƒ&lt;/td&gt;
&lt;td&gt;æ ¹æ“šcloudStorageè¨ˆåƒ¹&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ç¶²è·¯è¼¸å‡ºå¦è¨ˆ&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/artifact-registry/pricing?hl=zh-tw#storage&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Artifact Registry å®šåƒ¹&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/Price/GCPè²»ç”¨/" />
        </entry>
        <entry>
            <title>
                GCP CPUç”¨é€”
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/Price/GCP CPUç”¨é€”/</id>
            <content type="html">
                &lt;p&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/Price/GCP%20CPU%E7%94%A8%E9%80%94/#2024-07-09&quot;&gt;&lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#2024/07/09æ›´æ–°&quot;&gt;#2024/07/09æ›´æ–°&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;å®˜æ–¹å»ºè­°&quot; tabindex=&quot;-1&quot;&gt;å®˜æ–¹å»ºè­°&lt;/h1&gt;
&lt;p&gt;ä¸‹è¡¨æ˜¯å®˜æ–¹å»ºè­°çš„æ©Ÿå™¨å‹è™ŸåŠç”¨é€”&lt;br /&gt;
ref.&lt;a href=&quot;https://cloud.google.com/compute/docs/general-purpose-machines&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é€šç”¨æ©Ÿå™¨ç³»åˆ—&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;E2&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Web æœå‹™&lt;/li&gt;
&lt;li&gt;ä¸­å°å‹è³‡æ–™åº«&lt;/li&gt;
&lt;li&gt;æ‡‰ç”¨æä¾›æœå‹™&lt;/li&gt;
&lt;li&gt;å¾Œå°æ‡‰ç”¨&lt;/li&gt;
&lt;li&gt;å¾®æœå‹™&lt;/li&gt;
&lt;li&gt;è™›æ“¬æ¡Œé¢&lt;/li&gt;
&lt;li&gt;é–‹ç™¼ç’°å¢ƒ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;N2ã€N2Dã€Tau T2Dã€N1&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Web æœå‹™&lt;/li&gt;
&lt;li&gt;å¤§ä¸­å‹è³‡æ–™åº«&lt;/li&gt;
&lt;li&gt;æ‡‰ç”¨æä¾›æœå‹™&lt;/li&gt;
&lt;li&gt;å¾Œå°æ‡‰ç”¨&lt;/li&gt;
&lt;li&gt;å¿«å–&lt;/li&gt;
&lt;li&gt;åª’é«”/æµå¼å‚³è¼¸&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Tau T2A&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‡‰ç”¨æœå‹™ã€Web æœå‹™å’ŒéŠæˆ²æœå‹™&lt;/li&gt;
&lt;li&gt;åµŒå…¥å¼ç³»çµ±é–‹ç™¼&lt;/li&gt;
&lt;li&gt;Arm ä¸Šçš„ CI/CD é–‹ç™¼&lt;/li&gt;
&lt;li&gt;è¦–è¨Šå’Œåœ–ç‰‡ç·¨ç¢¼ã€è½‰ç¢¼å’Œè™•ç†&lt;/li&gt;
&lt;li&gt;æ•¸å­—å»£å‘Šäº¤æ˜“å’ŒæŠ•æ”¾&lt;/li&gt;
&lt;li&gt;å¿«å–ä¼ºæœå™¨&lt;/li&gt;
&lt;li&gt;è¨ˆç®—å‹è—¥å“ç ”ç™¼&lt;/li&gt;
&lt;li&gt;Android é–‹ç™¼&lt;/li&gt;
&lt;li&gt;è‡ªå‹•é§•é§›æˆ–å‚³çµ±æ±½è»Šè»Ÿé«”é–‹ç™¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä»– N2D è·Ÿ Tau T2Déƒ½æ˜¯AMDçš„CPUï¼Œåƒ¹æ ¼æ¯”N2çš„ä¾¿å®œ&lt;/p&gt;
&lt;p&gt;ä»¥åŒæ¨£çš„ 4 cpu , 16GB memory ä¾†æ¯”è¼ƒåƒ¹æ ¼çš„è©±ï¼Œ&lt;br /&gt;
æ”¹å¤©è¦é–‹åˆ°N2çš„è©±ï¼Œå¯ä»¥è©¦è©¦N2Dçš„æ©Ÿå™¨ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;é¡å‹&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;CPU&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;è¨˜æ†¶é«”&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;åƒ¹æ ¼&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;n2-standard-4&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;16GB&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$0.1942&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;n2d-standard-4&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;16GB&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$0.1690&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;e2-standard-4&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;16GB&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$0.13402&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ›´è©³ç´°çš„åƒ¹æ ¼ï¼Œåƒè€ƒ &lt;a href=&quot;https://cloud.google.com/compute/vm-instance-pricing&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è™›æ“¬æ©Ÿå™¨å¯¦ä¾‹åƒ¹æ ¼&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;2024-07-09&quot; tabindex=&quot;-1&quot;&gt;2024/07/09æ›´æ–°&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©ä¾†ç®—æ•¸å­¸äº†ï¼Œ&lt;br /&gt;
ç¾åœ¨è¦ä¾†æ¯”è¼ƒN2Dèˆ‡C2Dçš„åƒ¹æ ¼å·®è·&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;é¡å‹&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;On-demand price&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;1-year&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;3-year&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;Unit&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;N2D CPU&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$23.24612&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$14.64453&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$10.4609&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;vCPU month&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;C2D CPU&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$24.98863&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$15.74245&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$11.24492&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;vCPU month&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;C3D CPU&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$26.62383&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$16.77321&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$11.98076&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;vCPU month&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;N2D Memory&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$3.11564&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$1.96297&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$1.40233&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;GB month&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;C2D Memory&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$3.34632&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$2.10824&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$1.50599&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;GB month&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;C3D Memory&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$3.56532&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$2.24621&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;$1.60454&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;GB month&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä½†è¦ç‰¹åˆ¥æ³¨æ„ N2Dï¼Œå¦‚æœè‡ªå®šç¾©CPUèˆ‡Memoryçš„è©±ï¼Œ&lt;br /&gt;
åƒ¹æ ¼åˆä¸ä¸€æ¨£äº†ã€‚&lt;/p&gt;
&lt;p&gt;CPU æœƒä¾†åˆ°  $24.408426 / vCPU month&lt;br /&gt;
Memory æœƒä¾†åˆ°  $3.271422 / GB month&lt;/p&gt;
&lt;p&gt;åŒæ¨£ä»¥4é¡†CPUä¾†ç®—çš„è©±ï¼Œ&lt;br /&gt;
ç•¶è¨˜æ†¶é«”åˆ°13.82Gæ™‚ï¼Œåƒ¹æ ¼å°‡æ¥è¿‘æ¨™æº–N2Dã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/Price/GCP CPUç”¨é€”/" />
        </entry>
        <entry>
            <title>
                180. GCP ç›£æ§è²»ç”¨
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/Price/180. GCP ç›£æ§è²»ç”¨/</id>
            <content type="html">
                &lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åŠŸèƒ½&lt;/th&gt;
&lt;th&gt;åƒ¹æ ¼&lt;a href=&quot;https://cloud.google.com/stackdriver/pricing?hl=zh-cn#binary-units&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;1&lt;/a&gt;&lt;/th&gt;
&lt;th&gt;æ¯æœˆå…è²»é…é¡&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;https://cloud.google.com/logging/docs?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Logging&lt;/a&gt;Â å„²å­˜*&lt;/td&gt;
&lt;td&gt;$0.50/GiBï¼›  &lt;br /&gt;å°‡æ—¥èªŒæµå¼å‚³è¼¸åˆ°æ—¥èªŒå„²å­˜æ¡¶å„²å­˜ç©ºé–“ï¼Œä»¥ä¾¿ç·¨å…¥ç´¢å¼•ã€æŸ¥è©¢å’Œåˆ†æçš„ä¸€æ¬¡æ€§è²»ç”¨ï¼›åŒ…æ‹¬æ—¥èªŒå„²å­˜æ¡¶ä¸­é•·é” 30 å¤©çš„å„²å­˜è²»ç”¨ã€‚ æŸ¥è©¢å’Œåˆ†ææ—¥èªŒè³‡æ–™ä¸æœƒç”¢ç”Ÿé¡å¤–è²»ç”¨ã€‚&lt;/td&gt;
&lt;td&gt;æ¯å€‹é …ç›®æ¯æœˆçš„å‰ 50 GiB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;https://cloud.google.com/logging/docs?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Logging&lt;/a&gt;Â ä¿ç•™â€ &lt;/td&gt;
&lt;td&gt;å°æ–¼ä¿ç•™è¶…é 30 å¤©çš„æ—¥èªŒï¼Œæ¯æœˆæ¯ GiB ç‚º $0.01ï¼›æ ¹æ“šç•™å­˜ç‡æŒ‰æœˆçµç®—ã€‚&lt;/td&gt;
&lt;td&gt;åœ¨&lt;a href=&quot;https://cloud.google.com/logging/quotas?hl=zh-cn#logs_retention_periods&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é»˜èªä¿ç•™æœŸé™&lt;/a&gt;å…§ä¿ç•™çš„æ—¥èªŒä¸æœƒç”¢ç”Ÿä¿ç•™è²»ç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;https://cloud.google.com/logging/docs?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ—¥èªŒè¨˜éŒ„&lt;/a&gt;å…¥ç«™æµé‡â€¡&lt;/td&gt;
&lt;td&gt;ç„¡éœ€é¡å¤–è²»ç”¨&lt;/td&gt;
&lt;td&gt;ä¸é©ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;https://cloud.google.com/logging/docs/routing/overview?hl=zh-cn#ingesting-routing&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ—¥èªŒè·¯ç”±å™¨&lt;/a&gt;â™¦&lt;/td&gt;
&lt;td&gt;ç„¡éœ€é¡å¤–è²»ç”¨&lt;/td&gt;
&lt;td&gt;ä¸é©ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;https://cloud.google.com/logging/docs/log-analytics?hl=zh-cn#analytics&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Log Analytics&lt;/a&gt;â™£&lt;/td&gt;
&lt;td&gt;ç„¡éœ€é¡å¤–è²»ç”¨&lt;/td&gt;
&lt;td&gt;ä¸é©ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&quot;logging&quot; tabindex=&quot;-1&quot;&gt;Loggingä¿ç•™&lt;/h2&gt;
&lt;p&gt;Loggingä¿ç•™çš„è²»ç”¨ï¼Œåœ¨é»˜èªä¿ç•™çš„å¤©æ•¸ç‚ºä»¥ä¸‹&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ—¥èªŒå„²å­˜æ¡¶&lt;/th&gt;
&lt;th&gt;é»˜èªä¿ç•™æœŸé™&lt;/th&gt;
&lt;th&gt;è‡ªè¨‚ä¿ç•™æœŸé™&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;_Required&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;400 å¤©&lt;/td&gt;
&lt;td&gt;ä¸å¯çµ„æ…‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;_Default&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;30 å¤©&lt;/td&gt;
&lt;td&gt;å¯çµ„æ…‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä½¿ç”¨è€…å®šç¾©&lt;/td&gt;
&lt;td&gt;30 å¤©&lt;/td&gt;
&lt;td&gt;å¯çµ„æ…‹&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h5 id=&quot;code-required-code&quot; tabindex=&quot;-1&quot;&gt;&lt;code&gt;_Required&lt;/code&gt;Â æ—¥èªŒå„²å­˜æ¡¶&lt;/h5&gt;
&lt;p&gt;Cloud Logging æœƒè‡ªå‹•å°‡ä»¥ä¸‹é¡å‹çš„æ—¥èªŒè·¯ç”±åˆ°Â &lt;code&gt;_Required&lt;/code&gt;Â å„²å­˜æ¡¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/logging/docs/audit?hl=zh-cn#admin-activity&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç®¡ç†å“¡æ´»å‹•ç¨½æ ¸æ—¥èªŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/logging/docs/audit?hl=zh-cn#system-event&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç³»çµ±äº‹ä»¶ç¨½æ ¸æ—¥èªŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Google Workspace ç®¡ç†å“¡ç¨½æ ¸æ—¥èªŒ&lt;/li&gt;
&lt;li&gt;ä¼æ¥­ç‰ˆç¾¤çµ„ç¨½æ ¸æ—¥èªŒ&lt;/li&gt;
&lt;li&gt;ç™»éŒ„ç¨½æ ¸æ—¥èªŒ&lt;/li&gt;
&lt;li&gt;Access Transparency æ—¥èªŒã€‚å¦‚éœ€ç­è§£å¦‚ä½•å•Ÿç”¨ Access Transparency æ—¥èªŒï¼Œè«‹åƒé–±Â &lt;a href=&quot;https://cloud.google.com/assured-workloads/access-transparency/docs/overview?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Access Transparency æ—¥èªŒæ–‡ä»¶&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&quot;code-default-code&quot; tabindex=&quot;-1&quot;&gt;&lt;code&gt;_Default&lt;/code&gt;Â æ—¥èªŒå„²å­˜æ¡¶&lt;/h5&gt;
&lt;p&gt;é™¤éæ‚¨åœç”¨æˆ–ä»¥å…¶ä»–æ–¹å¼ä¿®æ”¹Â &lt;code&gt;_Default&lt;/code&gt;Â æ¥æ”¶å™¨ï¼Œå¦å‰‡æœªå„²å­˜åœ¨Â &lt;code&gt;_Required&lt;/code&gt;Â å„²å­˜æ¡¶ä¸­çš„ä»»ä½•æ—¥èªŒæ¢ç›®éƒ½æœƒè¢«Â &lt;code&gt;_Default&lt;/code&gt;Â æ¥æ”¶å™¨è·¯ç”±åˆ°Â &lt;code&gt;_Default&lt;/code&gt;Â å„²å­˜æ¡¶ã€‚å¦‚éœ€ç­è§£å¦‚ä½•ä¿®æ”¹æ¥æ”¶å™¨ï¼Œè«‹åƒé–±&lt;a href=&quot;https://cloud.google.com/logging/docs/export/configure_export_v2?hl=zh-cn#managing_sinks&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç®¡ç†æ¥æ”¶å™¨&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Cloud Logging æœƒè‡ªå‹•å°‡ä»¥ä¸‹é¡å‹çš„æ—¥èªŒè·¯ç”±åˆ°Â &lt;code&gt;_Default&lt;/code&gt;Â å„²å­˜æ¡¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/logging/docs/audit?hl=zh-cn#data-access&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è³‡æ–™è¨ªå•ç¨½æ ¸æ—¥èªŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/logging/docs/audit?hl=zh-cn#policy_denied&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ”¿ç­–æ‹’çµ•ç¨½æ ¸æ—¥èªŒ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é™¤éæ‚¨ç‚ºÂ &lt;code&gt;_Default&lt;/code&gt;Â å„²å­˜æ¡¶&lt;a href=&quot;https://cloud.google.com/logging/docs/buckets?hl=zh-cn#custom-retention&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;çµ„æ…‹è‡ªè¨‚ä¿ç•™&lt;/a&gt;ï¼Œå¦å‰‡ Cloud Logging æœƒå°‡æ—¥èªŒä¿ç•™ 30 å¤©ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/stackdriver/pricing?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Google Cloud çš„ç¶­é‹å¥—ä»¶åƒ¹æ ¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/logging/quotas?hl=zh-cn#logs_retention_periods&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ—¥èªŒä¿ç•™æœŸé™&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/logging/docs/routing/overview?hl=zh-cn#buckets&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è·¯ç”±å’Œå„²å­˜æ¦‚è¦½&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/Price/180. GCP ç›£æ§è²»ç”¨/" />
        </entry>
        <entry>
            <title>
                126. GCP ç¡¬ç¢Ÿè²»ç”¨æ¯”è¼ƒ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/Price/126. GCP ç¡¬ç¢Ÿè²»ç”¨æ¯”è¼ƒ/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;GCE&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Standard : $0.04 per GiB&lt;/li&gt;
&lt;li&gt;SSD : $0.17 per GiB&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;CloudStorage&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Standard ï¼šé©åˆçŸ­æœŸå„²å­˜å’Œç¶“å¸¸å­˜å–çš„è³‡æ–™&lt;/li&gt;
&lt;li&gt;Nearline ï¼š é©ç”¨æ–¼å‚™ä»½é …ç›®å’Œä¸€å€‹æœˆå­˜å–ä¸åˆ°ä¸€æ¬¡çš„è³‡æ–™&lt;/li&gt;
&lt;li&gt;Coldlineï¼šæœ€é©åˆç”¨æ–¼ç½é›£å¾©åŸï¼Œä»¥åŠå„²å­˜ã€Œæ¯å­£å­˜å–å°‘æ–¼ä¸€æ¬¡ã€çš„è³‡æ–™&lt;/li&gt;
&lt;li&gt;Archive ï¼šé©åˆä»¥æ•¸ä½æ–¹å¼é•·æœŸä¿å­˜ä¸€å¹´å­˜å–ä¸åˆ°ä¸€æ¬¡çš„è³‡æ–™&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹é¢ç‚ºæ¯æœˆæ¯GBçš„ç©ºé–“è²»ç”¨&lt;/p&gt;
&lt;p&gt;|                 | Standard å„²å­˜ç©ºé–“ | Nearline å„²å­˜ç©ºé–“ | Coldline å„²å­˜ç©ºé–“ | å°å­˜å„²å­˜ç©ºé–“     |    |&lt;br /&gt;
|-----------------|---------------|---------------|---------------|------------|&lt;br /&gt;
| å°ç£ (asia-east1) | $0.020 ç¾å…ƒ     | $0.010 ç¾å…ƒ     | $0.005 ç¾å…ƒ     | $0.0015 ç¾å…ƒ |&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰ç¶²è·¯æµé‡ï¼Œé¡å¤–åœ¨ç®—&lt;/p&gt;
&lt;p&gt;| æ¯æœˆç”¨é‡      | è¼¸å‡ºè‡³ä¸–ç•Œå„åœ° (äºæ´²å’Œæ¾³æ´²é™¤å¤–) | è¼¸å‡ºè‡³äºæ´²åœ°å€ (ä¸­åœ‹é™¤å¤–ï¼Œä½†å«é¦™æ¸¯) | è¼¸å‡ºè‡³ä¸­åœ‹åœ°å€ (é¦™æ¸¯é™¤å¤–) | è¼¸å‡ºè‡³æ¾³æ´²åœ°å€ï¼Œå¾ä½æ–¼æ¾³æ´²çš„ Cloud Storage å€åŸŸè¼¸å‡º | è¼¸å…¥ |   |   |   |   |&lt;br /&gt;
|-----------|-------------------|---------------------|----------------|-----------------------------------|----|&lt;br /&gt;
| 0 è‡³ 1 TB  | $0.12 ç¾å…ƒ          | $0.12 ç¾å…ƒ            | $0.23 ç¾å…ƒ       | $0.19 ç¾å…ƒ                          | å…è²»   |&lt;br /&gt;
| 1 è‡³ 10 TB | $0.11 ç¾å…ƒ          | $0.11 ç¾å…ƒ            | $0.22 ç¾å…ƒ       | $0.18 ç¾å…ƒ                          | å…è²»   |&lt;br /&gt;
| 10 TB ä»¥ä¸Š  | $0.08 ç¾å…ƒ          | $0.08 ç¾å…ƒ            | $0.20 ç¾å…ƒ       | $0.15 ç¾å…ƒ                          | å…è²»  |&lt;/p&gt;
&lt;p&gt;å†è£œä¸€ä¸‹æ“ä½œçš„è²»ç”¨ï¼Œ&lt;br /&gt;
å–®ç´”çœ‹é‡‘é¡å…¶å¯¦ä¸é«˜ï¼Œä½†å¦‚æœé »ç‡é«˜çš„è©±ï¼Œ&lt;br /&gt;
å…¶å¯¦ä¹Ÿä¸å°‘ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å„²å­˜ç©ºé–“ç´šåˆ¥1&lt;/th&gt;
&lt;th&gt;A ç´šä½œæ¥­  &lt;br /&gt;(æ¯ 1,000 æ¬¡æ“ä½œ)&lt;/th&gt;
&lt;th&gt;B ç´šä½œæ¥­  &lt;br /&gt;(æ¯ 1,000 æ¬¡æ“ä½œ)&lt;/th&gt;
&lt;th&gt;å…è²»æ“ä½œåŠŸèƒ½&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Standard Storage&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;$0.0100 ç¾å…ƒ&lt;/td&gt;
&lt;td&gt;$0.0004 ç¾å…ƒ&lt;/td&gt;
&lt;td&gt;å…è²»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Nearline Storage&lt;/strong&gt;Â å’ŒÂ &lt;strong&gt;Durable Reduced Availability (DRA) Storage&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;$0.0200 ç¾å…ƒ&lt;/td&gt;
&lt;td&gt;$0.0010 ç¾å…ƒ&lt;/td&gt;
&lt;td&gt;å…è²»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Coldline Storage&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;$0.0400 ç¾å…ƒ&lt;/td&gt;
&lt;td&gt;$0.0100 ç¾å…ƒ&lt;/td&gt;
&lt;td&gt;å…è²»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Archive Storage&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;$0.1000 ç¾å…ƒ&lt;/td&gt;
&lt;td&gt;$0.0500 ç¾å…ƒ&lt;/td&gt;
&lt;td&gt;å…è²»&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¦‚æœæ˜¯ä½¿ç”¨asyncï¼ŒåŸºæœ¬æƒ³åƒå¾—åˆ°çš„å°±æœ‰listã€insertã€‚å¯èƒ½é‚„æœ‰å…¶ä»–çš„æ“ä½œã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;API æˆ–åŠŸèƒ½&lt;/th&gt;
&lt;th&gt;A ç´šä½œæ¥­&lt;/th&gt;
&lt;th&gt;B ç´šä½œæ¥­&lt;/th&gt;
&lt;th&gt;å…è²»ä½œæ¥­é …ç›®&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;JSON API æˆ– gRPC&lt;/td&gt;
&lt;td&gt;storage.&lt;em&gt;.insert1  &lt;br /&gt;storage.&lt;/em&gt;.patch  &lt;br /&gt;storage.&lt;em&gt;.update  &lt;br /&gt;storage.&lt;/em&gt;.setIamPolicy  &lt;br /&gt;storage.buckets.list  &lt;br /&gt;storage.buckets.lockRetentionPolicy  &lt;br /&gt;storage.notifications.delete  &lt;br /&gt;storage.objects.compose  &lt;br /&gt;storage.objects.copy  &lt;br /&gt;storage.objects.list  &lt;br /&gt;storage.objects.restore  &lt;br /&gt;storage.objects.rewrite1  &lt;br /&gt;storage.objects.watchAll  &lt;br /&gt;storage.projects.hmacKeys.create  &lt;br /&gt;storage.projects.hmacKeys.list  &lt;br /&gt;storage.*AccessControls.delete  &lt;br /&gt;storage.folders.list  &lt;br /&gt;storage.folders.rename&lt;/td&gt;
&lt;td&gt;storage.&lt;em&gt;.get  &lt;br /&gt;storage.&lt;/em&gt;.getIamPolicy  &lt;br /&gt;storage.*.testIamPermissions  &lt;br /&gt;storage.*AccessControls.list  &lt;br /&gt;storage.notifications.list  &lt;br /&gt;æ¯å‰‡ç‰©ä»¶è®Šæ›´é€šçŸ¥2  &lt;br /&gt;storage.buckets.getStorageLayout&lt;/td&gt;
&lt;td&gt;storage.channels.stop  &lt;br /&gt;storage.buckets.delete  &lt;br /&gt;storage.objects.delete  &lt;br /&gt;storage.projects.hmacKeys.delete  &lt;br /&gt;storage.folders.delete&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;XML API&lt;/td&gt;
&lt;td&gt;GET æœå‹™  &lt;br /&gt;GET å€¼å€ (åˆ—å‡ºå€¼å€ä¸­çš„ç‰©ä»¶æ™‚)  &lt;br /&gt;PUT  &lt;br /&gt;POST&lt;/td&gt;
&lt;td&gt;GET å€¼å€ (æ“·å–å€¼å€è¨­å®šæˆ–åˆ—å‡ºæ­£åœ¨é€²è¡Œä¸­çš„å¤šéƒ¨åˆ†ä¸Šå‚³ä½œæ¥­æ™‚)  &lt;br /&gt;GET ç‰©ä»¶  &lt;br /&gt;HEAD&lt;/td&gt;
&lt;td&gt;Delete&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;https://cloud.google.com/storage/docs/lifecycle?hl=zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç‰©ä»¶ç”Ÿå‘½é€±æœŸç®¡ç†&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;SetStorageClass&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ä¸­æ­¢æœªå®Œæˆçš„å¤šéƒ¨åˆ†ä¸Šå‚³ä½œæ¥­  &lt;br /&gt;åˆªé™¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;https://cloud.google.com/storage/docs/autoclass?hl=zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è‡ªå‹•åˆ†é¡&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;ä»¥ä¸‹å„²å­˜ç©ºé–“ç´šåˆ¥è½‰æ›ï¼š&lt;br /&gt;&lt;br /&gt;- å¾ Coldline æ”¹ç‚º Standard&lt;br /&gt;- å¾å°å­˜æ”¹ç‚ºæ¨™æº–&lt;br /&gt;- Coldline åˆ° Nearline&lt;br /&gt;- å°‡è³‡æ–™å°å­˜è‡³ Nearline&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ä»¥ä¸‹å„²å­˜ç©ºé–“ç´šåˆ¥è½‰æ›ï¼š&lt;br /&gt;&lt;br /&gt;- Nearline åˆ° Standard&lt;br /&gt;- Standard è½‰æ›ç‚º Nearline&lt;br /&gt;- Nearline åˆ° Coldline&lt;br /&gt;- Coldline åˆ° Archive&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;https://cloud.google.com/storage/docs/tags-and-labels?hl=zh-tw#tags&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ¨™è¨˜&lt;/a&gt;3&lt;/td&gt;
&lt;td&gt;é™„åŠ æ¨™è¨˜  &lt;br /&gt;è§£é™¤æ¨™è¨˜&lt;/td&gt;
&lt;td&gt;åˆ—å‡ºé™„åŠ è‡³å€¼å€çš„æ¨™è¨˜&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;https://cloud.google.com/storage/docs/soft-delete?hl=zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è»Ÿåˆªé™¤&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;åœ¨ä¸€æ¬¡å¤§é‡é‚„åŸä½œæ¥­ä¸­è™•ç† 1,000 å€‹ç‰©ä»¶  &lt;br /&gt;é‚„åŸè™›åˆªé™¤çš„ç‰©ä»¶&lt;/td&gt;
&lt;td&gt;åˆ—å‡ºè™›åˆªé™¤çš„ç‰©ä»¶&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/storage/pricing?hl=zh-tw#asia&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åƒ¹ç›®è¡¨&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/Price/126. GCP ç¡¬ç¢Ÿè²»ç”¨æ¯”è¼ƒ/" />
        </entry>
        <entry>
            <title>
                97. Anthos åˆé«”é©—
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/97. Anthos åˆé«”é©—/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;æ¯å€‹æœˆå¢åŠ  50 ç¾&lt;/li&gt;
&lt;li&gt;create new cluster ,ç„¡æ³•æ›´æ”¹ç¾æœ‰(Anthos)&lt;/li&gt;
&lt;li&gt;åªèƒ½ç”¨workload identity&lt;/li&gt;
&lt;li&gt;cpuè‡³å°‘å››å€‹ï¼Œtotal è¦å…«å€‹&lt;/li&gt;
&lt;li&gt;Anthos è·Ÿ Anthos Service Mesh ä¸ä¸€æ¨£&lt;br /&gt;
ref. &lt;a href=&quot;https://cloud.google.com/service-mesh/docs/ui-differences&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Anthos èˆ‡ Anthos Service Mesh ç•Œé¢å·®ç•°&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœåœ¨macä¸Šï¼Œåƒç…§&lt;a href=&quot;https://cloud.google.com/service-mesh/docs/unified-install/install-dependent-tools&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ–‡ä»¶&lt;/a&gt;ï¼ŒåŸ·è¡Œçš„è©±æœƒå‡ºç¾ä¸€äº›éŒ¯èª¤ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;macä¸æ”¯æ´æ­¤æŒ‡ä»¤ï¼Œ&lt;/li&gt;
&lt;li&gt;ä¹Ÿä¸è¦ä½¿ç”¨cloudShellï¼Œæœƒå› ç‚ºVPCSC è€Œå‡ºç¾éŒ¯èª¤&lt;/li&gt;
&lt;li&gt;æœ€ä½³è§£æ³•ï¼Œä½¿ç”¨linuxç³»çµ±&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt; docker  run -it --rm   -v &amp;quot;$HOME&amp;quot;/.config:/root/.config -v /Users/ezio_liu/Documents/kill:/data google/cloud-sdk:latest

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å› ç‚ºæœ‰å°‡ gcpé©—è­‰ æ›è¼‰åˆ°imageå…§ï¼Œæ‰€ä»¥ä¸ç”¨åœ¨é©—è­‰ä¸€æ¬¡ã€‚&lt;br /&gt;
å¯ä»¥ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤ï¼Œçœ‹äººå“¡æœ‰æ²’æœ‰é©—è­‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud auth list 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€å¾Œï¼Œä½¿ç”¨ä¸‹é¢æŒ‡ä»¤å®‰è£&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./asmcli install   &#92;
--project_id rd7-project &#92;
--cluster_name istio-test &#92;
--cluster_location asia-east1-b &#92;
--fleet_id rd7-project &#92;
--output_dir asmcli_output &#92;
--managed  &#92;
--ca mesh_ca
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;--managed æ˜¯ä½¿ç”¨ ä»£ç®¡å¼anthos&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/97. Anthos åˆé«”é©—/" />
        </entry>
        <entry>
            <title>
                95.cloud buildçš„å•é¡Œ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/95.cloud buildçš„å•é¡Œ/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;åœ¨å»ºç½®cloud buildæ™‚é‡åˆ°å•é¡Œï¼Œ&lt;br /&gt;
ç¶“æŸ¥è©¢å¾Œæ¨æ¸¬å•é¡Œåœ¨æ–¼ï¼Œ&lt;br /&gt;
cloud buildçš„google serviceç•¶ä»–åœ¨é‹ä½œéç¨‹ï¼Œ&lt;br /&gt;
éœ€è¦å‘ç§æœ‰å°ˆæ¡ˆå…§çš„gke clusteræ“ä½œï¼Œ&lt;br /&gt;
cloud buildæ˜¯ä½¿ç”¨googleçš„æµ®å‹•ipï¼Œ&lt;br /&gt;
åœ¨æ­¤è™•æ‡‰è©²æ˜¯è¢«blockæ‰äº†æ‰€ä»¥ç„¡æ³•å®Œæˆcloud buildå»ºç½®&lt;/p&gt;
&lt;p&gt;éŒ¯èª¤è¨Šæ¯ï¼šUnable to connect to the server: dial tcp 124.111.27.75:443: i/o timeout&lt;/p&gt;
&lt;p&gt;(IPç‚ºclusterç«¯é»ip)&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/build/docs/troubleshooting#io_timeout_error&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;googleéŒ¯èª¤æ’è§£&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç¾éšæ®µæœ‰ä¸‰ç¨®æ–¹å¼&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è‡ªæ¶CICDç³»çµ±&lt;/li&gt;
&lt;li&gt;GKE ç›´æ¥é–‹æ”¾ 0.0.0.0/0 &amp;gt; é€™æœ‰å®‰å…¨ç–‘æ…®&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ private conn &amp;gt; é€™è¤‡é›œåº¦å¾ˆé«˜ä¸”ä¸å½ˆæ€§&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/95.cloud buildçš„å•é¡Œ/" />
        </entry>
        <entry>
            <title>
                9.GCPç¶²è·¯å°å¤–çš„æ–¹å¼
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/9.GCPç¶²è·¯å°å¤–çš„æ–¹å¼/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;é€™ç®—æ˜¯å…ˆå‰ä¸€ç›´æœ‰å•é¡Œï¼Œä½†ä¸çŸ¥é“ç‚ºä»€éº¼ï¼Œä¹Ÿæ²’å»æŸ¥åŸå› ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç‚ºäº†è¦æ­£ç¢ºå°æ‡‰ï¼Œè®“å…¶ä»–æ©Ÿå™¨é–‹ç™½åå–®ï¼Œä¸å¾—ä¸å¼„æ¸…æ¥šï¼Œåˆ°åº•æ€éº¼ä¸€å›äº‹ã€‚&lt;br /&gt;
ä¹‹å‰åŒäº‹éƒ½èªªæ˜¯èµ°cloudNatï¼Œä½†æˆ‘ç›´æ¥é€£å» vm  or podè£¡é¢ï¼Œ&lt;br /&gt;
ç”¨curl &lt;a href=&quot;http://ifconfig.me/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ifconfig.me&lt;/a&gt; æŠ“åˆ°çš„ipéƒ½ä¸æ˜¯æˆ‘æ‰€çŸ¥é“çš„ipï¼Œ&lt;br /&gt;
(&lt;a href=&quot;http://ifconfig.me/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ifconfig.me&lt;/a&gt; æ˜¯ä¸€å€‹ç¶²å€ï¼Œå–®ç´”é¡¯ç¤ºç›®å‰é€£å»ç¶²ç«™çš„ipä½ç½®)&lt;/p&gt;
&lt;p&gt;CloudNAT çš„åŸºæœ¬æ¦‚å¿µï¼Œä¸»è¦æ˜¯å¯æä¾›å…§éƒ¨æ©Ÿå™¨å°å¤–é€£ç·š&lt;br /&gt;
ref. &lt;a href=&quot;https://cloud.google.com/nat/docs/overview&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Cloud NAT æ¦‚è¦½&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åŸºæœ¬çš„è¨­å®šæ–¹å¼ï¼Œ&lt;br /&gt;
ref. &lt;a href=&quot;https://cloud.google.com/nat/docs/using-nat&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨ Cloud NAT&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;GCEæ²’æœ‰å•é¡Œï¼ŒåŸºæœ¬ä¸Šæ²’æœ‰å¤–éƒ¨ipè€Œä¸”åˆæ²’è¨­å®šcloudNATçš„è©±ï¼Œå°±æ˜¯ç„¡æ³•é€£æ¥å¤–ç¶²ã€‚&lt;br /&gt;
ç„¶è€Œæœ‰å¤–éƒ¨ipä½ç½®çš„è©±ï¼ŒGoogle Cloud æœƒè‡ªå‹•å°ä¾†æºèˆ‡è©²æ¥å£çš„ä¸»å…§éƒ¨ IP åœ°å€åŒ¹é…çš„æ•¸æ“šåŒ…åŸ·è¡Œä¸€å°ä¸€ NATã€‚&lt;br /&gt;
ä½†GKEå°±æœ‰é»å•é¡Œäº†ï¼Œå°±ç®—æ²’æœ‰è¨­å®šå¤–éƒ¨ipï¼Œé‚„æ˜¯èƒ½å¤ å°å¤–ï¼Œ&lt;br /&gt;
è€Œä¸”æŠ“åˆ°çš„ipä½ç½®ï¼Œä½ ä¸çŸ¥é“æ˜¯å¾ä½•è€Œä¾†ï¼Œä¹Ÿä¸æ˜¯CloudNATçš„IP&lt;/p&gt;
&lt;p&gt;æœ€å¾Œå¾&lt;a href=&quot;https://cloud.google.com/nat/docs/troubleshooting#internet-wo-nat&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å•é¡Œæ’æŸ¥&lt;/a&gt;é€™é‚Šæ‰¾åˆ°äº†ç­”æ¡ˆï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ç¢ºä¿æ‚¨çš„ Google Kubernetes Engine (GKE) é›†ç¾¤æ˜¯ä¸€å€‹å°ˆç”¨é›†ç¾¤ã€‚éå°ˆç”¨é›†ç¾¤ä¸­çš„æ¯å€‹ç¯€é»è™›æ“¬æ©Ÿéƒ½å…·æœ‰å¤–éƒ¨ IP åœ°å€ï¼Œå› æ­¤æ¯å€‹ç¯€é»éƒ½å¯ä»¥ä½¿ç”¨ Virtual Private Cloud (VPC) ç¶²çµ¡ä¸­ä¸‹ä¸€å€‹èºé»ç‚ºé»˜èªäº’è¯ç¶²ç¶²é—œè€Œä¸ä¾è³´ Cloud NAT çš„è·¯ç”±ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç°¡å–®èªªï¼Œå¦‚æœæ²’æœ‰è¨­å®šå°ˆæœ‰é›†ç¾¤ï¼ˆç§æœ‰å¢é›†ï¼‰ï¼Œæœ¬èº«çš„nodeæ˜¯å…·æœ‰å°å¤–çš„ipï¼Œæ‰€ä»¥é‚„æ²’åˆ°CloudNATä¹‹å‰ï¼Œ&lt;br /&gt;
å°±ç›´æ¥å¾nodeç¯€é»å‡ºå»äº†ã€‚é€™éƒ¨åˆ†å¯ä»¥åˆ°podè£¡é¢ æŠ“å–å°å¤–ipï¼Œç„¶å¾Œå»æ¯”å°ï¼Œé€™å€‹podæ‰€åœ¨çš„nodeçš„å°å¤–ipå°±çŸ¥é“äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters#console&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å»ºç«‹ç§äººå¢é›†&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;2021-04-19&quot; tabindex=&quot;-1&quot;&gt;2021/04/19 æ›´æ–°&lt;/h1&gt;
&lt;p&gt;ä»Šå¤©ä¾†ç®—ä¸€ä¸‹æ•¸å­¸ï¼Œ&lt;/p&gt;
&lt;p&gt;ä¸Šé¢æœ‰æåˆ°ï¼Œç•¶è¨­æˆç§æœ‰å¢é›†æˆ–æ˜¯VMï¼Œéœ€è¦å°å¤–é€£ç·šæ™‚ï¼Œ&lt;br /&gt;
éœ€è¨­å®šcloud nat ipï¼Œ&lt;br /&gt;
ç•¶å°å¤–é€£ç·šæ•¸é‡ä¸è¶³æ™‚ï¼Œæœƒç™¼ç”Ÿè¨±å¤šå¥‡æ€ªçš„å•é¡Œï¼Œ&lt;br /&gt;
ä¾‹å¦‚ï¼Œä½ˆç½² deployment ï¼Œæœƒç™¼ç”Ÿimage pull error ï¼Œpodç„¡æ³•å•Ÿå‹•ï¼Œä¸€ç›´é‡é–‹...ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;[[9-fig.1.jpg]]&lt;/p&gt;
&lt;p&gt;æ¯å€‹ VM åŸ·è¡Œå€‹é«”çš„æœ€ä½é€šè¨ŠåŸ æ•¸é‡ ï¼š64&lt;br /&gt;
è¡¨ç¤ºæ¯å°VMå¯ä»¥å°å¤–çš„é€£ç·šæ•¸é‡ã€‚&lt;/p&gt;
&lt;p&gt;å‡è¨­(fig.1)&lt;br /&gt;
å°å¤–çš„ipæœ‰å…©å€‹ï¼Œ&lt;br /&gt;
ä¸€å€‹å°å¤–ipå¯ä»¥æä¾› 64512çš„ port çµ¦è£¡é¢çš„ä¾†æºå­ç¶²è·¯èˆ‡IPä½¿ç”¨ï¼Œ&lt;br /&gt;
è€Œæˆ‘å€‘ä¸Šé¢è¨­å®š æ¯å€‹ VM åŸ·è¡Œå€‹é«”çš„æœ€ä½é€šè¨ŠåŸ æ•¸é‡ ç‚º 64 ï¼Œ&lt;br /&gt;
æ•… 64512 * 2/64 = 2016 å¯æä¾›çš„VMæ•¸é‡&lt;br /&gt;
è¡¨ç¤º ä¾†æºå­ç¶²è·¯èˆ‡ IP ç¯„åœ çš„VPCç¶²è·¯ å¯ä»¥æä¾›çµ¦2016 å€‹VM ï¼ˆåŒ…å« GCE è·Ÿ GKEçš„ç¯€é»ï¼‰ ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/nat/docs/ports-and-addresses#port-reservation-examples&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Cloud NAT åœ°å€å’Œç«¯å£æ¦‚è¦½&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/9.GCPç¶²è·¯å°å¤–çš„æ–¹å¼/" />
        </entry>
        <entry>
            <title>
                88.æ‰¹æ¬¡ä¿®æ”¹GCPçš„label
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/88.æ‰¹æ¬¡ä¿®æ”¹GCPçš„label/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ç™¼ç¾æœ‰ä¸€æ•´æ‰¹çš„è³‡æºæ²’æœ‰åŠ é label ï¼Œ&lt;br /&gt;
GCEçš„ç¡¬ç¢Ÿã€è² è¼‰å¹³è¡¡çš„å‰ç«¯è½‰å°è¦å‰‡..&lt;br /&gt;
æœ‰äº›æ¢ä»¶ä¸ä¸€æ¨£ï¼Œä¸€å€‹ä¸€å€‹åŠ æœƒç˜‹æ‰ã€‚&lt;br /&gt;
å·¥ç¨‹å¸«å°±æ˜¯æ‡¶...å¯«shå§&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;é–‹å§‹æ§‹æ€&quot; tabindex=&quot;-1&quot;&gt;é–‹å§‹æ§‹æ€&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆæŠŠé—œéµå€¼æ‹‰å‡ºä¾† (1)&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute forwarding-rules list
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/88-fig.1.png&quot; alt=&quot;88-fig.1.png&quot; /&gt;&lt;br /&gt;
åªæœ‰ipï¼Œè¦è·‘å»æ¯å€‹å¢é›†æŸ¥è³‡æ–™ï¼Œçœ‹é€™è©²æ­¸å±¬å“ªå€‹labelï¼Œ&lt;br /&gt;
å¤ªç¬¨äº†ï¼Œä¸è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å…ˆçœ‹ä¸€ä¸‹forwarding-rules æœ‰å“ªäº›è³‡è¨Š(2)ï¼Œå†æŠŠæ¬„ä½é¡¯ç¤ºå‡ºä¾†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute forwarding-rules describe a0589a367cdc1470e839b05803958e2b
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è£¡é¢çš„descriptionä¼¼ä¹è »æœ‰ç”¨è™•çš„ï¼Œå¯ä»¥å¹«å¿™é‡æ¸…æ˜¯å“ªå€‹cluster&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/88-fig.2.jpg&quot; alt=&quot;88-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç”¨ --format (3)ï¼Œé¡¯ç¤ºæ¬„ä½&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; gcloud compute forwarding-rules list  --format=&#39;table(name,IPAddress,description)&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/88-fig.3.jpg&quot; alt=&quot;88-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;é–‹å§‹å¯«bash&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å°‡nameä¸Ÿé€² æ–‡å­—æª”ï¼Œ&lt;br /&gt;
ç„¶å¾ŒåŸ·è¡Œbashï¼Œbashçš„æµç¨‹ï¼Œè¿´åœˆè®€æª”æ¡ˆå…§å®¹(4)ï¼ŒåŸ·è¡Œæ›´æ–°labelæŒ‡ä»¤(5)ã€‚é€™é‚Šè¦æ³¨æ„ï¼Œå¦‚æœæ˜¯ingressæˆ–æ˜¯å€åŸŸå‹çš„è¦é¡å¤–åŠ ä¸Š --globalï¼Œ&lt;br /&gt;
æ‰èƒ½æ›´æ–°ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;while read p; do
  echo &amp;quot;$p&amp;quot;; gcloud compute forwarding-rules update $p &#92;
    --update-labels=product=abc,env=prod,dept=rd; echo &amp;quot;done&amp;quot;;
done &amp;lt;lbfr.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/compute/forwarding-rules/list&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud compute forwarding-rules list&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/compute/forwarding-rules/describe&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud compute forwarding-rules describe&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/topic/formats&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud topic formats&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.compciv.org/topics/bash/loops/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;http://www.compciv.org/topics/bash/loops/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/compute/forwarding-rules/update&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud compute forwarding-rules update&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/88.æ‰¹æ¬¡ä¿®æ”¹GCPçš„label/" />
        </entry>
        <entry>
            <title>
                8.GCSä½¿ç”¨æ–¹å¼
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/8.GCSä½¿ç”¨æ–¹å¼/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æŸå€‹æ¡ˆå­ï¼Œè¦æ•´å€‹ç¿»æ‰é‡åšï¼Œé€™æ¬¡è¦è®“VMçš„æ©Ÿå™¨è·ŸGKEçš„podèƒ½å¤ åŒæ™‚å­˜å–ä¸€å€‹å„²å­˜ç©ºé–“ï¼Œ&lt;br /&gt;
é è¨ˆä½¿ç”¨Google Cloud Storageï¼Œè¸©äº†ä¸€å€‹æ—©ä¸Šçš„å‘ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;é è¨ˆåšå…©å€‹é …ç›®&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;åœ¨VMä¸Šé¢æ›è¼‰gcsçš„è³‡æ–™å¤¾&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨GKE ä¸Šé¢çš„podåŒæ™‚æ›è¼‰ gcsçš„è³‡æ–™å¤¾&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨VMä¸Šé¢æ›è¼‰gcsçš„è³‡æ–™å¤¾&lt;br /&gt;
å®‰è£æ–¹å¼ï¼Œç›®å‰æˆ‘çš„vmæ˜¯ RedHat æ‰€ä»¥ç”¨ä¸‹é¢çš„æ–¹å¼ï¼ŒCentOSä¹Ÿæ˜¯ç”¨åŒæ¨£çš„æ–¹å¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Configure the gcsfuse repo:&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sudo tee /etc/yum.repos.d/gcsfuse.repo &amp;gt; /dev/null &amp;lt;&amp;lt;EOF
[gcsfuse]
name=gcsfuse (packages.cloud.google.com)
baseurl=https://packages.cloud.google.com/yum/repos/gcsfuse-el7-x86_64
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg
       https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Install gcsfuse:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;  sudo yum install gcsfuse
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®Œæˆï¼Œå…¶ä»–å®‰è£æ–¹å¼ï¼Œè«‹åƒè€ƒ&lt;a href=&quot;https://github.com/GoogleCloudPlatform/gcsfuse/blob/master/docs/installing.md&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GoogleCloudPlatform/gcsfuse/install.md&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç™»å…¥ä½¿ç”¨ï¼Œ&lt;br /&gt;
é€™é‚Šå…ˆä½¿ç”¨ gcloud auth login åšæ¸¬è©¦&lt;br /&gt;
å…ˆå»ºç«‹è³‡æ–™å¤¾  mkdir upload&lt;br /&gt;
æ›è¼‰  gcsfuse my-bucket upload&lt;br /&gt;
å¸é™¤æ›è¼‰ fusermount -u upload&lt;/p&gt;
&lt;h3 id=&quot;debug&quot; tabindex=&quot;-1&quot;&gt;Debugç”¨&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;gcsfuse --foreground --debug_gcs --debug_http --debug_fuse --debug_invariants --key-file=/home/user/Downloads/my-key.json mybucket /upload
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;google-application-credentials&quot; tabindex=&quot;-1&quot;&gt;æ°¸ä¹…åŠ å…¥GOOGLE_APPLICATION_CREDENTIALSè®Šæ•¸&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;é–‹å•Ÿ /etc/profiles
æ–°å¢ export GOOGLE_APPLICATION_CREDENTIALS=&amp;quot;/home/user/Downloads/my-key.json&amp;quot;
ä¿®æ”¹æª”æ¡ˆå¾Œè¦æƒ³é¦¬ä¸Šç”Ÿæ•ˆé‚„è¦åŸ·è¡Œ#
source /etc/profileä¸ç„¶åªèƒ½åœ¨ä¸‹æ¬¡é‡é€²æ­¤ä½¿ç”¨è€…æ™‚ç”Ÿæ•ˆã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://www.itread01.com/content/1547223515.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linuxç³»çµ±ç’°å¢ƒè®Šæ•¸å’Œåˆ¥åè¨­å®šï¼ˆæ°¸ä¹…ç”Ÿæ•ˆå’Œè‡¨æ™‚ç”Ÿæ•ˆï¼‰&lt;/a&gt;&lt;br /&gt;
é™„è¨»ï¼Œjsonæª”æ¡ˆçš„å–å¾—åœ¨ IAMè§’è‰²å…§çš„æœå‹™è³¬æˆ¶&lt;br /&gt;
ref.&lt;a href=&quot;https://cloud.google.com/iam/docs/creating-managing-service-account-keys&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å‰µå»ºå’Œç®¡ç†æœå‹™å¸³è™Ÿå¯†é‘°&lt;/a&gt;ã€‚&lt;br /&gt;
æ–°å¢å®ŒGCSï¼Œè¨˜å¾—æŠŠæ¬Šé™çµ¦æœå‹™è³¬æˆ¶ã€‚è¨˜å¾—é¸æ“‡å®Œæ•´æ¬Šé™ï¼ˆFig. 1)&lt;/p&gt;
&lt;h3 id=&quot;è‡ªå‹•æ›è¼‰&quot; tabindex=&quot;-1&quot;&gt;è‡ªå‹•æ›è¼‰&lt;/h3&gt;
&lt;p&gt;æœ‰æ¬Šé™äº†å·²å¾Œï¼Œå†ä¾†å°±æ˜¯è‡ªå‹•æ›è¼‰äº†ã€‚&lt;br /&gt;
åˆ°/etc/fstabä¸Šï¼Œè¼¸å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;my_bucket /home/ezio/upload gcsfuse key_file=key/key.json,rw,user,allow_other,uid=1008,gid=1009  0 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‡é–‹æ©Ÿæ¸¬è©¦çœ‹çœ‹ï¼Œæ”¶å·¥ã€‚&lt;br /&gt;
ref.&lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/42638048/how-to-use-mount-command-in-fstab-file/42638136#42638136&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How to use mount command in fstab file&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://serverfault.com/questions/1021950/gcsfuse-automount-on-a-non-root-user&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcsfuse automount on a non root user&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;æŸ¥è©¢ç›®å‰ç™»å…¥ä½¿ç”¨è€…çš„uid è·Ÿ gid
id $(whoami)

å¦‚æœè¦çœ‹å…¨éƒ¨ä½¿ç”¨è€…çš„è©±ï¼Œ
cat /etc/passwd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;a href=&quot;http://linux.vbird.org/linux_basic/0410accountmanager/0410accountmanager-centos5.php#account_id&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux çš„å¸³è™Ÿèˆ‡ç¾¤çµ„&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;åœ¨GKE ä¸Šé¢çš„podåŒæ™‚æ›è¼‰ gcsçš„è³‡æ–™å¤¾&lt;br /&gt;
åŸºæœ¬çš„æ–¹å¼ï¼Œ&lt;br /&gt;
å…ˆè‡ªå·±ç”¢ç”Ÿä¸€å€‹ image&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;FROM golang:1.14-alpine AS build-env
ENV GO111MODULE on

# WORKDIR /å·¥ä½œåéŒ„åç¨± ç•¶å‰çš„å·¥ä½œç›®éŒ„åç¨±ï¼Œè‹¥æ˜¯ä¸å­˜åœ¨å‰‡æœƒæ–°å»ºè©²ç›®éŒ„ï¼Œ
# éœ€è¦æ³¨æ„çš„æ˜¯copyè·Ÿrunçš„æŒ‡ä»¤éƒ½æ˜¯ä»¥WORKDIRç‚ºç•¶å‰ç›®éŒ„ä¸‹å»è·‘çš„ï¼Œ
# é‹ç”¨çš„æ™‚å€™éœ€è¦æ³¨æ„ç›¸å°ä½ç½®ã€‚
WORKDIR $GOPATH/src

RUN go get -u github.com/googlecloudplatform/gcsfuse

COPY key.json .


FROM alpine:3.6
RUN apk add --no-cache ca-certificates fuse &amp;amp;&amp;amp; rm -rf /tmp/*
COPY --from=build-env /go/bin/gcsfuse /usr/local/bin
COPY --from=build-env /go/src/key.json /
WORKDIR /
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½ˆç½² Deployment&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: gcs-fuse
    version: v1
  namespace: debug
  name: gcsfuse-test
spec:
  replicas: 1
  selector:
    matchLabels:
      app: gcs-fuse
      version: v1
  template:
    metadata:
      labels:
        app: gcs-fuse
        version: v1
    spec:
      containers:
        - name: gcsfuse-test
          image: gcr.io/your-project/gcsfuse:v1.2
          # image: golang:1.14-alpine
          # command: [ &amp;quot;/bin/sh&amp;quot;, &amp;quot;-c&amp;quot;, &amp;quot;--&amp;quot; ]
          # args: [ &amp;quot;while true; do sleep 600; done;&amp;quot; ]
          securityContext:
            privileged: true
          command:
            - &amp;quot;/bin/sh&amp;quot;
            - &amp;quot;-c&amp;quot;
            - &amp;quot;while true; do mkdir /upload ; gcsfuse --key-file=key.json your-bucket /folder; sleep 600; done; &amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœè·Ÿç¾æœ‰çš„ç¨‹å¼æ•´åˆçš„è©±ï¼Œ&lt;br /&gt;
ç”±æ–¼è¦åŸ·è¡Œå¤šè¡ŒæŒ‡ä»¤ï¼Œéœ€ä½¿ç”¨shellScriptçš„æ–¹å¼åŸ·è¡ŒæŒ‡ä»¤ã€‚&lt;br /&gt;
å¯èƒ½æœƒé‡åˆ°ä¸‹åˆ—æƒ…æ³&lt;/p&gt;
&lt;h3 id=&quot;and-quot-exec-and-quot-init-sh-and-quot-permission-denied&quot; tabindex=&quot;-1&quot;&gt;&amp;quot;exec: &amp;quot;/init.sh&amp;quot;: permission denied&lt;/h3&gt;
&lt;p&gt;åœ¨Dockerfileä¸Šä¿®æ”¹æ¬Šé™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;RUN chmod +x /init.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/44687685/getting-permission-denied-in-docker-run&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;getting permission denied in docker run&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;exec-user-process-caused-and-quot-exec-format-error-and-quot&quot; tabindex=&quot;-1&quot;&gt;exec user process caused &amp;quot;exec format error&amp;quot;&lt;/h3&gt;
&lt;p&gt;æœ‰äººèªªåœ¨shçš„é ‚ç«¯åŠ ä¸Š&lt;br /&gt;
#!/bin/bash&lt;br /&gt;
ä½†æˆ‘è©¦äº†æ²’ç”¨ï¼Œåœ¨çŒœæƒ³å¯èƒ½æ˜¯alpine linuxæ²’æœ‰bashå°è‡´&lt;br /&gt;
æ‰€ä»¥æ”¹ç”¨ä¸‹é¢é€™å€‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ENTRYPOINT [&amp;quot;sh&amp;quot;,&amp;quot;/run.sh&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://stackoverflow.com/questions/42494853/standard-init-linux-go178-exec-user-process-caused-exec-format-error&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;standard_init_linux.go:178: exec user process caused â€œexec format errorâ€&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;sh-debug&quot; tabindex=&quot;-1&quot;&gt;åŸ·è¡Œshæ™‚å¡ä½ï¼Œdebugæ–¹å¼&lt;/h3&gt;
&lt;p&gt;ç”¨if elseæª¢æŸ¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;if mkdir /upload; then
    echo &amp;quot;mkdir directory! Success&amp;quot; 1&amp;gt;&amp;amp;2
    gcsfuse --key-file=key.json yellow-video /upload
else
    echo &amp;quot;Could not mkdir directory!&amp;quot; 1&amp;gt;&amp;amp;2
    exit 1
fi
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦å¤–ï¼Œæœ€å¾Œæ‰¾å‡ºä¾†åŸå› æ˜¯å› ç‚ºå…ˆåŸ·è¡Œgoçš„ç¨‹å¼ï¼Œå°è‡´å¾ŒçºŒå¡ä½ï¼Œæ‰€ä»¥å…ˆå»ºç«‹è³‡æ–™å¤¾å¾Œï¼Œå†åŸ·è¡Œgo&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://www.opencli.com/linux/shell-script-exit-on-error&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Shell Script é‡åˆ°éŒ¯èª¤æ™‚è‡ªå‹•é€€å‡ºé›¢é–‹&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/docs/authentication/getting-started&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;èº«ä»½é©—è­‰å…¥é–€&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.itread01.com/content/1547223515.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linuxç³»çµ±ç’°å¢ƒè®Šæ•¸å’Œåˆ¥åè¨­å®šï¼ˆæ°¸ä¹…ç”Ÿæ•ˆå’Œè‡¨æ™‚ç”Ÿæ•ˆï¼‰&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/8.GCSä½¿ç”¨æ–¹å¼/" />
        </entry>
        <entry>
            <title>
                79. gcloud compute instance ç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/79. gcloud compute instance ç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å› ç‚ºå…¬å¸æ”¿ç­–ï¼Œ&lt;br /&gt;
è¦æŠŠlabelå…¨éƒ¨çµ±ä¸€ï¼Œä¹‹å‰æœ‰äº›å·²ç¶“å‘½åéä¸€æ¬¡çš„ä½†åç¨±ä¸å°ï¼Œ&lt;br /&gt;
ä¸€å€‹ä¸€å€‹æ”¹åˆå¥½éº»ç…©ï¼Œ&lt;br /&gt;
ä¾†å¯«commandå§&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æŒ‡ä»¤æ¼”åŒ–é †åº&lt;/p&gt;
&lt;p&gt;Step 1.&lt;br /&gt;
å…ˆç”¨æŒ‡ä»¤æ’ˆå‡º GCEçš„å…¨éƒ¨åˆ—è¡¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute instances --project=project list --format=&#39;table(name,status,labels.list())&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Step 2.&lt;/p&gt;
&lt;p&gt;æ‰¾å‡ºlabelåªæœ‰ç‰¹å®šå­—å…ƒçš„åˆ—è¡¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute instances --project=project list --format=&#39;table(name,status,labels.list())&#39; | grep product=abc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/79-fig.1.jpg&quot; alt=&quot;79-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å•é¡Œä¾†äº†ï¼Œå¦‚æœæˆ‘åªè¦å–nameå‡ºä¾†ï¼Œä½œçˆ²è®Šæ•¸çš„è©±ï¼Œ&lt;br /&gt;
è¦æ€éº¼åšï¼Ÿ&lt;br /&gt;
æˆ‘ä¹Ÿä¸€ä¸‹å­æƒ³ä¸å‡ºä¾†ï¼Œå°±å…ˆè·‘å»çœ‹ä¸€ä¸‹gcloudæ–‡ä»¶äº†ã€‚&lt;/p&gt;
&lt;p&gt;Step 3.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute instances --project=project list --filter=&amp;quot;labels.product:abc&amp;quot; --format=&amp;quot;table(name)&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ”¹ç”¨ &lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/topic/filters&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;filter&lt;/a&gt;å»ç¯©é¸ï¼Œé€™æ¨£å°±èƒ½åªé¡¯ç¤ºåç¨±äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/79-fig.2.jpg&quot; alt=&quot;79-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Step 4.&lt;br /&gt;
åŠ ä¸Šforè¿´åœˆï¼Œå°‡label.productæ”¹æˆ zzz&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;for name in $(gcloud compute instances --project=project list --filter=&amp;quot;labels.product:abc&amp;quot; --format=&amp;quot;table(name)&amp;quot;); do
  gcloud compute instances update &amp;quot;$name&amp;quot; --update-labels product=zzz
done 

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é™„è¨»ï¼š&lt;/p&gt;
&lt;p&gt;åˆªé™¤labelçš„æŒ‡ä»¤&lt;br /&gt;
product ç‚º keyå€¼&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute instances update beta-api01 --remove-labels product
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/compute/docs/labeling-resources#gcloud&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨æ¨™ç±¤æ•´ç†è³‡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud command&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/79. gcloud compute instance ç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                5. Google Cloud Functioné™åˆ¶
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/5. Google Cloud Functioné™åˆ¶/</id>
            <content type="html">
                &lt;h2 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;é€™æ¬¡è¦ç”Ÿä¸€å€‹ffmpegçš„ç’°å¢ƒå‡ºä¾†ï¼Œç„¶å¾Œæ‰¾é˜¿æ‰¾é˜¿ï¼Œ&lt;br /&gt;
æ‰¾åˆ°ä¸€ç¯‡æ–‡ç« ï¼Œä¸Šé¢å¯«&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  Googleå°‡Cloud Functionsä½œæ¥­ç³»çµ±å‡ç´šåˆ°äº†Ubuntu 18.04 LTSï¼Œæ“´å¤§äº†å¯ç”¨å‡½å¼åº«çš„ç¯„åœï¼Œé™¤äº†Imagemagickä¸€ç›´éƒ½æœ‰å¤–ï¼Œé‚„å¤šäº†Ffmpegå’ŒLibcairo2ç³»çµ±å‡½å¼åº«ï¼Œé€£ç„¡é ­Chromeä¹Ÿæœ‰ï¼Œä½¿ç”¨è€…ä¸åªå¯ä»¥åœ¨Cloud Functionsä¸­è™•ç†å½±ç‰‡ï¼Œç”šè‡³é‚„èƒ½é€²è¡Œç¶²é æˆªåœ–ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref &lt;a href=&quot;https://www.ithome.com.tw/news/125258&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Googleäº‹ä»¶é©…å‹•ç„¡ä¼ºæœå™¨å¹³è‡ºCloud Functionsæ­£å¼ä¸Šç·šäº†!&lt;/a&gt;&lt;br /&gt;
ç„¶å¾Œä¸ç”¨æ¶æ©Ÿå™¨ï¼Œå°±ä¾†çœ‹çœ‹é€™æ¢è·¯è¡Œä¸è¡Œçš„é€šå§&lt;/p&gt;
&lt;h2 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h2&gt;
&lt;p&gt;æ‰¾äº†ä¸€é™£å­ï¼Œå…ˆæ³¨æ„åˆ°çš„æ˜¯GCFçš„é™åˆ¶&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;timeout é è¨­1åˆ†é˜ï¼Œæœ€é•·9åˆ†é˜&lt;/li&gt;
&lt;li&gt;å–®ä¸€functionå¯ç”¨memoryç‚º2Gï¼Œè¶…éæœƒä¸­æ–·&lt;br /&gt;
é€™å…©å€‹æ˜¯æˆ‘èªç‚ºæ¯”è¼ƒé‡è¦çš„éƒ¨åˆ†ï¼Œå…¶ä»–ç´°é …ï¼Œ&lt;br /&gt;
å¯åƒè€ƒ&lt;br /&gt;
&lt;a href=&quot;https://firebase.google.com/docs/functions/quotas?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é…é¡å’Œé™åˆ¶&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://medium.com/%E5%AE%85%E7%94%B7%E9%9B%9C%E5%AD%B8%E7%AD%86%E8%A8%98/%E6%B7%BA%E8%AB%87serverless-solution-%E4%BB%A5gcp-cloud-function%E7%82%BA%E4%BE%8B-6374bf74df98&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ·ºè«‡Serverless Solution â€” ä»¥GCP Cloud Functionç‚ºä¾‹&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;çµè«–ï¼Œæ‹¿ä¾†åšå½±ç‰‡è½‰æª”çš„è©±...æ‡‰è©²æ˜¯æ²’è¾¦æ³•äº†ã€‚é™¤éé€™å½±ç‰‡å¤ å°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ç„¶åªå¯«apiçœ‹ä¾†æ˜¯æŒºå¿«çš„&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/5. Google Cloud Functioné™åˆ¶/" />
        </entry>
        <entry>
            <title>
                46.åˆ—å‡ºGCEçš„æ‰€æœ‰VM
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/46.åˆ—å‡ºGCEçš„æ‰€æœ‰VM/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å¦‚æœè¦æŸ¥ç‰¹å®šçš„æ¬„ä½ï¼Œå¯ä»¥å…ˆåˆ—å‡ºinstances çš„çµæ§‹ï¼Œ&lt;br /&gt;
çœ‹ä¸€ä¸‹è¦ä»€éº¼æ¨£çš„è³‡æ–™ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute instances describe gke-xxxxxx-test-n2-8-819a6098-3b3r --zone=asia-east1-b
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œå°±èƒ½æ¹Šå‡ºä¸‹é¢çš„èªæ³•äº†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute instances list --format=&amp;quot;table(
name,
zone.basename(),
networkInterfaces[].ipv6AccessConfigs[0].externalIpv6.notnull().list():label=EXTERNAL_IPV6,
networkInterfaces[].subnetwork)&amp;quot; | sort -k 5 | grep -E &#39;gateway.*test&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€å‰é¢çš„èªæ³•ï¼Œæ˜¯è¦å–å‡ºå­ç¶²è·¯çš„åç¨±ï¼Œä»¥ä¾¿è¨ˆç®—è©²å­ç¶²è·¯å…§æœ‰å¹¾å°VMï¼Œ&lt;br /&gt;
ç„¶å¾Œæ’åºã€æ¯”å° åç¨±è£¡é¢æœ‰  gatewayè€Œä¸”å¾Œé¢æ˜¯ testçš„VMã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://www.opencli.com/linux/grep-or-and-operators&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;grep æŒ‡ä»¤ä½¿ç”¨ or åŠ and æŸ¥å…©å€‹æ¢ä»¶ä»¥ä¸Š&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/compute/instances/describe&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud compute instances describe&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/compute/instances/list&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud compute instances list&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/46.åˆ—å‡ºGCEçš„æ‰€æœ‰VM/" />
        </entry>
        <entry>
            <title>
                46.GCEæ©Ÿå™¨åˆ—è¡¨å…§çš„CPUå€‹æ•¸
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/46.GCEæ©Ÿå™¨åˆ—è¡¨å…§çš„CPUå€‹æ•¸/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;è¦ç®—ä¸€ä¸‹å„æœå‹™æ‰€ä½”çš„æ¯”ä¾‹ï¼Œ&lt;br /&gt;
å¤§æ–¹å‘ç”¨VMçš„æ©Ÿå™¨ cpuä¾†ç®—&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å¦‚æœç”¨gcloud compute list èƒ½å¤ åˆ—å‡ºæ©Ÿå™¨çš„é¡å‹ï¼Œä½†è£¡é¢çš„cpuæ•¸é‡é‚„æ˜¯ä¸çŸ¥é“ã€‚&lt;/p&gt;
&lt;p&gt;æ‰¾äº†ä¸€ä¸‹ç™¼ç¾æœ‰äººå¯«å¥½ä¸€å€‹shell scriptï¼Œæ‹¿ä¾†æ”¹ä¸€ä¸‹èƒ½å¤ ç›´æ¥åˆ—å‡ºcpuæ•¸é‡&lt;br /&gt;
è·Ÿé€£çµçš„å…§å®¹ç›¸æ¯”ï¼Œæˆ‘é€™é‚Šå¤šåŠ äº†ä¸€å€‹ç‹€æ…‹ã€‚&lt;br /&gt;
å› ç‚ºæœ‰äº›æ©Ÿå™¨æ˜¯ä¸é–‹æ©Ÿçš„ï¼Œç•¶æœ‰ä»»å‹™æ™‚ï¼Œæ‰æœƒé–‹æ©Ÿï¼Œæ•…å¤§éƒ¨åˆ†æ™‚é–“éƒ½æ˜¯é—œæ©Ÿç‹€æ…‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Get instance name,zone for `${PROJECT}
for PAIR in $(&#92;
  gcloud compute instances list &#92;
  --project=${PROJECT} &#92;
  --format=&amp;quot;csv[no-heading](name,zone.scope(zones),status)&amp;quot;)
do
  # Parse result from above into instance and zone vars
  IFS=, read INSTANCE ZONE STATUS &amp;lt;&amp;lt;&amp;lt; ${PAIR}
  # Get the machine type value only
  MACHINE_TYPE=$(&#92;
    gcloud compute instances describe ${INSTANCE} &#92;
    --project=${PROJECT} &#92;
    --zone=${ZONE} &#92;
    --format=&amp;quot;value(machineType.scope(machineTypes))&amp;quot;)
  # If it&#39;s custom-${vCPUs}-${RAM} we&#39;ve sufficient info
  if [[ ${MACHINE_TYPE} == custom* ]]
  then
    IFS=- read CUSTOM CPU MEM &amp;lt;&amp;lt;&amp;lt; ${MACHINE_TYPE}
    printf &amp;quot;%s: vCPUs: %s; Mem: %s; Status: %s&#92;n&amp;quot; ${INSTANCE} ${CPU} ${MEM} ${STATUS}
  else
    # Otherwise, we need to call `machine-types describe`
    CPU_MEMORY=$(&#92;
      gcloud compute machine-types describe ${MACHINE_TYPE} &#92;
      --project=${PROJECT} &#92;
      --zone=${ZONE} &#92;
      --format=&amp;quot;csv[no-heading](guestCpus,memoryMb)&amp;quot;)
    IFS=, read CPU MEM &amp;lt;&amp;lt;&amp;lt; ${CPU_MEMORY}
    printf &amp;quot;%s: vCPUs: %s; Mem: %s; Status: %s&#92;n&amp;quot; ${INSTANCE} ${CPU} ${MEM} ${STATUS}
  fi
done


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.  &lt;a href=&quot;https://stackoverflow.com/questions/65888736/gcloud-command-to-display-vcpus-and-memory-assigned-to-instances&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud command to display vCPU&#39;s and Memory assigned to Instances&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/46.GCEæ©Ÿå™¨åˆ—è¡¨å…§çš„CPUå€‹æ•¸/" />
        </entry>
        <entry>
            <title>
                19. GCEç¡¬ç¢Ÿå¢åŠ å®¹é‡å¤§å°
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/19. GCEç¡¬ç¢Ÿå¢åŠ å®¹é‡å¤§å°/</id>
            <content type="html">
                &lt;h2 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰æœ‰åŠ å¤§éGCEçš„CPUè·Ÿramï¼Œä½†æ€éº¼åŠ ç¡¬ç¢Ÿç©ºé–“é‚„çœŸçš„ä¸çŸ¥é“ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆåˆ°GCEï¼Œé–‹å•Ÿæ©Ÿå™¨ã€‚é¸æ“‡é–‹æ©Ÿç£ç¢Ÿï¼ˆå¯åœ¨é–‹æ©Ÿçš„ç‹€æ…‹ä¸‹é‹ä½œï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/19.fig-1.jpg&quot; alt=&quot;19.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;æŒ‰ä¸‹ç·¨è¼¯ï¼Œä¿®æ”¹ç¡¬ç¢Ÿå¤§å°ï¼Œå„²å­˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/19.fig-2.jpg&quot; alt=&quot;19.fig-2.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;
&lt;p&gt;é‡æ–°æ•´ç†ç•«é¢ï¼Œæœƒçœ‹åˆ°ç¡¬ç¢Ÿç©ºé–“å®¹é‡è®Šäº†ã€‚ä½†é‚„æ²’å®Œæˆï¼Œéœ€è¦åˆ°æ©Ÿå™¨è£¡é¢é‡æ–°èª¿æ•´å¤§å°ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;lsblk åˆ—å‡ºå¯ç”¨è¨­å‚™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lsblk
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;NAME   MAJ:MIN RM SIZE RO TYPE MOUNTPOINT&lt;br /&gt;
sda      8:0    0  35G  0 disk&lt;br /&gt;
â””â”€sda1   8:1    0  30G  0 part /&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NAMEï¼šé€™æ˜¯å¡Šè¨­å‚™åã€‚&lt;/li&gt;
&lt;li&gt;MAJ:MINï¼šæœ¬æ¬„é¡¯ç¤ºä¸»è¦å’Œæ¬¡è¦è¨­å‚™è™Ÿã€‚&lt;/li&gt;
&lt;li&gt;RMï¼šæœ¬æ¬„é¡¯ç¤ºè¨­å‚™æ˜¯å¦å¯ç§»å‹•è¨­å‚™ã€‚æ³¨æ„ï¼Œåœ¨è¨­å‚™sdbå’Œsr0çš„RMå€¼ç­‰æ–¼1ï¼Œé€™èªªæ˜ä»–å€‘æ˜¯å¯ç§»å‹•è¨­å‚™ã€‚&lt;/li&gt;
&lt;li&gt;SIZEï¼šæœ¬æ¬„åˆ—å‡ºè¨­å‚™çš„å®¹é‡å¤§å°ä¿¡æ¯ã€‚ä¾‹å¦‚35Gè¡¨æ˜è©²è¨­å‚™å¤§å°ç‚º35GBï¼Œè€Œ1Kè¡¨æ˜è©²è¨­å‚™å¤§å°ç‚º1KBã€‚&lt;/li&gt;
&lt;li&gt;ROï¼šè©²é …è¡¨æ˜è¨­å‚™æ˜¯å¦ç‚ºåªè®€ã€‚åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œæ‰€æœ‰è¨­å‚™çš„ROå€¼ç‚º0ï¼Œè¡¨æ˜ä»–å€‘ä¸æ˜¯åªè®€çš„ã€‚&lt;/li&gt;
&lt;li&gt;TYPEï¼šæœ¬æ¬„é¡¯ç¤ºå¡Šè¨­å‚™æ˜¯å¦æ˜¯ç£ç›¤æˆ–ç£ç›¤ä¸Šçš„ä¸€å€‹åˆ†å€ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œsdaå’Œsdbæ˜¯ç£ç›¤ï¼Œè€Œsr0æ˜¯åªè®€å­˜å„²ï¼ˆromï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;MOUNTPOINTï¼šæœ¬æ¬„æŒ‡å‡ºè¨­å‚™æ›è¼‰çš„æ›è¼‰é»ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://man.linuxde.net/lsblk&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;lsblkå‘½ä»¤&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;growpart å°‡å…¨éƒ¨å¤šé¤˜çš„ç©ºé–“çµ¦æŒ‡å®šçš„åˆ†å‰²å€&lt;br /&gt;
extend  a partition	in a partition table to	fill available space&lt;br /&gt;
ubuntu å®‰è£æ–¹å¼ï¼š&lt;br /&gt;
&lt;code&gt;apt -y install cloud-guest-growpart&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;2024/08/15æ›´æ–°&lt;br /&gt;
&lt;code&gt;apt -y install cloud-guest-utils&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;CentOS å®‰è£æ–¹å¼ï¼š&lt;br /&gt;
&lt;code&gt;yum -y install cloud-utils-growpart&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  growpart /dev/sda 1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šçš„dev/sda æŒ‡çš„æ˜¯disk,æ•…sdaèˆ‡ 1 ä¸­é–“æœ‰ç©ºæ ¼&lt;br /&gt;
ref. &lt;a href=&quot;https://www.freebsd.org/cgi/man.cgi?query=growpart&amp;amp;manpath=Debian+8.1.0&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;growpart&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;p.s å¦‚æœå‡ºç¾ éŒ¯èª¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FAILED: sfdisk not found
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è«‹ä½¿ç”¨sudo growpart /dev/sda 1 çš„æ–¹å¼åŸ·è¡Œ&lt;br /&gt;
æˆ– &lt;code&gt;apt install -y fdisk&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;resize2fs èª¿æ•´ç³»çµ±å¤§å°&lt;pre&gt;&lt;code&gt;  resize2fs /dev/sda1
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€™é‚Šçš„dev/sda1 æŒ‡çš„æ˜¯part ,æ•…sdaèˆ‡ 1 ä¸­é–“æ²’æœ‰ç©ºæ ¼&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.itread01.com/content/1541634723.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;LinuxåŸºç¤å‘½ä»¤---resize2fs&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;df æª¢æŸ¥åˆ†å‰²å€å¤§å°&lt;pre&gt;&lt;code&gt;df -h
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;http://genesic.blogspot.com/2018/01/gcp.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcp å¢åŠ ç¡¬ç¢Ÿå®¹é‡&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.timelog.to/a159164305&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä¸é—œæ©Ÿã€ä¸æ‹”ç¡¬ç¢Ÿæ“´å……VM root ç£ç¢Ÿå€ - growpart&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://docs.aws.amazon.com/zh_tw/AWSEC2/latest/UserGuide/recognize-expanded-volume-linux.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;èª¿æ•´ç£ç¢Ÿå€å¤§å°å¾Œæ“´å±• Linux æª”æ¡ˆç³»çµ±&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://blog.skywebster.com/resize-ext-and-xfs-root-partition-without-lvm/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux æ“´å±•ext2/3/4 xfs rootåˆ†å‰²å€ä¸ç”¨LVM&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨resize2fs ç¢°åˆ°éŒ¯èª¤è¨Šæ¯&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;resize2fs 1.45.6 (20-Mar-2020)&lt;br /&gt;
resize2fs: Bad magic number in super-block while trying to open /dev/sda2&lt;br /&gt;
Couldn&#39;t find valid filesystem superblock.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¡¨ç¤ºä½ ä½¿ç”¨çš„å¯èƒ½æ˜¯xfsç³»çµ±ï¼Œä¾†æŸ¥ä¸€ä¸‹&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	mount 	
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/19.fig-3.jpg&quot; alt=&quot;19.fig-3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¿…é ˆæ”¹ç”¨ä¸‹é¢æŒ‡ä»¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;xfs_growfs /dev/sda2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://blog.90.vc/archives/164&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;# xfsæª”æ¡ˆç³»çµ±æ“´å®¹å ±resize2fs: Bad magic number in super-block while trying to open /dev/centos/root Couldnâ€™t find valid filesystem superblock&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/19. GCEç¡¬ç¢Ÿå¢åŠ å®¹é‡å¤§å°/" />
        </entry>
        <entry>
            <title>
                181. cloudstorageç„¡æ³•ä½¿ç”¨cloudflareè½‰å€
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/181. cloudstorageç„¡æ³•ä½¿ç”¨cloudflareè½‰å€/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ç·šä¸Šçš„åœ–ç‰‡æ˜¯ä½¿ç”¨GCPçš„Load balanceré€£åˆ°Google cloud storageï¼Œ&lt;br /&gt;
ä¹‹å‰æ¸¬è©¦æ²’å•é¡Œï¼Œä½†å¾Œä¾† &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/186.%20istio%E7%9A%84Authorization%20policy(%E7%99%BD%E5%90%8D%E5%96%AE)/#cloudflare&quot;&gt;186. istioçš„Authorization policy(ç™½åå–®)#cloudflareè½‰ç™¼&lt;/a&gt; ï¼Œ&lt;br /&gt;
clientåˆ°origin server éƒ½ä½¿ç”¨sslé€£ç·šå¾Œï¼Œå°±æ›äº†ï¼Œ&lt;br /&gt;
å› ç‚ºLoad balancerç•¶åˆæ²’æœ‰è¨­å®šSSLçš„æ†‘è­‰ï¼Œå°è‡´ç„¡æ³•é€£ç·šã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;åˆ°GCPçš„æ†‘è­‰ç®¡ç†å™¨ï¼Œæ–°å¢æ†‘è­‰ã€‚&lt;br /&gt;
ä¸€é–‹å§‹æ˜¯æ²’æœ‰å•“ç”¨çš„ï¼Œå¿…é ˆå…ˆå•“ç”¨&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/181-fig.2.jpg&quot; alt=&quot;181-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/181-fig.1.jpg&quot; alt=&quot;181-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å»ºç«‹æ–°æ†‘è­‰ï¼Œä¸æ”¯æ´è¬ç”¨å­—å…ƒ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/181-fig.3.jpg&quot; alt=&quot;181-fig.3.jpg&quot; /&gt;&lt;br /&gt;
é€™é‚Šæ³¨æ„ï¼Œå»ºç«‹å®Œå¾Œï¼Œ&lt;br /&gt;
å¯èƒ½éœ€è¦ç­‰ä¸€é™£å­(å¹¾å°æ™‚ï¼‰æ‰æœƒå¥½ï¼Œ&lt;br /&gt;
å»ºç«‹å®Œå¾Œä¸€å®šè¦åˆ°LBç¶å®šï¼Œå‘ˆç¾æœ‰ä½¿ç”¨è€…çš„ç‹€æ…‹ã€‚&lt;br /&gt;
ç•¶å¥½çš„æ™‚å€™ï¼Œæœƒçœ‹åˆ°ç‹€æ…‹ç‚ºã€æœ‰æ•ˆã€ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ™‚ï¼Œå†åˆ°Load Balanceré‚£é‚Šè¨­å®šæ†‘è­‰ï¼Œé–‹å•“httpsçš„å…¥å£å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/181-fig.4.jpg&quot; alt=&quot;181-fig.4.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å‰é¢æ­¥é©Ÿï¼Œåƒè€ƒ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/140.%20gcs%20%E6%8E%9B%E8%BC%89domain/&quot;&gt;140. gcs æ›è¼‰domain&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/181. cloudstorageç„¡æ³•ä½¿ç”¨cloudflareè½‰å€/" />
        </entry>
        <entry>
            <title>
                17. Gcloud AttributeError module importlib has no attribute util
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/17. Gcloud AttributeError module importlib has no attribute util/</id>
            <content type="html">
                &lt;h2 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/16.dustise%20sleep%20%E6%B8%AC%E8%A9%A6%E5%B7%A5%E5%85%B7%E7%B0%A1%E4%BB%8B/&quot;&gt;16.dustise sleep æ¸¬è©¦å·¥å…·ç°¡ä»‹&lt;/a&gt; ä¸Šä¸€ç¯‡ï¼Œæœ‰è¬›åˆ°httpieé€™å€‹å¥—ä»¶ï¼Œç°¡å–®ä½¿ç”¨ï¼Œæˆ‘å°±ç›´æ¥åœ¨macä¸Šè£äº†ã€‚&lt;br /&gt;
ç„¶å¾Œï¼Œgcloud,kubectlå°±æ›äº†...&lt;/p&gt;
&lt;h2 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h2&gt;
&lt;p&gt;éŒ¯èª¤ç¢¼æ˜¯é€™æ¨£ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  AttributeError: module &#39;importlib&#39; has no attribute &#39;util&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¾Œä¾†ä¸€æŸ¥ï¼Œç™¼ç¾æ˜¯kubectl è·Ÿ python 3.9 çš„å•é¡Œ&lt;a href=&quot;https://github.com/kubernetes/kubectl/issues/970&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;AttributeError: module &#39;importlib&#39; has no attribute &#39;util&#39; &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#970&quot;&gt;#970&lt;/a&gt;&lt;/a&gt;&lt;br /&gt;
æœ¬ä¾†æ˜¯æƒ³ç›´æ¥å‡ç´škubectlå°±å¥½&lt;a href=&quot;https://kubernetes.io/zh/docs/tasks/tools/install-kubectl/#install-with-homebrew-on-macos&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åœ¨ macOS ä¸Šä½¿ç”¨ Homebrew å®‰è£&lt;/a&gt;ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  brew upgrade kubectl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é›–ç„¶å‡ç´šå®Œæˆäº†ï¼Œ&lt;br /&gt;
ä½†æŸ¥è©¢ç‰ˆæœ¬&lt;br /&gt;
kubectl version --client&lt;br /&gt;
å‡ºä¾†çš„ç‰ˆæœ¬ä»æ˜¯èˆŠçš„ã€‚&lt;/p&gt;
&lt;p&gt;å¾Œä¾†æ‰æƒ³åˆ°ï¼Œæˆ‘çš„kubectl å¥½åƒæ˜¯è·Ÿgcloud ä¸€èµ·è£çš„ï¼Œè©¦äº†ä¸€ä¸‹ï¼Œé€£gcloudä¹Ÿæ˜¯åŒæ¨£çš„éŒ¯èª¤ã€‚&lt;br /&gt;
é‚£å°±ä¾†å‡ç´šgcloudå§ã€‚ä½†åªè¦è¼¸å…¥ gcloud components update ä¹Ÿæ˜¯å‡ºç¾åŒæ¨£çš„éŒ¯èª¤ï¼Œé‚£è¦æ€éº¼å‡ç´š...&lt;br /&gt;
æ‰€ä»¥ï¼Œæ ¹æ“š&lt;a href=&quot;https://stackoverflow.com/questions/64010263/attributeerror-module-importlib-has-no-attribute-util&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é€™ç¯‡&lt;/a&gt;  å…ˆåœ¨terminalä¸Šé¢è¼¸å…¥ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;export CLOUDSDK_PYTHON=python2   # å…ˆæŒ‡å®šä½¿ç”¨å…¶ä»–pythonç‰ˆæœ¬
gcloud components update          # æ›´æ–°gcloud
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®Œæˆã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/17. Gcloud AttributeError module importlib has no attribute util/" />
        </entry>
        <entry>
            <title>
                164.gcloud install by bash
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/164.gcloud install by bash/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å› çˆ²ã€æ‡¶ã€ï¼Œæ‰€ä»¥è¦ä¾†æå€‹ä¸€å€‹shå°±èƒ½å®‰è£å®Œæ‰€æœ‰æ±è¥¿ã€‚&lt;br /&gt;
ä½†åœ¨install gcloudå°±è¸©å‘äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://cloud.google.com/sdk/docs/install-sdk?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®˜æ–¹æ–‡ä»¶&lt;/a&gt;ï¼Œé€™é‚Šæåˆ°æ­£å¸¸çš„å®‰è£æ–¹å¼ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./google-cloud-sdk/install.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†é€™å€‹æ˜¯å»ºç«‹åœ¨äººè¦åœ¨é›»è…¦å‰é¢è¼¸å…¥Yï¼Œæ–¼æ˜¯æ”¹æˆ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./google-cloud-sdk/install.sh --command-completion=true --path-update=true --quiet
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æ¨£æ‰æœƒåœ¨.bashrc å¢åŠ åŸ·è¡Œçš„åƒæ•¸ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€é–‹å§‹æ²’æœ‰æƒ³åˆ°æ˜¯æ²’æœ‰å¢åŠ  .bashrcçš„é—œä¿‚ï¼Œ&lt;br /&gt;
åªæœ‰ä¸€ç›´å‡ºç¾æ‰¾ä¸åˆ°gcloudçš„éŒ¯èª¤ï¼Œ&lt;br /&gt;
æœ€å¾Œç¢ºèª&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/163.Shell%E7%9A%84%E5%8D%80%E5%88%A5%E5%8F%8A%E6%9F%A5%E8%A9%A2/&quot;&gt;163.Shellçš„å€åˆ¥åŠæŸ¥è©¢&lt;/a&gt;çš„é—œä¿‚å¾Œï¼Œ&lt;br /&gt;
æ‰é‡æ¸…æ˜¯.bashrcæ²’åŠ ï¼Œ&lt;br /&gt;
æ–¼æ˜¯åˆ©ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./google-cloud-sdk/install.sh --help
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŸ¥è©¢æœ‰å“ªäº›åƒæ•¸å¯ä¾›ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&quot;shell-script&quot; tabindex=&quot;-1&quot;&gt;å®Œæ•´shell script&lt;/h2&gt;
&lt;p&gt;å®Œæ•´install.shå¦‚ä¸‹ï¼Œéœ€ä½¿ç”¨rootåŸ·è¡Œï¼Œä¸ç„¶åœ¨å®‰è£gcloudæœƒå‡ºéŒ¯ï¼Œ&lt;br /&gt;
update-cert.shæ˜¯å¦ä¸€å€‹shell scriptï¼Œæ˜¯ç”¨gsutilæ‹¿ä¾†æŠ“gcsçš„è³‡æ–™ç”¨ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;curl -O https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-cli-443.0.0-linux-x86_64.tar.gz
tar -xf google-cloud-cli-443.0.0-linux-x86_64.tar.gz
./google-cloud-sdk/install.sh --command-completion=true --path-update=true --quiet
source ~/.bashrc

gcloud auth activate-service-account view-bucket@project.iam.gserviceaccount.com --key-file=view-bucket.json

SCRIPTPATH=$(dirname &amp;quot;$(readlink -f $0)&amp;quot;)
chmod u+x update-cert.sh

echo &amp;quot;30 1 * * 1 root /bin/bash ${SCRIPTPATH}/update-cert.sh&amp;quot; &amp;gt;&amp;gt; /etc/crontab
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/31037279/gcloud-command-not-found-while-installing-google-cloud-sdk&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud command not found - while installing Google Cloud SDK&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sdk/docs/install-sdk&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;install Google Cloud CLI&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://andy6804tw.github.io/2020/07/21/linux-shell-script/#%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%B3%95&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; [Shell Script] åŸ·è¡Œshæª”æ¡ˆæç¤ºPermission denied&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://linux.vbird.org/linux_basic/centos7/0430cron.php&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç¬¬åäº”ç« ã€ä¾‹è¡Œæ€§å·¥ä½œæ’ç¨‹(crontab)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/164.gcloud install by bash/" />
        </entry>
        <entry>
            <title>
                161. GKEåˆ©ç”¨pubsubé€šçŸ¥è¨Šæ¯åˆ°discord
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/161. GKEåˆ©ç”¨pubsubé€šçŸ¥è¨Šæ¯åˆ°discord/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ¬ä¾†ä»¥çˆ²ä¸éœ€è¦ï¼Œä½†GKEæœ‰æ™‚å°±æœƒå¹«ä½ å‡ç´šmasterçš„ç‰ˆæœ¬ï¼Œ&lt;br /&gt;
ç¥ä¸çŸ¥é¬¼ä¸è¦ºï¼Œå°±ç®—ç”¨éœæ…‹ç‰ˆæœ¬ä¹Ÿæ˜¯ã€‚&lt;br /&gt;
é›–ç„¶æ˜¯ä¸æœƒå½±éŸ¿åˆ°ç·šä¸Šæœå‹™ï¼Œ&lt;br /&gt;
ä½†é‚„æ˜¯æœ€å¥½çŸ¥é“ä¸€ä¸‹æ˜¯ä»€éº¼æ™‚å€™å‡ç´šçš„ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Pub/Subå»ºç«‹ä¸€å€‹ä¸»é¡Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/161-fig.1.jpg&quot; alt=&quot;161-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;GKEçš„å¢é›†è¨­å®šé–‹å•“é€šçŸ¥ï¼Œä¸¦é¸æ“‡å‰›å‰›å»ºç«‹çš„ä¸»é¡Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/161-fig.2.jpg&quot; alt=&quot;161-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å»ºç«‹Cloud Function&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/161-fig.3.jpg&quot; alt=&quot;161-fig.3.jpg&quot; /&gt;&lt;br /&gt;
ç’°å¢ƒé¸ã€ç¬¬äºŒä»£ã€ï¼Œå‡½å¼åç¨±è‡ªå·±å‘½åã€‚&lt;br /&gt;
è§¸ç™¼æ¢ä»¶ï¼Œã€å…è¨±æœªç¶“é©—è­‰çš„å«ç”¨ã€ï¼Œå†é¸æ“‡ ADD TRIGERè£é¢çš„ã€Pub/Sub triggerã€&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/161-fig.4.jpg&quot; alt=&quot;161-fig.4.jpg&quot; /&gt;&lt;br /&gt;
é¸æ“‡å‰›å‰›å»ºç«‹çš„Pub/Subä¸»é¡Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/161-fig.5.jpg&quot; alt=&quot;161-fig.5.jpg&quot; /&gt;&lt;br /&gt;
åœ¨é€£ç·šçš„åœ°æ–¹ï¼Œå¯é¸æ“‡åƒ…å…è¨±å…§éƒ¨æµé‡å³å¯ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å»ºç«‹ç¨‹å¼ç¢¼&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/161-fig.6.jpg&quot; alt=&quot;161-fig.6.jpg&quot; /&gt;&lt;br /&gt;
é¸æ“‡Go 1.20 ï¼Œé€²å…¥é»æ”¹æˆ sendDiscord&lt;br /&gt;
åŸå§‹ç¢¼åˆ°&lt;a href=&quot;https://github.com/daimom/pubsub_notify&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;pubsub notify&lt;/a&gt;è¤‡è£½ function.goçš„ç¨‹å¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¸¬è©¦&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/161-fig.7.jpg&quot; alt=&quot;161-fig.7.jpg&quot; /&gt;&lt;br /&gt;
è§¸ç™¼GKEçš„å‡ç´šå¾Œï¼Œå°±æœƒç™¼é€è¨Šæ¯åˆ°Discordä¸Šé¢ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;ç›¸é—œè³‡è¨Š&quot; tabindex=&quot;-1&quot;&gt;ç›¸é—œè³‡è¨Š&lt;/h2&gt;
&lt;h3 id=&quot;pub-sub&quot; tabindex=&quot;-1&quot;&gt;Pub/Subåƒ¹æ ¼&lt;/h3&gt;
&lt;p&gt;åœ¨æ¯å€‹æ—¥æ›†æœˆï¼Œçµç®—å¸³è™Ÿçš„Â &lt;strong&gt;Message Delivery Basic&lt;/strong&gt;Â SKU çš„å‰ 10 GiB ååé‡å…è²»&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/pubsub/pricing?hl=zh-cn#pubsub-pricing&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Pub/Sub åƒ¹æ ¼&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;pub-sub-1&quot; tabindex=&quot;-1&quot;&gt;Pub/Subæ¶æ§‹&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/161-fig.8.jpg&quot; alt=&quot;161-fig.8.jpg&quot; /&gt;&lt;br /&gt;
ref. &lt;a href=&quot;https://cloud.google.com/pubsub/docs/overview?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä»€éº¼æ˜¯ Pub/Subï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;the-request-was-not-authenticated&quot; tabindex=&quot;-1&quot;&gt;The request was not authenticated.&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;The request was not authenticated. Either allow unauthenticated invocations or set the proper Authorization header. Read more at &lt;a href=&quot;https://cloud.google.com/run/docs/securing/authenticating&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://cloud.google.com/run/docs/securing/authenticating&lt;/a&gt; Additional troubleshooting documentation can be found at: &lt;a href=&quot;https://cloud.google.com/run/docs/troubleshooting#unauthorized-client&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://cloud.google.com/run/docs/troubleshooting#unauthorized-client&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœæ²’åœ¨ ç¬¬ä¸‰æ­¥é©Ÿï¼Œé¸æ“‡ã€å…è¨±æœªç¶“é©—è­‰çš„å«ç”¨ã€ï¼Œäº‹å¾Œéœ€æ”¹åˆ°cloud runä¿®æ”¹å®‰å…¨æ€§ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/161-fig.9.jpg&quot; alt=&quot;161-fig.9.jpg&quot; /&gt;&lt;br /&gt;
å¾cloud functionçš„é€£çµåˆ°cloud run&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/161-fig.10.jpg&quot; alt=&quot;161-fig.10.jpg&quot; /&gt;&lt;br /&gt;
åˆ°å®‰å…¨æ€§ï¼Œå°‡é©—è­‰æ”¹æˆã€å…è¨±æœªç¶“é©—è­‰çš„å«ç”¨ã€ã€‚&lt;br /&gt;
å¦‚æœä½ ä»ç„¶æƒ³è¦ç”¨éœ€è¦é©—è­‰ï¼Œ&lt;br /&gt;
å¯èƒ½éœ€è¦ç ”ç©¶ä¸‹ï¼Œç›®å‰åªå…è¨±å…§éƒ¨æµé‡èª¿ç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&quot;message-published-data&quot; tabindex=&quot;-1&quot;&gt;MessagePublishedData&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://cloud.google.com/eventarc/docs/cloudevents?hl=zh-cn#pubsub_1&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;pub/sub äº‹ä»¶çš„çµ„æˆéƒ¨åˆ†&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;{
  &amp;quot;subscription&amp;quot;: &amp;quot;projects/test-project/subscriptions/my-subscription&amp;quot;,
  &amp;quot;message&amp;quot;: {
    &amp;quot;attributes&amp;quot;: {
      &amp;quot;attr1&amp;quot;:&amp;quot;attr1-value&amp;quot;
    },
    &amp;quot;data&amp;quot;: &amp;quot;dGVzdCBtZXNzYWdlIDM=&amp;quot;,
    &amp;quot;messageId&amp;quot;: &amp;quot;message-id&amp;quot;,
    &amp;quot;publishTime&amp;quot;:&amp;quot;2021-02-05T04:06:14.109Z&amp;quot;,
    &amp;quot;orderingKey&amp;quot;: &amp;quot;ordering-key&amp;quot;
  }
}
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/161. GKEåˆ©ç”¨pubsubé€šçŸ¥è¨Šæ¯åˆ°discord/" />
        </entry>
        <entry>
            <title>
                142.gcs corsè¨­å®š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/142.gcs corsè¨­å®š/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;æ¶æ§‹å¾æœ¬ä¾†çš„ NFSå…¨éƒ¨è½‰åˆ°GCSä¸Šäº†ï¼Œ&lt;br /&gt;
æ‰€ä»¥corsä¹Ÿè¦è·Ÿç€è¨­å®š&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å°‡ä¸‹é¢æª”æ¡ˆï¼Œå­˜æˆjson&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;[
    {
      &amp;quot;origin&amp;quot;: [&amp;quot;https://tester.abc.com&amp;quot;],
      &amp;quot;method&amp;quot;: [&amp;quot;GET&amp;quot;,&amp;quot;PUT&amp;quot;,&amp;quot;POST&amp;quot;,&amp;quot;HEAD&amp;quot;,&amp;quot;DELETE&amp;quot;,&amp;quot;PATCH&amp;quot;],
      &amp;quot;responseHeader&amp;quot;: [&amp;quot;Content-Type&amp;quot;, &amp;quot;DNT&amp;quot;,&amp;quot;X-CustomHeader&amp;quot;,&amp;quot;X-LANG,Keep-Alive&amp;quot;,&amp;quot;User-Agent&amp;quot;,&amp;quot;X-Requested-With&amp;quot;,&amp;quot;If-Modified-Since,Cache-Control&amp;quot;,&amp;quot;X-Api-Key,X-Device-Id&amp;quot;,&amp;quot;Access-Control-Allow-Origin&amp;quot;],
      &amp;quot;maxAgeSeconds&amp;quot;: 3600
    }
]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŸ·è¡Œï¼Œæ”¶å·¥ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gsutil cors set example_cors_file.json gs://example_bucket
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†è¦æ³¨æ„ï¼Œé€™å€‹ä¸æœƒé¦¬ä¸Šç”Ÿæ•ˆï¼Œæ„Ÿè¦ºè¦ç­‰è¶…é10åˆ†é˜ä»¥ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;~~è£œå……ï¼Œoriginä¸èƒ½ç”¨ * çš„è¬ç”¨ç¬¦è™Ÿï¼Œä¹‹å‰æ¸¬äº†æ²’æœ‰æ•ˆæœ ï¼Œ&lt;br /&gt;
æœªä¾†æœƒä¸æœƒæ”¹ä¸æ¸…æ¥šã€‚ ~~&lt;/p&gt;
&lt;p&gt;æ¸¬è©¦æ™‚ï¼Œå¯ä»¥ç”¨* ï¼Œç›´æ¥ç”¨ &lt;code&gt;origin:*&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹bucketæœ‰æ²’æœ‰è¨­å®šcorså‰‡ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gsutil cors get gs://example_bucket
or
gcloud storage buckets describe gs://example_bucket --format=&amp;quot;default(cors_config)&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/142-fig.1.jpg&quot; alt=&quot;142-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦ç”¨gcloud/apiï¼Œè«‹çœ‹ä¸‹é¢é€£çµ&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/storage/docs/using-cors?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è¨­å®šå’ŒæŸ¥çœ‹ CORS çµ„æ…‹&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;cors&quot; tabindex=&quot;-1&quot;&gt;Corsçš„å·¥ä½œåŸç†&lt;/h3&gt;
&lt;p&gt;ç•¶ç€è¦½å™¨å‘ Cloud Storage ç™¼å‡ºç°¡å–®è«‹æ±‚æ™‚ï¼Œæœƒç™¼ç”Ÿä»¥ä¸‹éç¨‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç€è¦½å™¨å°‡Â &lt;code&gt;Origin&lt;/code&gt;Â æ¨™é ­æ–°å¢åˆ°è«‹æ±‚ä¸­ã€‚&lt;code&gt;Origin&lt;/code&gt;Â æ¨™é ­åŒ…å«ç›¸æ‡‰è³‡æºï¼ˆè©²è³‡æºåœ¨å°‹æ±‚å…±äº« Cloud Storage å„²å­˜æ¡¶çš„è³‡æºï¼‰çš„ä¾†æºï¼Œä¾‹å¦‚Â &lt;code&gt;Origin:https://www.example.appspot.com&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cloud Storage å°‡è«‹æ±‚çš„ HTTP æ–¹æ³•ä»¥åŠÂ &lt;code&gt;Origin&lt;/code&gt;Â æ¨™é ­çš„å€¼èˆ‡ç›®æ¨™å„²å­˜æ¡¶çš„ CORS çµ„æ…‹ä¸­çš„&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;å’Œ&lt;strong&gt;ä¾†æº&lt;/strong&gt;è³‡è¨Šé€²è¡Œæ¯”è¼ƒï¼Œä»¥æŸ¥çœ‹æ˜¯å¦å­˜åœ¨åŒ¹é…é …ã€‚å¦‚æœå­˜åœ¨åŒ¹é…é …ï¼ŒCloud Storage å°‡åœ¨éŸ¿æ‡‰ä¸­åŒ…å«Â &lt;code&gt;Access-Control-Allow-Origin&lt;/code&gt;Â æ¨™é ­ã€‚&lt;code&gt;Access-Control-Allow-Origin&lt;/code&gt;Â æ¨™é ­åŒ…å«åˆå§‹è«‹æ±‚çš„Â &lt;code&gt;Origin&lt;/code&gt;Â æ¨™é ­çš„å€¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç€è¦½å™¨æ¥æ”¶éŸ¿æ‡‰ä¸¦æª¢æŸ¥Â &lt;code&gt;Access-Control-Allow-Origin&lt;/code&gt;Â å€¼æ˜¯å¦èˆ‡åŸå§‹è«‹æ±‚ä¸­æŒ‡å®šçš„ç¶²åŸŸåŒ¹é…ã€‚å¦‚æœå®ƒå€‘åŒ¹é…ï¼Œå‰‡è«‹æ±‚æˆåŠŸã€‚å¦‚æœå®ƒå€‘ä¸åŒ¹é…ï¼Œæˆ–è€…éŸ¿æ‡‰ä¸­ä¸å­˜åœ¨Â &lt;code&gt;Access-Control-Allow-Origin&lt;/code&gt;Â æ¨™é ­ï¼Œå‰‡è«‹æ±‚å¤±æ•—ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/142.gcs corsè¨­å®š/" />
        </entry>
        <entry>
            <title>
                141. gcsè‡ªå‹•åˆªé™¤æª”æ¡ˆ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/141. gcsè‡ªå‹•åˆªé™¤æª”æ¡ˆ/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;æœ¬ç¯‡çš„ç›®æ¨™ï¼Œæ¸¬è©¦ç”¨çš„bucketï¼Œæ¯éš”ä¸€æ®µæ™‚é–“å°±åˆªé™¤æª”æ¡ˆã€‚&lt;br /&gt;
æˆ–æ˜¯è½‰åˆ°æ›´ä¾¿å®œçš„bucketã€‚&lt;br /&gt;
å…ˆèªªå€‹æ¦‚å¿µï¼Œä¸€å€‹bucketè£é¢ï¼Œä»–çš„æª”æ¡ˆé¡å‹å¯ä»¥æ˜¯ä¸ä¸€æ¨£çš„ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä¸Šé¢é‚£å¥è©±ä¸æ‡‚çš„è©±ï¼Œç›´æ¥çœ‹åœ–å§ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/141-fig.1.jpg&quot; alt=&quot;141-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç”±æ–¼æ¯å€‹å„²å­˜é¡å‹çš„åƒ¹æ ¼ä¸ä¸€æ¨£ï¼Œé‡å¤§çš„è©±é‚„æ˜¯èƒ½çœä¸å°‘éŒ¢ã€‚&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/Price/126.%20GCP%20%E7%A1%AC%E7%A2%9F%E8%B2%BB%E7%94%A8%E6%AF%94%E8%BC%83/&quot;&gt;126. GCP ç¡¬ç¢Ÿè²»ç”¨æ¯”è¼ƒ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆ°bucketè£é¢é¸æ“‡ ã€ç”Ÿå‘½é€±æœŸã€-&amp;gt;æ–°å¢è¦å‰‡&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/141-fig.2.jpg&quot; alt=&quot;141-fig.2.jpg&quot; /&gt;&lt;br /&gt;
å‹•ä½œçœ‹è¦é¸æ“‡å“ªä¸€ç¨®&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/141-fig.3.jpg&quot; alt=&quot;141-fig.3.jpg&quot; /&gt;&lt;br /&gt;
é¸æ“‡æ¢ä»¶&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/141-fig.4.jpg&quot; alt=&quot;141-fig.4.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œè¨­å®šå®Œä¸æ˜¯é¦¬ä¸Šç”Ÿæ•ˆï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å°å„²å­˜æ¡¶ç”Ÿå‘½é€±æœŸçµ„æ…‹çš„æ›´æ”¹å¯èƒ½éœ€è¦é•·é” 24 å°æ™‚æ‰èƒ½ç”Ÿæ•ˆï¼Œåœ¨æ­¤æœŸé–“ï¼Œå°è±¡ç”Ÿå‘½é€±æœŸç®¡ç†å¯èƒ½ä»æœƒæ ¹æ“šèˆŠçµ„æ…‹åŸ·è¡Œæ“ä½œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¨­å®šå®Œå¾Œï¼Œå†ä¾†å°±æ˜¯ç­‰å¾…ä»–åŸ·è¡Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œå¦‚æœæœ‰å¤šå€‹è¦å‰‡çš„è©±ï¼Œ&lt;br /&gt;
ç›®å‰GCPçš„å„ªå…ˆé †åºç‚º&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœå¤šå€‹è¦å‰‡åŒæ™‚æ»¿è¶³å–®å€‹å°è±¡çš„æ¢ä»¶ï¼Œå‰‡ Cloud Storage å°‡åŸºæ–¼ä»¥ä¸‹è€ƒæ…®ï¼Œåƒ…åŸ·è¡Œèˆ‡å…¶ä¸­ä¸€å€‹è¦å‰‡é—œè¯çš„æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Delete&lt;/code&gt;Â æ“ä½œå„ªå…ˆæ–¼ä»»ä½•Â &lt;code&gt;SetStorageClass&lt;/code&gt;Â æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;å°‡å°è±¡åˆ‡æ›è‡³&lt;a href=&quot;https://cloud.google.com/storage/pricing?hl=zh-cn#storage-pricing&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;éœæ…‹å„²å­˜åƒ¹æ ¼&lt;/a&gt;æœ€ä½çš„å„²å­˜é¡åˆ¥çš„Â &lt;code&gt;SetStorageClass&lt;/code&gt;Â æ“ä½œå„ªå…ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;p.s å¦‚æœä½ ä¹Ÿè·‘å»chtGPTæå•çš„è©±ï¼Œå¯èƒ½ä¹Ÿæœƒç¢°åˆ°æˆ‘é€™å€‹ç­”æ¡ˆï¼Œä½†ç›®å‰çœ‹èµ·ä¾†GCSæ²’æœ‰æ¨™è¨˜é€™å€‹æ±è¥¿äº†ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/141-fig.5.jpg&quot; alt=&quot;141-fig.5.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/storage/docs/lifecycle?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å°è±¡ç”Ÿå‘½é€±æœŸç®¡ç†&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/141. gcsè‡ªå‹•åˆªé™¤æª”æ¡ˆ/" />
        </entry>
        <entry>
            <title>
                140. gcs æ›è¼‰domain
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/140. gcs æ›è¼‰domain/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;é€™ç¯‡æ–‡ç« è¦å®Œæˆå¾—éƒ¨åˆ†æœ‰&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å»ºç«‹LBï¼Œé€£çµåˆ°GCS&lt;/li&gt;
&lt;li&gt;è¨­å®šcloud Armorç™½åå–®&lt;/li&gt;
&lt;li&gt;Certificate Manager å¢åŠ  sslæ†‘è­‰&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h2 id=&quot;å»ºç«‹è² è¼‰å¹³è¡¡&quot; tabindex=&quot;-1&quot;&gt;å»ºç«‹è² è¼‰å¹³è¡¡&lt;/h2&gt;
&lt;p&gt;å»ºç«‹è² è¼‰å¹³è¡¡ -&amp;gt; HTTP(S) è² è¼‰å¹³è¡¡&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.1.jpg&quot; alt=&quot;140-fig.1.jpg&quot; /&gt;&lt;br /&gt;
ä¸èƒ½ç”¨å€åŸŸçš„ï¼Œå› ç‚ºå€åŸŸçš„ä¸æ”¯æ´å¾Œç«¯å€¼å€&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.2.jpg&quot; alt=&quot;140-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;h5 id=&quot;å‰ç«¯è¨­å®š&quot; tabindex=&quot;-1&quot;&gt;å‰ç«¯è¨­å®š&lt;/h5&gt;
&lt;p&gt;é€™é‚Šå»ºè­°æœ€å¥½å°±ç›´æ¥å»ºç«‹ä¸€å€‹ipï¼Œä¸è¦ç”¨è‡¨æ™‚çš„ã€‚&lt;br /&gt;
å¦‚æœé€šè¨Šå”å®šè¦ç”¨httpsï¼Œéœ€è¦è¨­å®šæ†‘è­‰ï¼Œæ‰€ä»¥é€™é‚Šå…ˆé¸æ“‡httpå°±å¥½&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.3.jpg&quot; alt=&quot;140-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;h5 id=&quot;å¾Œç«¯è¨­å®š&quot; tabindex=&quot;-1&quot;&gt;å¾Œç«¯è¨­å®š&lt;/h5&gt;
&lt;p&gt;å»ºç«‹å€¼å€&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.4.jpg&quot; alt=&quot;140-fig.4.jpg&quot; /&gt;&lt;br /&gt;
ç¬¬ä¸€å€‹ç®­é ­ï¼Œé¸æ“‡ä½ è¦å»ºç«‹çš„å€¼å€&lt;br /&gt;
ç¬¬äºŒå€‹ç®­é ­ï¼Œçœ‹è¦ä¸è¦å»ºCDN&lt;br /&gt;
ç¬¬ä¸‰å€‹ç®­é ­ï¼Œæ˜¯è¨­å®šç™½åå–®(cloud Armor)ç”¨çš„ï¼Œé€™é‚Šå…ˆä¸è¨­å®šï¼Œç­‰ç­‰ç¬¬äºŒéƒ¨åˆ†æœƒèªª&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.5.jpg&quot; alt=&quot;140-fig.5.jpg&quot; /&gt;&lt;/p&gt;
&lt;h5 id=&quot;ä¸»æ©Ÿèˆ‡è·¯å¾‘è¦å‰‡&quot; tabindex=&quot;-1&quot;&gt;ä¸»æ©Ÿèˆ‡è·¯å¾‘è¦å‰‡&lt;/h5&gt;
&lt;p&gt;é è¨­æœƒç›´æ¥é€²å…¥bucketï¼Œé€™é‚Šè¦æ³¨æ„ï¼Œè¨˜å¾—è¦å°‡bucket è¨­å®šç‚ºå…¬é–‹ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.6.jpg&quot; alt=&quot;140-fig.6.jpg&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;cloud-armor&quot; tabindex=&quot;-1&quot;&gt;è¨­å®šcloud Armor&lt;/h2&gt;
&lt;p&gt;ä¸Šä¸€éƒ¨ä»½æœ‰èªªåˆ°è¨­å®šç™½åå–®(cloud Armor)&lt;/p&gt;
&lt;p&gt;ç¶²è·¯å®‰å…¨æ€§-&amp;gt; Cloud Armor&lt;br /&gt;
é€™é‚Šè¦å¢åŠ çš„è¨­å®šæ˜¯ Edge å®‰å…¨æ€§æ”¿ç­–ï¼Œä¸æ˜¯å¾Œç«¯å®‰å…¨æ€§æ”¿ç­–ï¼Œ&lt;br /&gt;
å› ç‚ºåªæœ‰edgeå®‰å…¨æ€§æ”¿ç­–æ”¯æ´å¾Œç«¯å„²å­˜åˆ†å€&lt;br /&gt;
ref. &lt;a href=&quot;https://cloud.google.com/armor/docs/security-policy-overview?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®‰å…¨æ”¿ç­–çš„é¡å‹&lt;/a&gt;ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.8.jpg&quot; alt=&quot;140-fig.8.jpg&quot; /&gt;&lt;br /&gt;
æ–°å¢çš„æ™‚å€™ï¼Œé¸æ“‡ Edgeå®‰å…¨æ€§æ”¿ç­–ï¼Œå¦‚æœæ²’çœ‹åˆ°é€™å€‹é¸é …ï¼Œ&lt;br /&gt;
ä½ å¯èƒ½å·²ç¶“é€²åˆ°æ”¿ç­–è£é¢çš„è¦å‰‡äº†ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.9.jpg&quot; alt=&quot;140-fig.9.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å»ºç«‹å®Œæˆå¾Œï¼Œå¯ä»¥å¾ç›®æ¨™å»æ–°å¢è¦æ–°å¢çš„å°è±¡ï¼Œæˆ–æ˜¯åˆ°è² è¼‰å¹³è¡¡é‚£é‚Šåšä¿®æ”¹ã€‚&lt;/p&gt;
&lt;h5 id=&quot;cloud-armor-1&quot; tabindex=&quot;-1&quot;&gt;cloud armor ç›®æ¨™æ–°å¢&lt;/h5&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.10.jpg&quot; alt=&quot;140-fig.10.jpg&quot; /&gt;&lt;br /&gt;
é¸æ“‡ã€è² è¼‰å¹³è¡¡å™¨å¾Œç«¯å€¼å€ã€ï¼Œå†é¸æ“‡ä½ çš„bucket&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.11.jpg&quot; alt=&quot;140-fig.11.jpg&quot; /&gt;&lt;/p&gt;
&lt;h5 id=&quot;è² è¼‰å¹³è¡¡å™¨ä¿®æ”¹&quot; tabindex=&quot;-1&quot;&gt;è² è¼‰å¹³è¡¡å™¨ä¿®æ”¹&lt;/h5&gt;
&lt;p&gt;å¾Œç«¯è¨­å®š -&amp;gt; ä¿®æ”¹&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.12.jpg&quot; alt=&quot;140-fig.12.jpg&quot; /&gt;&lt;br /&gt;
ç®­é ­è™•é¸æ“‡å‰›å‰›æ–°å¢çš„ cloud armorè¦å‰‡&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.13.jpg&quot; alt=&quot;140-fig.13.jpg&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;certificate-manager&quot; tabindex=&quot;-1&quot;&gt;Certificate Manager æ–°å¢æ†‘è­‰&lt;/h2&gt;
&lt;p&gt;sslæ†‘è­‰ï¼Œåœ¨GCPä¸Šé¢æ˜¯å¯ä»¥ç›´æ¥å¹«ä½ ç®¡ç†çš„ã€‚&lt;br /&gt;
é›–ç„¶ä¸æ”¯æ´ Wildcard SSL Certificate&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.14.jpg&quot; alt=&quot;140-fig.14.jpg&quot; /&gt;&lt;br /&gt;
æ†‘è­‰åˆ†æˆè‡ªå·±ç®¡ç†èˆ‡googleä»£ç®¡ï¼Œ&lt;br /&gt;
è‡ªå·±ç®¡ç†ï¼Œæ™‚é–“åˆ°å°±è¦è‡ªå·±ä¸Šå‚³æ–°çš„æ†‘è­‰ã€‚&lt;br /&gt;
googleç®¡ç†ï¼Œä¸ç”¨ç®¡ï¼Œæ™‚é–“åˆ°æœƒè‡ªå·±å±•å»¶ï¼Œå‰ææ˜¯ä½ å¿…é ˆè¦æœ‰è©²domainã€‚&lt;br /&gt;
é¸æ“‡googleä»£ç®¡çš„æ†‘è­‰ï¼Œè¼¸å…¥è¦ç®¡ç†çš„domain&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.15.jpg&quot; alt=&quot;140-fig.15.jpg&quot; /&gt;&lt;br /&gt;
å„²å­˜å¾Œï¼Œå›åˆ°ç•«é¢æ‡‰è©²æœƒçœ‹åˆ°æ­£åœ¨ä½ˆå»ºä¸­(PROVISIONING)ï¼Œ&lt;br /&gt;
é€™å€‹éœ€è¦ä¸€é»æ™‚é–“ï¼Œæœ€ä¹…å¯èƒ½è¦åˆ°60 åˆ†&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.16.jpg&quot; alt=&quot;140-fig.16.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œåˆ°dnsä¼ºæœå™¨ä¸Šé¢ç¶å®šdomainè·Ÿipäº†ï¼Œ&lt;br /&gt;
æˆ‘æ˜¯ä½¿ç”¨cloudflareï¼Œå°±ä¸æˆªåœ–äº†ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/load-balancing/docs/ssl-certificates/google-managed-certs?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨ Google ç®¡ç†çš„ SSL è­‰æ›¸&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¨­å®šå¥½äº†ä»¥å¾Œï¼Œå›åˆ°è² è¼‰å¹³è¡¡çš„å‰ç«¯è¨­å®š&lt;br /&gt;
ç¬¬ä¸€å€‹ç®­é ­ï¼Œå¯ä»¥é¸æ“‡è·Ÿä¸Šé¢ä¸€æ¨£çš„ipï¼ˆä½†ä½ å¿…é ˆå…ˆå¹«ä»–å»ºç«‹ï¼‰&lt;br /&gt;
ç¬¬äºŒå€‹ç®­é ­ï¼Œé¸æ“‡å‰›å‰›æ–°å¢çš„sslæ†‘è­‰ï¼Œè¨˜å¾—ä¸€å®šè¦æ–°å¢ï¼Œ&lt;br /&gt;
ä¸ç„¶æˆ‘å¡äº†ä¸‰å€‹å¤šå°æ™‚é‚„æ²’éƒ¨ç½²å®Œã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.17.jpg&quot; alt=&quot;140-fig.17.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/certificate-manager/docs/deploy?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;éƒ¨ç½²æ¦‚è¦½&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;ç¶œåˆè¨­å®š&quot; tabindex=&quot;-1&quot;&gt;ç¶œåˆè¨­å®š&lt;/h2&gt;
&lt;p&gt;å‡è¨­æœ‰ä¸€å€‹æƒ…å¢ƒæ˜¯å¸Œæœ›domainå¾Œé¢ä¸€å®šè¦æœ‰filesæ‰èƒ½çœ‹åœ–çš„è©±ï¼Œ&lt;br /&gt;
éœ€è¦ç”¨åˆ°ã€é€²éšå‹ä¸»æ©Ÿèˆ‡è·¯å¾‘è¦å‰‡(ç¬¬ä¸€å€‹ç®­é ­)ã€&lt;br /&gt;
ç¬¬äºŒå€‹ç®­é ­è¨­å®šdomain&lt;br /&gt;
ç¬¬ä¸‰å€‹ç®­é ­æ–°å¢æ–°çš„è·¯å¾‘è¦å‰‡&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.7.jpg&quot; alt=&quot;140-fig.7.jpg&quot; /&gt;&lt;br /&gt;
è·¯å¾‘å‰ç½®å­—ä¸²é‡æ–°ç·¨å¯«ï¼Œå°‡/filesè½‰æˆ / è¨ªå•bucket&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/140-fig.18.jpg&quot; alt=&quot;140-fig.18.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–è¦æ³¨æ„ï¼Œç”±æ–¼æ¯å€‹è¦å‰‡éƒ½æœ‰ä¸€æ¢é è¨­çš„æ¢ä»¶ï¼Œ&lt;br /&gt;
ã€ä»»ä½•ä¸ç›¸ç¬¦åˆçš„é …ç›®ã€ï¼Œé€™å€‹å¯ä»¥é¸æ“‡è¦ä¸è¦å°è½‰åˆ°å…¶ä»–ç¶²ç«™ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/140. gcs æ›è¼‰domain/" />
        </entry>
        <entry>
            <title>
                135. gsutilæ•´æ‰¹è¤‡è£½
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/135. gsutilæ•´æ‰¹è¤‡è£½/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;å¹«å¾Œç«¯æ”¹åœ–ç‰‡ä¸Šå‚³çš„æ¶æ§‹ï¼Œç›´æ¥æŠŠGCE(Google Compute Engine)çš„æ©Ÿå™¨æ”¹æˆç”¨GCSï¼ˆGoogleCloudStorageï¼‰ï¼Œæ‰€ä»¥è¦æŠŠGCEçš„åœ–æ¬åˆ°GCSã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆè¦ç”¨åˆ°çš„æ˜¯ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/135.%20gsutil%E6%95%B4%E6%89%B9%E8%A4%87%E8%A3%BD/&quot;&gt;é—œé–‰sshé€£ç·šå¾Œï¼Œä»å¯åŸ·è¡Œç¨‹å¼&lt;/a&gt; ï¼Œä¸ç„¶ç”¨gcloud é€£ç·šæ™‚é–“éä¹…æ˜¯æœƒè¢«åˆ‡æ–·é€£ç·šçš„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;1&quot; tabindex=&quot;-1&quot;&gt;æƒ…å¢ƒ 1  æ•´æ‰¹è³‡æ–™å¤¾&lt;/h3&gt;
&lt;p&gt;å°‡nfsè³‡æ–™å¤¾è£é¢çš„æ‰€æœ‰æª”æ¡ˆ/è³‡æ–™å¤¾è¤‡è£½åˆ°bucketè£é¢ï¼Œ&lt;br /&gt;
-m æ˜¯å¤šå·¥ï¼Œ-r æ˜¯è¤‡è£½åº•ä¸‹è³‡æ–™å¤¾çš„æª”æ¡ˆ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gsutil  -m rsync -r nfs gs://systemfile-stage/
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/storage/docs/gsutil/commands/rsync&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gsutil rsync &lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;2&quot; tabindex=&quot;-1&quot;&gt;æƒ…å¢ƒ2 ï¼Œè¤‡è£½ç‰¹å®šè³‡æ–™å¤¾&lt;/h3&gt;
&lt;p&gt;éœ€è¦å…ˆå»ºç«‹ä¸€å€‹æ–‡å­—æª”ï¼Œå°‡è³‡æ–™å¤¾åç¨±å¯«å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rsync.txt

20220201
20220301
20220310
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;while read p;
do
  folder=$(echo &amp;quot;$p&amp;quot;);
  gsutil rsync -r nfs/$p gs://systemfile-stage/$p/
done &amp;lt; rsync.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;3&quot; tabindex=&quot;-1&quot;&gt;æƒ…å¢ƒ3ï¼Œè¤‡è£½ç‰¹å®šåœ–ç‰‡&lt;/h3&gt;
&lt;p&gt;é€™é‚Šåªèƒ½æ ¹æ“šä½ çš„ä¾†æºéš¨æ©Ÿæ‡‰è®Šäº†ï¼Œ&lt;br /&gt;
æˆ‘çš„æ–‡ä»¶æ ¼å¼ç‚º&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;keepfile.csv

&amp;quot;files/20230217/104abc69-e612-4b6c-abe4-52b91b79562f.jpg&amp;quot;,&amp;quot;17/2/2023 19:27:46.79&amp;quot;
&amp;quot;files/20230217/7a30d9eb-5e7c-4eb8-93c9-a72e5bd74f78.jpg&amp;quot;,&amp;quot;17/2/2023 19:28:47.56&amp;quot;
&amp;quot;files/20230217/ea81d738-ff0c-416a-b6d9-3520fda8f0ed.jpg&amp;quot;,&amp;quot;17/2/2023 19:32:47.44&amp;quot;
&amp;quot;files/20230217/7a7e1c75-4bec-4831-9a58-fa9650a82df1.jpg&amp;quot;,&amp;quot;17/2/2023 19:33:24.94&amp;quot;
&amp;quot;files/20230217/cf495ecb-71a9-4d46-95f4-b051f260523a.jpg&amp;quot;,&amp;quot;17/2/2023 19:33:49.4&amp;quot;
&amp;quot;files/20230217/eb05163b-bc0f-4e3b-96d5-82b0bb4f3a8d.jpg&amp;quot;,&amp;quot;17/2/2023 19:34:41.463&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œè¦æ”¹è®€csvçš„æ ¼å¼ï¼Œç„¶å¾Œå°‡è·¯å¾‘èˆ‡æª”æ¡ˆåç¨±æ‹†é–‹ï¼Œ&lt;br /&gt;
æœ€å¾Œæ‰è¤‡è£½åœ–ç‰‡éå»ã€‚ä½†é€™å€‹éæˆçœŸçš„ä¹…ï¼Œ&lt;br /&gt;
å¦‚æœå¯ä»¥æœ€å¥½æ˜¯ç”¨rsyncè¤‡è£½è³‡æ–™å¤¾å§ã€‚&lt;/p&gt;
&lt;p&gt;$fileçš„è®Šæ•¸ï¼Œæ‹†è§£å‡ºä¾†æœ‰&amp;quot; ï¼Œæ‰€ä»¥åˆç”¨äº†&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/133.%20shell%20script%E5%AD%97%E4%B8%B2%E8%99%95%E7%90%86/&quot;&gt;133. shell scriptå­—ä¸²è™•ç†&lt;/a&gt;çš„æ–¹å¼ï¼Œå°‡&amp;quot;åˆªé™¤ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;while IFS=&amp;quot;,&amp;quot; read -r path date
do
  folder=$(echo &amp;quot;$path&amp;quot; | awk -F &#39;/&#39; &#39;{print $2}&#39;);
  file=$(echo &amp;quot;$path&amp;quot; | awk -F &#39;/&#39; &#39;{print $3}&#39;);
  gsutil cp -n nfs/$folder/${file%*&#92;&amp;quot;} gs://systemfile-stage/$folder/
done &amp;lt; keepfile-sort.csv
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.baeldung.com/linux/csv-parsing&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How to Parse a CSV File in Bash&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/storage/docs/gsutil/commands/cp&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gsutil cp&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/135. gsutilæ•´æ‰¹è¤‡è£½/" />
        </entry>
        <entry>
            <title>
                130. Google IAP sshå¤±æ•—
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/130. Google IAP sshå¤±æ•—/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;ç‚ºä»€éº¼æœƒç™¼ç”Ÿï¼Œä¿ºä¸çŸ¥é“ã€‚&lt;br /&gt;
ä½†å¥½åƒæ˜¯å¥½ä¹‹å‰ç¡¬ç¢Ÿç©ºé–“ä¸å¤ ï¼Œæˆ‘ç äº†è³‡æ–™å¤¾çš„é—œä¿‚...&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å…ˆçœ‹å€‹éŒ¯èª¤è¨Šæ¯&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/130-fig.1.jpg&quot; alt=&quot;130-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ¬Šé™æˆæ¬Šå¤±æ•—ï¼Œä¸€èˆ¬ä½¿ç”¨sshé€£ç·šçš„è©±ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯serverçš„ssh keyå‡ºå•é¡Œ&lt;br /&gt;
å¯ä»¥å…ˆåƒè€ƒ&lt;a href=&quot;https://medium.com/%E4%B8%80%E5%80%8B%E5%B0%8F%E5%B0%8F%E5%B7%A5%E7%A8%8B%E5%B8%AB%E7%9A%84%E9%9A%A8%E6%89%8B%E7%AD%86%E8%A8%98/gcp-%E9%81%87%E5%88%B0permission-denied-publickey-%E6%80%8E%E9%BA%BC%E8%BE%A6-e41e26ebdf47&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; [GCP]é‡åˆ°permission denied (publickey)æ€éº¼è¾¦ï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘æ‰å›æƒ³èµ·ï¼Œä¹‹å‰æˆ‘å¥½åƒå»ç éè³‡æ–™å¤¾ã€‚&lt;br /&gt;
æ‰€ä»¥å…ˆå¼„sshèƒ½å¤ ç›´é€£GCEçš„æ©Ÿå™¨ï¼Œå†ä¾†ç´°çœ‹è£é¢çš„ç‹€æ³ã€‚&lt;/p&gt;
&lt;h3 id=&quot;ssh&quot; tabindex=&quot;-1&quot;&gt;SSHè§£æ³•&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å»ºç«‹ssh key&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;ssh-keygen -C &amp;quot;ezio&amp;quot; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šä½¿ç”¨ezioç•¶ä½œåç¨±&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;
&lt;p&gt;è¤‡è£½ public key&lt;br /&gt;
å°‡ &lt;code&gt;~/.ssh/id_rsa.pub&lt;/code&gt;çš„å…§å®¹è¤‡è£½&lt;br /&gt;
æœ‰ .pubçš„æ˜¯å…¬é‘°  ï¼Œæ²’æœ‰çš„æ˜¯ ç§é‘°&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è²¼ä¸Šå…¬é‘°&lt;br /&gt;
åˆ°GCEçš„VMåŸ·è¡Œå€‹é«”å…§ï¼Œå°‡å‰›å‰›å–å¾—çš„å…¬é‘°è²¼åˆ° ã€å®‰å…¨æ®¼å±¤é‡‘é‘°ã€&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/130-fig.2.jpg&quot; alt=&quot;130-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›´æ¥ç”¨sshé€£ç·š&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	ssh ezio@32.12.32.12
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸€èˆ¬åˆ°é€™é‚Šå°±çµæŸäº†ï¼Œä½†ä»Šå¤©çš„ä¸»é¡Œæ˜¯ç”¨IAPç„¡æ³•ç™»å…¥ã€‚&lt;br /&gt;
æ›´è©³ç´°çš„ssh ç”¨æ³•ï¼Œè«‹åƒè€ƒä¸‹åˆ—ç¶²å€&lt;br /&gt;
ref.&lt;br /&gt;
- &lt;a href=&quot;https://dotblogs.com.tw/as15774/2018/04/30/174737&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;### [Git] å¤šå€‹SSH Keyèˆ‡å¸³è™Ÿçš„è¨­å®š(Mac) &lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://xenby.com/b/220-%E6%95%99%E5%AD%B8-%E7%94%A2%E7%94%9Fssh-key%E4%B8%A6%E4%B8%94%E9%80%8F%E9%81%8Ekey%E9%80%B2%E8%A1%8C%E5%85%8D%E5%AF%86%E7%A2%BC%E7%99%BB%E5%85%A5&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; [æ•™å­¸] ç”¢ç”ŸSSH Keyä¸¦ä¸”é€éKEYé€²è¡Œå…å¯†ç¢¼ç™»å…¥&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;iap&quot; tabindex=&quot;-1&quot;&gt;IAPè§£æ³•&lt;/h3&gt;
&lt;p&gt;èƒ½é€£é€²å»äº†ï¼Œçµ‚æ–¼ç¢ºå®šè£é¢æ²’æœ‰æˆ‘ä¹‹å‰çš„è³‡æ–™å¤¾ã€‚&lt;br /&gt;
æ‰€ä»¥æ‡‰è©²æ˜¯é€™æ¨£å°è‡´ç„¡æ³•ç™»å…¥ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç„¶å¾ŒæŸ¥äº†ä¸€ä¸‹ç›®å‰çš„ä½¿ç”¨è€…å¸³è™Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cat /etc/passwd | awk -F: &#39;{print $1}&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ‰æˆ‘mailçš„ä½¿ç”¨è€…å¸³è™Ÿï¼Œ&lt;br /&gt;
ç„¶å¾Œåˆªé™¤ï¼ï¼ï¼&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;userdel -r daimom
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ä¾†è©¦è©¦ï¼Œç”¨IAPç™»å…¥ï¼Œçœ‹èƒ½ä¸èƒ½åœ¨VMä¸Šé¢é‡å»ºä¸€å€‹ä½¿ç”¨è€…&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute ssh --tunnel-through-iap  --project sms --zone asia-east1-b test-service01
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‚„æ˜¯åŒæ¨£çš„æ¬Šé™å¤±æ•—ã€‚&lt;/p&gt;
&lt;p&gt;æœ€å¾Œï¼Œåœ¨GCEçš„è¨­å®šç•«é¢ï¼Œå°‡æœ¬ä¾†çš„å®‰å…¨æ®¼å±¤é‡‘é‘°åˆªæ‰ï¼Œå¼·è¿«é‡å»ºï¼Œ&lt;br /&gt;
çµ‚æ–¼èƒ½é€£äº†&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/130-fig.3.jpg&quot; alt=&quot;130-fig.3.jpg&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/130. Google IAP sshå¤±æ•—/" />
        </entry>
        <entry>
            <title>
                13.é¨°è¨Šé›²é€£æ¥GOOGLEé›²
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/13.é¨°è¨Šé›²é€£æ¥GOOGLEé›²/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;åˆåœ¨ææ–°çš„æ±è¥¿äº†ï¼Œé€™æ¬¡è¦æŠŠé¨°è¨Šé›²ï¼ˆTKEï¼‰è·ŸGoogleé›²ï¼ˆGCPï¼‰ï¼ŒåšVPNå°é€£ï¼Œ&lt;br /&gt;
é€™æ¬¡ä¸€æ¨£åˆå¼„äº†å¹¾å¤©....æœ€å¾Œé‚„æ˜¯æ‰¾äº†GOOGLEå·¥ç¨‹å¸«å”åŠ©ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä¸‹é¢çš„æ­¥é©Ÿï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯TKEè·ŸGCPï¼Œäº’ç›¸åˆ‡æ›è¨­å®šã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é¨°è¨Šé›²è¨­å®šç¶²é—œIP&lt;br /&gt;
ç§æœ‰ç¶²è·¯-&amp;gt; VPNé€£æ¥-&amp;gt;VPNç¶²é—œ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;!&lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;13.fig-1.jpg&lt;/a&gt;&lt;br /&gt;
å…§å®¹å°±ç…§æƒ³è¼¸å…¥çš„æ‰“ï¼Œè¼¸å…¥å®Œæˆå¾Œæœƒçœ‹åˆ°å…¬ç¶²IPï¼Œç‚ºäº†æ–¹ä¾¿æºé€šï¼Œå°±ç¨±å‘¼ä»–ç‚ºTKEçš„é–˜é“IPã€‚&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;GCPè¨­å®šVPNé–˜é“&lt;br /&gt;
é€™é‚Šçš„é¸é …æ¯”è¼ƒç¹ç‘£ï¼Œå› ç‚ºé¨°è¨Šé›²ä¸æ”¯æ´IKEv2ï¼ŒåŒæ™‚ä¹Ÿä¸æ”¯æ´BGPçš„å”å®šï¼Œ&lt;br /&gt;
æ‰€ä»¥Googleè¦ä½¿ç”¨å‚³çµ±VPNã€‚&lt;br /&gt;
é«˜å¯ç”¨æ€§çš„VPNæœ‰äº›è¦æ±‚æ‰èƒ½ä½¿ç”¨ï¼Œè«‹åƒè€ƒ&lt;a href=&quot;https://cloud.google.com/network-connectivity/docs/vpn/how-to/moving-to-ha-vpn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è½‰ç‚ºé«˜å¯ç”¨æ€§ VPN&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.fig-2.jpg&quot; alt=&quot;13.fig-2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.fig-2.jpg&quot; alt=&quot;13.fig-2.jpg&quot; /&gt;&lt;br /&gt;
å¾Fig.3 æœ‰é€£çµå¯ä»¥åˆ‡åˆ° å‚³çµ±VPNè¨­å®šï¼Œ&lt;br /&gt;
å†ä¾†çµ‚æ–¼è¦é–‹å§‹è¨­å®šGCPé–˜é“IPäº†ã€‚&lt;br /&gt;
å»ºç«‹IPï¼Œé€™é‚Šå»ºç«‹çš„å°±æ˜¯GCPçš„é–˜é“ipï¼Œé€™çµ„å°±æ˜¯è¦èˆ‡ TKEçš„é–˜é“IP å°è¯çš„IPã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.%20fig-4.jpg&quot; alt=&quot;13. fig-4.jpg&quot; /&gt;&lt;br /&gt;
å…¶ä»–çš„é¸é …ï¼Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åç¨±ï¼š è‡ªå¡«&lt;/li&gt;
&lt;li&gt;ç¶²è·¯ï¼š VPN è¦é€£çµçš„ Compute Engine ç¶²è·¯&lt;/li&gt;
&lt;li&gt;å€åŸŸï¼š é€£çµè‡³ Compute Engine ç¶²è·¯çš„é–˜é“æ‰€åœ¨åœ°å€&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;GCPçš„é€šé“è¨­å®š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.%20fig-5.jpg&quot; alt=&quot;13. fig-5.jpg&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åç¨±ï¼š éš¨æ„&lt;/li&gt;
&lt;li&gt;é ç«¯å°ç­‰äº’é€£IPï¼š TKEçš„é–˜é“IP&lt;/li&gt;
&lt;li&gt;IKEç‰ˆæœ¬ï¼šé€™é‚Šé¸ IKEv1&lt;/li&gt;
&lt;li&gt;IKEé å…ˆå…±ç”¨é‡‘é‘°ï¼š å¯ä»¥è‡ªè¡Œè¼¸å…¥ æˆ–æ˜¯ ç”±ç³»çµ±ç”¢ç”Ÿï¼Œä½†è¦æ³¨æ„é¨°è¨Šé›²ä¸æ”¯æ´ ç‰¹æ®Šç¬¦è™Ÿï¼ˆ. / ä¹‹é¡çš„ï¼‰ï¼Œ&lt;br /&gt;
æ‰€ä»¥è¦æ³¨æ„è‡ªè¡Œç”¢ç”Ÿçš„é‡‘é‘°&lt;/li&gt;
&lt;li&gt;å°å‘é¸é …ï¼š é€™é‚Šé¸æ“‡ ã€ä¾æ“šæ”¿ç­–ã€&lt;br /&gt;
é ç«¯ç¶²è·¯ipç¯„åœï¼šè¼¸å…¥TKEçš„ç§æœ‰ç¶²è·¯ç¯„åœï¼Œå¯ä»¥å¾ã€é¨°è¨Šé›²çš„ç§æœ‰ç¶²è·¯-&amp;gt;ç§æœ‰ç¶²è·¯ã€ çœ‹åˆ° IPv4 CIDR (Fig.6)ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.%20fig-6.jpg&quot; alt=&quot;13. fig-6.jpg&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;gcp&quot; tabindex=&quot;-1&quot;&gt;GCPçš„é˜²ç«ç‰†è¨­å®š&lt;/h3&gt;
&lt;p&gt;å¯èƒ½éœ€è¦é…ç½®é˜²ç«ç‰†è¦å‰‡ï¼Œä¸ç¢ºå®šã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://cloud.google.com/network-connectivity/docs/vpn/how-to/configuring-firewall-rules&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é…ç½®é˜²ç«ç‰†è¦å‰‡&lt;/a&gt;&lt;br /&gt;
4. é¨°è¨Šé›²çš„å°ç«¯ç¶²é—œè¨­å®š&lt;br /&gt;
ç§æœ‰ç¶²è·¯-&amp;gt;VPNé€£æ¥-&amp;gt;å°ç«¯ç¶²é—œ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.%20fig-7.jpg&quot; alt=&quot;13. fig-7.jpg&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åç¨±ï¼š éš¨æ„&lt;/li&gt;
&lt;li&gt;å…¬ç¶²IP: é€™é‚Šå°±æ˜¯è¼¸å…¥ GCPçš„é–˜é“ip&lt;/li&gt;
&lt;li&gt;æ¨™ç±¤ï¼š å¯ä»¥ä¸æ‰“&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;é¨°è¨Šé›²çš„VPNé€šé“è¨­å®š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.%20fig-8.jpg&quot; alt=&quot;13. fig-8.jpg&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šé“åç¨±ï¼šéš¨æ„&lt;/li&gt;
&lt;li&gt;åœ°åŸŸï¼š é€£çµè‡³ç¶²è·¯çš„å€åŸŸ&lt;/li&gt;
&lt;li&gt;VPNç¶²é—œé¡å‹ï¼š ç§æœ‰ç¶²è·¯ã€‚ é›²è¯ç¶²æŒ‡çš„æ˜¯ é¨°è¨Šé›²å…§éƒ¨å„å€åŸŸçš„ç§æœ‰ç¶²è·¯äº’è¯(ref.&lt;a href=&quot;https://cloud.tencent.com/document/product/877/18675&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é›²è¯ç¶²ç”¢å“æ¦‚è¿°&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;ç§æœ‰ç¶²è·¯ï¼š  è«‹çœ‹(Fig.6)&lt;/li&gt;
&lt;li&gt;VPNç¶²é—œï¼š  è«‹çœ‹(Fig.1)&lt;/li&gt;
&lt;li&gt;å°ç«¯ç¶²é—œï¼š  è«‹çœ‹(Fig.7)&lt;/li&gt;
&lt;li&gt;é å…±äº«é‡‘é‘°ï¼š è«‹çœ‹(Fig.5) çš„é å…ˆå…±äº«é‡‘é‘°&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;SPDç­–ç•¥&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.fig-9.jpg&quot; alt=&quot;13.fig-9.jpg&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ¬ç«¯ç¶²æ®µï¼š è«‹çœ‹(Fig.6)&lt;/li&gt;
&lt;li&gt;å°ç«¯ç¶²æ®µï¼š è«‹çœ‹(Fig.4)çš„ç¶²æ®µ&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;7&quot;&gt;
&lt;li&gt;IKEã€IPsecé…ç½®&lt;br /&gt;
éœ€èˆ‡ä¸‹åœ–ä¸€æ‘¸ä¸€æ¨£ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.fig-10.jpg&quot; alt=&quot;13.fig-10.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/network-connectivity/docs/vpn/concepts/supported-ike-ciphers&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ”¯æŒçš„ IKE åŠ å¯†æ–¹å¼&lt;/a&gt;ï¼Œæ­¤æ–‡å…§(IKEv1 åŠ å¯†æ–¹å¼çš„ç¬¬äºŒéšæ®µï¼ŒæŒ‡çš„å°±æ˜¯ IPsecé…ç½®ï¼‰&lt;/p&gt;
&lt;h3 id=&quot;ike&quot; tabindex=&quot;-1&quot;&gt;IKE é…ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç‰ˆæœ¬ï¼š IKEv1&lt;/li&gt;
&lt;li&gt;åŠ å¯†ç®—æ³•ï¼š AES-128&lt;/li&gt;
&lt;li&gt;èªè­‰ç®—æ³•ï¼š SHA1&lt;/li&gt;
&lt;li&gt;å”å•†æ¨¡å¼ï¼š main&lt;/li&gt;
&lt;li&gt;DH group: DH2&lt;/li&gt;
&lt;li&gt;IKE SA Lifetimeï¼š 36600&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;i-psec&quot; tabindex=&quot;-1&quot;&gt;IPsec é…ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åŠ å¯†ç®—æ³•ï¼šAES-128&lt;/li&gt;
&lt;li&gt;èªè­‰ç®—æ³•ï¼šSHA1&lt;/li&gt;
&lt;li&gt;PFSï¼š DH-GROUP2&lt;/li&gt;
&lt;li&gt;IPsec sa Lifetimeï¼š10800&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;8&quot;&gt;
&lt;li&gt;çµå°¾ï¼ˆä¸ï¼Œé‚„æœ‰è·¯ç”±è¦è¨­å®šï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.fig-11.jpg&quot; alt=&quot;13.fig-11.jpg&quot; /&gt;&lt;br /&gt;
é€™é‚Šæœƒå…ˆçœ‹åˆ°VPNçš„é€šé“ç‹€æ…‹æ˜¯ å·²è¯é€šï¼Œ ä½†å¦‚æœå¯¦éš›å»Pingæ©Ÿå™¨ï¼Œæœƒç™¼ç¾é‚„æ˜¯ä¸é€šã€‚&lt;/p&gt;
&lt;ol start=&quot;9&quot;&gt;
&lt;li&gt;é¨°è¨Šé›²è·¯ç”±è¡¨è¨­å®š&lt;br /&gt;
ç§æœ‰ç¶²è·¯-&amp;gt;è·¯ç”±è¡¨-&amp;gt;é»˜èªè·¯ç”±è¡¨&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.%20fig-12.jpg&quot; alt=&quot;13. fig-12.jpg&quot; /&gt;&lt;br /&gt;
æ–°å¢è·¯ç”±ç­–ç•¥(Fig.13)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.%20fig-13.jpg&quot; alt=&quot;13. fig-13.jpg&quot; /&gt;&lt;br /&gt;
æ–°å¢è·¯ç”±(Fig.14)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–°å¢è·¯ç”±ï¼šé€™é‚Šæ˜¯å¾é¨°è¨Šé›²è¦è·³å»GCPçš„ç¶²æ®µï¼Œæ‰€ä»¥é€™é‚Šè¦è¼¸å…¥çš„æ˜¯ï¼ˆFig.9)çš„å°ç«¯ç¶²æ®µ&lt;/li&gt;
&lt;li&gt;ä¸‹ä¸€è·³é¡å‹ï¼šé¸æ“‡VPNç¶²é—œ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.%20fig-14.jpg&quot; alt=&quot;13. fig-14.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;10&quot;&gt;
&lt;li&gt;çµè«–&lt;br /&gt;
å¯èƒ½æœ‰äººæœƒæƒ³ï¼Œç‚ºä»€éº¼é¨°è¨Šé›²è¦è¨­å®šè·¯ç”±ï¼Œ&lt;br /&gt;
è€ŒGCPä¸ç”¨è¨­å®šè·¯ç”±ã€‚&lt;br /&gt;
å› ç‚ºåœ¨è¨­å®š(Fig.5)çš„æ™‚å€™ï¼Œå°±å·²ç¶“å¹«ä½ è¨­å®šå¥½äº†ã€‚&lt;br /&gt;
ä½†å¦‚æœèµ°çš„æ˜¯ ä¾æ“šè·¯å¾‘ï¼Œé‚£é€™å¡Šå°±å¿…é ˆè¦è‡ªè¡Œè¨­å®šäº†ã€‚&lt;br /&gt;
å¦‚æœæƒ³è¦çœ‹è·¯ç”±è¡¨ï¼Œå¯ä»¥åˆ°&lt;br /&gt;
GCP-&amp;gt;VPCç¶²è·¯-&amp;gt;è·¯å¾‘&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/13.fig-15.jpg&quot; alt=&quot;13.fig-15.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/network-connectivity/docs/vpn/how-to/creating-static-vpns&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨éœæ…‹è·¯ç”±å‰µå»ºå‚³çµ± VPN&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/network-connectivity/docs/vpn/concepts/choosing-networks-routing#route-alignment&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç¶²çµ¡å’Œéš§é“è·¯ç”±&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://bbs.huaweicloud.com/forum/thread-19167-1-1.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ã€VPNéŒ¦å›Šã€‘ é¨°è¨Šé›²å°æ¥è¯ç‚ºé›²é…ç½®æŒ‡å—&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://cloud.tencent.com/developer/article/1731806?s=original-sharing&amp;amp;sharedUid=7435714&amp;amp;from=10680&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é€šéVPNé€£æ¥åˆ°VPC&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://blog.gtwang.org/linux/mtr-linux-network-diagnostic-tool/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;MTRï¼šLinux ç¶²è·¯è¨ºæ–·å·¥å…·ä½¿ç”¨æ•™å­¸&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/13.é¨°è¨Šé›²é€£æ¥GOOGLEé›²/" />
        </entry>
        <entry>
            <title>
                129. nginx æ›è¼‰gcs
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/129. nginx æ›è¼‰gcs/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;ä»Šå¤©è¦ä¸ŠQAæ¸¬è©¦äº†ï¼Œç„¶å¾Œæˆ‘çªç„¶ç™¼ç¾æˆ‘ä¹‹å‰æ¸¬å®Œæ²’ç•™ä¸‹ç­†è¨˜ã€‚&lt;br /&gt;
ç¾åœ¨éƒ½å¿«å¿˜å…‰äº†ï¼Œé‚„å¥½æœ€å¾Œæœ‰æ‰¾å›è¨˜æ†¶ã€‚&lt;br /&gt;
ä¾†è£œä¸€ä¸‹äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä»Šå¤©è¦åšçš„æ˜¯æŠŠGCSè®Šæˆä¸€å€‹åœ–ç‰‡ä¸Šå‚³ç©ºé–“ï¼Œ&lt;br /&gt;
å¯ä»¥ç”¨nginxä¾†è¨ªå•ã€‚&lt;/p&gt;
&lt;div class=&quot;transclusion internal-embed is-loaded&quot;&gt;&lt;a class=&quot;markdown-embed-link&quot; href=&quot;https://daimom.github.io/gcp/8-gcs/&quot; aria-label=&quot;Open link&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; class=&quot;svg-icon lucide-link&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;div class=&quot;markdown-embed&quot;&gt;
&lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æŸå€‹æ¡ˆå­ï¼Œè¦æ•´å€‹ç¿»æ‰é‡åšï¼Œé€™æ¬¡è¦è®“VMçš„æ©Ÿå™¨è·ŸGKEçš„podèƒ½å¤ åŒæ™‚å­˜å–ä¸€å€‹å„²å­˜ç©ºé–“ï¼Œ&lt;br /&gt;
é è¨ˆä½¿ç”¨Google Cloud Storageï¼Œè¸©äº†ä¸€å€‹æ—©ä¸Šçš„å‘ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡-1&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;é è¨ˆåšå…©å€‹é …ç›®&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;åœ¨VMä¸Šé¢æ›è¼‰gcsçš„è³‡æ–™å¤¾&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨GKE ä¸Šé¢çš„podåŒæ™‚æ›è¼‰ gcsçš„è³‡æ–™å¤¾&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨VMä¸Šé¢æ›è¼‰gcsçš„è³‡æ–™å¤¾&lt;br /&gt;
å®‰è£æ–¹å¼ï¼Œç›®å‰æˆ‘çš„vmæ˜¯ RedHat æ‰€ä»¥ç”¨ä¸‹é¢çš„æ–¹å¼ï¼ŒCentOSä¹Ÿæ˜¯ç”¨åŒæ¨£çš„æ–¹å¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Configure the gcsfuse repo:&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sudo tee /etc/yum.repos.d/gcsfuse.repo &amp;gt; /dev/null &amp;lt;&amp;lt;EOF
[gcsfuse]
name=gcsfuse (packages.cloud.google.com)
baseurl=https://packages.cloud.google.com/yum/repos/gcsfuse-el7-x86_64
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg
       https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Install gcsfuse:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;  sudo yum install gcsfuse
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®Œæˆï¼Œå…¶ä»–å®‰è£æ–¹å¼ï¼Œè«‹åƒè€ƒ&lt;a href=&quot;https://github.com/GoogleCloudPlatform/gcsfuse/blob/master/docs/installing.md&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GoogleCloudPlatform/gcsfuse/install.md&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç™»å…¥ä½¿ç”¨ï¼Œ&lt;br /&gt;
é€™é‚Šå…ˆä½¿ç”¨ gcloud auth login åšæ¸¬è©¦&lt;br /&gt;
å…ˆå»ºç«‹è³‡æ–™å¤¾  mkdir upload&lt;br /&gt;
æ›è¼‰  gcsfuse my-bucket upload&lt;br /&gt;
å¸é™¤æ›è¼‰ fusermount -u upload&lt;/p&gt;
&lt;h3 id=&quot;debug&quot; tabindex=&quot;-1&quot;&gt;Debugç”¨&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;gcsfuse --foreground --debug_gcs --debug_http --debug_fuse --debug_invariants --key-file=/home/user/Downloads/my-key.json mybucket /upload
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;google-application-credentials&quot; tabindex=&quot;-1&quot;&gt;æ°¸ä¹…åŠ å…¥GOOGLE_APPLICATION_CREDENTIALSè®Šæ•¸&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;é–‹å•Ÿ /etc/profiles
æ–°å¢ export GOOGLE_APPLICATION_CREDENTIALS=&amp;quot;/home/user/Downloads/my-key.json&amp;quot;
ä¿®æ”¹æª”æ¡ˆå¾Œè¦æƒ³é¦¬ä¸Šç”Ÿæ•ˆé‚„è¦åŸ·è¡Œ#
source /etc/profileä¸ç„¶åªèƒ½åœ¨ä¸‹æ¬¡é‡é€²æ­¤ä½¿ç”¨è€…æ™‚ç”Ÿæ•ˆã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://www.itread01.com/content/1547223515.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linuxç³»çµ±ç’°å¢ƒè®Šæ•¸å’Œåˆ¥åè¨­å®šï¼ˆæ°¸ä¹…ç”Ÿæ•ˆå’Œè‡¨æ™‚ç”Ÿæ•ˆï¼‰&lt;/a&gt;&lt;br /&gt;
é™„è¨»ï¼Œjsonæª”æ¡ˆçš„å–å¾—åœ¨ IAMè§’è‰²å…§çš„æœå‹™è³¬æˆ¶&lt;br /&gt;
ref.&lt;a href=&quot;https://cloud.google.com/iam/docs/creating-managing-service-account-keys&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å‰µå»ºå’Œç®¡ç†æœå‹™å¸³è™Ÿå¯†é‘°&lt;/a&gt;ã€‚&lt;br /&gt;
æ–°å¢å®ŒGCSï¼Œè¨˜å¾—æŠŠæ¬Šé™çµ¦æœå‹™è³¬æˆ¶ã€‚è¨˜å¾—é¸æ“‡å®Œæ•´æ¬Šé™ï¼ˆFig. 1)&lt;/p&gt;
&lt;h3 id=&quot;è‡ªå‹•æ›è¼‰&quot; tabindex=&quot;-1&quot;&gt;è‡ªå‹•æ›è¼‰&lt;/h3&gt;
&lt;p&gt;æœ‰æ¬Šé™äº†å·²å¾Œï¼Œå†ä¾†å°±æ˜¯è‡ªå‹•æ›è¼‰äº†ã€‚&lt;br /&gt;
åˆ°/etc/fstabä¸Šï¼Œè¼¸å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;my_bucket /home/ezio/upload gcsfuse key_file=key/key.json,rw,user,allow_other,uid=1008,gid=1009  0 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‡é–‹æ©Ÿæ¸¬è©¦çœ‹çœ‹ï¼Œæ”¶å·¥ã€‚&lt;br /&gt;
ref.&lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/42638048/how-to-use-mount-command-in-fstab-file/42638136#42638136&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How to use mount command in fstab file&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://serverfault.com/questions/1021950/gcsfuse-automount-on-a-non-root-user&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcsfuse automount on a non root user&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;æŸ¥è©¢ç›®å‰ç™»å…¥ä½¿ç”¨è€…çš„uid è·Ÿ gid
id $(whoami)

å¦‚æœè¦çœ‹å…¨éƒ¨ä½¿ç”¨è€…çš„è©±ï¼Œ
cat /etc/passwd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;a href=&quot;http://linux.vbird.org/linux_basic/0410accountmanager/0410accountmanager-centos5.php#account_id&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux çš„å¸³è™Ÿèˆ‡ç¾¤çµ„&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;åœ¨GKE ä¸Šé¢çš„podåŒæ™‚æ›è¼‰ gcsçš„è³‡æ–™å¤¾&lt;br /&gt;
åŸºæœ¬çš„æ–¹å¼ï¼Œ&lt;br /&gt;
å…ˆè‡ªå·±ç”¢ç”Ÿä¸€å€‹ image&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;FROM golang:1.14-alpine AS build-env
ENV GO111MODULE on

# WORKDIR /å·¥ä½œåéŒ„åç¨± ç•¶å‰çš„å·¥ä½œç›®éŒ„åç¨±ï¼Œè‹¥æ˜¯ä¸å­˜åœ¨å‰‡æœƒæ–°å»ºè©²ç›®éŒ„ï¼Œ
# éœ€è¦æ³¨æ„çš„æ˜¯copyè·Ÿrunçš„æŒ‡ä»¤éƒ½æ˜¯ä»¥WORKDIRç‚ºç•¶å‰ç›®éŒ„ä¸‹å»è·‘çš„ï¼Œ
# é‹ç”¨çš„æ™‚å€™éœ€è¦æ³¨æ„ç›¸å°ä½ç½®ã€‚
WORKDIR $GOPATH/src

RUN go get -u github.com/googlecloudplatform/gcsfuse

COPY key.json .


FROM alpine:3.6
RUN apk add --no-cache ca-certificates fuse &amp;amp;&amp;amp; rm -rf /tmp/*
COPY --from=build-env /go/bin/gcsfuse /usr/local/bin
COPY --from=build-env /go/src/key.json /
WORKDIR /
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½ˆç½² Deployment&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: gcs-fuse
    version: v1
  namespace: debug
  name: gcsfuse-test
spec:
  replicas: 1
  selector:
    matchLabels:
      app: gcs-fuse
      version: v1
  template:
    metadata:
      labels:
        app: gcs-fuse
        version: v1
    spec:
      containers:
        - name: gcsfuse-test
          image: gcr.io/your-project/gcsfuse:v1.2
          # image: golang:1.14-alpine
          # command: [ &amp;quot;/bin/sh&amp;quot;, &amp;quot;-c&amp;quot;, &amp;quot;--&amp;quot; ]
          # args: [ &amp;quot;while true; do sleep 600; done;&amp;quot; ]
          securityContext:
            privileged: true
          command:
            - &amp;quot;/bin/sh&amp;quot;
            - &amp;quot;-c&amp;quot;
            - &amp;quot;while true; do mkdir /upload ; gcsfuse --key-file=key.json your-bucket /folder; sleep 600; done; &amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœè·Ÿç¾æœ‰çš„ç¨‹å¼æ•´åˆçš„è©±ï¼Œ&lt;br /&gt;
ç”±æ–¼è¦åŸ·è¡Œå¤šè¡ŒæŒ‡ä»¤ï¼Œéœ€ä½¿ç”¨shellScriptçš„æ–¹å¼åŸ·è¡ŒæŒ‡ä»¤ã€‚&lt;br /&gt;
å¯èƒ½æœƒé‡åˆ°ä¸‹åˆ—æƒ…æ³&lt;/p&gt;
&lt;h3 id=&quot;and-quot-exec-and-quot-init-sh-and-quot-permission-denied&quot; tabindex=&quot;-1&quot;&gt;&amp;quot;exec: &amp;quot;/init.sh&amp;quot;: permission denied&lt;/h3&gt;
&lt;p&gt;åœ¨Dockerfileä¸Šä¿®æ”¹æ¬Šé™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;RUN chmod +x /init.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/44687685/getting-permission-denied-in-docker-run&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;getting permission denied in docker run&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;exec-user-process-caused-and-quot-exec-format-error-and-quot&quot; tabindex=&quot;-1&quot;&gt;exec user process caused &amp;quot;exec format error&amp;quot;&lt;/h3&gt;
&lt;p&gt;æœ‰äººèªªåœ¨shçš„é ‚ç«¯åŠ ä¸Š&lt;br /&gt;
#!/bin/bash&lt;br /&gt;
ä½†æˆ‘è©¦äº†æ²’ç”¨ï¼Œåœ¨çŒœæƒ³å¯èƒ½æ˜¯alpine linuxæ²’æœ‰bashå°è‡´&lt;br /&gt;
æ‰€ä»¥æ”¹ç”¨ä¸‹é¢é€™å€‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ENTRYPOINT [&amp;quot;sh&amp;quot;,&amp;quot;/run.sh&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://stackoverflow.com/questions/42494853/standard-init-linux-go178-exec-user-process-caused-exec-format-error&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;standard_init_linux.go:178: exec user process caused â€œexec format errorâ€&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;sh-debug&quot; tabindex=&quot;-1&quot;&gt;åŸ·è¡Œshæ™‚å¡ä½ï¼Œdebugæ–¹å¼&lt;/h3&gt;
&lt;p&gt;ç”¨if elseæª¢æŸ¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;if mkdir /upload; then
    echo &amp;quot;mkdir directory! Success&amp;quot; 1&amp;gt;&amp;amp;2
    gcsfuse --key-file=key.json yellow-video /upload
else
    echo &amp;quot;Could not mkdir directory!&amp;quot; 1&amp;gt;&amp;amp;2
    exit 1
fi
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦å¤–ï¼Œæœ€å¾Œæ‰¾å‡ºä¾†åŸå› æ˜¯å› ç‚ºå…ˆåŸ·è¡Œgoçš„ç¨‹å¼ï¼Œå°è‡´å¾ŒçºŒå¡ä½ï¼Œæ‰€ä»¥å…ˆå»ºç«‹è³‡æ–™å¤¾å¾Œï¼Œå†åŸ·è¡Œgo&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://www.opencli.com/linux/shell-script-exit-on-error&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Shell Script é‡åˆ°éŒ¯èª¤æ™‚è‡ªå‹•é€€å‡ºé›¢é–‹&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/docs/authentication/getting-started&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;èº«ä»½é©—è­‰å…¥é–€&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.itread01.com/content/1547223515.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linuxç³»çµ±ç’°å¢ƒè®Šæ•¸å’Œåˆ¥åè¨­å®šï¼ˆæ°¸ä¹…ç”Ÿæ•ˆå’Œè‡¨æ™‚ç”Ÿæ•ˆï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;
 é€™ç¯‡æœ‰è¬›åˆ°å¦‚ä½•åœ¨deployæ›è¼‰GCS
é€šå¸¸å°±æ˜¯è¦å®‰è£ä¸€äº›æ±è¥¿ã€‚
&lt;p&gt;æœƒä½¿ç”¨åˆ°gcsfuseé€™å€‹æŒ‡ä»¤ï¼Œ&lt;br /&gt;
æ‰€ä»¥æˆ‘é¸æ“‡ç›´æ¥å»ºä¸€å€‹imageï¼Œ&lt;br /&gt;
ç„¶å¾Œæ›è¼‰çš„æ™‚å€™ç›´æ¥ç”¨é‚£å€‹imageå°±å¥½ã€‚&lt;/p&gt;
&lt;p&gt;gcs-download.json æ˜¯ è¦æ›è¼‰GCSç”¨çš„æ¬Šé™jsonæª”&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FROM nginx:latest
WORKDIR /app

COPY gcs-download.json .
&lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#Start&quot;&gt;#Start&lt;/a&gt; CloudStorage
RUN apt update &amp;amp;&amp;amp; apt install -y gnupg lsb-release
RUN echo &amp;quot;deb https://packages.cloud.google.com/apt gcsfuse-$(lsb_release -c -s) main&amp;quot; |  tee /etc/apt/sources.list.d/gcsfuse.list
RUN curl https://packages.cloud.google.com/apt/doc/apt-key.gpg |  apt-key add -
RUN apt-get update &amp;amp;&amp;amp; apt-get install -y gcsfuse
ENV GOOGLE_APPLICATION_CREDENTIALS=/app/gcs-download.json

WORKDIR /usr/share/nginx/html/files


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œéƒ¨ç½²çš„yamlï¼Œ&lt;br /&gt;
é€™é‚Šè¦æ³¨æ„çš„åœ°æ–¹æ˜¯&lt;br /&gt;
1.&lt;br /&gt;
nginx.conf  è¦åŠ ä¸Š user root  ï¼Œ&lt;br /&gt;
é€™æ˜¯å› çˆ²gcsæ›è¼‰è³‡æ–™å¤¾æ˜¯ç”¨rootçš„è§’è‰²ï¼Œæ‰€ä»¥å¦‚æœnginxä¸ç”¨rootå•“å‹•ï¼Œ&lt;br /&gt;
æœƒå‡ºç¾403çš„æ¬Šé™å•é¡Œã€‚&lt;br /&gt;
ref.  &lt;a href=&quot;https://www.linuxprobe.com/nginx-403-forbidden.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å››ç¨®è§£æ±ºNginxå‡ºç¾403 forbidden å ±éŒ¯çš„æ–¹æ³•&lt;/a&gt;&lt;br /&gt;
2.&lt;br /&gt;
daemon off;  é€™éƒ¨åˆ†æŒ‡çš„æ˜¯è¦è®“nginxèƒ½å¤ åœ¨å‰æ™¯åŸ·è¡Œï¼Œä¸ç„¶podæœƒä¸€ç›´é‡é–‹ã€‚&lt;br /&gt;
ref.  &lt;a href=&quot;https://www.cnblogs.com/JulianHuang/p/15753732.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;nginx -g &amp;quot;daemon off;&amp;quot; ä½ å­¸å»¢äº†å—ï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: v1
kind: ConfigMap
metadata:
  name: systemfile-nginx-config
  namespace: default
data:
  nginx.conf: |
    user  root;
    worker_processes  auto;

    error_log  /var/log/nginx/error.log notice;
    pid        /var/run/nginx.pid;


    events {
        worker_connections  1024;
    }


    http {
        include       /etc/nginx/mime.types;
        default_type  application/octet-stream;

        log_format  main  &#39;$remote_addr - $remote_user [$time_local] &amp;quot;$request&amp;quot; &#39;
                          &#39;$status $body_bytes_sent &amp;quot;$http_referer&amp;quot; &#39;
                          &#39;&amp;quot;$http_user_agent&amp;quot; &amp;quot;$http_x_forwarded_for&amp;quot;&#39;;

        access_log  /var/log/nginx/access.log  main;

        sendfile        on;
        &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#tcp_nopush&quot;&gt;#tcp_nopush&lt;/a&gt;     on;

        keepalive_timeout  65;

        &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#gzip&quot;&gt;#gzip&lt;/a&gt;  on;

        include /etc/nginx/conf.d/*.conf;
    }

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: sms-systemfile-config
  namespace: default
data:
  default.conf: |
    server {
        listen           80  default_server;
        server_name      _;
        server_tokens    off;

        index index.html;

        location /files {
            alias        /usr/share/nginx/html/files;
            autoindex    on;
        }

        location / {
            root         /usr/share/nginx/html;
            index        index.html;
        }

        error_page       500 502 503 504  /50x.html;
        location = /50x.html {
            root         /usr/share/nginx/html;
        }
    }
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: systemmanageservice-systemfile
  namespace: default
  labels:
    group: systemmanageservice
    app: systemfile
spec:
  replicas: 1
  revisionHistoryLimit: 5
  progressDeadlineSeconds: 15
  selector:
    matchLabels:
      group: systemmanageservice
      app: systemfile
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      labels:
        group: systemmanageservice
        app: systemfile
    spec:
      containers:
        - name: systemmanageservice-systemfile
          image: gcs-nginx:0.0.2
          command:
            - /bin/bash
            - &#39;-c&#39;
            - &amp;gt;-
              gcsfuse systemfile-qa /usr/share/nginx/html/files &amp;amp;&amp;amp; nginx -g
              &amp;quot;daemon off;&amp;quot;;
          imagePullPolicy: Always # IfNotPresent, Always, Never
          securityContext:
            privileged: true
          ports:
            - name: http
              containerPort: 80
              protocol: TCP
          resources: {}
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
            - name: config-volume
              mountPath: /etc/nginx/conf.d/default.conf
              subPath: default.conf
              readOnly: true
            - name: nginx-config-volume
              mountPath: /etc/nginx/nginx.conf
              subPath: nginx.conf
              readOnly: true              
      volumes:
        - name: config-volume
          configMap:
            name: sms-systemfile-config
            items:
              - key: default.conf
                path: default.conf
            defaultMode: 420
        - name: nginx-config-volume
          configMap:
            name: systemfile-nginx-config
            items:
              - key: nginx.conf
                path: nginx.conf
            defaultMode: 420
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      terminationGracePeriodSeconds: 30
      schedulerName: default-scheduler
      securityContext: {}

&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/129. nginx æ›è¼‰gcs/" />
        </entry>
        <entry>
            <title>
                128. è§£æ±º the gcp auth plugin is deprecated in v1.22+
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/128. è§£æ±º the gcp auth plugin is deprecated in v1.22+/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;æ¯æ¬¡ä¸‹kubectlçš„æŒ‡ä»¤ç¸½æœƒè·³é€™å€‹éŒ¯èª¤å‡ºä¾†ï¼Œ&lt;br /&gt;
ä¸è™•ç†ä¹Ÿæ²’ä»€éº¼äº‹ï¼Œä½†å°±æ˜¯éƒ½æœƒå‡ºç¾ã€‚&lt;br /&gt;
ä»Šå¤©...å°±è§£æ±ºå§&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;è­¦å‘Šè¨Šæ¯é€šå¸¸æ˜¯é€™æ¨£ï¼Œ&lt;br /&gt;
ä½†ä½ deployçš„æœå‹™éƒ½é‚„æ˜¯æœƒè·‘ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;WARNING: the gcp auth plugin is deprecated in v1.22+, unavailable in v1.26+; use gcloud instead.&lt;br /&gt;
To learn more, consult &lt;a href=&quot;https://cloud.google.com/blog/products/containers-kubernetes/kubectl-auth-changes-in-gke&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://cloud.google.com/blog/products/containers-kubernetes/kubectl-auth-changes-in-gke&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é€™æ˜¯ç”±æ–¼dockeråœ¨å®‰è£çš„æ™‚å€™ï¼Œæœƒé †ä¾¿å°‡kubectlå®‰è£é€²å»ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;where kubectl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥å¾—åˆ° kubectlçš„åŸ·è¡Œæª”ä½ç½®&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;/usr/local/bin/kubectl&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æŸ¥è©¢kubectlçš„softlink ä½ç½®ï¼ŒæœƒæŸ¥åˆ°kubectlçš„å‘½ä»¤æ˜¯è·Ÿdockeré€£çµçš„ã€‚&lt;br /&gt;
é™„è¨», &lt;code&gt;ll è·Ÿ ls -la åŒæ„&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ls -la /usr/local/bin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…ˆå°‡æœ¬ä¾†çš„softlinkåˆªé™¤ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rm /usr/local/bin/kubectl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®‰è£gcloudç‰ˆæœ¬çš„kubectl&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud components install kubectl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è£å®Œå¾Œå¦‚æœé‚„ä¸èªè­˜æŒ‡ä»¤ï¼Œ&lt;br /&gt;
éœ€è¦é¡å¤–è™•ç†ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæª¢æŸ¥ä¸€ä¸‹gcloudæœ‰æ²’æœ‰å®‰è£å¥½kubectlï¼Œ&lt;br /&gt;
å¦‚æœpathæœ‰è·¯å¾‘å°±ä»£è¡¨æ­£å¸¸ï¼Œä¸ç„¶éœ€è¦é‡æ–°è£½ä½œsoftlink&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud info | grep -i kubectl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/128.fig-1.jpg&quot; alt=&quot;128.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è£½ä½œsoftlink&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ln /usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/bin/kubectl /usr/local/bin/kubectl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://blog.marsen.me/2022/06/08/2022/the_gcp_auth_plugin_is_deprecated/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[å¯¦ä½œç­†è¨˜] éŒ¯èª¤è™•ç† the gcp auth plugin is deprecated&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://stackoverflow.com/questions/51429553/how-to-set-path-to-kubectl-when-installed-using-gcloud-components-install&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How to set path to kubectl when installed using gcloud components install?&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/128. è§£æ±º the gcp auth plugin is deprecated in v1.22+/" />
        </entry>
        <entry>
            <title>
                127. fuse device not found, try &#39;modprobe fuse&#39; first
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/127. fuse device not found, try &#39;modprobe fuse&#39; first/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;ä»¥å‰ç”¨GKEæ›è¼‰gcsçš„æ™‚å€™ç™¼ç”ŸéŒ¯èª¤ï¼Œfuse device not found, try &#39;modprobe fuse&#39; firstã€‚è§£æ±ºæ–¹æ³•ã€‚&lt;br /&gt;
ç¾åœ¨GKEæœ‰äº†æ–°çš„æ›è¼‰GCSæ–¹æ³•äº†ï¼Œ&lt;a href=&quot;https://cloud.google.com/blog/products/containers-kubernetes/announcing-cloud-storage-fuse-and-gke-csi-driver-for-aiml-workloads&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Announcing Cloud Storage FUSE and GKE CSI driver for AI/ML workloads&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰æˆ‘æ²’é‡‡ç”¨æ­¤æ–¹å¼ï¼Œè«‹ä»–å€‘æ”¹ç”¨apiçš„æ–¹å¼ä¸Šå‚³æª”æ¡ˆäº†ï¼Œ&lt;br /&gt;
è¦è¨ªå•çš„è©±ï¼Œç”¨Load balancing æŒ‡å‘GCS bucketã€‚&lt;br /&gt;
é€™æ–‡ç« ç”¨æ–¹æ³•æ‡‰è©²ä¸å¤ªé©ç”¨ï¼Œ&lt;br /&gt;
è€Œä¸”æ­¤æ–¹æ³•æœ‰ç¼ºé»ï¼Œç•¶ä½ æª”æ¡ˆæ•¸é‡å¤ªå¤šæ™‚ï¼Œæœƒæ›è¼‰ä¸èµ·ä¾†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;
apt install -y gnupg lsb-release
export GCSFUSE_REPO=gcsfuse-`lsb_release -c -s`
export GCSFUSE_REPO=gcsfuse-buster
echo &amp;quot;deb https://packages.cloud.google.com/apt $GCSFUSE_REPO main&amp;quot; |  tee /etc/apt/sources.list.d/gcsfuse.list
curl https://packages.cloud.google.com/apt/doc/apt-key.gpg |  apt-key add -
apt-get update
apt-get install -y gcsfuse
export GOOGLE_APPLICATION_CREDENTIALS=/home/gcs-download.json
gcsfuse sms_backend_backup ./gcs-mount

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/127.fig-1.jpg&quot; alt=&quot;127.fig-1.jpg&quot; /&gt;&lt;br /&gt;
éœ€è¦ç”¨ç‰¹æ¬Šæ¨¡å¼&lt;br /&gt;
åœ¨yamlæª”è£é¢ï¼ŒåŠ ä¸Š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    securityContext:
      privileged: true
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/127. fuse device not found, try &#39;modprobe fuse&#39; first/" />
        </entry>
        <entry>
            <title>
                121.cloudCDNè¨­å®š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/121.cloudCDNè¨­å®š/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;ä¹‹å‰æ¸¬å®Œå¾Œå°±å¿˜äº†å¯«ï¼Œ&lt;br /&gt;
ä½†ä»Šå¤©æœ‰äººå•æˆ‘æ‰æƒ³èµ·ä¾†ï¼Œ&lt;br /&gt;
æˆ‘åˆ°åº•è·‘å»å“ªè¨­å®šçš„ï¼ï¼Ÿ&lt;br /&gt;
ç¾åœ¨è¶•ç·Šè£œä¸€ä¸‹&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å¦‚æœå·²ç¶“åœ¨GCPä¸Šé¢å»ºç«‹å¥½äº†è² è¼‰å¹³è¡¡ï¼Œ&lt;br /&gt;
é‚£å°±åˆ°å¾Œç«¯è¨­å®šï¼Œçœ‹è¦é‡å°å“ªå€‹æœå‹™å»é–‹å•“cdnå°±å¥½äº†ã€‚&lt;br /&gt;
ä¸Šé¢æœ‰å€‹é€¾æ™‚çš„è¨­å®šï¼Œçœ‹è¦è¨­å®šå¤šå°‘ï¼Œ&lt;br /&gt;
ç•¶åˆåŒäº‹æ˜¯æœ‰èªªä»–æ¸¬30ç§’å°±æœƒæ–·ç·šä¸€æ¬¡ï¼Œ&lt;br /&gt;
æ‰€ä»¥æˆ‘æœ‰æŠŠé€™é‚Šæ‹‰é•·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/121-fig.1.png&quot; alt=&quot;121-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€™é‚Šè¨­å®šå®Œå¾Œï¼Œåœ¨cloudCDNä¸Šé¢å°±æœƒå¤šä¸€å€‹è¨­å®šå‡ºä¾†ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/121-fig.2.jpg&quot; alt=&quot;121-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿèƒ½ç”¨æŒ‡ä»¤å»æŸ¥ï¼Œå•“ç”¨cdnæ™‚çš„æ¬„ä½&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get BackendConfig
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/ingress-features#timeout&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;cloudCDN&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/121.cloudCDNè¨­å®š/" />
        </entry>
        <entry>
            <title>
                120. æŒ‡ä»¤å‚™ä»½cloudSQLåŠä¸‹è¼‰
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/120. æŒ‡ä»¤å‚™ä»½cloudSQLåŠä¸‹è¼‰/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ‰äººä¸ç¿’æ…£uiæ“ä½œï¼Œ&lt;br /&gt;
åŠ ä¸Šä»–å€‘æ˜¯å…©ä¸‰å€‹æœˆç”¨ä¸€æ¬¡ï¼Œ&lt;br /&gt;
é‚£å°±ç”Ÿå€‹æŒ‡ä»¤çµ¦ä»–å€‘ç”¨å§ã€‚&lt;/p&gt;
&lt;p&gt;åšæˆè‡ªå‹•åŒ–æ‡‰è©²ä¹Ÿå¯ä»¥ï¼Œ&lt;br /&gt;
åªæ˜¯è¦çœ‹ä¸€ä¸‹æ¬Šé™è¦ç”¨èª°çš„ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä¸»è¦çš„å…©è¡ŒæŒ‡ä»¤ï¼Œè«‹å°‡è¦–è§’å¾€ä¸‹ç§»&lt;/p&gt;
&lt;ol ä¾†æº=&quot;&quot;&gt;
&lt;li&gt;
&lt;p&gt;test-db01: cloudSQLçš„instanceåç¨±&lt;br /&gt;
gs://data/desk-22-12-14.bak ï¼šè¦å­˜æ”¾cloudStorageçš„ä½ç½®&lt;br /&gt;
Desk : è³‡æ–™åº«åç¨±&lt;/p&gt;
&lt;/li&gt;
&lt;li ç›®çš„=&quot;&quot;&gt;
&lt;p&gt;gcloud storage cp &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;gcloud beta sql export bak test-db01 gs://data/desk-22-12-14.bak &#92;
--database=Desk

gcloud storage cp  gs://data/desk-22-12-14.bak /Users/daimom/Downloads
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;åŸ·è¡Œ gcloud storage cp ï¼Œå‡ºç¾error   invalid choice storage&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ›´æ–° gcloud components&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;gcloud components update
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://stackoverflow.com/questions/42916677/gcloud-beta-functions-command-says-invalid-choice-functions&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud beta functions command says &amp;quot;Invalid choice functions&amp;quot;&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;
&lt;p&gt;æ¬Šé™å•é¡Œ&lt;br /&gt;
cloudSQL å‚™ä»½æ¬Šé™&lt;br /&gt;
Cloud SQL Editor è§’è‰²å’ŒÂ &lt;code&gt;storage.objectAdmin&lt;/code&gt;Â IAM è§’è‰²&lt;br /&gt;
cloudStorageä¸‹è¼‰æ¬Šé™&lt;br /&gt;
é€™éƒ¨åˆ†å°±éœ€è¦åˆ°cloudStorageçš„bucketè¨­å®šäº†&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/sql/docs/sqlserver/import-export/import-export-bak#gcloud&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨ BAK æª”æ¡ˆåŒ¯å‡ºå’ŒåŒ¯å…¥&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/storage/docs/downloading-objects?hl=zh-cn#downloading-an-object&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¾å„²å­˜æ¡¶ä¸‹è¼‰å°è±¡&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/120. æŒ‡ä»¤å‚™ä»½cloudSQLåŠä¸‹è¼‰/" />
        </entry>
        <entry>
            <title>
                109.GCSè‡¨æ™‚ä¸‹è¼‰æ¬Šé™
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/109.GCSè‡¨æ™‚ä¸‹è¼‰æ¬Šé™/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;ä»Šå¤©ç¶­è­·ï¼Œå¾Œç«¯åŒä»è¦cloudSQLçš„å‚™ä»½æª”ï¼Œ&lt;br /&gt;
ç„¶å¾Œï¼Œå› ç‚ºä»–å€‘éƒ½æ²’æ¬Šé™ï¼Œåªå¥½ä¸Ÿå»ç¶²è·¯ç©ºé–“ï¼Œçµ¦ä»–å€‘æŠ“ã€‚&lt;br /&gt;
æˆ‘å°±åœ¨æƒ³ï¼Œæ²’é“ç†é˜¿ï¼Œæ‡‰è©²æœ‰å€‹æ–¹æ³•èƒ½å¤ é–‹ç‰¹å®šçš„æª”æ¡ˆè‡¨æ™‚çµ¦äººç”¨ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç”±æ–¼GCSçš„æ¬Šé™æ˜¯ &lt;a href=&quot;https://cloud.google.com/storage/docs/uniform-bucket-level-access&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;çµ±ä¸€å„²å­˜åˆ†å€ç´šå­˜å–æ¬Š&lt;/a&gt;ï¼Œ&lt;br /&gt;
æ‰€ä»¥ä¸èƒ½ç´°åˆ†æª”æ¡ˆæ¬Šé™çµ¦åˆ¥äººç”¨ã€‚&lt;br /&gt;
æ‰€ä»¥ï¼Œé–‹&lt;a href=&quot;https://cloud.google.com/storage/docs/access-control/signing-urls-with-helpers?hl=zh-cn&amp;amp;skip_cache=true%22&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;V4ç°½å&lt;/a&gt;ï¼Œå°±èƒ½çµ¦åˆ¥äººè¨ªå•äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; gsutil signurl -d 1m gcs-download.json gs://ai-assist-data/&amp;quot;Cloud_SQL_Export_warehouse_2022-10-12 (06:03:23)&amp;quot;.bak
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;1m è¡¨ç¤ºï¼Œåªé–‹æ”¾ä¸€åˆ†é˜çš„æ™‚é–“&lt;br /&gt;
gcs-download.jsonæ˜¯SAï¼Œå¾IAMé‚£é‚Šæ‰¾åˆ°ä¸€å€‹æœ‰æ¬Šé™ä¸‹è¼‰çš„å¸³è™Ÿç”¢ç”Ÿçš„é‡‘é‘°ã€‚&lt;br /&gt;
gs çš„ç¶²å€ï¼Œå¯ä»¥åˆ°è©³ç´°è³‡æ–™å…§å–å¾— gsutil URI&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/109-fig.1.jpg&quot; alt=&quot;â˜ï¸ GCP/109-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€™å€‹åŸ·è¡Œå¾Œï¼Œæœƒå¾—åˆ°ä¸€ä¸²&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%98%81%EF%B8%8E%20GCP/109-fig.2.jpg&quot; alt=&quot;â˜ï¸ GCP/109-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æŠŠå¾Œé¢çš„httpsè¤‡è£½ï¼Œå°±èƒ½æ‹¿ä¾†ç”¨äº†ã€‚&lt;/p&gt;
&lt;h2 id=&quot;éŒ¯èª¤è™•ç†&quot; tabindex=&quot;-1&quot;&gt;éŒ¯èª¤è™•ç†&lt;/h2&gt;
&lt;p&gt;å¦‚æœåœ¨åŸ·è¡Œsignurlçš„æ™‚å€™ç™¼ç”Ÿä»¥ä¸‹éŒ¯èª¤ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;CommandException: The signurl command requires the pyopenssl library (try pip install pyopenssl or easy_install pyopenssl)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŸ·è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pip3 install pyopenssl
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;å…¶ä»–æ–¹å¼&quot; tabindex=&quot;-1&quot;&gt;å…¶ä»–æ–¹å¼&lt;/h2&gt;
&lt;p&gt;å°‡åº•ä¸‹çš„æª”æ¡ˆè·‘éè¿´(-R)ï¼Œé€šé€šè¨­æˆpublic-read&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gsutil -m acl set -R -a public-read gs://bucket
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/109.GCSè‡¨æ™‚ä¸‹è¼‰æ¬Šé™/" />
        </entry>
        <entry>
            <title>
                0.GCP MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â˜ï¸ GCP/0.GCP MOC/</id>
            <content type="html">
                &lt;h1 id=&quot;é›²æ¶æ§‹ä¸­å¿ƒ&quot; tabindex=&quot;-1&quot;&gt;é›²æ¶æ§‹ä¸­å¿ƒ&lt;/h1&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/architecture?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;### é›²æ¶æ§‹ä¸­å¿ƒ&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;price&quot; tabindex=&quot;-1&quot;&gt;Price&lt;/h1&gt;
&lt;p&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/Price/GCP%E8%B2%BB%E7%94%A8/&quot;&gt;GCPè²»ç”¨&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/Price/GCP%20CPU%E7%94%A8%E9%80%94/&quot;&gt;GCP CPUç”¨é€”&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/Price/180.%20GCP%20%E7%9B%A3%E6%8E%A7%E8%B2%BB%E7%94%A8/&quot;&gt;180. GCP ç›£æ§è²»ç”¨&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/Price/126.%20GCP%20%E7%A1%AC%E7%A2%9F%E8%B2%BB%E7%94%A8%E6%AF%94%E8%BC%83/&quot;&gt;126. GCP ç¡¬ç¢Ÿè²»ç”¨æ¯”è¼ƒ&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;gcp&quot; tabindex=&quot;-1&quot;&gt;GCP&lt;/h1&gt;
&lt;p&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/88.%E6%89%B9%E6%AC%A1%E4%BF%AE%E6%94%B9GCP%E7%9A%84label/&quot;&gt;88.æ‰¹æ¬¡ä¿®æ”¹GCPçš„label&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/5.%20Google%20Cloud%20Function%E9%99%90%E5%88%B6/&quot;&gt;5. Google Cloud Functioné™åˆ¶&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/95.cloud%20build%E7%9A%84%E5%95%8F%E9%A1%8C/&quot;&gt;95.cloud buildçš„å•é¡Œ&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/97.%20Anthos%20%E5%88%9D%E9%AB%94%E9%A9%97/&quot;&gt;97. Anthos åˆé«”é©—&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/120.%20%E6%8C%87%E4%BB%A4%E5%82%99%E4%BB%BDcloudSQL%E5%8F%8A%E4%B8%8B%E8%BC%89/&quot;&gt;120. æŒ‡ä»¤å‚™ä»½cloudSQLåŠä¸‹è¼‰&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/121.cloudCDN%E8%A8%AD%E5%AE%9A/&quot;&gt;121.cloudCDNè¨­å®š&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/128.%20%E8%A7%A3%E6%B1%BA%20the%20gcp%20auth%20plugin%20is%20deprecated%20in%20v1.22+/&quot;&gt;128. è§£æ±º the gcp auth plugin is deprecated in v1.22+&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/161.%20GKE%E5%88%A9%E7%94%A8pubsub%E9%80%9A%E7%9F%A5%E8%A8%8A%E6%81%AF%E5%88%B0discord/&quot;&gt;161. GKEåˆ©ç”¨pubsubé€šçŸ¥è¨Šæ¯åˆ°discord&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/164.gcloud%20install%20by%20bash/&quot;&gt;164.gcloud install by bash&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/181.%20cloudstorage%E7%84%A1%E6%B3%95%E4%BD%BF%E7%94%A8cloudflare%E8%BD%89%E5%9D%80/&quot;&gt;181. cloudstorageç„¡æ³•ä½¿ç”¨cloudflareè½‰å€&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;gce&quot; tabindex=&quot;-1&quot;&gt;GCE&lt;/h1&gt;
&lt;p&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/19.%20GCE%E7%A1%AC%E7%A2%9F%E5%A2%9E%E5%8A%A0%E5%AE%B9%E9%87%8F%E5%A4%A7%E5%B0%8F/&quot;&gt;GCEç¡¬ç¢Ÿå¢åŠ å®¹é‡å¤§å°&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/46.%E5%88%97%E5%87%BAGCE%E7%9A%84%E6%89%80%E6%9C%89VM/&quot;&gt;46.åˆ—å‡ºGCEçš„æ‰€æœ‰VM&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/46.GCE%E6%A9%9F%E5%99%A8%E5%88%97%E8%A1%A8%E5%85%A7%E7%9A%84CPU%E5%80%8B%E6%95%B8/&quot;&gt;46.GCEæ©Ÿå™¨åˆ—è¡¨å…§çš„CPUå€‹æ•¸&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/79.%20gcloud%20compute%20instance%20%E7%AD%86%E8%A8%98/&quot;&gt;GCEæŒ‡ä»¤&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/130.%20Google%20IAP%20ssh%E5%A4%B1%E6%95%97/&quot;&gt;130. Google IAP sshå¤±æ•—&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;gcs&quot; tabindex=&quot;-1&quot;&gt;GCS&lt;/h1&gt;
&lt;p&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/8.GCS%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F/&quot;&gt;GCSä½¿ç”¨æ–¹å¼&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/109.GCS%E8%87%A8%E6%99%82%E4%B8%8B%E8%BC%89%E6%AC%8A%E9%99%90/&quot;&gt;109.GCSè‡¨æ™‚ä¸‹è¼‰æ¬Šé™&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/127.%20fuse%20device%20not%20found,%20try%20&#39;modprobe%20fuse&#39;%20first/&quot;&gt;127. fuse device not found, try &#39;modprobe fuse&#39; first&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/129.%20nginx%20%E6%8E%9B%E8%BC%89gcs/&quot;&gt;129. nginx æ›è¼‰gcs&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/135.%20gsutil%E6%95%B4%E6%89%B9%E8%A4%87%E8%A3%BD/&quot;&gt;135. gsutilæ•´æ‰¹è¤‡è£½&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/140.%20gcs%20%E6%8E%9B%E8%BC%89domain/&quot;&gt;140. gcs æ›è¼‰domain&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/141.%20gcs%E8%87%AA%E5%8B%95%E5%88%AA%E9%99%A4%E6%AA%94%E6%A1%88/&quot;&gt;141. gcsè‡ªå‹•åˆªé™¤æª”æ¡ˆ&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;netwrok&quot; tabindex=&quot;-1&quot;&gt;Netwrok&lt;/h1&gt;
&lt;p&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/9.GCP%E7%B6%B2%E8%B7%AF%E5%B0%8D%E5%A4%96%E7%9A%84%E6%96%B9%E5%BC%8F/&quot;&gt;GCPç¶²è·¯å°å¤–çš„æ–¹å¼&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/13.%E9%A8%B0%E8%A8%8A%E9%9B%B2%E9%80%A3%E6%8E%A5GOOGLE%E9%9B%B2/&quot;&gt;13.é¨°è¨Šé›²é€£æ¥GOOGLEé›²&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h1&gt;
&lt;p&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/17.%20Gcloud%20AttributeError%20module%20importlib%20has%20no%20attribute%20util/&quot;&gt;17. Gcloud AttributeError module importlib has no attribute util&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â˜ï¸ GCP/0.GCP MOC/" />
        </entry>
        <entry>
            <title>
                78. drone k8s-runner é€²éšè¨­å®š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â± Drone/78. drone k8s-runner é€²éšè¨­å®š/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å†ä¸Šç¯‡ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8F%B1%20Drone/72.%20drone%20on%20GKE%20%E5%BB%BA%E7%AB%8B/&quot;&gt;72. drone on GKE å»ºç«‹&lt;/a&gt;ï¼Œæœ‰è«‡åˆ°k8s runnerï¼Œ&lt;br /&gt;
é‚£æ™‚å€™éƒ½åœ¨default çš„ namespaceä¸Šé¢é‹ä½œï¼Œ&lt;br /&gt;
æ‰€ä»¥æ²’ä»€éº¼å•é¡Œï¼Œ&lt;br /&gt;
ä½†ä¸€åˆ°äº†æ­£å¼ç’°å¢ƒï¼Œè¦åˆ‡å°ˆé–€çš„namespaceï¼Œ&lt;br /&gt;
å°±é™£äº¡æ‹‰)))))&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;é€™ç¯‡æœƒè¬›åˆ°å…©å€‹æ±è¥¿ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;RBAC(Role-based Access Control)&lt;/li&gt;
&lt;li&gt;drone k8s-runner policy&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;step-1&quot; tabindex=&quot;-1&quot;&gt;Step 1.&lt;/h3&gt;
&lt;p&gt;å…ˆå¾Cloud RBACé–‹å§‹èªªèµ·ï¼Œ&lt;/p&gt;
&lt;p&gt;åŸºæœ¬æ¦‚å¿µå¦‚ä¸‹åœ–&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/78-fig.1.png&quot; alt=&quot;78-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: default
  name: drone
rules:
- apiGroups:
  - &amp;quot;&amp;quot;
  resources:
  - secrets
  verbs:
  - create
  - delete
- apiGroups:
  - &amp;quot;&amp;quot;
  resources:
  - pods
  - pods/log
  verbs:
  - get
  - create
  - delete
  - list
  - watch
  - update

---

kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: drone
  namespace: default
subjects:
- kind: ServiceAccount
  name: default
  namespace: default
roleRef:
  kind: Role
  name: drone
  apiGroup: rbac.authorization.k8s.io
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;role ï¼š è¨­å®šæ¬Šé™èƒ½åšä»€éº¼äº‹&lt;br /&gt;
roleBinding ï¼š è¦å°‡å“ªå€‹è§’è‰²ç¶å®šæ¬Šé™åˆ°saå¸³è™Ÿ&lt;/p&gt;
&lt;p&gt;é€™é‚Šç°¡å–®èªªæ˜roleBinding ï¼ˆå› rolebindingçš„roleRef ç„¡æ³•æŒ‡å®šns)ï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å°‡ role, namespace åœ¨ default çš„ drone è·Ÿ&lt;br /&gt;
serviceAccountçš„ namespaceåœ¨ default çš„ default ç¶åœ¨ä¸€èµ·ï¼Œ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ›´ç´°é …çš„èªªæ˜ï¼Œè«‹åƒè€ƒ (1)~(4)&lt;/p&gt;
&lt;p&gt;ç•¶æœå‹™æ²’æœ‰æŒ‡å®šæ˜¯å“ªä¸€å€‹ ã€serviceAccountNameã€ï¼Œå°±æœƒä½¿ç”¨é è¨­çš„default ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œå¦‚æœå°‡namespaceé€šé€šæ”¹æˆdroneçš„è©±ï¼Œæœƒç™¼ç”Ÿä»€éº¼äº‹ï¼Ÿ&lt;br /&gt;
æœƒå…ˆåœ¨droneçš„ç•«é¢çœ‹åˆ° skip&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/78-fig.3.jpg&quot; alt=&quot;78-fig.3.jpg&quot; /&gt;&lt;br /&gt;
ç„¶å¾ŒæŸ¥çœ‹ k8s-runnerçš„ logï¼Œæœƒçœ‹åˆ°æ²’æœ‰æ¬Šé™ï¼Œè¢«æ‹’çµ•åŸ·è¡Œã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/78-fig.2.jpg&quot; alt=&quot;78-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;step-2&quot; tabindex=&quot;-1&quot;&gt;Step 2.&lt;/h3&gt;
&lt;p&gt;å†ä¾†è¦è§£æ±ºæ¬Šé™å•é¡Œï¼Œ&lt;br /&gt;
å› ç‚ºk8s-runnerï¼Œé è¨­éƒ½æ˜¯ä½¿ç”¨ default(namespace)çš„defaultå†å»ºç«‹podã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œç¾åœ¨æœ‰å…©ç¨®åšæ³•ï¼ˆé€™é‚Šæœƒè¬›ç¬¬äºŒç¨®åšæ³•ï¼‰ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;roleçš„æ¬Šé™ï¼Œçµ¦ä»–èƒ½å¤ åœ¨ä¸åŒçš„nsä¹Ÿèƒ½ä½ˆç½²çš„æ¬Šé™ï¼ˆé€™éƒ¨åˆ†æ‡‰è©²æ˜¯å»ºç«‹clusterRoleï¼Œæ²’è©¦éï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;k8s-runneråœ¨pipelineæ™‚ï¼Œè¦æ±‚åœ¨æŒ‡å®šçš„namespaceåšå‹•ä½œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å»ºç«‹ä¸€å€‹ policy(5) çš„ ymlï¼Œ&lt;br /&gt;
åº•ä¸‹çš„é—œéµæ¬„ä½ï¼Œæœ‰åœ¨ç¢°k8sçš„æ‡‰è©²éƒ½å¾ˆç†Ÿï¼Œ&lt;br /&gt;
matché€™å¡Šè¦å†æ¸¬è©¦çœ‹çœ‹ï¼Œé€™é‚Šå°±å…ˆè¨»è§£æ‰ã€‚&lt;br /&gt;
ï¼ˆæ–‡ä»¶ä¸Šæ˜¯èªª ï¼Œå¯ä»¥ç”¨ä¾†å®šç¾©å¤šå€‹policyç”¨ï¼Œ&lt;br /&gt;
ç•¶æœ‰ç¬¦åˆæ™‚ï¼Œå°±åŸ·è¡Œä¸‹é¢çš„policyï¼‰&lt;/p&gt;
&lt;p&gt;é€™é‚Šè¨­å®šè¦å‰‡æ˜¯ï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½ˆç½²æ™‚ï¼Œä½ˆç½²åˆ°droneçš„namespace ï¼Œ&lt;br /&gt;
è³‡æºè«‹æ±‚æ˜¯ 512Mi,ç¯€é»é¸æ“‡çš„label æ˜¯ disktype: ssd&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;kind: policy
name: drone

# match:
#   repo:
#   - &amp;quot;octocat/*&amp;quot;
#   - &amp;quot;octocat/hello-world&amp;quot;

metadata:
  namespace: drone

resources:
  request:
    memory: 512MiB
  # limit:
  #   cpu: 4000
  #   memory: 1GiB

node_selector:
  disktype: ssd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ä¾†è¦åœ¨runnerè£¡é¢æ›è¼‰é€™å€‹æª”æ¡ˆï¼Œç›´æ¥ç”¨ configMapå°‡æª”æ¡ˆè¼‰å…¥ã€‚&lt;/p&gt;
&lt;p&gt;å»ºç«‹configmap&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; kubectl create configmap -n drone drone-policy --from-file=policy.yml --dry-run=client -o yaml | kubectl apply -f -
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;k8s-runnerå…§æ›è¼‰configmap&lt;br /&gt;
è¦ç‰¹åˆ¥æ³¨æ„env ï¼Œ&lt;br /&gt;
DRONE_POLICY_FILE(6)ï¼Œéœ€è¦æŒ‡å®šä½ çš„ymlä½ç½®ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: apps/v1
kind: Deployment
metadata:
  name:  drone-runner-k8s
  namespace: drone
  labels:
    drone:  runner-k8s
spec:
  replicas: 1
  selector:
    matchLabels:
      drone:  runner-k8s
  template:
    metadata:
      labels:
        drone:  runner-k8s
    spec:
      containers:
      - name: runner
        image: drone/drone-runner-kube:latest
        ports:
        - containerPort: 3000
        volumeMounts:
        - mountPath: /policy.yml
          name: policy
          subPath: policy.yml
        env:
        - name: DRONE_POLICY_FILE
          value: /policy.yml        
      volumes:
      - configMap:
          defaultMode: 420
          name: drone-policy
        name: policy  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é™„è¨»ï¼Œå¦‚æœnode_selectorï¼Œé¸æ“‡çš„ç¯€é»æ˜¯ssdçš„ç¡¬ç¢Ÿçš„è©±ï¼Œ&lt;br /&gt;
æ™‚é–“æœƒæ¸›å°‘ 35%ã€‚ ä½†æ¯å€‹æœˆæœƒå¤š13å¡Šç¾é‡‘ã€‚&lt;/p&gt;
&lt;p&gt;å†ä¾†ä¸‹ç¯‡æ‡‰è©²å°±æ˜¯å¯«å°‡droneå®Œæ•´å°å…¥istioçš„åšæ³•äº†&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/zh/docs/reference/access-authn-authz/rbac/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨ RBAC é‘‘æ¬Š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.orchome.com/1308&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubernetesæ¬Šé™ç®¡ç†ä¹‹RBAC&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10252766?sc=rss.iron&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Day-28 ç­è§£ Namespace èˆ‡ Rbac&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://godleon.github.io/blog/Kubernetes/k8s-How-to-access-resource-legally/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[Kubernetes] å¦‚ä½•å–å¾—åˆæ³•å¯ç”¨çš„æ¬Šé™ï¼Œè®“ pod èˆ‡ API server æºé€š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.drone.io/runner/kubernetes/configuration/policies/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Policies&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.drone.io/runner/kubernetes/configuration/reference/drone-policy-file/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;DRONE_POLICY_FILE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://jimmysong.io/kubernetes-handbook/guide/configure-pod-service-account.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é…ç½® Pod çš„ Service Account&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/â± Drone/78. drone k8s-runner é€²éšè¨­å®š/" />
        </entry>
        <entry>
            <title>
                77. drone build Open Source Edition
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â± Drone/77. drone build Open Source Edition/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;åœ¨æŸä¸€å¤©ï¼Œdroneå°±è·³å‡ºä¾†äº† ã€Your license limit is exceededã€‚ã€&lt;br /&gt;
ç•¶ä¸‹çœŸæ˜¯åš‡æ­»æˆ‘äº†ï¼Œç•¶å¤©åˆæ˜¯ç¶­è­·æ—¥ï¼Œ&lt;br /&gt;
ä¸€å †ç¨‹å¼è¦ä¸Šç‰ˆï¼Œè‡ªå‹•ä½ˆç½²æ›æ‰å°±å®Œäº†ï¼Œè¦é€šé€šæ‰‹å‹•ä¸Šã€‚&lt;br /&gt;
é‚„å¥½ï¼Œæ²’äº‹ï¼Œåªæ˜¯è·³å€‹é€šçŸ¥åœ¨é‚£é‚Šï¼ŒæŸ¥äº†ä¸€äº›æ–‡ä»¶ï¼Œ&lt;br /&gt;
éƒ½æ²’èªªåˆ°æœŸäº†æœƒæ€æ¨£ï¼Œå°±é€™æ¨£éäº†å…©å€‹æœˆï¼Œ&lt;br /&gt;
ä¹Ÿéƒ½æ²’äº‹ç™¼ç”Ÿï¼Œæœ¬ä¾†æƒ³ç¹¼çºŒæ’ä¸‹å»çš„ï¼Œ&lt;br /&gt;
ä½†æœ‰å…¶ä»–æ±è¥¿è¦ç”¨ï¼Œå°±é †ä¾¿ä¸€èµ·å‹•äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/77-fig.1.jpg&quot; alt=&quot;77-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å®˜æ–¹æ–‡ä»¶æœ‰å¯«åˆ°é—œæ–¼æ¬Šé™çš„éƒ¨åˆ†ï¼Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Your license limit is exceeded ï¼Œé€™å€‹æ˜¯å› ç‚ºä½ build è¶…éäº†5000æ¬¡ï¼Œç„¶å¾Œä½ åˆæ˜¯ç›´æ¥æŠ“å®˜æ–¹ç‰ˆæœ¬çš„imageæ‰æœƒå‡ºç¾é€™å€‹é€šçŸ¥ã€‚ï¼ˆOSï¼šä¸€é–‹å§‹æ¸¬è©¦ç•¶ç„¶ç›´æ¥æŠ“å®˜æ–¹çš„imageä¾†ç”¨é˜¿...ï¼‰&lt;/li&gt;
&lt;li&gt;åŸºæœ¬ä¸Šåªè¦æ˜¯å¹´æ”¶å…¥æ²’åˆ° 1 millionï¼ˆç¾é‡‘ï¼‰çš„å…¬å¸ï¼Œéƒ½èƒ½å…è²»ä½¿ç”¨ï¼Œä½†è¦è‡ªå·±æ‰“åŒ…imageã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä»–ç´°é …ï¼Œå¯è‡ªè¡Œåƒè€ƒ&lt;a href=&quot;https://docs.drone.io/enterprise/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®˜æ–¹ç¶²ç«™&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;build-image&quot; tabindex=&quot;-1&quot;&gt;Build image&lt;/h3&gt;
&lt;p&gt;æˆ‘å€‘å¯ä»¥å…ˆå¾å®˜æ–¹çš„githubçœ‹çœ‹ï¼Œä»–å€‘æ˜¯æ€éº¼ç·¨è­¯çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/harness/drone/blob/v2.9.1/.drone.yml&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;drone.yml&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆåŸ·è¡Œï¼Œ &lt;a href=&quot;https://github.com/harness/drone/blob/v2.9.1/scripts/build.sh&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;scripts/build.sh&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å†æ ¹æ“š &lt;a href=&quot;https://github.com/harness/drone/blob/v2.9.1/docker/Dockerfile.agent.linux.amd64&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;docker/Dockerfile.server.linux.amd64&lt;/a&gt; çš„dockerfileå»æ‰“åŒ…ç¨‹å¼ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸‹é¢é€™æ®µï¼Œç›´æ¥å­˜æˆdockerfileå»ç·¨è­¯å§ï¼Œ&lt;br /&gt;
ç‰ˆæœ¬è™Ÿè‡ªè¡Œæ›´æ”¹ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&quot;è£œå……èªªæ˜ï¼Œ&quot; tabindex=&quot;-1&quot;&gt;è£œå……èªªæ˜ï¼Œ&lt;/h4&gt;
&lt;p&gt;docker åœ¨ç·¨è­¯çš„æ™‚å€™ï¼Œ&lt;br /&gt;
æ¯ä¸€è¡ŒæŒ‡ä»¤ (å‰é¢æœ‰åŠ  RUN æˆ–COPY..çš„é€™ç¨®ç®—ä¸€è¡Œï¼‰ï¼Œ&lt;br /&gt;
éƒ½ç®—æ˜¯ä¸€å€‹æ–°çš„imageï¼Œå¯ä»¥çœ‹åˆ°sha256çš„æ•¸å€¼éƒ½ä¸ä¸€æ¨£ï¼Œ&lt;br /&gt;
æ‰€ä»¥ç”¨ cd drone åˆ‡ è·¯å¾‘çš„è©±ï¼Œè¦å†åŒä¸€è¡ŒæŠŠè¦åŸ·è¡Œçš„commandï¼Œ&lt;br /&gt;
éƒ½åŸ·è¡Œå®Œã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FROM golang AS Builder

ENV DRONE_VERSION v2.9.1
WORKDIR $GOPATH/src
RUN git clone  https://github.com/drone/drone --branch ${DRONE_VERSION} --single-branch
RUN cd drone &amp;amp;&amp;amp; pwd  &amp;amp;&amp;amp; go mod download &amp;amp;&amp;amp; &#92;
   go build -ldflags &amp;quot;-extldflags &#92;&amp;quot;-static&#92;&amp;quot;&amp;quot; -tags=&amp;quot;nolimit&amp;quot; github.com/drone/drone/cmd/drone-server


FROM alpine:3.13 AS Certs

RUN apk add -U --no-cache ca-certificates

FROM alpine:3.13
EXPOSE 80 443
VOLUME /data

RUN [ ! -e /etc/nsswitch.conf ] &amp;amp;&amp;amp; echo &#39;hosts: files dns&#39; &amp;gt; /etc/nsswitch.conf

ENV GODEBUG netdns=go
ENV XDG_CACHE_HOME /data
ENV DRONE_DATABASE_DRIVER sqlite3
ENV DRONE_DATABASE_DATASOURCE /data/database.sqlite
ENV DRONE_RUNNER_OS=linux
ENV DRONE_RUNNER_ARCH=amd64
ENV DRONE_SERVER_PORT=:80
ENV DRONE_SERVER_HOST=localhost
ENV DRONE_DATADOG_ENABLED=true
ENV DRONE_DATADOG_ENDPOINT=https://stats.drone.ci/api/v1/series

COPY --from=Certs /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/
COPY --from=Builder go/src/drone/drone-server /bin/drone-server

ENTRYPOINT [&amp;quot;/bin/drone-server&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ¬ä¾†æƒ³ç”¨go get çš„æ–¹å¼ï¼Œç›´æ¥æŠŠç¨‹å¼buildå‡ºä¾†ï¼Œ&lt;br /&gt;
ä½†ä¸€ç›´å¡åœ¨go çš„&lt;a href=&quot;https://mileslin.github.io/2020/08/Golang/%E5%88%B0%E5%BA%95-go-get-%E7%9A%84%E7%89%88%E8%99%9F%E6%80%8E%E9%BA%BC%E9%81%8B%E4%BD%9C%E7%9A%84/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç‰ˆè™Ÿé™åˆ¶&lt;/a&gt;ï¼Œçœ‹äº†ä¸€äº›æ–‡ç« éƒ½èªªè¦æ”¹è£¡é¢çš„ç¨‹å¼ã€‚&lt;br /&gt;
ä½†é€™æ±è¥¿å¯«å®Œï¼ŒåŸºæœ¬ä¸Šå°±ä¸æœƒå†å‹•äº†ã€‚&lt;br /&gt;
åªå¥½ç”¨git cloneæŠŠç¨‹å¼å…ˆæŠ“ä¸‹ä¾†ï¼Œå†buildäº†ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.tencent.com/developer/article/1814669&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨å®¹å™¨æ–¹å¼ç·¨è­¯ç„¡åŠŸèƒ½é™åˆ¶çš„ Drone CI&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://c.biancheng.net/view/123.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;go getå‘½ä»¤â€”â€”ä¸€éµç²å–ä»£ç¢¼ã€ç·¨è­¯ä¸¦å®‰è£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://willh.gitbook.io/build-web-application-with-golang-zhtw/01.0/01.3&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;go å‘½ä»¤&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/â± Drone/77. drone build Open Source Edition/" />
        </entry>
        <entry>
            <title>
                72. drone on GKE å»ºç«‹
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â± Drone/72. drone on GKE å»ºç«‹/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;gitlabçš„å®‰è£æ–¹å¼ï¼Œåƒè€ƒ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/71.gitlab%20on%20GKE%20%E7%81%BD%E5%AE%B3%E9%82%84%E5%8E%9F%E7%AD%86%E8%A8%98/&quot;&gt;71.gitlab on GKE ç½å®³é‚„åŸç­†è¨˜&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å†ä¾†æ˜¯å®‰è£droneçš„æ–¹å¼ï¼Œ&lt;br /&gt;
é€™é‚Šä¹‹å‰æ²’å¯«æ–‡ä»¶ï¼Œé‡è©¦çš„æ™‚å€™æäº†ä¸€é™£å­ã€‚&lt;/p&gt;
&lt;p&gt;è¦å…ˆçŸ¥é“ runneråˆ†æˆå“ªå¹¾ç¨®ï¼Œæ ¹æ“šä½ çš„ç’°å¢ƒé¸æ“‡ä½ è¦çš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨droneç•«é¢ï¼ŒåŸºæœ¬ä¸Šéƒ½å·®ä¸å¤šã€‚&lt;br /&gt;
æœ‰å·®ç•°çš„é»æ˜¯å†å»ºç½®æ™‚ï¼Œå°±ç›´æ¥çœ‹åœ–å§&lt;/p&gt;
&lt;p&gt;Drone Runneråˆ†æˆäº”ç¨®ï¼Œé©ç”¨æ–¼ä¸åŒçš„æƒ…å¢ƒ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Docker runner :æ˜¯droneæœ€å¸¸è¦‹çš„ç”¨æ³•ï¼Œpinelineä¸­çš„æ¯ä¸€å€‹stepéƒ½èµ·ä¸€å€‹ç¨ç«‹çš„containeré‹è¡Œç‰¹å®šä»»å‹™ï¼Œæœ¬æ–‡å³æ˜¯æ¡ç”¨docker runnerã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨å»ºç½®æ™‚ï¼Œæœƒåœ¨è©²runnerè£¡é¢åŸ·è¡Œdockerï¼Œæ‰€ä»¥ç•¶ä¸‹åªæœƒçœ‹åˆ°runnerè£¡é¢çš„cpuè·Ÿramä½¿ç”¨é‡ä¸Šå‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kubernetes runner:è·Ÿdocker runner çš„åŠŸèƒ½ç›¸ä¼¼ï¼Œåªæ˜¯æ”¹æˆKubernetes ç‰ˆæœ¬ï¼Œå¦‚æœä½ çš„æœå‹™è¦æ­å»ºåœ¨k8sä¸Šï¼Œå°±ç”¨é€™å€‹ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/72-fig.2.jpg&quot; alt=&quot;72-fig.2.jpg&quot; /&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/72-fig.3.jpg&quot; alt=&quot;72-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¸æ“‡kubernetesçš„ç‰ˆæœ¬ï¼Œå†å»ºç½®æ™‚æœƒåœ¨ç•¶ä¸‹çš„å¢é›†å»ºç«‹ä¸€å€‹podï¼Œ&lt;br /&gt;
ç„¶å¾Œå°±æœƒåœ¨è£¡é¢åŸ·è¡Œè¦è·‘å¾—æ­¥é©Ÿã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Exec runner:ç”¨æ–¼ä½ çš„å°ˆæ¡ˆä¸é©åˆè·‘åœ¨å®¹å™¨å…§çš„ç‹€æ³EX:MacOså°ˆæ¡ˆã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SSH runner:ç›´æ¥ä»¥ssh é€£ç·šåˆ°é ç«¯ä»¥default shell åŸ·è¡Œpipelineæµç¨‹ï¼Œéœ€è¦ä½¿ç”¨openssh 7.9 ä»¥ä¸Šç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Digital Ocean runnerÂ :ç”¨æ–¼ç•¶ä½ çš„pipelineéœ€è¦æ¬Šé™å¯ä»¥æ“ä½œæ•´å°è™›æ“¬æ©Ÿçš„æƒ…æ³ï¼Œä¸”ä¸é©åˆè·‘åœ¨å®¹å™¨å…§ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è§’è‰²&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;åŠŸèƒ½&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ç”¨æˆ¶&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;Gitlab&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Drone Server&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;Drone ä¸»æœå‹™ï¼Œæä¾›Webç•Œé¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Drone Runner&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;æˆ‘ç†è§£ç‚ºå¯¦ç¾å„ç¨®æ“ä½œçš„é©é…å™¨ï¼Œä¾‹å¦‚sshã€dockerã€k8sæ“ä½œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Drone Agent&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;æ“ä½œä¸»æ©Ÿ Docker API çš„ä»£ç†ç¨‹åº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Docker Server&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;ä¸»æ©Ÿçš„ Doker ç¨‹åº&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/72-fig.1.jpg&quot; alt=&quot;72-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç™¼ä½ˆåˆ°GKEï¼Œ&lt;a href=&quot;https://github.com/nytimes/drone-gke/blob/main/DOCS.md#template&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åƒæ•¸èªªæ˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ç™¼ä½ˆåˆ°GCRï¼Œ&lt;a href=&quot;https://daimom.github.io/%5Bhttp://plugins.drone.io/drone-plugins/drone-gcr/%5D(http://plugins.drone.io/drone-plugins/drone-gcr/)&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åƒæ•¸èªªæ˜&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å†ä¾†å°±æ˜¯è¦ä½ˆç½² drone serverè·Ÿ runneräº†ã€‚&lt;/p&gt;
&lt;h3 id=&quot;step-1&quot; tabindex=&quot;-1&quot;&gt;Step 1.&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆè¦åˆ°Gitlabï¼Œå»ºç«‹oAuthçš„id è·Ÿtokenã€‚&lt;br /&gt;
åˆ‡è¨˜æ˜¯åœ¨user Settingçš„ Applicationï¼Œ&lt;br /&gt;
å› ç‚ºGitlabæ˜¯æˆ‘å»ºçš„ï¼Œæ‰€ä»¥æˆ‘æœ‰å¦ä¸€å€‹Adminçš„å€åŸŸï¼Œ&lt;br /&gt;
ä¸æ˜¯åœ¨Adminè£¡é¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/72-fig.4.jpg&quot; alt=&quot;72-fig.4.jpg&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/72-fig.5.jpg&quot; alt=&quot;72-fig.5.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç¶²é ä¸è¦é—œï¼Œ Application ID è·Ÿ Secretç­‰ç­‰æœƒç”¨åˆ°ã€‚&lt;/p&gt;
&lt;br /&gt;
&lt;h3 id=&quot;step-2-drone-server&quot; tabindex=&quot;-1&quot;&gt;Step 2. drone Server&lt;/h3&gt;
&lt;br /&gt;
&lt;p&gt;å°‡ä¸€äº›åƒæ•¸æ”¹æˆè‡ªå·±çš„ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;yamlæ¬„ä½&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;å°æ‡‰çš„æ¬„ä½&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;DRONE_GITLAB_CLIENT_ID&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;Application ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DRONE_GITLAB_CLIENT_SECRET&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;Secret&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DRONE_SERVER_HOST&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;Callback URL çš„domain&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DRONE_RPC_SECRET&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;è‡ªè¡Œå»ºç«‹ï¼Œrunnerçš„secretéœ€ä¸€è‡´&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: apps/v1
kind: Deployment
metadata:
  name: gke-drone-server
  labels:
    app: drone
    drone: drone-server
    io.kompose.service: drone-server
spec:
  selector:
    matchLabels:
      app: drone
      drone: drone-server
      io.kompose.service: drone-server
  template:
    metadata:
      labels:
            app: drone
            drone: drone-server
            io.kompose.service: drone-server
    spec:
      containers:
      - env:
        - name: DRONE_GITLAB_CLIENT_ID    # OAuth çš„ Application ID
          value: 5b2f90188137bab7b1c6959721feb6e55f1137919e5b4b5ce005bd5e15af536a      
        - name: DRONE_GITLAB_CLIENT_SECRET    # OAuth çš„ Secret
          value: 4cc261149603b3df864677f5af37b55613f6f4d20dd65fbb3e4f77f0cbca9e15
        - name: DRONE_GITLAB_SERVER       # Gitlab Server
          value: http://35.234.26.234
        - name: DRONE_GIT_ALWAYS_AUTH     # Drone clone æ™‚ï¼Œæ˜¯å¦æ¯æ¬¡éƒ½é©—è­‰
          value: &amp;quot;false&amp;quot;
        - name: DRONE_LOGS_COLOR          # Log å•Ÿç”¨é¡è‰²è¾¨è­˜
          value: &amp;quot;true&amp;quot;
        - name: DRONE_LOGS_DEBUG          # é¸æ“‡æ˜¯å¦é–‹å•Ÿ debug æ¨¡å¼
          value: &amp;quot;false&amp;quot;
        - name: DRONE_LOGS_PRETY
          value: &amp;quot;false&amp;quot;
        # - name: DRONE_LOGS_TRACE          &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é–‹å•Ÿlogè¿½è¹¤&quot;&gt;#é–‹å•Ÿlogè¿½è¹¤&lt;/a&gt;
        #   value: &amp;quot;true&amp;quot;
        - name: DRONE_RUNNER_CAPACITY     # è¡¨ç¤ºä¸€æ¬¡å¯åŸ·è¡Œ n å€‹ job
          value: &amp;quot;3&amp;quot;
        - name: DRONE_SERVER_HOST         # Drone URL,ä¸èƒ½åŠ HTTPï¼Œè§£ææœƒåœ¨åŠ ä¸ŠHTTP
          value: 14.199.130.26
        - name: DRONE_SERVER_PROTO        # http æˆ–è€… https é€£ç·šè¨­å®š
          value: http
        - name: DRONE_TLS_AUTOCERT        # è‡ªå‹•ç”Ÿæˆ ssl è­‰æ›¸ï¼Œä¸¦æ¥å— https é€£ç·šï¼Œæœ«èªç‚ºfalse
          value: &amp;quot;false&amp;quot;
        - name: DRONE_REGISTRATION_CLOSED # å•Ÿç”¨çš„è©±ï¼Œç®¡ç†å“¡éœ€åœ¨ç”¨æˆ¶ç™»å…¥å‰å‰µå»ºç”¨æˆ¶
          value: &amp;quot;false&amp;quot;
        - name: DRONE_USER_CREATE         # å»ºç«‹adminæ¬Šé™çš„ä½¿ç”¨è€…  cliç™»å…¥ç”¨
          value: username:ezio,admin:true
        - name: DRONE_USER_FILTER         # å¯æ“ä½œ Drone çš„ç”¨æˆ¶æ¸…å–®
          value: root,ezio
        - name: DRONE_RPC_SECRET
          value: 824de51510f08498fa770c7798e3cc9e
        image: drone/drone:2
        imagePullPolicy: &amp;quot;Always&amp;quot;
        name: drone-server        
        ports:
        - containerPort: 80
        resources: {}
        volumeMounts:
        - mountPath: /data
          name: drone-server-claim0
      restartPolicy: Always
      serviceAccountName: &amp;quot;&amp;quot;
      volumes:
      - name: drone-server-claim0
        persistentVolumeClaim:
          claimName: gke-drone-server-claim0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœè¦å…¶ä»–gitçš„å®‰è£æ–¹å¼è«‹åƒè€ƒ 1. çš„å®˜æ–¹æ–‡ä»¶&lt;br /&gt;
ref.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://readme.drone.io/server/provider/gitlab/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Drone Gitlab&lt;/a&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;step-3-a-drone-runner-docker-runner&quot; tabindex=&quot;-1&quot;&gt;Step 3-a.  drone Runner - Docker Runner&lt;/h3&gt;
&lt;br /&gt;
&lt;p&gt;æ³¨æ„ DRONE_RPC_SECRETéœ€èˆ‡serverä¸€è‡´ã€‚&lt;br /&gt;
é€™é‚Šæœƒç”¨åˆ° docker.sockï¼Œä¹Ÿæ˜¯å› ç‚ºé€™å€‹çš„é—œä¿‚ï¼Œ&lt;br /&gt;
æ‰å°è‡´é€™æ¬¡é‡æ–°æ¸¬è©¦ã€‚&lt;/p&gt;
&lt;p&gt;k8så³å°‡å»¢æ£„ Dockershimï¼Œæ”¹ç”¨containerdï¼Œ&lt;br /&gt;
è©³ç´°å…§å®¹å°±ä¸å¤šèªªäº†ï¼Œæœ‰èˆˆè¶£çš„å¯åƒè€ƒ (1) ã€ (2)&lt;/p&gt;
&lt;p&gt;é›–ç„¶æˆ‘å¯¦æ¸¬å‡ºä¾†çš„çµæœï¼Œ&lt;br /&gt;
åœ¨containerdçš„nodeæ˜¯å¯ä»¥ç”¨çš„ã€‚&lt;br /&gt;
æœ‰åœ¨æƒ³æ˜¯ä¸æ˜¯å› ç‚ºæ ¸å¿ƒé‚„æ˜¯ /var/run/docker.sock å€‹é—œä¿‚ï¼Œ&lt;br /&gt;
ä½†éš¨è‘—å¾ŒçºŒç ”ç©¶ docker.sock (3)ï¼Œç™¼è¦ºæ‡‰è©²æ˜¯ä¸èƒ½ç”¨çš„æ‰å°...&lt;br /&gt;
ä½†ç‚ºä»€éº¼èƒ½ç”¨é‚„æ˜¯æä¸æ‡‚ã€‚ä½†(4)çš„å®˜æ–¹è«–å£‡æœ‰èªªï¼Œä»–ä¸æ“”å¿ƒé€™å€‹å•é¡Œï¼Œ&lt;br /&gt;
å¯¦éš›ä¸Šé‚„çœŸçš„æ²’å•é¡Œ...&lt;/p&gt;
&lt;p&gt;è£œå……ï¼Œ&lt;br /&gt;
æœ€è¿‘æŠŠnodeçš„ containerd ç‰ˆæœ¬å‡åˆ° 1.20 å¾Œï¼ŒDocker Runnerå°±çœŸçš„ä¸èƒ½ç”¨äº†ã€‚æ‡‰è©²æ˜¯æ—©æœŸé‚„åœ¨ç”¨èˆŠç‰ˆçš„containerdï¼Œæ‰€ä»¥æ‰èƒ½è·‘ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: apps/v1
kind: Deployment
metadata:
  name: agent
spec:
  selector:
    matchLabels:
      drone: drone-agent
  replicas: 1
  template:
    spec:
      containers:
      - env:
        - name: DRONE_LOGS_DEBUG
          value: &amp;quot;false&amp;quot;
        # - name: DRONE_LOGS_TRACE          &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é–‹å•Ÿlogè¿½è¹¤&quot;&gt;#é–‹å•Ÿlogè¿½è¹¤&lt;/a&gt;
        #   value: &amp;quot;true&amp;quot;
        - name: DRONE_RPC_SECRET
          value: 824de51510f08498fa770c7798e3cc9e
        - name: DRONE_RPC_HOST
          value: 14.199.130.26
        - name: DRONE_RPC_PROTO
          value: &amp;quot;http&amp;quot;
        - name: DRONE_RUNNER_CAPACITY
          value: &amp;quot;3&amp;quot;
        image: drone/drone-runner-docker:1
        imagePullPolicy: &amp;quot;&amp;quot;
        name: drone-agent
        resources: {}
        volumeMounts:
        - mountPath: /var/run/docker.sock
          name: docker-socket
      restartPolicy: Always
      serviceAccountName: &amp;quot;&amp;quot;
      volumes:
      - name: docker-socket
        hostPath:
          path: /var/run/docker.sock
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
1. &lt;a href=&quot;https://kubernetes.io/zh/docs/tasks/administer-cluster/migrating-from-dockershim/check-if-dockershim-deprecation-affects-you/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æª¢æŸ¥æ£„ç”¨ Dockershim å°ä½ çš„å½±éŸ¿&lt;/a&gt;&lt;br /&gt;
2. &lt;a href=&quot;https://kubernetes.io/zh/blog/2020/12/02/dockershim-faq/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ£„ç”¨ Dockershim çš„å¸¸è¦‹å•é¡Œ&lt;/a&gt;&lt;br /&gt;
3. &lt;a href=&quot;https://ephrain.net/docker-%E6%8E%9B%E8%BC%89-var-run-docker-sock-%E7%9A%84%E7%94%A8%E6%84%8F%EF%BC%9F/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[Docker] æ›è¼‰ /var/run/docker.sock çš„ç”¨æ„ï¼Ÿ&lt;/a&gt;&lt;br /&gt;
4. &lt;a href=&quot;https://discourse.drone.io/t/docker-plugin-dockershim-deprecation-kubernetes-1-20/8850&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Drone Disscus -  Docker plugin &amp;amp; dockershim deprecation // Kubernetes 1.20+&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;step-3-b-drone-runner-kubernete-runner&quot; tabindex=&quot;-1&quot;&gt;Step 3-b.  drone Runner - kubernete Runner&lt;/h3&gt;
&lt;br /&gt;
&lt;p&gt;æ³¨æ„ DRONE_RPC_SECRETéœ€èˆ‡serverä¸€è‡´ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: default
  name: drone
rules:
- apiGroups:
  - &amp;quot;&amp;quot;
  resources:
  - secrets
  verbs:
  - create
  - delete
- apiGroups:
  - &amp;quot;&amp;quot;
  resources:
  - pods
  - pods/log
  verbs:
  - get
  - create
  - delete
  - list
  - watch
  - update

---

kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: drone
  namespace: default
subjects:
- kind: ServiceAccount
  name: default
  namespace: default
roleRef:
  kind: Role
  name: drone
  apiGroup: rbac.authorization.k8s.io

---


apiVersion: apps/v1
kind: Deployment
metadata:
  name:  gke-drone-agent

  labels:
    app: drone
    drone: drone-agent
    io.kompose.service: drone-agent
spec:
  replicas: 1
  selector:
    matchLabels:
      app: drone
      drone: drone-agent
      io.kompose.service: drone-agent
  template:
    metadata:
      annotations:
        sidecar.istio.io/inject: &amp;quot;true&amp;quot;
      labels:
        app: drone
        drone: drone-agent
        io.kompose.service: drone-agent
    spec:
      containers:
      - name: runner
        image: drone/drone-runner-kube:latest
        ports:
        - containerPort: 3000
        env:
        - name: DRONE_RPC_SECRET
          value: 824de51510f08498fa770c7798e3cc9e
        - name: DRONE_RPC_HOST
          value: 14.199.130.26
        - name: DRONE_RPC_PROTO
          value: &amp;quot;http&amp;quot;
        - name: DRONE_RUNNER_CAPACITY
          value: &amp;quot;3&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://docs.drone.io/runner/kubernetes/installation/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;KUBERNETES Runner&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;å•é¡Œæ’é™¤&quot; tabindex=&quot;-1&quot;&gt;å•é¡Œæ’é™¤&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆç¢°åˆ°çš„å•é¡Œæ˜¯ï¼Œdroneæ²’æœ‰åæ‡‰ï¼Œå…ˆæª¢æŸ¥webhook&lt;br /&gt;
åˆ°å°ˆæ¡ˆåº•ä¸‹çš„webhooké¸é …ï¼ŒæŸ¥çœ‹éŒ¯èª¤çš„è¨Šæ¯&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/72-fig.6.jpg&quot; alt=&quot;72-fig.6.jpg&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/72-fig.7.jpg&quot; alt=&quot;72-fig.7.jpg&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å› ç‚ºGKEçš„é˜²ç«ç‰†æ²’é–‹çš„é—œä¿‚ï¼Œå°è‡´webhookè³‡æ–™ä¸Ÿä¸éå»ã€‚&lt;br /&gt;
&lt;br /&gt;&lt;br /&gt;
2.  droneç„¡æ³•é€£ç·šåˆ°gitlab&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/72-fig.8.jpg&quot; alt=&quot;72-fig.8.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æœ¬ä¾†ä»¥ç‚ºæ˜¯é˜²ç«ç‰†çš„é—œä¿‚ï¼Œä½†ç›´æ¥é€£é€²å»podè£¡é¢ï¼Œå‘¼å«é€™å€‹ç¶²å€æ˜¯æ­£å¸¸çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¾Œä¾†çœ‹åˆ° (2) çš„è¨è«–ï¼Œæˆ‘è·Ÿä»–å€‘ç‹€æ³ä¸€æ¨£ï¼Œæ‡‰è©²ä¹Ÿæ˜¯istioé€ æˆçš„ã€‚&lt;br /&gt;
åŸä»¥ç‚ºæ˜¯ drone serveræˆ– runnerï¼Œæœ‰å®‰è£istioçš„é—œä¿‚ï¼Œ&lt;br /&gt;
é‚„ç‰¹åˆ¥å¯«äº†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;template:
  metadata:
    annotations:
      sidecar.istio.io/inject: &amp;quot;false&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¾†é˜»æ­¢ istioçš„æ³¨å…¥(3)ã€‚&lt;/p&gt;
&lt;p&gt;å¾Œä¾†æƒ³äº†åˆæƒ³ï¼Œæ‰é©šè¦ºï¼Œæˆ‘è¦å–æ¶ˆçš„æ‡‰è©²æ˜¯æ•´å€‹namespaceçš„istioæ³¨å…¥ï¼Œ&lt;br /&gt;
å› ç‚ºç•¶æ–°çš„ pipelineå»ºç«‹æ™‚ï¼Œå°±å·²ç¶“æ³¨å…¥äº†istioçš„sidecarï¼Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/72-fig.2.jpg&quot; alt=&quot;72-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¦å…ˆè®“é€™å€‹namespaceé€šé€šä¸èƒ½è‡ªå‹•æ³¨å…¥ï¼Œ&lt;br /&gt;
æŒ‡å®šå…¶ä»–çš„deployæœƒè‡ªå‹•æ³¨å…¥ã€‚&lt;br /&gt;
è‡ªå‹•æ³¨å…¥çš„è¦å‰‡ï¼Œè«‹åƒè€ƒ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/73.%20istio%20sidecar%20%E6%B3%A8%E5%85%A5%E8%A6%8F%E5%89%87/&quot;&gt;73. istio sidecar æ³¨å…¥è¦å‰‡&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;
&lt;p&gt;åˆ‡æ›namespaceï¼Œç„¡æ³•ä½ˆç½²&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref.&lt;br /&gt;
1. &lt;a href=&quot;https://docs.gitlab.com/ee/user/project/integrations/webhooks.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Gitlab Webhooks&lt;/a&gt;&lt;br /&gt;
2. &lt;a href=&quot;https://discourse.drone.io/t/drone-ci-pipeline-first-step-clone-failed-connection-refused/7626&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Drone CI pipeline first step clone failed: Connection refused&lt;/a&gt;&lt;br /&gt;
3. &lt;a href=&quot;https://istio.io/latest/zh/docs/setup/additional-setup/sidecar-injection/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®‰è£ Sidecar&lt;/a&gt;&lt;br /&gt;
4. &lt;a href=&quot;https://istio.io/latest/docs/reference/config/annotations/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;istio -Resource Annotations&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â± Drone/72. drone on GKE å»ºç«‹/" />
        </entry>
        <entry>
            <title>
                3. æ’°å¯«drone.yml ç­†è¨˜ç¯‡(æœª)
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â± Drone/3. æ’°å¯«drone.yml ç­†è¨˜ç¯‡(æœª)/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ›å·¥ä½œå¾Œï¼Œé–‹å§‹æ¥è§¸k8sã€GCPã€GKEï¼Œå†ä¾†æ˜¯Droneã€‚&lt;br /&gt;
k8sä¸­åˆå»¶ä¼¸äº†kustomize ï¼Œymalçš„å¯«æ³•ã€ä½ˆç½²æ–¹å¼ã€‚&lt;br /&gt;
GCPä¸­çš„cloud armorã€GCE ï¼Œç„¶å¾ŒGKEçš„æ¶æ§‹&lt;br /&gt;
çœŸçš„æ˜¯....æ»¿æ»¿çš„å‘é˜¿ã€‚ä»¥ä¸Šè¬›åˆ°çš„ï¼Œé‚„è™•æ–¼æ‡æ‡‚ä¸­ï¼Œ&lt;br /&gt;
ç­†è¨˜ä¸çŸ¥é“ä½•å¹´ä½•æœˆä½•æ—¥å¯å¯«&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç°¡å–®èªªä¸€ä¸‹ç’°å¢ƒï¼Œåœ¨GKEä¸Šé¢ä½ˆç½² drone è·Ÿ gitlabï¼Œ&lt;br /&gt;
ç•¶gitlabæœ‰æ¢ä»¶è§¸ç™¼çš„è©±(ä¾‹å¦‚åœ¨push åœ¨masterä¸Š)ï¼ŒæœƒåŒæ™‚é€å‡ºä¸€å€‹webhookçµ¦droneï¼Œ&lt;br /&gt;
æ­¤æ™‚droneå°±æœƒå»gitlab  pullç¨‹å¼ç¢¼ä¸‹ä¾†ï¼Œåšä½ æƒ³è¦çš„å‹•ä½œï¼ˆä¾‹å¦‚ï¼Œæ‰“åŒ…æˆimageï¼ŒæŠŠimageé€åˆ°gcrä¸Šé¢ï¼Œå†ä½ˆç½²åˆ°GKEä¸Šï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆä¾†ä»½yamlï¼Œå»ºè­°å¯ä»¥å…ˆçœ‹ä¸€ä¸‹yamlæ˜¯ä»€éº¼æ±è¥¿ï¼Œé€™æ¨£å¯«èµ·ä¾†æ¯”è¼ƒä¸æœƒæ’ç‰†ã€‚&lt;br /&gt;
(ref. &lt;a href=&quot;https://zh.wikipedia.org/wiki/YAML&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://zh.wikipedia.org/wiki/YAML&lt;/a&gt;)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kind: pipeline
name: Pipeline(branch)

steps:      
- name: push2GCR(å‰å“¨)
  image: plugins/gcr
  settings:
    repo: gcr.io/rd7-project/landingpage
    tags:
      - latest
      - ${DRONE_COMMIT}
    # dockerfile: configs/beta/Dockerfile
    json_key:
      from_secret: GOOGLE_CREDENTIALS
    build_args:
      - website=beta

- name: deploy2GKE(å‰å“¨)
  image: nytimes/drone-gke
  environment:
    TOKEN:
      from_secret: GOOGLE_CREDENTIALS
  settings:
    project: rd7-project
    # æ”¹æ‹‰åƒæ•¸å‚³å…¥kube.ymlå…§
    # template: configs/beta/.kube.yml
    vars:
      deployName: yaboxxx-landing-page-beta
      env: beta
    zone: asia-east1-a
    cluster: xbb-common
trigger:   
  # branch:
  #   - master
  ref:
    include:
      - refs/heads/master
  event:
    - push
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æˆä¸‰å°å¡Šä¾†çœ‹ï¼Œ&lt;br /&gt;
å¦‚æœä»¥ --- å€åˆ†çš„è©±ï¼Œé‚£&lt;br /&gt;
kind: pipeline&lt;br /&gt;
name: Pipeline(branch)&lt;br /&gt;
æ˜¯å¿…é ˆçš„ã€‚&lt;/p&gt;
&lt;p&gt;å†ä¾†æ˜¯ steps ï¼Œ&lt;br /&gt;
æ ¹æ“šæ­¥é©Ÿæ¸¸ä¸Šå¾€ä¸‹åŸ·è¡Œï¼Œå¦‚æœè¦å¹¶è¡Œçš„è©±ï¼Œå‰‡ä½¿ç”¨depend_on ï¼Œ&lt;br /&gt;
é€™éƒ¨åˆ†ç•™åˆ°ä¸‹æ¬¡è¬›ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;trigger ï¼Œé€™æ˜¯è§¸ç™¼æ¢ä»¶ï¼Œè¡¨ç¤ºåœ¨gitlabä¸Šé¢åšäº†å“ªäº›å‹•ä½œï¼Œæœƒè§¸ç™¼é€™å€‹stepï¼ˆæ­¥é©Ÿï¼‰&lt;br /&gt;
é€™é‚Šçš„è§¸ç™¼äº‹ä»¶ï¼Œå¸¸ç”¨åˆ°æ‡‰è©²æ˜¯ Branchã€Reference ä»¥åŠ Event&lt;br /&gt;
(ref. &lt;a href=&quot;https://docs.drone.io/pipeline/docker/syntax/trigger/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://docs.drone.io/pipeline/docker/syntax/trigger/&lt;/a&gt;)&lt;br /&gt;
Branch è·Ÿ Event æ¯”è¼ƒå¥½ç†è§£ï¼ˆä½†ç¢°åˆ°Tagçš„äº‹ä»¶åˆæ˜¯å¦ä¸€å›äº‹äº†ï¼‰ ã€‚&lt;br /&gt;
Reference é€™å€‹å…¶å¯¦åªè¦åœ¨ä½ çš„gitè£¡é¢ä¸‹æŒ‡ä»¤&lt;br /&gt;
tree .git/refs/&lt;br /&gt;
å¤§æ¦‚å°±æœƒçŸ¥é“ä»–åœ¨è¬›äº›ä»€éº¼ï¼Œgitçš„åº•å±¤éƒ½æ˜¯é refså»ç”¨å‡ºä¾†çš„&lt;br /&gt;
(&lt;br /&gt;
ref.&lt;br /&gt;
&lt;a href=&quot;http://iissnan.com/progit/html/zh-tw/ch9_3.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;http://iissnan.com/progit/html/zh-tw/ch9_3.html&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://titangene.github.io/article/git-branch-ref.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://titangene.github.io/article/git-branch-ref.html&lt;/a&gt;&lt;br /&gt;
)&lt;br /&gt;
ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œdrone 1.Xï¼Œä»¥å¾Œçš„ç‰ˆæœ¬ä¸æ”¯æ´eventçš„tag èˆ‡ branch å…±å­˜ã€‚&lt;br /&gt;
å¯ä»¥åƒè€ƒé€™ç¯‡&lt;br /&gt;
(&lt;br /&gt;
ref.&lt;br /&gt;
&lt;a href=&quot;https://github.com/drone/drone/issues/2536&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://github.com/drone/drone/issues/2536&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://rabbit52.com/2019/11/drone-from-0-8-to-1-0/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://rabbit52.com/2019/11/drone-from-0-8-to-1-0/&lt;/a&gt;&lt;br /&gt;
)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;steps:&lt;br /&gt;
é€™éƒ¨åˆ†å‰‡é–‹å§‹ç”±ä¸Šå¾€ä¸‹é–‹å§‹åŸ·è¡Œï¼Œ&lt;br /&gt;
åƒä¸Šé¢çš„ç¨‹å¼å…ˆåšçš„æ˜¯å°‡ç¨‹å¼æ‰“åŒ…å¾Œï¼Œä¸Šå‚³åˆ°GCRä¸Šé¢ã€‚&lt;br /&gt;
ï¼ˆæœ€ä¸Šé¢é‚„æœ‰ä¸€æ®µcloneï¼Œæœƒå…ˆåšï¼ˆé€™æ˜¯droneé è¨­çš„ï¼‰ï¼Œå°‡gitlabçš„ç¨‹å¼è¤‡è£½åˆ°æ©Ÿå™¨å…§ï¼Œé€™æ¨£æ‰èƒ½åšå¾Œé¢çš„ä¸Šå‚³ï¼Œ&lt;br /&gt;
é€™ä¸€å¡Šå¯ä»¥ åƒè€ƒ &lt;a href=&quot;https://docs.drone.io/pipeline/docker/syntax/cloning/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://docs.drone.io/pipeline/docker/syntax/cloning/&lt;/a&gt;  ï¼‰&lt;br /&gt;
ä¸Šå‚³åˆ°GCRä½¿ç”¨çš„ plugins/gcr ï¼Œé€™å€‹imageï¼Œè£¡é¢çš„åƒæ•¸è«‹åƒè€ƒ&lt;a href=&quot;http://plugins.drone.io/drone-plugins/drone-gcr/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;èªªæ˜é é¢&lt;/a&gt;&lt;br /&gt;
ç”±æ–¼é€™é‚Šéœ€è¦ä¸Šå‚³åˆ°GCRï¼Œæ•…è¦å…ˆåˆ°Google çš„ æœå‹™è³¬æˆ¶ç”³è«‹æ¬Šé™ ï¼Œé™¤äº†éœ€è¦pushä»¥å¤–é‚„å¿…é ˆè¦æœ‰ storage.buckets.get&lt;br /&gt;
é€™é‚Šæœƒå–å¾—ä¸€å€‹jsonæª”æ¡ˆï¼Œå°‡å…§å®¹å¡å…¥droneå…§çš„Sercetsã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/3.%20fig-1.jpg&quot; alt=&quot;3. fig-1.jpg&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â± Drone/3. æ’°å¯«drone.yml ç­†è¨˜ç¯‡(æœª)/" />
        </entry>
        <entry>
            <title>
                119. Drone  plugin-Drone-docker ä¿®æ”¹åŸå§‹æª”
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â± Drone/119. Drone  plugin-Drone-docker ä¿®æ”¹åŸå§‹æª”/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;ä¹‹å‰ç™¼ç¾ä¸€å€‹å¾Œç«¯åŸ·è¡Œdroneæœƒç™¼ç”Ÿçš„å•é¡Œï¼Œ&lt;br /&gt;
å¶çˆ¾ç™¼ç”Ÿï¼Œä½†ä¸€æ®µæ™‚é–“ç¸½æœƒç™¼ç”Ÿä¸€æ¬¡ã€‚&lt;br /&gt;
å¤šå€‹stepåŒæ™‚buildï¼Œæœƒé€ æˆimageéŒ¯äº‚ã€‚&lt;br /&gt;
å¥½éº»ç…©é˜¿....&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å…ˆä¾†çœ‹å¹¾å¼µåœ–ï¼Œæ‡‰è©²å°±èƒ½ç­è§£æˆ‘å†èªªä»€éº¼äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/119-fig.1.jpg&quot; alt=&quot;119-fig.1.jpg&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/119-fig.2.jpg&quot; alt=&quot;119-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆçœ‹åˆ°ç¬¬ä¸€å¼µåœ–ï¼Œä»–åœ¨åŸ·è¡Œdocker buildçš„æ™‚å€™ï¼Œæœƒç”¨git commitçš„å€¼ï¼Œç•¶ä½œimageçš„tagåç¨±ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œçœ‹ç¬¬äºŒå¼µåœ–ï¼Œç›´åˆ°buildå®Œimageå¾Œï¼Œæ‰æœƒå†æ ¹æ“šä½ çš„tagå»å°‡imageæ”¹æˆä½ è¦çš„tags&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘å€‘ä¾†æƒ³ä¸€å€‹æƒ…å¢ƒï¼Œç•¶Aã€BåŒæ™‚åŸ·è¡Œæ™‚ï¼Œä»–å€‘çš„git commitéƒ½ä¸€æ¨£ï¼Œ&lt;br /&gt;
Aå·²ç¶“buildå®Œäº†ï¼Œæ­£è¦åŸ·è¡Œæœ€å¾Œä¸€å€‹æ­¥é©Ÿï¼Œå°‡git commit tagæ”¹æˆæ­£å¸¸çš„image tag ã€‚&lt;br /&gt;
æ­¤æ™‚Bä¹Ÿå‰›buildå®Œï¼Œæ‰€ä»¥ä»–ä¹Ÿç”¢ç”Ÿäº†ä¸€å€‹ä¸€æ¨¡ä¸€æ¨£çš„ commit tagçš„imageï¼Œé‚£AåŸ·è¡Œæœ€å¾Œä¸€å€‹æ­¥é©Ÿæ™‚ï¼Œä»–æ”¹å¾—åˆ°åº•æ˜¯èª°çš„imageï¼Ÿ&lt;/p&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä¸€å€‹æ¥ä¸€å€‹stepè·‘çš„è©±ï¼Œæ™‚é–“å¤§æ¦‚éœ€è¦ 4åˆ†åŠï¼Œ&lt;br /&gt;
ä½†åŒæ­¥çš„è©±ï¼Œåªè¦1åˆ†åŠï¼Œæ™‚é–“å¿«äº†ä¸‰å€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥é‚„æ˜¯è¦æƒ³è¾¦æ³•è§£æ‰ï¼Œæœ¬ä¾†æœ‰æƒ³å¹¾å€‹è§£æ³•ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸€æ¬¡æŠŠç¨‹å¼éƒ½buildä¸€éï¼Œæ”¾åœ¨åŒä¸€å€‹imageå…§ï¼Œ&lt;br /&gt;
åŸ·è¡Œæ™‚ï¼Œå†æ ¹æ“šåƒæ•¸çœ‹è¦åŸ·è¡Œå“ªå€‹æª”æ¡ˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½†æ˜¯ä»–å€‘æœ‰ä¸€ç¨®æƒ…å¢ƒæ˜¯åªè¦æ›´æ–°å…¶ä¸­ä¸€å€‹åŠŸèƒ½å°±å¥½ï¼Œé‚£æ­¤æ™‚å…¨éƒ¨buildå°±ä¸å¤ªé©åˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;
&lt;p&gt;åœ¨drone stepæ™‚ï¼Œå¡tagé€²å»ï¼Œä½†ä»–åªæœƒåœ¨æœ€å¾Œä¸€å€‹æ­¥é©Ÿï¼Œæ‰æœƒæ”¹imageçš„tag ï¼Œé€™æ‹›ä¹Ÿä¸è¡Œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¹plugin/gcr äº†ï¼Œåœ¨ç¬¬ä¸€æ­¥é©Ÿæ™‚å°±æŠŠimageçš„tagæ”¹æ‰ï¼Œä¸è¦ä½¿ç”¨git commitï¼Œé‚£å°±è§£æ‰é€™å€‹å•é¡Œäº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;å‹•æ‰‹&quot; tabindex=&quot;-1&quot;&gt;å‹•æ‰‹&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆæ‰¾åˆ°é€™å€‹imageçš„åŸå§‹ç¢¼ &lt;a href=&quot;https://github.com/drone-plugins/drone-docker&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;drone-plugins/drone-docker&lt;/a&gt;ï¼Œç„¶å¾Œé–‹å§‹æ”¹å§ã€‚&lt;/p&gt;
&lt;p&gt;å„ç’°å¢ƒmain.goçš„package import docker è¦å…ˆæ”¹æ‰ï¼Œä¸æ”¹æ‰æˆ‘ä¸ç¢ºå®šä»–æœƒä¸æœƒæŠ“æœ¬æ©Ÿçš„packageï¼Œæˆ‘golangåˆå­¸æ²’å¤šä¹…ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹å‰&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-go&quot;&gt;import (
	&amp;quot;os&amp;quot;
	&amp;quot;runtime&amp;quot;

	&amp;quot;github.com/joho/godotenv&amp;quot;
	&amp;quot;github.com/sirupsen/logrus&amp;quot;
	&amp;quot;github.com/urfave/cli&amp;quot;

	docker &amp;quot;github.com/drone-plugins/drone-docker&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¿®æ”¹å¾Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-go&quot;&gt;import (
	&amp;quot;os&amp;quot;
	&amp;quot;runtime&amp;quot;

	&amp;quot;github.com/joho/godotenv&amp;quot;
	&amp;quot;github.com/sirupsen/logrus&amp;quot;
	&amp;quot;github.com/urfave/cli&amp;quot;

	docker &amp;quot;drone-docker&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œæˆ‘åœ¨docker.goä¸Šé¢ç›´æ¥åŠ äº†å…©è¡Œï¼ŒæŒ‡å®šäº†tagï¼Œé€™ä¸é©åˆæ‰€æœ‰äººï¼Œ&lt;br /&gt;
å› ç‚ºä½ å€‘çš„ä½¿ç”¨æƒ…å¢ƒå¯èƒ½è·Ÿæˆ‘ä¸å¤ªä¸€æ¨£ï¼Œæˆ‘é€™é‚Šæ˜¯åªè¦pushåˆ°gitå¾Œï¼Œdroneæœƒè‡ªå‹•ç”¢ç”Ÿtagï¼Œæ‰€ä»¥å¦‚æœä¸æŒ‡å®šçš„è©±ï¼Œæˆ‘é‚„æ˜¯æœ‰tagçš„å€¼å¯ä»¥å–å¾—ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-go&quot;&gt;tag := build.Repo + &amp;quot;:&amp;quot; + build.Tags[0]

args := []string{
&amp;quot;build&amp;quot;,
&amp;quot;--rm=true&amp;quot;,
&amp;quot;-f&amp;quot;, build.Dockerfile,
&amp;quot;-t&amp;quot;, build.Name,
&amp;quot;-t&amp;quot;, tag,
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦å¤–ï¼Œå¦‚æœè¦çŸ¥é“plugin/gcrè£é¢æœ‰ä»€éº¼ç’°å¢ƒè®Šæ•¸å¯ä»¥æ‹¿ä¾†ç”¨çš„è©±ï¼Œ&lt;br /&gt;
å¯ä»¥åœ¨droneçš„stepä¸Šé¢ï¼ŒåŸ·è¡Œexport -p&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- name: publish-dev
  image: plugins/gcr
  pull: if-not-exists
  volumes:
    - name: docker
      path: /var/run/docker.sock   
  commands: 
    - export -p
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŸ·è¡Œçµæœï¼š&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/119-fig.3.jpg&quot; alt=&quot;119-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ”¹å®Œå¾Œï¼ŒåŸ·è¡Œä¸‹é¢çš„æŒ‡ä»¤å…ˆç”¢ç”Ÿgo çš„ç¨‹å¼ã€‚&lt;br /&gt;
é€™å€‹goçš„æŒ‡ä»¤ï¼Œæˆ‘æ˜¯å¾.drone.yamlæŠ„å‡ºä¾†çš„ã€‚&lt;br /&gt;
åŸ·è¡Œå‰è¨˜å¾—å…ˆè¨­å®šç’°å¢ƒè®Šæ•¸&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;export GOOS=linux
export GOARCH=amd64
export CGO_ENABLED=0
export GO111MODULE=on
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;go-build&quot; tabindex=&quot;-1&quot;&gt;Go build&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-go&quot;&gt;go build -v -ldflags &amp;quot;-X main.version=${DRONE_COMMIT_SHA:0:8}&amp;quot; -a -tags netgo -o release/linux/amd64/drone-docker ./cmd/drone-docker
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&quot;language-go&quot;&gt;go build -v -ldflags &amp;quot;-X main.version=${DRONE_COMMIT_SHA:0:8}&amp;quot; -a -tags netgo -o release/linux/amd64/drone-gcr ./cmd/drone-gcr
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;docker-build&quot; tabindex=&quot;-1&quot;&gt;Docker build&lt;/h3&gt;
&lt;p&gt;å°‡goçš„åŸ·è¡Œæª”æ‰“åŒ…é€²å»docker imageå…§ï¼Œ&lt;br /&gt;
å…ˆæ‰“åŒ…åˆ°æœ¬æ©Ÿçš„docker:linux-amd64ï¼Œ&lt;br /&gt;
å› ç‚ºdocker-gcrçš„dockerfileæœƒå»æŠ“docker:linux-amd64 ç•¶ä½œimageçš„åŸºåº•å†ç”¢ç”Ÿæª”æ¡ˆ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;docker build &#92;
  --label org.label-schema.build-date=$(date -u +&amp;quot;%Y-%m-%dT%H:%M:%SZ&amp;quot;) &#92;
  --label org.label-schema.vcs-ref=$(git rev-parse --short HEAD) &#92;
  --file docker/docker/Dockerfile.linux.amd64 --tag plugins/docker:linux-amd64 .
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;docker build &#92;
  --label org.label-schema.build-date=$(date -u +&amp;quot;%Y-%m-%dT%H:%M:%SZ&amp;quot;) &#92;
  --label org.label-schema.vcs-ref=$(git rev-parse --short HEAD) &#92;
  --file docker/gcr/Dockerfile.linux.amd64 --tag asia-east1-docker.pkg.dev/rouge-sms/docker-public/gcr:0.0.13 .
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;å®Œæˆ&quot; tabindex=&quot;-1&quot;&gt;å®Œæˆ&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/119-fig.4.jpg&quot; alt=&quot;119-fig.4.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šåœ–å¯ä»¥çœ‹åˆ°ï¼Œåœ¨docker buildæ™‚ï¼ŒæœƒåŒæ™‚ä¸‹å…©å€‹tagï¼Œ&lt;br /&gt;
ä¸€å€‹é‚„æ˜¯ç¶­æŒgit commitçš„å€¼ï¼Œä½†å¦ä¸€å€‹å°±æ˜¯æ‹¿repositoryåŠ ç‰ˆæœ¬è™Ÿç•¶ä½œtagã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://discourse.drone.io/t/drone-step-name-not-available-as-substitution-in-environment/8389&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;DRONE_STEP_NAME not available as substitution in environment&lt;/a&gt;
&lt;blockquote&gt;
&lt;p&gt;æŸ¥è³‡æ–™æ™‚å‰›å¥½æœ‰ç¢°åˆ°é€™å€‹å•é¡Œï¼Œdrone_step_nameä¸€ç›´æŠ“ä¸åˆ°ï¼ŒåŸå› å†æ–‡ç« å…§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/drone-plugins/drone-docker/compare/f9d0b60cb05ff9e37787651be4c54bfff2fe9a08..d41b50e5aa5ec4baf57f94448c1e7ce6c8f6282a&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; ä¿®å¾©åœ¨å¤šæ¨¡çµ„javaé …ç›®ä¸­ï¼Œå¹³è¡Œæ‰“åŒ…é¡åƒæ™‚ï¼Œé¡åƒå› ç‚ºåŒåç¨±è¢«è¦†è“‹çš„å•é¡Œ&lt;/a&gt;
&lt;blockquote&gt;
&lt;p&gt;æ˜¨å¤©æ‰çœ‹åˆ°æœ‰äººç™¼äº†å€‹PRä¿®å¾©åŒåç¨±çš„å•é¡Œï¼Œæ„Ÿè¦ºè·Ÿæˆ‘çš„é —åƒï¼Œä½†å¯¦éš›çœ‹äº†ï¼Œè¦ºå¾—ä¸å¤ªé©åˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/â± Drone/119. Drone  plugin-Drone-docker ä¿®æ”¹åŸå§‹æª”/" />
        </entry>
        <entry>
            <title>
                109. drone jsonnet å„ç¨®æ€ªæ‹›
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â± Drone/109. drone jsonnet å„ç¨®æ€ªæ‹›/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;æœ¬æ–‡ç« å…§å®¹åŒ…å«è¨±å¤šå¯«drone jsonnetæœƒç¢°åˆ°çš„å¯«æ³•ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;åœ¨pipelineä¸‹comandçš„æ™‚å€™ï¼Œæœ‰æ™‚æœƒç¢°åˆ°å¤šè¡ŒæŒ‡ä»¤æ¹Šåœ¨ä¸€èµ·çš„æƒ…æ³ï¼Œ&lt;br /&gt;
åœ¨drone.yamlæ˜¯ç›´æ¥é€™æ¨£å¯«&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/109-fig.1.jpg&quot; alt=&quot;â± Drone/109-fig.1.jpg&quot; /&gt;&lt;br /&gt;
ä½†å¦‚æœè¦ç”¨jsonnetçš„è©±ï¼Œè¦ç”¨&lt;code&gt;&#92;n&lt;/code&gt;æ›è¡Œï¼Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/109-fig.2.jpg&quot; alt=&quot;â± Drone/109-fig.2.jpg&quot; /&gt;&lt;br /&gt;
è½‰æ›å¾Œå°±æœƒè®Šæˆä¸‹åœ–&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/109-fig.3.jpg&quot; alt=&quot;109-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨åŸ·è¡Œcommandçš„æ™‚å€™ï¼Œå› ç‚ºè¦å…ˆç”¨&lt;code&gt;&amp;quot;&lt;/code&gt; å°‡æŒ‡ä»¤åŒ…èµ·ä¾†ï¼Œå¦‚æœè£é¢é‚„è¦æœ‰&lt;code&gt;&amp;quot;&lt;/code&gt; çš„è©±ï¼Œå¿…é ˆåœ¨å‰é¢åŠ ä¸Š &lt;code&gt;&#92;&lt;/code&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/109-fig.4.jpg&quot; alt=&quot;109-fig.4.jpg&quot; /&gt;&lt;br /&gt;
åŸ·è¡Œ&lt;code&gt;drone jsonnet --stream --format&lt;/code&gt;å¾Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/109-fig.5.jpg&quot; alt=&quot;109-fig.5.jpg&quot; /&gt;&lt;br /&gt;
é€™æ˜¯å› çˆ² linux shellè£é¢ï¼Œå–®å¼•è™Ÿè·Ÿé›™å¼•è™Ÿçš„å·®åˆ¥ï¼Œè©³ç´°å¯çœ‹&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/133.%20shell%20script%E5%AD%97%E4%B8%B2%E8%99%95%E7%90%86/&quot;&gt;shell script é›™å¼•è™Ÿèˆ‡å–®å¼•è™Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœç¢°åˆ°å¾ˆé•·çš„ä¸€ä¸²æŒ‡ä»¤ï¼Œä¾‹å¦‚if elseä¹‹é¡çš„ï¼Œæ”¹ä½¿ç”¨  @&#39;&#39; å°‡ç¨‹å¼åŒ…èµ·ä¾†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;@&#39;
if [ -z $${TAG_FROM} ]

then

echo &amp;quot;éŒ¯èª¤ï¼šç„¡ä¾†æºTAGã€‚&amp;quot;;

exit 1

fi&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;å¦‚æœå­—ä¸²éé•·ï¼Œæƒ³è¦æ›è¡Œçš„è©±ï¼Œ å¯åœ¨é›™å¼•è™Ÿå…§ ä½¿ç”¨ å…©å€‹&#92; &lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/109-fig.6.jpg&quot; alt=&quot;109-fig.6.jpg&quot; /&gt;&lt;/li&gt;
&lt;li&gt;ç”¨curlæ™‚ï¼Œæœ‰äº›åƒæ•¸è¦ç”¨&amp;quot; ï¼Œæ‰€ä»¥åœ¨å–®å¼•è™Ÿä½¿ç”¨ &amp;quot; &amp;quot; å›ºå®šåƒæ•¸ï¼Œè¦å…ˆç”¨ @ &#39;&#39; åŒ…èµ·ä¾†&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;  @&#39;OAUTH2_TOKEN=$(curl -XGET $${TOTP_AUTH_URL} &#92;&#92;
       -H &amp;quot;accept: application/json&amp;quot; &#92;&#92;
       -H &amp;quot;TOTP-PIN-CODE: $${pin}&amp;quot; &#92;&#92;
       -H &amp;quot;TOTP-USER: $${user}&amp;quot;)&#39;, 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://book.king011.com/view/en-US/view/google-jsonnet/tutorial&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; jsonnetæ•™å­¸ &lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://jsonnet.org/learning/tutorial.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;jsonnet å®˜æ–¹èªªæ˜ &lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://jsonnet.org/ref/stdlib.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; Standard Library&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/â± Drone/109. drone jsonnet å„ç¨®æ€ªæ‹›/" />
        </entry>
        <entry>
            <title>
                10.drone ä½¿ç”¨ é¨°è¨Šé›² K8SåŠ å®¹å™¨é¡åƒæœå‹™
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â± Drone/10.drone ä½¿ç”¨ é¨°è¨Šé›² K8SåŠ å®¹å™¨é¡åƒæœå‹™/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ç§‘æŠ€å§‹çµ‚ä¾†è‡ªæ–¼äººæ€§ï¼Œç¾åœ¨è¦è®“è‡ªå‹•ä½ˆç½²å¯ä»¥æ”¯æ´åˆ°é¨°è¨Šé›²&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;1.ç™¼ä½ˆimageåˆ°é¨°è¨Šé›²çš„å®¹å™¨é¡åƒæœå‹™&lt;/p&gt;
&lt;p&gt;ç›´æ¥å…ˆçµ¦ drone.yml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- name: push2TCR  
  image: plugins/docker
  settings:
    username:
      from_secret: TCR_user
    password:
      from_secret: TCR_PW
    build_args:
      - website=qa
      - location=tke  
    repo: tcr.tencentcloudcr.com/project/abc
    registry: tcr.tencentcloudcr.com
    tags:
    - latest
    - ${DRONE_COMMIT}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šä½¿ç”¨çš„docker image è«‹åƒè€ƒ &lt;a href=&quot;http://plugins.drone.io/drone-plugins/drone-docker/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Docker&lt;/a&gt;&lt;br /&gt;
è¦æ³¨æ„çš„åœ°æ–¹åœ¨ï¼Œå¦‚æœç›´æ¥æŠŠusernameè·Ÿ password æ‰“åœ¨ä¸Šé¢çš„è©±ï¼Œ&lt;br /&gt;
æœƒç™¼ç”Ÿé©—è­‰å¤±æ•—ã€‚&lt;br /&gt;
éœ€è¦å°‡å¸³è™Ÿå¯†ç¢¼æ”¾åˆ°droneè£¡é¢çš„ Secretsï¼Œ&lt;br /&gt;
ä¸€é–‹å§‹ä¹Ÿå¯ä»¥ä½¿ç”¨ command ç›´æ¥çœ‹æœ‰æ²’æœ‰æˆåŠŸç™»å…¥ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- name: push2TCR  
  image: plugins/docker
  commands:
    - docker login tcr.tencentcloudcr.com --username 123456789 --password token
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦å¤–ï¼Œç•¶åˆåœ¨è¨­å®šçš„æ™‚å€™ï¼Œæœ‰é™å®šipæ‰èƒ½é€£ç·šï¼Œé€™éƒ¨åˆ†è¨˜å¾—è¦æ‰“é–‹&lt;br /&gt;
ï¼Œå¦‚æœæ²’æœ‰å°±ä¸ç”¨åœ¨æ„äº†ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/10.fig-1.jpg&quot; alt=&quot;10.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;2.ä½ˆç½²åˆ°é¨°è¨Šé›²&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kind: pipeline
name: TKEPipeline(QA)

platform:
  os: linux
  arch: amd64

steps:

- name: deploy2TKE-QA
  image: danielgormly/drone-plugin-kube:0.0.2
  settings:
    template: tke.yml
    server: https://loud.com
    ca:
      from_secret: TKE_CA
    token:
      from_secret:  TKE_TOKEN
    namespace: demo
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;server è·Ÿ  ca tokenï¼Œéœ€çœ‹é¨°è¨Šé›²é›†ç¾¤ä¸Šçš„è¨­å®š&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/10.fig-2.jpg&quot; alt=&quot;10.fig-2.jpg&quot; /&gt;&lt;br /&gt;
é€™å€‹imageä¸åƒGKEä¸€æ¨£æœ‰åƒæ•¸å¯ä»¥ä¸Ÿé€²å»ï¼Œåªæœ‰å›ºå®šçš„å¹¾å€‹åƒæ•¸&lt;br /&gt;
ref. &lt;a href=&quot;https://github.com/danielgormly/drone-plugin-kube&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;danielgormly/drone-plugin-kube&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‰€å¹¸é€™å€‹æœ‰æ”¾åœ¨githubä¸Šï¼Œé‚„èƒ½å¤ æ ¹æ“šè‡ªå·±çš„éœ€æ±‚æ›´æ”¹å…§å®¹ï¼Œå¢åŠ åƒæ•¸ã€‚&lt;br /&gt;
é‡æ–°ç·¨è­¯å¾Œï¼Œå¦‚æœä¸æ˜¯ä¸Šå‚³åˆ°å…¬é–‹çš„Container Registry ï¼Œè€Œæ˜¯å‚³åˆ°ç§æœ‰çš„CRå°±å¿…é ˆåŠ ä¸Š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;image_pull_secrets:
- TKE_LOGIN
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™å€‹èˆ‡image åŒæ¨£çš„å±¤ç´šï¼Œä¸ç„¶æœƒå°è‡´pull imageå¤±æ•—&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8F%B1%20Drone/10.fig-3.jpg&quot; alt=&quot;10.fig-3.jpg&quot; /&gt;&lt;br /&gt;
ref.&lt;a href=&quot;https://discourse.drone.io/t/how-to-pull-private-images-with-1-0/3155&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How to pull private images with 1.0&lt;/a&gt;ï¼Œ&lt;/p&gt;
&lt;p&gt;è‡³æ–¼TKE_LOGINçš„å…§å®¹ï¼ˆé€™å€‹ä¹Ÿå¿…é ˆåŠ åœ¨droneçš„Secretså…§ï¼‰ï¼Œ&lt;br /&gt;
é€šå¸¸æ˜¯åœ¨ $HOME/.docker/config.json å…§ï¼Œæœƒé•·å¾—åƒ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{
	&amp;quot;auths&amp;quot;: {
		&amp;quot;https://index.docker.io/v1/&amp;quot;: {
			&amp;quot;auth&amp;quot;: &amp;quot;YW11cmRhY2E6c3VwZXJzZWNyZXRwYXNzd29yZA==&amp;quot;
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œæˆ‘çš„åªæœ‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{
	&amp;quot;auths&amp;quot;: {
		&amp;quot;https://index.docker.io/v1/&amp;quot;: {}
	}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥ä¸‹é¢é‚£å€‹å°±å¿…é ˆè‡ªå·±ç”¢ç”Ÿäº†ï¼Œ&lt;br /&gt;
ç”¢ç”Ÿçš„æ–¹å¼å¦‚ä¸‹&lt;br /&gt;
echo -n &#39;username:password&#39; | base64&lt;br /&gt;
æŠŠusernameèˆ‡ password è¼¸å…¥ï¼Œè½‰æˆbase64ï¼Œå†è²¼ä¸Šå»è‡³ç¨‹å¼ç¢¼å…§ï¼Œä¸¦å„²å­˜è‡³droneçš„Secrets&lt;br /&gt;
ref.&lt;a href=&quot;https://stackoverflow.com/questions/43441454/docker-login-auth-token&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Docker login auth token&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è‡³æ–¼ä¿®æ”¹é€™å€‹imageï¼Œè¦åŠ å…¥åƒæ•¸çš„è©±ï¼Œ&lt;br /&gt;
ç›®å‰çœ‹æ‡‰è©²æ˜¯ å¢åŠ  main.go è·Ÿ plugin çš„ Kubeconfig åƒæ•¸ï¼Œç„¶å¾Œé‡æ–°ç·¨è­¯(&lt;a href=&quot;http://build.sh/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;build.sh&lt;/a&gt;)å³å¯&lt;/p&gt;
&lt;p&gt;p.s. åœ¨é¨°è¨Šé›²çš„pod(Alpine Linux)å…§å®‰è£è»Ÿé«”ï¼Œéœ€æ›¿æ›é¡åƒæº&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sed -i &#39;s/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g&#39; /etc/apk/repositories
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
æ”¯æ´k8sçš„å„ç¨®æŒ‡ä»¤&lt;a href=&quot;https://github.com/Sh4d1/drone-kubernetes&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Sh4d1/drone-kubernetes&lt;/a&gt;&lt;br /&gt;
å¯ç›´æ¥åœ¨droneä¸Šä¸‹kubectlæŒ‡ä»¤&lt;a href=&quot;https://github.com/sinlead/drone-kubectl&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;sinlead/drone-kubectl&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://containerization-automation.readthedocs.io/zh_CN/latest/docker/advanced/%5Balpine%5D%E6%BA%90%E9%85%8D%E7%BD%AE/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;alpineæºé…ç½®&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/â± Drone/10.drone ä½¿ç”¨ é¨°è¨Šé›² K8SåŠ å®¹å™¨é¡åƒæœå‹™/" />
        </entry>
        <entry>
            <title>
                0.Drone MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/â± Drone/0.Drone MOC/</id>
            <content type="html">
                &lt;h1 id=&quot;å»ºç½®&quot; tabindex=&quot;-1&quot;&gt;å»ºç½®&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8F%B1%20Drone/72.%20drone%20on%20GKE%20%E5%BB%BA%E7%AB%8B/&quot;&gt;72. drone on GKE å»ºç«‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8F%B1%20Drone/10.drone%20%E4%BD%BF%E7%94%A8%20%E9%A8%B0%E8%A8%8A%E9%9B%B2%20K8S%E5%8F%8A%20%E5%AE%B9%E5%99%A8%E9%8F%A1%E5%83%8F%E6%9C%8D%E5%8B%99/&quot;&gt;10.drone ä½¿ç”¨ é¨°è¨Šé›² K8SåŠ å®¹å™¨é¡åƒæœå‹™&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8F%B1%20Drone/77.%20drone%20build%20Open%20Source%20Edition/&quot;&gt;77. drone build Open Source Edition&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8F%B1%20Drone/78.%20drone%20k8s-runner%20%E9%80%B2%E9%9A%8E%E8%A8%AD%E5%AE%9A/&quot;&gt;78. drone k8s-runner é€²éšè¨­å®š&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;ç·¨å¯«&quot; tabindex=&quot;-1&quot;&gt;ç·¨å¯«&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;3. æ’°å¯«drone.yml ç­†è¨˜ç¯‡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8F%B1%20Drone/109.%20drone%20jsonnet%20%E5%90%84%E7%A8%AE%E6%80%AA%E6%8B%9B/&quot;&gt;109. drone jsonnet å„ç¨®æ€ªæ‹›&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8F%B1%20Drone/119.%20Drone%20%20plugin-Drone-docker%20%E4%BF%AE%E6%94%B9%E5%8E%9F%E5%A7%8B%E6%AA%94/&quot;&gt;119. Drone  plugin-Drone-docker ä¿®æ”¹åŸå§‹æª”&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/â± Drone/0.Drone MOC/" />
        </entry>
        <entry>
            <title>
                98. k8sä¸­çš„commandèˆ‡dockerfileçš„ CMD
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Yaml/98. k8sä¸­çš„commandèˆ‡dockerfileçš„ CMD/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å¿˜è¨˜æ˜¯ä»€éº¼åŸå› ï¼Œ&lt;/p&gt;
&lt;p&gt;è®“æˆ‘è·‘å»æŸ¥é€™å…©å€‹çš„å·®ç•°&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;dockerfileä¸­çš„æŒ‡ä»¤&lt;/p&gt;
&lt;p&gt;CMD ã€ ENTRYPOINT&lt;/p&gt;
&lt;p&gt;k8s ä¸­çš„yaml ä¸­ä¹Ÿæœ‰&lt;/p&gt;
&lt;p&gt;command ã€args&lt;/p&gt;
&lt;p&gt;å…ˆä¾†åˆ†è¾¨ CMD èˆ‡ ENTRYPOINTçš„å·®åˆ¥&lt;/p&gt;
&lt;h3 id=&quot;cmd&quot; tabindex=&quot;-1&quot;&gt;CMD&lt;/h3&gt;
&lt;p&gt;å…ˆä¸Šå€‹Dockerfile&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FROM golang:1.16-alpine AS build-env

CMD [&amp;quot;/bin/sh&amp;quot;,&amp;quot;-c&amp;quot;,&amp;quot;echo $HOME&amp;quot;]

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™å€‹buildå®Œå¾Œï¼Œç›´æ¥åŸ·è¡Œæœƒé¡¯ç¤º /rootï¼Œå¦‚æœç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker run golang:1.16 /bin/sh -c &amp;quot;echo $SHELL&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼Œæœƒç›´æ¥åŸ·è¡Œå‰›å‰›çš„æŒ‡ä»¤ã€‚&lt;br /&gt;
åŸå› æ˜¯ï¼ŒCMD è·Ÿ å¤–é¢æ¥å—çš„æŒ‡ä»¤æœƒäº’ç›¸è¦†è“‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/98-fig-1.jpg&quot; alt=&quot;98-fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;entrypoint&quot; tabindex=&quot;-1&quot;&gt;ENTRYPOINT&lt;/h3&gt;
&lt;p&gt;Dockerfile&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FROM golang:1.16-alpine AS build-env

ENTRYPOINT [&amp;quot;/bin/sh&amp;quot;,&amp;quot;-c&amp;quot;,&amp;quot;echo $HOME&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŒæ¨£ä¹Ÿç›´æ¥åŸ·è¡Œæœƒé¡¯ç¤º /root ï¼Œ&lt;br /&gt;
å¦‚æœç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker run golang:1.17 /bin/sh -c &amp;quot;echo $SHELL&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‚„æ˜¯é¡¯ç¤º /root&lt;br /&gt;
åŸå› æ˜¯ï¼Œä½¿ç”¨entrypointçš„è©±ï¼ŒæŒ‡ä»¤ä¸æœƒäº’ç›¸è¦†è“‹ã€‚&lt;/p&gt;
&lt;p&gt;åè€Œæ˜¯è¢«ç•¶æˆåƒæ•¸åŠ åœ¨å¾Œé¢ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://myapollo.com.tw/zh-tw/docker-cmd-vs-entrypoint/&quot; title=&quot;Docker CMD èˆ‡ ENTRYPOINT èªªæ˜è©³è§£&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Docker CMD èˆ‡ ENTRYPOINT èªªæ˜è©³è§£&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;å…©è€…äº’å‹•è¡¨&quot; tabindex=&quot;-1&quot;&gt;å…©è€…äº’å‹•è¡¨&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;No ENTRYPOINT&lt;/th&gt;
&lt;th&gt;ENTRYPOINT exec_entry p1_entry&lt;/th&gt;
&lt;th&gt;ENTRYPOINT [â€œexec_entryâ€, â€œp1_entryâ€]&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;No CMD&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;error, not allowed&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;/bin/sh -c exec_entry p1_entry&lt;/td&gt;
&lt;td&gt;exec_entry p1_entry&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CMD [â€œexec_cmdâ€, â€œp1_cmdâ€]&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;exec_cmd p1_cmd&lt;/td&gt;
&lt;td&gt;/bin/sh -c exec_entry p1_entry&lt;/td&gt;
&lt;td&gt;exec_entry p1_entry exec_cmd p1_cmd&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;CMD exec_cmd p1_cmd&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;/bin/sh -c exec_cmd p1_cmd&lt;/td&gt;
&lt;td&gt;/bin/sh -c exec_entry p1_entry&lt;/td&gt;
&lt;td&gt;exec_entry p1_entry /bin/sh -c exec_cmd p1_cmd&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.docker.com/engine/reference/builder/#understand-how-cmd-and-entrypoint-interact&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Understand how CMD and ENTRYPOINT interact&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://myapollo.com.tw/blog/docker-cmd-vs-entrypoint/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Docker CMD èˆ‡ ENTRYPOINT èªªæ˜è©³è§£&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;k8-s-yaml-command&quot; tabindex=&quot;-1&quot;&gt;K8S yaml  command&lt;/h3&gt;
&lt;p&gt;ä½ˆç½²å€‹cronJobä¾†æ¸¬è©¦&lt;/p&gt;
&lt;p&gt;é€™æ¬¡æ›è¼‰çš„æ˜ åƒæª”æ˜¯ä½¿ç”¨ dockerfileã€commandã€çš„æ˜ åƒæª”&lt;br /&gt;
è·Ÿä¸Šé¢æ¸¬è©¦æ–¹æ³•ä¸€æ¨£ï¼Œå…ˆä¸åŠ commandçœ‹çµæœæ˜¯ä»€éº¼&lt;br /&gt;
åŠ äº†å¾Œçµæœåˆæœƒæ˜¯ä»€éº¼ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;  spec:
    containers:
    - command:
      - /bin/sh
      - -c
      - echo $PATH
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/98-fig.2.jpg&quot; alt=&quot;98-fig.2.jpg&quot; /&gt;&lt;br /&gt;
11:57 é‚£å€‹æ²’æœ‰åŠ commandï¼Œæ‰€ä»¥æœƒçœ‹åˆ°é¡¯ç¤ºroot&lt;br /&gt;
12:03 åŠ äº†ä¸Šé¢çš„commandï¼ŒæŒ‡ä»¤è¦†è“‹ï¼Œæ‰€ä»¥é¡¯ç¤º$PATHçš„å…§å®¹&lt;/p&gt;
&lt;p&gt;p.s å¦‚æœä¸ç”¨commandæ”¹ç”¨argsï¼ŒæŒ‡ä»¤è¦†è“‹ã€‚&lt;/p&gt;
&lt;h3 id=&quot;k8-s-yaml-args&quot; tabindex=&quot;-1&quot;&gt;K8S yaml args&lt;/h3&gt;
&lt;p&gt;é€™æ¬¡æ›è¼‰çš„æ˜ åƒæª”æ˜¯ä½¿ç”¨ dockerfileã€ENTRYPOINTã€çš„æ˜ åƒæª”&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;  spec:
    containers:
    - args:
      - /bin/sh
      - -c
      - echo $PATH
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/98-fig.3.jpg&quot; alt=&quot;98-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;13:44 ä¸åŠ ä»»ä½•åƒæ•¸ï¼Œé¡¯ç¤º /root&lt;br /&gt;
13:45 åŠ äº†argsï¼Œé‚„æ˜¯é¡¯ç¤º/rootï¼ŒæŒ‡ä»¤ç„¡è¦†è“‹&lt;/p&gt;
&lt;p&gt;argsçš„ä¸»è¦ç”¨é€”æ˜¯ï¼Œç•¶dockerfile ç‚º ENTRYPOINTæ™‚ï¼Œ&lt;br /&gt;
ä½¿ç”¨argsæœƒå°‡å…¶è¦–çˆ²åƒæ•¸å‚³å…¥åˆ°imageå…§ã€‚&lt;/p&gt;
&lt;p&gt;ps. å¦‚æœæ”¹ä½¿ç”¨ command ï¼Œå‰‡è¦†è“‹&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://kung-fu-master.github.io/2021/03/13/microService/kubernetes/k8s_command_args_entrypoint_cmd%E5%8C%BA%E5%88%AB/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;k8s command, args, entrypoint, cmd å€åˆ¥&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h3&gt;
&lt;p&gt;Docker&lt;/p&gt;
&lt;p&gt;ENTRYPOINT ä¸»è¦æ˜¯å°‡æ•´å€‹containerç•¶åšå¯åŸ·è¡Œæª”ä¾†ç”¨ã€‚&lt;br /&gt;
CMD å‰‡æ¯”è¼ƒé¡ä¼¼ä¸€å°VM&lt;/p&gt;
&lt;p&gt;K8S&lt;/p&gt;
&lt;p&gt;command  ï¼š æŒ‡ä»¤éƒ½æ˜¯è¦†è“‹&lt;br /&gt;
args ï¼š å¤–åŠ çš„åƒæ•¸ï¼Œå¯èˆ‡commandä¸€èµ·ä½¿ç”¨ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;  spec:
    containers:
    - args:
      - -a
      command:
      - /bin/sh
      - -c
      - uname
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;commandå°æ‡‰çš„æ˜¯ Dockerfileå…§çš„ ENTRYPOINT&lt;br /&gt;
argså°æ‡‰çš„æ˜¯ Dockerfileå…§çš„çš„CMD&lt;/p&gt;
&lt;p&gt;å¦‚æœDockerfileåªæœ‰ cmdï¼Œk8så¯ä»¥åªç”¨ commandå–ä»£ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Yaml/98. k8sä¸­çš„commandèˆ‡dockerfileçš„ CMD/" />
        </entry>
        <entry>
            <title>
                94. k8s ç´°ç¯€è£œå……
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Yaml/94. k8s ç´°ç¯€è£œå……/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘å¹«å…¶ä»–çµ„çš„åŒäº‹çœ‹å•é¡Œæ™‚ï¼Œ&lt;/p&gt;
&lt;p&gt;ç™¼ç¾æœ‰äº›æ±è¥¿æ˜¯æˆ‘æ²’çœ‹éçš„ï¼Œ&lt;/p&gt;
&lt;p&gt;å°±æ•´åˆå†ä¸€èµ·ï¼Œå¯«èµ·ä¾†ç•¶å‚™å¿˜æ‹‰ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;deployment çš„ lifecycle&lt;/p&gt;
&lt;p&gt;postStart åœ¨containerå‰µå»ºå¾Œï¼Œç«‹å³ç™¼é€postStartäº‹ä»¶ã€‚&lt;br /&gt;
preStop åœ¨ containerçµæŸå‰ï¼Œç«‹å³ç™¼é€preStopäº‹ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: v1
kind: Pod
metadata:
  name: lifecycle-demo
spec:
  containers:
  - name: lifecycle-demo-container
    image: nginx
    lifecycle:
      postStart:
        exec:
          command: [&amp;quot;/bin/sh&amp;quot;, &amp;quot;-c&amp;quot;, &amp;quot;echo Hello from the postStart handler &amp;gt; /usr/share/message&amp;quot;]
      preStop:
        exec:
          command: [&amp;quot;/bin/sh&amp;quot;,&amp;quot;-c&amp;quot;,&amp;quot;nginx -s quit; while killall -0 nginx; do sleep 1; done&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://kubernetes.io/zh/docs/tasks/configure-pod-container/attach-handler-lifecycle-event/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç‚ºå®¹å™¨çš„ç”Ÿå‘½é€±æœŸäº‹ä»¶è¨­ç½®è™•ç†å‡½æ•¸&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;podçš„çµ‚æ­¢&lt;br /&gt;
é€šå¸¸æƒ…æ³ä¸‹ï¼Œcontaineræœƒç™¼é€TERMä¿¡è™Ÿåˆ°æ¯å€‹containerä¸­ï¼Œ&lt;br /&gt;
ç•¶è¶…å‡ºäº†æ­£å¸¸çµ‚æ­¢æœŸé™ï¼Œå‰‡æœƒå‘å…¶ä»–çš„processorç™¼é€KILLä¿¡è™Ÿ&lt;br /&gt;
ref. &lt;a href=&quot;https://kubernetes.io/zh/docs/concepts/workloads/pods/pod-lifecycle/#pod-termination&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Pod çš„çµ‚æ­¢&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr /&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;æ¢é‡&lt;br /&gt;
livenessProbe ï¼šåˆ¤æ–·containeræ˜¯å¦æ­£å¸¸&lt;br /&gt;
readinessProbeï¼šåˆ¤æ–·æœå‹™æ˜¯å¦æ­£å¸¸&lt;/li&gt;
&lt;/ol&gt;
&lt;hr /&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;æŸ¥è©¢kubectl resouce ç°¡å¯«&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl api-resources
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é¡ä¼¼ä¸‹åˆ—è³‡æºéƒ½å¯ç”¨ç¸®å¯«&lt;br /&gt;
configmap = cm&lt;br /&gt;
deployment=deploy&lt;br /&gt;
pod = po&lt;br /&gt;
persistentvolumeclaims = pvc&lt;/p&gt;
&lt;p&gt;ref .&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10236404&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ã€å¾é¡Œç›®ä¸­å­¸ç¿’k8sã€‘-ã€Day8ã€‘K8så¸¸ç”¨æŒ‡ä»¤ (Cheat Sheet)&amp;amp;è§£é¡ŒæŠ€å·§&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;k8sçš„ command ï¼Œbash -c æ„æ€&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;        command: [&amp;quot;/bin/bash&amp;quot;,&amp;quot;-c&amp;quot;]
        args: [ &amp;quot;service cron start; while true; do sleep 30; done;&amp;quot; ]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¾ˆå¸¸çœ‹åˆ° bash -c ï¼Œé€™å€‹è¡¨ç¤ºå¾å¾Œé¢çš„å­—ä¸²ä¸­ è®€å–å‘½ä»¤ä¾†ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ps. bash è·Ÿ sh ä¸ä¸€æ¨£ï¼Œshé€šå¸¸æ˜¯æŒ‡dashã€‚&lt;br /&gt;
å¯ç”¨ä¸‹åˆ—æŒ‡ä»¤ï¼ŒæŸ¥çœ‹ç›®å‰ä½¿ç”¨çš„shell&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo $SHELL
or
ls -l /bin/sh

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;ref-br-a-href-https-www-computerhope-com-unix-ubash-htm-target-blank-class-external-link-the-bash-shell-a-br-a-href-https-www-wongwonggoods-com-linux-bin-bash-bin-sh-target-blank-class-external-link-bash-bin-bash-bin-sh-script-sh-bash-a&quot; tabindex=&quot;-1&quot;&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://www.computerhope.com/unix/ubash.htm&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;The bash shell&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://www.wongwonggoods.com/linux/bin-bash-bin-sh/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ã€Bashã€‘ä»€éº¼æ˜¯ #!/bin/bash, #!/bin/shï¼Œç‚ºä»€éº¼è¦åŠ åœ¨ script å‰é¢ (å•é¡Œè§£æ±ºï¼šsh, bash çš„ä¸åŒ)&lt;/a&gt;&lt;/h2&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;ä½¿ç”¨æŒ‡ä»¤å»ºç«‹åŸºæœ¬çš„ yaml&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl run nginx-kusc00101 --image=nginx --restart=Never --dry-run=client -o yaml&amp;gt; q1.pod
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ‰åŸºæœ¬æŒ‡ä»¤å¾Œå†å»è£¡é¢ä¿®ä¿®æ”¹æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦ç›´æ¥å–å¾—ç¾æœ‰çš„yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   kubectl get deploy  yiyuan-landingpage-qa -n istio-yiyuan -o yaml &amp;gt; yiyuan.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;7&quot;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Yaml/94. k8s ç´°ç¯€è£œå……/" />
        </entry>
        <entry>
            <title>
                87.kustomize å…±ç”¨label(optionalï¼‰
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Yaml/87.kustomize å…±ç”¨label(optionalï¼‰/</id>
            <content type="html">
                &lt;h2 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;è¦æŠŠåˆ¥äººå¯«çš„yamlæ‹†é–‹ï¼Œç„¶å¾Œæ•´ä½µåˆ°è‡ªå·±çš„imageï¼Œ&lt;br /&gt;
æ‰ç™¼ç¾serviceçš„ base æ€éº¼æ²’å¯«selector ï¼Œ&lt;br /&gt;
ä½†ä½ˆç½²æ™‚å»æœ‰mappingåˆ°ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h2&gt;
&lt;p&gt;åŸå› åœ¨kustomizeçš„ å…±ç”¨å±¬æ€§&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;commonLabels:
  app: token-proxy
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™å€‹æœƒè‡ªå‹•åœ¨å„å€‹resourceä¸Šé¢å¢åŠ labelï¼Œ&lt;br /&gt;
å¦‚æœé€™é‚Šæ‹”æ‰çš„è©±ï¼Œ&lt;br /&gt;
éœ€è¦åœ¨Deploymentä»¥åŠserviceä¸Šé¢å¢åŠ labelã€‚&lt;/p&gt;
&lt;p&gt;ä½†åœ¨ä¸€äº›æ–‡ç« ä¹Ÿæœ‰äººè¨è«–åˆ°é€™å€‹å•é¡Œï¼Œ&lt;br /&gt;
å¦‚æœæˆ‘ä¸è¦è®“ä»–å¼·åˆ¶å¢åŠ çš„è©±ï¼Œ&lt;br /&gt;
è©²æ€éº¼åšï¼Ÿ&lt;/p&gt;
&lt;p&gt;kustomizeæœ‰æ–°çš„åƒæ•¸å¯ä¾›è¨­å®š(1)ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;commonLabels:
- path: metadata/labels
  create: true

- path: spec/selector
  create: true
  version: v1
  kind: Service

- path: spec/selector/matchLabels
  create: true
  kind: Deployment
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦å¤–ï¼Œé‚„æœ‰ ä¸‹åˆ—æ–°å¢çš„å¯ä¾›åƒè€ƒã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;annotations&lt;/li&gt;
&lt;li&gt;images&lt;/li&gt;
&lt;li&gt;labels&lt;/li&gt;
&lt;li&gt;name reference&lt;/li&gt;
&lt;li&gt;namespace&lt;/li&gt;
&lt;li&gt;prefix/suffix&lt;/li&gt;
&lt;li&gt;variable reference&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;br /&gt;
1 .&lt;a href=&quot;https://github.com/kubernetes-sigs/kustomize/tree/master/examples/transformerconfigs#labels-transformer&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;transformerconfigs&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Yaml/87.kustomize å…±ç”¨label(optionalï¼‰/" />
        </entry>
        <entry>
            <title>
                85. gke-cronjobç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Yaml/85. gke-cronjobç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¹‹å‰åŒäº‹æ˜¯ç›´æ¥è‡ªå·±åœŸç‚®ç”¨golangå¯«timerï¼Œ&lt;br /&gt;
ä¸éå¦‚æœç¢°åˆ°åŸ·è¡Œæ™‚é–“éé•·ï¼Œé‡è¤‡åŸ·è¡Œçš„è©±ï¼Œ&lt;br /&gt;
å°±è¦åˆ¤æ–·ä¸€å †ç‹€æ…‹ï¼Œæ±ºå®šè¦ä¸è¦åšï¼Œ&lt;br /&gt;
é‚£å°±æ”¹ç”¨k8sçš„cronJobäº†å§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æ–‡ä»¶çœ‹ä¸€çœ‹(1) (2)ï¼Œå¥½åƒå°±å·®ä¸å¤šäº†ã€‚&lt;br /&gt;
ä¸‹é¢æ˜¯æ¸¬è©¦ï¼Œæ¯å…©åˆ†é˜åŸ·è¡Œä¸€æ¬¡ï¼Œ&lt;br /&gt;
ä½†å¦‚æœåŸ·è¡Œæ™‚é–“éé•·ï¼Œæ˜¯ä¸æ˜¯æœƒåœ¨åŸ·è¡Œã€‚&lt;br /&gt;
é€™é‚Šé—œæ‰çš„æ˜¯ä½µç™¼ä»¥åŠ æš«åœå¾ŒçºŒåŸ·è¡Œï¼Œ&lt;br /&gt;
å¦å¤–æ³¨æ„ï¼Œgcpçš„cronjobæ˜¯æ¯10ç§’æª¢æŸ¥ä¸€æ¬¡ç‹€æ…‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: batch/v1beta1     # k8s after version 1.21 ,apiVersion: batch/v1
kind: CronJob
metadata:
  name: hello
spec:
  schedule: &amp;quot;*/2 * * * *&amp;quot;             # min hour day Mon week
  concurrencyPolicy: Forbid           # ä¸¦ç™¼æ”¿ç­– 
  startingDeadlineSeconds: 60        # æˆªæ­¢æ™‚é™
  suspend: true                       # æš«åœå¾ŒçºŒåŸ·è¡Œ
  successfulJobsHistoryLimit: 3       # æ­·å²é™åˆ¶: ä¿å­˜æˆåŠŸçš„æ•¸é‡
  failedJobsHistoryLimit: 1           # æ­·å²é™åˆ¶ï¼š ä¿å­˜å¤±æ•—çš„æ•¸é‡
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: hello
            image: busybox
            args:
            - /bin/sh
            - -c
            - echo &amp;quot;start&amp;quot;; date; echo &amp;quot;Hello, World! Sleep 150s&amp;quot;; sleep 150s; date;
          restartPolicy: OnFailure
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
1.  &lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/cronjobs&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GCP-CronJob&lt;/a&gt;&lt;br /&gt;
2. &lt;a href=&quot;https://kubernetes.io/zh/docs/concepts/workloads/controllers/cron-jobs/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;k8s-CronJob&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Yaml/85. gke-cronjobç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                74. kubernetes æ‰¹æ¬¡æª¢æŸ¥yamlç‰¹å®šå­—å…ƒ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Yaml/74. kubernetes æ‰¹æ¬¡æª¢æŸ¥yamlç‰¹å®šå­—å…ƒ/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å› ç‚ºdockershimçš„å•é¡Œï¼Œ&lt;br /&gt;
é€™æ¬¡è¦æ¬clusterçš„nodeäº†ã€‚&lt;br /&gt;
ä½†æˆ‘æ ¹æœ¬å¿˜è¨˜æœ‰å“ªå€‹yamlæœ‰å¯«åˆ° nodeSelectoräº†ï¼Œ&lt;br /&gt;
ä¸€å€‹ä¸€å€‹çœ‹åˆå¥½æ‡¶...æ€éº¼è¾¦ï¼Ÿ&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æƒ³èµ·ä¾†ä¹‹å‰åœ¨æª¢æŸ¥  docker.sockçš„æ™‚å€™ï¼Œæœ‰ç”¨æŒ‡ä»¤æª¢æŸ¥éé€™å€‹yaml (1)è£¡é¢ï¼Œ&lt;br /&gt;
æœ‰æ²’æœ‰ /docker.sock&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get pods --all-namespaces &#92;
-o=jsonpath=&#39;{range .items[*]}{&amp;quot;&#92;n&amp;quot;}{.metadata.namespace}{&amp;quot;:&#92;t&amp;quot;}{.metadata.name}{&amp;quot;:&#92;t&amp;quot;}{range .spec.volumes[*]}{.hostPath.path}{&amp;quot;, &amp;quot;}{end}{end}&#39; &#92;
| sort &#92;
| grep &#39;/var/run/docker.sock&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æ®µæœ€å¾Œé¢å…©å€‹å°±ä¸ç”¨çœ‹äº†ï¼Œsort è·Ÿ grep æ˜¯ linuxçš„æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦é‡å° -o jsonpath ä¾†çœ‹ï¼Œè©³ç´°æŒ‡ä»¤ã€€ åƒè€ƒ(2)&lt;/p&gt;
&lt;p&gt;ç•¶è¦å–å¾—è¤‡æ•¸è³‡æ–™æ™‚ï¼Œç”¨ range ä¾†å–è³‡æ–™ã€‚&lt;br /&gt;
ç„¶å¾Œ...åƒè€ƒ podçš„yamlçœ‹è¦å–å¾—å“ªäº›æ¬„ä½ä¾†ç”¨å§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ç¯„ä¾‹ç‚ºå–å¾— å…¨éƒ¨çš„ nodeSelectord&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get pods -Aã€€ &#92;
-o=jsonpath=&#39;{range .items[*]}{&amp;quot;&#92;n&amp;quot;}{.metadata.namespace}{&amp;quot;:&#92;t&amp;quot;}{.metadata.name}{&amp;quot;:&#92;t&amp;quot;}{.spec.nodeSelector}{end}&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/Yaml/74-fig.1.jpg&quot; alt=&quot;74-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å†æ’åºä¸€ä¸‹ï¼Œå°±å¯ä»¥å¾ˆå¿«çš„çŸ¥é“æœ‰å“ªäº›yamlæœ‰ç”¨åˆ° nodeSelectoräº†ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
1. &lt;a href=&quot;https://kubernetes.io/zh/docs/tasks/administer-cluster/migrating-from-dockershim/migrating-telemetry-and-security-agents/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¾ dockershim é·ç§»é™æ¸¬å’Œå®‰å…¨ä»£ç†&lt;/a&gt;&lt;br /&gt;
2. &lt;a href=&quot;http://kubernetes.kansea.com/docs/user-guide/jsonpath/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;JSONpath å¹«åŠ©&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Yaml/74. kubernetes æ‰¹æ¬¡æª¢æŸ¥yamlç‰¹å®šå­—å…ƒ/" />
        </entry>
        <entry>
            <title>
                2. k8s yamlæ’°å¯« volume è¸©å‘ç¯‡
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Yaml/2. k8s yamlæ’°å¯« volume è¸©å‘ç¯‡/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ˜¨å¤©æ¥åˆ°ä¸€å€‹ä»»å‹™ï¼Œè¦æŠŠä¸€å€‹ç´”htmlï¼Œæ”¾åˆ°nginxä¸Šé¢ã€‚&lt;br /&gt;
ç„¶å¾Œå°±é–‹å§‹è¸©å‘ä¹‹æ—…äº†&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;é€™é‚Šå¯«çš„éƒ½æ˜¯GKE çš„ä½ˆç½²æ–¹å¼ï¼Œ&lt;br /&gt;
é—œæ–¼GKE  æ–‡ç« å¯¦åœ¨å¤ªå¤šäº†ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä½•å¹´ä½•æœˆä½•æ—¥æ‰æœ‰é‚£å€‹æŠ€è¡“å­˜é‡å¯ä»¥æŠŠå®ƒå¯«æˆæ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰ä½¿ç”¨çš„æ˜¯ kustomizeçš„æ–¹å¼ä½ˆç½²ç¶²ç«™ï¼Œ&lt;br /&gt;
ç›®å‰ä¹Ÿåœ¨æ¶è¨­droneï¼Œæ—¥å¾Œèµ°çš„æ˜¯è‡ªå‹•ä½ˆç½²ï¼Œ&lt;br /&gt;
ä½†æ˜¯ç¬¬ä¸€æ¬¡ä½ˆç½²é‚„æ˜¯è¦è‡ªå·±ä¾†çš„ã€‚&lt;/p&gt;
&lt;p&gt;åŸºæœ¬çš„æµç¨‹æ˜¯ï¼Œå°‡ç¶²é åŒ…æˆä¸€å€‹ docker imageï¼Œ&lt;br /&gt;
(ä¸è«–æ˜¯php æˆ–æ˜¯ htmlï¼Œ Go å‰‡æ˜¯æœ¬èº«æœ‰æœå‹™å¯ä»¥æ›è¼‰ï¼Œæ¯”è¼ƒç°¡å–®é»ã€‚)&lt;br /&gt;
å†å°‡æ­¤imageè¨­å®šæˆ initContainers ï¼Œ&lt;br /&gt;
å°‡æ­¤imageçš„è³‡æ–™å¤¾ï¼Œæ›è¼‰æˆvolumeï¼Œè®“nginxå¯ä»¥ç›´æ¥æ›è¼‰æ­¤è³‡æ–™å¤¾ã€‚&lt;/p&gt;
&lt;p&gt;é€™æ¬¡è¸©çš„å‘æœ‰å…©å€‹ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¶²ç«™ç¨‹å¼ï¼Œæ˜¯åˆ¥äººå‚³çµ¦æˆ‘çš„ï¼Œæ‰€ä»¥æª”æ¡ˆæ¬Šé™ï¼Œeveryoneéƒ½æ˜¯ ç„¡æ³•å­˜å–ã€‚&lt;br /&gt;
æ‰€ä»¥è¦æŠŠè£¡é¢çš„æ‰€æœ‰æª”æ¡ˆæ”¹æˆ 755 rwxr-xr-x ï¼Œnginxåœ–ç‰‡æ‰èƒ½å¤ è®€å–ã€‚&lt;br /&gt;
æˆ‘æ‡¶çš„ä¸€å€‹ä¸€å€‹æ”¹ï¼Œæ‰€ä»¥ä¸‹æŒ‡ä»¤ä¸€æ¬¡æŠŠæ•´å€‹è³‡æ–™å¤¾å…§å®¹éƒ½æ”¹æ‰ï¼Œç•¶åˆå®‰å…¨é»æ˜¯è¨­å®š777&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;chmod -R 755 resource
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(ref. &lt;a href=&quot;https://www.jianshu.com/p/6c52260b1ff3&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://www.jianshu.com/p/6c52260b1ff3&lt;/a&gt;)&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;åœ¨å¯«yamlçš„æ™‚å€™ï¼Œæ²’æœ‰ææ¸…æ¥š volumeçš„ç”¨é€”&lt;br /&gt;
å°è‡´ä¸€ç›´å‡ºç¾rsyncçš„éŒ¯èª¤ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;initContainers:
- command:
  - sh
  - -c
  - |
    rsync -avrh --delete /source/* /app
  image: gcr.io/project/busybox-web:v2.7
  imagePullPolicy: Always
  name: source
  volumeMounts:
  - mountPath: /app
    name: source
volumes:
- emptyDir: {}
  name: source
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;volumeMounts: é€™æ®µçš„æ„æ€æ˜¯ å®šç¾©ä¸€å€‹å« soureçš„æ–°ç£å€ï¼Œæ›è¼‰åœ¨ busybox-webå®¹å™¨è£¡çš„ /app çš„pathä¸Šé¢ã€‚&lt;br /&gt;
volumes: çš„æ„æ€æ˜¯å®šç¾©ç£ç¢Ÿå€ï¼ŒemptyDiræ˜¯ä¼´éš¨è‘—podçš„ç”Ÿå‘½ï¼Œç•¶podæ¶ˆå¤±è³‡æ–™ä¹Ÿæœƒè·Ÿè‘—æ¶ˆå¤±&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;nginx.conf æ”¹å®Œå¾Œï¼Œè¦é‡å•Ÿpod ï¼Œå› ç‚ºnginx.conf æ˜¯å¯«åœ¨ k8sçš„ configMapGeneratorï¼Œ&lt;br /&gt;
æ‰€ä»¥æ›´æ”¹è£¡é¢çš„è¨­å®šå¾Œï¼Œä¸æœƒé‡å•Ÿpod ï¼Œè£¡é¢çš„æœå‹™å°±ä¸æœƒé‡æ–°æŠ“å–confã€‚&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Yaml/2. k8s yamlæ’°å¯« volume è¸©å‘ç¯‡/" />
        </entry>
        <entry>
            <title>
                136. ä¸€æ­¥æ­¥ç¯©é¸k8sçš„deployå…§å®¹
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Yaml/136. ä¸€æ­¥æ­¥ç¯©é¸k8sçš„deployå…§å®¹/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;è¦æŠ“ä¸€ä¸‹ï¼Œç›®å‰ingressè£é¢çš„æ‰€æœ‰ç™½åå–®è³‡è¨Šï¼Œ&lt;br /&gt;
ä½†ä¸€å€‹ä¸€å€‹é–‹èµ·ä¾†çœ‹åˆå¾ˆéº»ç…©ï¼Œ&lt;br /&gt;
å°±å¯«code filterå§&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆå–å¾—jsonï¼Œå…ˆæŒ‡å®šä¸€å€‹æœå‹™ï¼Œä¸ç„¶æœƒå¤ªäº‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl get ingress websocketclient -o json
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/Yaml/136-fig.1.jpg&quot; alt=&quot;136-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;ç„¶å¾Œé–‹å§‹çœ‹json æ ¼å¼é–‹å§‹æ‹†è§£ï¼Œé€™æ¬¡ç›®çš„æ˜¯è¦å–å¾—&lt;br /&gt;
&lt;code&gt;nginx.ingress.kubernetes.io/whitelist-source-range&lt;/code&gt;çš„å€¼ï¼Œ&lt;br /&gt;
é€™é‚Šæœƒç¢°åˆ°ä¸€å€‹å•é¡Œï¼Œå› ç‚ºæœ‰ç‰¹æ®Šç¬¦è™Ÿ . è·Ÿ / ï¼Œæ‰€ä»¥è¦ç”¨ &#92; ï¼Œå°‡å®ƒè¦–çˆ²ä¸€å€‹æ•´é«”ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl get ingress -n default -o=jsonpath=&#39;{range .items[*]}{&amp;quot;&#92;n&amp;quot;}{.metadata.name}{&amp;quot;&#92;t&amp;quot;}{.metadata.annotations.nginx&#92;.ingress&#92;.kubernetes&#92;.io&#92;/whitelist-source-range}{end}&#39; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/Yaml/136-fig.2.jpg&quot; alt=&quot;136-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/docs/reference/kubectl/jsonpath/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;JSONPath Support&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/64014047/extract-information-of-kubernetes-annotations-with-jsonpath&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Extract information of kubernetes annotations with jsonpath&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Yaml/136. ä¸€æ­¥æ­¥ç¯©é¸k8sçš„deployå…§å®¹/" />
        </entry>
        <entry>
            <title>
                12. k8s YAML å°ç´°ç¯€
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Yaml/12. k8s YAML å°ç´°ç¯€/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘å¯«yamlï¼Œæœ‰æ™‚å¸¸æœƒå¿˜è¨˜é€™å€‹çš„åŠŸèƒ½æ˜¯ä»€éº¼ï¼Œå°±è¨˜ä¸€ä¸‹å§&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Service çš„PortåŠŸèƒ½&lt;br /&gt;
Port exposes the Kubernetes service on the specified port within the cluster. Other pods within the cluster can communicate with this server on the specified port.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;TargetPort is the port on which the service will send requests to, that your pod will be listening on. Your application in the container will need to be listening on this port also.&lt;/p&gt;
&lt;p&gt;NodePort exposes a service externally to the cluster by means of the target nodes IP address and the NodePort. NodePort is the default setting if the port field is not specified.&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;æ¢é‡æª¢æŸ¥&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;livenessProbe:
  initialDelaySeconds: 10
  periodSeconds: 10
  successThreshold: 1
  failureThreshold: 3
  tcpSocket:
    port: 80
readinessProbe:
  initialDelaySeconds: 30
  periodSeconds: 10
  successThreshold: 1
  failureThreshold: 3
  tcpSocket:
    port: 80
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;pull image èªè­‰&lt;br /&gt;
å¦‚æœè¦ä½ˆç½²çš„imageæ˜¯å±¬æ–¼ ç§å¯†çš„ï¼Œ&lt;br /&gt;
éœ€è¦åŠ ä¸Š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;imagePullSecrets:
  - name: regcred
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¦å…ˆæ³¨å…¥Secred&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl create secret generic regcred --from-file=./username.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;Service æœå‹™é¡å‹&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ClusterIP
&lt;ul&gt;
&lt;li&gt;ä¸€å€‹é›†ç¾¤å…§çš„æœå‹™ï¼Œé›†ç¾¤å…§çš„å…¶å®ƒæ‡‰ç”¨éƒ½å¯ä»¥è¨ªå•è©²æœå‹™ã€‚é›†ç¾¤å¤–éƒ¨ç„¡æ³•è¨ªå•å®ƒã€‚ é€™ä¹Ÿæ˜¯é»˜èªçš„ ServiceTypeã€‚&lt;/li&gt;
&lt;li&gt;å¯ä»¥ä½¿ç”¨proxy çš„æœ¬æ©Ÿ portè½‰ç§»ï¼Œä¾†è¨ªå•æœå‹™ã€‚åƒ (Fig.1)&lt;br /&gt;
[[12.fig-1.jpg]]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;NodePort
&lt;ul&gt;
&lt;li&gt;åœ¨æ‰€æœ‰ç¯€é»ï¼ˆè™›æ“¬æ©Ÿï¼‰ä¸Šé–‹æ”¾ä¸€å€‹ç‰¹å®šç«¯å£ï¼Œä»»ä½•ç™¼é€åˆ°è©²ç«¯å£çš„æµé‡éƒ½è¢«è½‰ç™¼åˆ°å°æ‡‰æœå‹™ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ 1 çš„service portï¼Œå°±æ˜¯æŒ‡é€™å€‹éƒ¨åˆ†ã€‚&lt;/li&gt;
&lt;li&gt;éœ€ä½¿ç”¨K8sçš„å¢é›†ä¸»æ©ŸåŠ ä¸Športï¼Œå»è¨ªå•æœå‹™ã€‚ (Fig.2)&lt;br /&gt;
[[12.fig-2.jpg]]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;LoadBalancer
&lt;ul&gt;
&lt;li&gt;LoadBalancer æœå‹™æ˜¯æš´éœ²æœå‹™åˆ° internet çš„æ¨™æº–æ–¹å¼ã€‚åœ¨ GKE ä¸Šï¼Œé€™ç¨®æ–¹å¼æœƒå•Ÿå‹•ä¸€å€‹ Network Load Balancerï¼Œå®ƒå°‡çµ¦ä½ ä¸€å€‹å–®ç¨çš„ IP åœ°å€ï¼Œè½‰ç™¼æ‰€æœ‰æµé‡åˆ°ä½ çš„æœå‹™ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€å€‹å¤–éƒ¨ipï¼Œç›´æ¥è¨ªå•å³å¯ï¼Œæœ‰æ™‚éœ€æ³¨æ„é˜²ç«ç‰†æœ‰æ²’æœ‰æ“‹ä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;http://dockone.io/article/4884&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubernetesçš„ä¸‰ç¨®å¤–éƒ¨è¨ªå•æ–¹å¼ï¼šNodePortã€LoadBalancer å’Œ Ingress&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://kubernetes.io/zh/docs/concepts/services-networking/service/#nodeport&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubernetes æœå‹™&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;kube dns&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;pod-dns-record&quot; tabindex=&quot;-1&quot;&gt;Pod DNS record&lt;/h3&gt;
&lt;p&gt;[[12.fig-3.jpg]]&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  172-17-0-6.default.pod.cluster.local
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;172-17-0-6: Pod IP&lt;/li&gt;
&lt;li&gt;default: Namespace Name&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;service-dns-record&quot; tabindex=&quot;-1&quot;&gt;Service DNS record&lt;/h3&gt;
&lt;p&gt;[[12.fig-4.jpg]]&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  nginx.default.svc.cluster.local
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;nginx: Service Name&lt;/li&gt;
&lt;li&gt;default:  Namespace Name&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;service-discovery&quot; tabindex=&quot;-1&quot;&gt;Service Discovery&lt;/h3&gt;
&lt;p&gt;[[12.fig-5.jpg]]&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  web-0.nginx.default.svc.cluster.local
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;web-0: Pod Name&lt;/li&gt;
&lt;li&gt;nginx: Service Name&lt;/li&gt;
&lt;li&gt;default: Namespace Name&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;Auto Scalingï¼ˆè‡ªå‹•æ“´å±•ï¼‰&lt;br /&gt;
åœ¨Auto Scaling è£¡é¢ï¼Œæœ‰ä¸€å€‹è¨­å®šæ˜¯æ ¹æ“šcpuçš„ä½¿ç”¨é‡å¤§å°å»å¢åŠ Podï¼Œ&lt;br /&gt;
å‡è¨­&lt;br /&gt;
targetCPUUtilizationPercentage:10&lt;br /&gt;
åœ¨deploy è£¡çš„request CPU è¨­å®š 200m&lt;br /&gt;
è¡¨ç¤ºï¼Œç•¶cpuçš„ä½¿ç”¨ç‡åœ¨ 20m(200m * 10% = 20m )æ™‚ï¼Œæœƒè‡ªå‹•æ“´å±•&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœè¦ä½¿ç”¨å…¶ä»–çš„æŒ‡æ¨™ï¼Œapi éœ€æ”¹ç”¨ autoscaling/v2beta2&lt;br /&gt;
é€™é‚Šé‚„æ²’æ¸¬è©¦éï¼Œæœ‰éœ€è¦çš„å¯è‡³ç›¸é—œç¶²é æŸ¥è©¢&lt;br /&gt;
ref.&lt;br /&gt;
&lt;a href=&quot;https://medium.com/andy-blog/kubernetes-%E9%82%A3%E4%BA%9B%E4%BA%8B-auto-scaling-7b887f61fdec&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubernetes é‚£äº›äº‹ â€” Auto Scaling&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.mdeditor.tw/pl/p7hU/zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubernetes--k8s--é€²éš--å…¨é¢ç­è§£HPA--éƒ¨ç½²HPAå¯¦ç¾é«˜å¯ç”¨å’Œæˆæœ¬æ§åˆ¶&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.openshift.com/blog/kubernetes-1-8-now-custom-metrics&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubernetes 1.8: Now with 100% Daily Value of Custom Metrics&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Yaml/12. k8s YAML å°ç´°ç¯€/" />
        </entry>
        <entry>
            <title>
                82. Terraform vs Ansible
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Terraform/82. Terraform vs Ansible/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ¬ä¾†æƒ³ç›´æ¥ç”¨è¡¨æ ¼é—¡è¿°å…©é‚Šä¸åŒçš„åœ°æ–¹ï¼Œ&lt;br /&gt;
ä½†ç™¼ç¾æˆ‘ä¸çŸ¥é“å¾ä½•ä¸‹æ‰‹ã€‚&lt;br /&gt;
åªå¥½å…ˆç”¨æ¢åˆ—ä»£æ›¿äº†ï¼Œ&lt;br /&gt;
é€™å…©å¥—æˆ‘éƒ½æ²’ç”¨éï¼Œå› ç‚º...æˆ‘ç›´æ¥å¾GKEé–‹å§‹XDã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;Terraform&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è²æ˜æ€§ä»£ç¢¼ï¼šç¨‹å¼ç¢¼çš„çµæœå°±æ˜¯æœ€çµ‚ç‹€æ…‹&lt;/li&gt;
&lt;li&gt;å”ä½œ(Orchestration)ï¼šç¢ºä¿ç’°å¢ƒæŒçºŒè™•æ–¼ã€ç†æƒ³ç‹€æ…‹ã€ï¼Œç•¶æœå‹™ä¸èƒ½ç”¨æ™‚ï¼Œæœƒç æ‰é‡å»ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ansible&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¨‹å¼æ€§ä»£ç¢¼ï¼šæ¯ä¸€æ¬¡çš„ç‹€æ…‹éƒ½æ˜¯ç¨ç«‹çš„&lt;/li&gt;
&lt;li&gt;é…ç½®ç®¡ç†å·¥å…·(Configuration Management)ï¼š æ˜¯ä¸€å¥—æµç¨‹å’Œç¨‹åºï¼ŒåŸ·è¡Œæ™‚ä¸æœƒé‡ç½®ç³»çµ±ï¼Œæœƒåœ¨æ©Ÿå™¨ä¸Šä¿®å¾©å•é¡Œæˆ–å‡ç´šæœå‹™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h2&gt;
&lt;p&gt;ç›®å‰çœ‹èµ·ä¾†ï¼Œ&lt;/p&gt;
&lt;p&gt;Ansibleä¸»è¦åå‘è‡ªå‹•åŒ–ç®¡ç†å·¥å…·ä½†åŒæ™‚å…·å‚™ä¸€å®šç¨‹åº¦ä¸Šçš„ç’°å¢ƒã€€å»ºç«‹ã€‚&lt;/p&gt;
&lt;p&gt;Terraform å°±æ˜¯å–®ç´”çš„  ç’°å¢ƒå»ºç«‹å·¥å…·&lt;/p&gt;
&lt;p&gt;å¦‚æœèµ°å‘k8sæœå‹™çš„è©±ï¼Œå­¸TerraFormå°±å¥½äº†ã€‚&lt;br /&gt;
ç”¨ä¾†å»ºç«‹clusterã€loadbalancer...ã€‚&lt;br /&gt;
ç”±æ–¼ k8sçš„æœå‹™éƒ½å·²ç¶“å®¹å™¨åŒ–äº†ï¼Œä½¿ç”¨Ansibleä¹Ÿæ²’ä»€éº¼æ„ç¾©ï¼Œ&lt;br /&gt;
é‡é–‹æœå‹™åˆæ¶ˆå¤±äº†ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://linuxhandbook.com/terraform-vs-ansible/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Terraform vs Ansible: What&#39;s the difference and which one you should use?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.lsbin.com/13252.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Ansible vs Terraform vs Puppetå·®ç•°æ¯”è¼ƒï¼šæœ‰ä»€éº¼å€åˆ¥ï¼Ÿé¸æ“‡å“ªå€‹ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/gemini-open-cloud/%E6%9E%B6%E6%A7%8B%E7%A8%8B%E5%BC%8F%E7%A2%BC-iii-devops-%E5%AF%A6%E6%96%BD%E5%B7%A5%E5%85%B7-873301f662e7&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ¶æ§‹ç¨‹å¼ç¢¼çš„å¯¦æ–½å·¥å…·&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://juejin.cn/post/6844903908213522445&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; [DevOpsç³»åˆ—] ç‚ºä»€éº¼æˆ‘å€‘ä½¿ç”¨Terraform è€Œä¸ä½¿ç”¨Puppet, Ansible&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://spacelift.io/blog/ansible-vs-terraform&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Terraform vs. Ansible : Key Differences and Comparison of Tools&lt;/a&gt;ï¼Œæ„Ÿè¦ºé€™ç¯‡å¯«çš„æœ€å¥½ï¼Œä½†çµè«–å°±...&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Terraform/82. Terraform vs Ansible/" />
        </entry>
        <entry>
            <title>
                189. å°å…¥Terraform
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Terraform/189. å°å…¥Terraform/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å‰é¢æœ‰ç¨å¾®æåˆ°å¹¾ç¯‡æ˜¯terraformçš„ä½¿ç”¨æ–¹å¼ï¼Œ&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Terraform/148.%20Terraform%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/&quot;&gt;148. Terraformçš„åŸºæœ¬æ¦‚å¿µ&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Terraform/149.%20terraform%20%E9%83%A8%E7%BD%B2VM%EF%BC%8C%E5%95%93%E5%8B%95docker%E5%AE%89%E8%A3%9Dmetadata_startup_script/&quot;&gt;149. terraform éƒ¨ç½²VMï¼Œå•“å‹•dockerå®‰è£metadata_startup_script&lt;/a&gt;&lt;br /&gt;
&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Terraform/183.%20Terrafrom%20%E5%BB%BA%E7%AB%8Bprivate%20cluster/&quot;&gt;183. Terrafrom å»ºç«‹private cluster&lt;/a&gt;&lt;br /&gt;
å†ä¾†æŠŠå‰©ä¸‹ç¢°åˆ°çš„è£œä¸€è£œäº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;å»ºç«‹å®Œäº†private clusterï¼Œå¾ŒçºŒè¦å»ºç«‹SQL è·Ÿ redisçš„è©±ï¼Œè©²æ€éº¼å»ºï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦å¤–é–‹ä¸€å€‹è³‡æ–™å¤¾ï¼Œé‡æ–°&lt;code&gt;terraform init&lt;/code&gt;ï¼Œä½†è¦æ³¨æ„ï¼Œ&lt;br /&gt;
ä½ çš„backend.hclæ˜¯æ€éº¼å¯«çš„ã€‚&lt;/p&gt;
&lt;p&gt;èˆ‰ä¾‹ä¾†èªªï¼Œ&lt;br /&gt;
private clusterçš„bucket.hclæ˜¯é€™æ¨£&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   bucket  = &amp;quot;terraform-devops&amp;quot;
   prefix  = &amp;quot;terraform/state&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœï¼Œå¦ä¸€å€‹è³‡æ–™å¤¾è£é¢çš„bucket.hclä¹Ÿç›¸åŒï¼Œ&lt;br /&gt;
é‚£åœ¨ç”¢ç”Ÿè¨ˆåŠƒæ™‚ï¼Œå°±æœƒæŠŠä½ å‰›å‰›å»ºå¥½çš„private clusterçµ¦åˆªé™¤ï¼Œ&lt;br /&gt;
å› çˆ²ä»–æª¢æŸ¥çš„æ˜¯tfstateè·Ÿä½ ç›®å‰è¨ˆåŠƒæœ‰å“ªäº›å·®åˆ¥ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œéœ€è¦æ›´æ”¹prefix&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   bucket  = &amp;quot;terraform-devops&amp;quot;
   prefix  = &amp;quot;terraform/other&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æ¨£åœ¨bucketè£é¢ï¼Œå°±æœƒå­˜æˆå…©å€‹ä¸åŒçš„tfstate&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/Terraform/189-fig.1.jpg&quot; alt=&quot;189-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;terrafromä½¿ç”¨è¿´åœˆï¼Œæ¸›å°‘é‡è¤‡çš„ç¨‹å¼ç¢¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å»ºç«‹å…©å€‹bucketï¼Œä¸¦é–‹å•“allUser read&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;variable &amp;quot;bucket_names&amp;quot; {
  type    = list(string)
  default = [&amp;quot;A-legacy&amp;quot;, &amp;quot;B-legacy&amp;quot;]
}
resource &amp;quot;google_storage_bucket&amp;quot; &amp;quot;frontend_bucket&amp;quot; {
  uniform_bucket_level_access = true
  for_each = { for name in toset(var.bucket_names) : name =&amp;gt; name }
  name          = each.value
  force_destroy = false
  location      = &amp;quot;asia-east1&amp;quot;
  storage_class = &amp;quot;STANDARD&amp;quot;
  # public_access_prevention = &amp;quot;inherited&amp;quot;  

  //ç‰©ä»¶ç‰ˆæœ¬ç®¡ç†
  versioning {  
    enabled = false
  }
}
resource &amp;quot;google_storage_bucket_iam_binding&amp;quot; &amp;quot;binding&amp;quot; {
  for_each = google_storage_bucket.frontend_bucket

  bucket = each.value.name
  role = &amp;quot;roles/storage.legacyObjectReader&amp;quot;
  members = [
    &amp;quot;allUsers&amp;quot;,
  ]
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.hashicorp.com/terraform/language/meta-arguments/for_each&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;The for_each Meta-Argument&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/storage/docs/public-access-prevention?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç¦æ­¢å…¬é–‹è¨ªå•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket_iam&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;IAM policy for Cloud Storage Bucket&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;è®€å–ä¹‹å‰çš„è¨­å®š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åœ¨å»ºç«‹private clusterçš„æ™‚å€™ï¼Œå°±å·²ç¶“å»ºå¥½äº†vpc ï¼Œ&lt;br /&gt;
ç›¸åŒçš„ç¶²è·¯ï¼Œæˆ‘æƒ³åœ¨å»ºç«‹mssql æ™‚ä½¿ç”¨ï¼Œ&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨dataå‘¼å«é€™å€‹VPCã€‚&lt;br /&gt;
é€™å€‹ç¯„ä¾‹æ˜¯æ‹¿ä¾†å»ºç«‹vpcè£é¢çš„ç§äººæœå‹™é€£ç·šçš„ä½ç½®ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;data &amp;quot;google_compute_network&amp;quot; &amp;quot;private-network&amp;quot; {
  name = &amp;quot;basic&amp;quot;
}

resource &amp;quot;google_compute_global_address&amp;quot; &amp;quot;private_ip_address&amp;quot; {
  depends_on = [ google_project_service.project ]
  name          = &amp;quot;private-ip-address&amp;quot;
  purpose       = &amp;quot;VPC_PEERING&amp;quot;
  address_type  = &amp;quot;INTERNAL&amp;quot;
  prefix_length = 16
  network       = data.google_compute_network.private-network.id
}
resource &amp;quot;google_service_networking_connection&amp;quot; &amp;quot;private_vpc_connection&amp;quot; {

  network                 = data.google_compute_network.private-network.id
  service                 = &amp;quot;servicenetworking.googleapis.com&amp;quot;
  reserved_peering_ranges = [google_compute_global_address.private_ip_address.name]
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/Terraform/189-fig.2.jpg&quot; alt=&quot;189-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;è¨­å®š.gitignore&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;
# Local .terraform directories
**/.terraform/*

# .tfstate files
*.tfstate
*.tfstate.*

# Crash log files
crash.log
crash.*.log

# Exclude all .tfvars files, which are likely to contain sensitive data, such as
# password, private keys, and other secrets. These should not be part of version 
# control as they are data points which are potentially sensitive and subject 
# to change depending on the environment.
# *.tfvars
# *.tfvars.json

# Ignore override files as they are usually used to override resources locally and so
# are not checked in
override.tf
override.tf.json
*_override.tf
*_override.tf.json

# Include override files you do wish to add to version control using negated pattern
# !example_override.tf

# Include tfplan files to ignore the plan output of command: terraform plan -out=tfplan
# example: *tfplan*

# Ignore CLI configuration files
.terraformrc
terraform.rc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.  &lt;a href=&quot;https://github.com/github/gitignore&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gitignore&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;çµå°¾&quot; tabindex=&quot;-1&quot;&gt;çµå°¾&lt;/h4&gt;
&lt;p&gt;åŸºç¤æ¦‚å¿µä»‹ç´¹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://lonegunmanb.github.io/introduction-terraform/2.1.Terraform%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5%E2%80%94%E2%80%94Provider.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;TerraformåŸºç¤æ¦‚å¿µâ€”â€”Provider&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/docs/terraform/best-practices-for-terraform?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GCP-ä½¿ç”¨ Terraform çš„æœ€ä½³å¯¦è¸&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://heretse.medium.com/%E5%A4%A7%E5%AE%B6%E9%83%BD%E5%9C%A8%E7%94%A8-terraform-%E5%AF%A6%E4%BD%9C-iac-%E7%82%BA%E4%BB%80%E9%BA%BC%E4%B8%8D%E5%B0%87%E7%A8%8B%E5%BC%8F%E5%AF%AB%E5%BE%97%E6%9B%B4%E7%B0%A1%E6%BD%94%E6%98%93%E8%AE%80%E5%91%A2-a736db1f6ef2&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¤§å®¶éƒ½åœ¨ç”¨ Terraform å¯¦ä½œ IaC ç‚ºä»€éº¼ä¸å°‡ç¨‹å¼å¯«å¾—æ›´ç°¡æ½”æ˜“è®€å‘¢ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://shazi7804.github.io/terraform-manage-guide/basic/locals.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Locals&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Terraform/189. å°å…¥Terraform/" />
        </entry>
        <entry>
            <title>
                183. Terrafrom å»ºç«‹private cluster
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Terraform/183. Terrafrom å»ºç«‹private cluster/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;è¦é‡å»ºä¸€å€‹æ–°çš„projectï¼Œç„¶å¾ŒæŠŠèˆŠçš„æœå‹™æ¬éå»ã€‚&lt;br /&gt;
åˆæ­¥ä¼°è¨ˆå°±ä¸€å †æ±è¥¿ï¼Œæ­£å¥½æ‹¿ä¾†ç·´ä¸€ä¸‹terraformäº†&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æœå‹™åˆ—è¡¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Create Project&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Create Cluster&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Create VPC&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Create CLoudSQL&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Create Memorystore&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Create CloudStorage&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Copy file to CloudStorage&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¾Œç«¯ä¿®æ”¹config&amp;amp;publish&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Creaet RabbitMQ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Create Nginx ingress&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å‰ç«¯æœå‹™éƒ¨ç½²&amp;amp;æ¸¬è©¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¾Œç«¯æœå‹™éƒ¨ç½²&amp;amp;æ¸¬è©¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Network policy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Obserbility service&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;EFK logs&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å‰å¾Œç«¯ CI/CD ä¿®æ”¹ &amp;amp; IAMæ¬Šé™&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Projectæ²’è¾¦æ³•ç”¨terraformï¼Œå› çˆ²é‚£ä¸æ˜¯æˆ‘æ“ä½œçš„ã€‚&lt;br /&gt;
ä¹Ÿä¸çŸ¥é“é‚£å€‹èƒ½ä¸èƒ½ç”¨terraform ã€‚&lt;/p&gt;
&lt;p&gt;é€™ç¯‡æœƒå»ºç«‹ä¸€å€‹bucketã€vpc ã€private clusterä»¥åŠcloud NATã€‚&lt;br /&gt;
ä¸‹é¢æœƒç”¨tf ä¾†ç¨±å‘¼terraform&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å»ºç«‹bucket&lt;br /&gt;
å› çˆ²ç‹€æ…‹é—œä¿‚ï¼Œå°±ä¹¾è„†ç”¨gcsçµ±ä¸€ç‹€æ…‹äº†ï¼Œå¯åƒè€ƒ&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Terraform/148.%20Terraform%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/&quot;&gt;148. Terraformçš„åŸºæœ¬æ¦‚å¿µ&lt;/a&gt;&lt;br /&gt;
&lt;code&gt;new&#92;gcs&#92;main.tf&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;terraform {
  required_providers {
    google = {
      source = &amp;quot;hashicorp/google&amp;quot;
      version = &amp;quot;4.63.1&amp;quot;
    }
  }
}

provider &amp;quot;google&amp;quot; {
  project = &amp;quot;ezio-sms-o&amp;quot;
}


resource &amp;quot;random_id&amp;quot; &amp;quot;bucket_prefix&amp;quot; {
  byte_length = 3
}

resource &amp;quot;google_storage_bucket&amp;quot; &amp;quot;tfstate_bucket&amp;quot; {
  name          = &amp;quot;${random_id.bucket_prefix.hex}-terraform-devops&amp;quot;
  force_destroy = false
  location      = &amp;quot;asia-east1&amp;quot;
  storage_class = &amp;quot;Nearline&amp;quot;
  
  //ç‰©ä»¶ç‰ˆæœ¬ç®¡ç†
  versioning {  
    enabled = false
  }
}

output &amp;quot;bucket_name&amp;quot;{
  description = &amp;quot;get bucket name&amp;quot;
  value = google_storage_bucket.tfstate_bucket.name
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¨˜ä¸‹bucket nameèˆ‡é è¨ˆè¦ç”¨çš„å‰ç¶´ï¼Œç„¶å¾Œå¯«åœ¨backend.hclï¼Œ&lt;br /&gt;
ç­‰ç­‰ä¸‹é¢æœƒç”¨åˆ°ã€‚&lt;br /&gt;
&lt;code&gt;new&#92;backend.hcl&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   bucket  = &amp;quot;cb0392-terraform-devops&amp;quot;
   prefix  = &amp;quot;terraform/state&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å»ºvpc èˆ‡cloudNAT&lt;br /&gt;
&lt;code&gt;new&#92;gke&#92;main.tf&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;terraform {
  required_providers {
    google = {
      source  = &amp;quot;hashicorp/google&amp;quot;
      version = &amp;quot;5.4.0&amp;quot;
    }
  }
  backend &amp;quot;gcs&amp;quot; {

  }
}

provider &amp;quot;google&amp;quot; {
  project = &amp;quot;ezio-sms-o&amp;quot;
  zone    = &amp;quot;asia-east1-b&amp;quot;
}

# VPC
resource &amp;quot;google_compute_network&amp;quot; &amp;quot;basic&amp;quot; {
  name                            = &amp;quot;basic&amp;quot;
  auto_create_subnetworks         = false
  # delete_default_routes_on_create = false
  routing_mode                    = &amp;quot;REGIONAL&amp;quot;
}

resource &amp;quot;google_compute_subnetwork&amp;quot; &amp;quot;basic&amp;quot; {
  name                     = &amp;quot;basic-subnet&amp;quot;
  ip_cidr_range            = var.subnet_cidr
  region                   = var.gcp_region
  network                  = google_compute_network.basic.id
  private_ip_google_access = true

  secondary_ip_range {
    range_name    = &amp;quot;gke-pod-range&amp;quot;
    ip_cidr_range = var.pod_cidr
  }
  secondary_ip_range {
    range_name    = &amp;quot;gke-service-range&amp;quot;
    ip_cidr_range = var.service_cidr
  }
}

# Cloud NAT
resource &amp;quot;google_compute_router&amp;quot; &amp;quot;default_cloudnat&amp;quot; {
  name    = &amp;quot;default-nat&amp;quot;
  region  = var.gcp_region
  network = google_compute_network.basic.id
}

resource &amp;quot;google_compute_router_nat&amp;quot; &amp;quot;default_cloudnat&amp;quot; {
  name   = &amp;quot;nat&amp;quot;
  router = google_compute_router.default_cloudnat.name
  region = var.gcp_region

  source_subnetwork_ip_ranges_to_nat = &amp;quot;LIST_OF_SUBNETWORKS&amp;quot;
  nat_ip_allocate_option             = &amp;quot;MANUAL_ONLY&amp;quot;

  subnetwork {
    name                    = google_compute_subnetwork.basic.id
    source_ip_ranges_to_nat = [&amp;quot;ALL_IP_RANGES&amp;quot;]
  }

  nat_ips = [google_compute_address.nat.self_link]
}

resource &amp;quot;google_compute_address&amp;quot; &amp;quot;nat&amp;quot; {
  name         = &amp;quot;nat&amp;quot;
  address_type = &amp;quot;EXTERNAL&amp;quot;
  network_tier = &amp;quot;PREMIUM&amp;quot;
  region       = var.gcp_region

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è®Šæ•¸çš„è¨­å®šï¼Œä¹Ÿè«‹åƒè€ƒ&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Terraform/148.%20Terraform%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/&quot;&gt;148. Terraformçš„åŸºæœ¬æ¦‚å¿µ&lt;/a&gt;&lt;br /&gt;
&lt;code&gt;new&#92;gke&#92;terraform.tf&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;variable &amp;quot;project_id&amp;quot; {
  default = &amp;quot;ezio-sms-o&amp;quot;
}
variable &amp;quot;gcp_region&amp;quot; {
  default = &amp;quot;asia-east1&amp;quot;
}
variable &amp;quot;gcp_zone&amp;quot; {
  type    = list(string)
  default = [&amp;quot;asia-east1-b&amp;quot;]
}
variable &amp;quot;gke_name&amp;quot; {
  default = &amp;quot;fixed&amp;quot;
}

variable &amp;quot;subnet_cidr&amp;quot; {
  default = &amp;quot;10.10.0.0/16&amp;quot;
}

variable &amp;quot;pod_cidr&amp;quot; {
  default = &amp;quot;192.168.8.0/21&amp;quot;
}

variable &amp;quot;service_cidr&amp;quot; {
  default = &amp;quot;192.168.16.0/21&amp;quot;
}

variable &amp;quot;master_cidr&amp;quot; {
  default = &amp;quot;10.0.2.0/28&amp;quot;
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://alanzhan.dev/post/2023-03-12-terraform-private-gke/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é€é Terraform å»ºç«‹ç§æœ‰ GKE Cluster&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cloudskillsboost.google/focuses/15842?locale=zh_TW&amp;amp;parent=catalog&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;# ä½¿ç”¨åŸºç¤æ¶æ§‹å³ç¨‹å¼ç¢¼å·¥å…· Terraform&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_network&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;google_compute_network&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;å»ºç«‹GKE&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€™éƒ¨åˆ†ç®—æ˜¯æŸ¥æœ€ä¹…çš„ï¼Œç”¨åˆ°äº†terraformçš„moduleæ¦‚å¿µã€‚&lt;br /&gt;
å¯ä»¥å…ˆçœ‹é€™ç¯‡ &lt;a href=&quot;https://godleon.github.io/blog/DevOps/terraform-getting-started/#%E4%BD%BF%E7%94%A8-module&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[Terraform] å…¥é–€å­¸ç¿’ç­†è¨˜&lt;/a&gt;ï¼Œç­è§£ä¸€ä¸‹ä»€éº¼æ˜¯moduleã€‚&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œå†ä¾†å°±æ˜¯çœ‹å®˜æ–¹æ–‡ä»¶äº†ã€‚&lt;br /&gt;
&lt;code&gt;new&#92;gke&#92;main.tf&lt;/code&gt;&lt;br /&gt;
æ²’éŒ¯è·Ÿä¸Šé¢vpcçš„æª”æ¡ˆä¸€æ¨£ï¼Œå› çˆ²æ˜¯åŒä¸€ä»½æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# GKE
module &amp;quot;gke&amp;quot; {
  source  = &amp;quot;terraform-google-modules/kubernetes-engine/google//modules/private-cluster&amp;quot;
  version = &amp;quot;29.0.0&amp;quot;
  project_id                 = var.project_id
  name                       = var.gke_name
  # å€åŸŸæ€§
  regional                   = false
  region                     = var.gcp_region
  zones                      = var.gcp_zone
  network                    = google_compute_network.basic.name
  subnetwork                 = google_compute_subnetwork.basic.name
  ip_range_pods              = google_compute_subnetwork.basic.secondary_ip_range[0].range_name
  ip_range_services          = google_compute_subnetwork.basic.secondary_ip_range[1].range_name
  http_load_balancing        = true
  network_policy             = false
  horizontal_pod_autoscaling = true
  filestore_csi_driver       = false
  # private cluster
  enable_private_endpoint    = false
  enable_private_nodes       = true
  master_global_access_enabled  = false
  master_ipv4_cidr_block     = &amp;quot;10.0.0.0/28&amp;quot;
  # gke version
  release_channel            = &amp;quot;UNSPECIFIED&amp;quot;
  remove_default_node_pool   = true
  # log record
  logging_enabled_components = [&amp;quot;SYSTEM_COMPONENTS&amp;quot;]
  create_service_account     = false

  node_pools = [
    {
      autoscaling               = false
      node_count                = 2
      name                      = &amp;quot;default-node-pool&amp;quot;
      machine_type              = &amp;quot;e2-custom-4-12288&amp;quot;
      local_ssd_count           = 0
      spot                      = false
      disk_size_gb              = 100
      disk_type                 = &amp;quot;pd-standard&amp;quot;
      image_type                = &amp;quot;COS_CONTAINERD&amp;quot;
      enable_gcfs               = false
      enable_gvnic              = false
      logging_variant           = &amp;quot;DEFAULT&amp;quot;
      auto_repair               = true
      auto_upgrade              = false
      preemptible               = false
      initial_node_count        = 80
    },
  ]

  node_pools_oauth_scopes = {
    all = [
		&amp;quot;https://www.googleapis.com/auth/logging.write&amp;quot;,
		&amp;quot;https://www.googleapis.com/auth/monitoring&amp;quot;,
		&amp;quot;https://www.googleapis.com/auth/devstorage.read_only&amp;quot;,
		&amp;quot;https://www.googleapis.com/auth/service.management.readonly&amp;quot;,
		&amp;quot;https://www.googleapis.com/auth/servicecontrol&amp;quot;,
		&amp;quot;https://www.googleapis.com/auth/trace.append&amp;quot;
    ]
  }

  node_pools_labels = {
    all = {}

    default-node-pool = {
      default-node-pool = true
    }
  }

  node_pools_metadata = {
    all = {}

    default-node-pool = {
      node-pool-metadata-custom-value = &amp;quot;fixed-node-pool&amp;quot;
    }
  }

  node_pools_taints = {
    all = []

    default-node-pool = [
      {
        key    = &amp;quot;default-node-pool&amp;quot;
        value  = true
        effect = &amp;quot;PREFER_NO_SCHEDULE&amp;quot;
      },
    ]
  }

  node_pools_tags = {
    all = []

    default-node-pool = [
      &amp;quot;default-node-pool&amp;quot;,
    ]
  }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç°¡å–®èªªä¸€ä¸‹moduleçš„ç”¨æ³•ï¼Œ&lt;br /&gt;
ç•¶ç¬¬ä¸€æ¬¡ç”¨moduleæ™‚ï¼Œéœ€è¦åˆå§‹åŒ–ï¼ŒåŠ ä¸ŠæŒ‡å®šgcså„²å­˜tfstat&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tf init -backend-config=../backend.hcl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹‹å¾Œè¦ä½¿ç”¨submoduleçš„è©±ï¼Œä¸ç”¨å†åˆå§‹åŒ–ï¼Œåªè¦get&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tf get
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¦å»ºç«‹private clusterçš„è©±ï¼Œéœ€è¦ä½¿ç”¨submoduleï¼Œ&lt;br /&gt;
å¯å¾&lt;a href=&quot;https://registry.terraform.io/modules/terraform-google-modules/kubernetes-engine/google/latest?tab=inputs&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kubernetes-engine&lt;/a&gt; åˆ° submoduleçš„ &lt;a href=&quot;https://registry.terraform.io/modules/terraform-google-modules/kubernetes-engine/google/latest/submodules/private-cluster?tab=inputs&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;private-cluster&lt;/a&gt;ï¼Œ&lt;/p&gt;
&lt;p&gt;æœ‰äº›åƒæ•¸ä¸çŸ¥é“æ˜¯å»ºç«‹GKEçš„å“ªå€‹è¨­å®šï¼Œ&lt;br /&gt;
å¯ä»¥å¤šåˆ©ç”¨&lt;code&gt;tf validate&lt;/code&gt; é©—è­‰ï¼Œ&lt;br /&gt;
ä½†æœ‰æ™‚æ˜¯éƒ¨ç½²æ™‚æ‰æœƒç™¼ç”ŸéŒ¯èª¤ã€‚&lt;br /&gt;
æˆ‘å¾Œä¾†æ˜¯ç›´æ¥æ‰‹å‹•æŠŠclusterç æ‰ï¼Œå†&lt;code&gt;tf apply&lt;/code&gt;æ¯”è¼ƒå¿«ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬ä¾†ä¹Ÿæœ‰æƒ³éä¸è¦ç”¨moduleï¼Œç›´æ¥å¯¦ä½œã€‚&lt;br /&gt;
ä½†çœ‹äº†å®˜æ–¹æ–‡ä»¶&lt;a href=&quot;https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/using_gke_with_terraform&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; Using GKE with Terraform&lt;/a&gt;ï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Additionally, you may consider using Google&#39;sÂ &lt;a href=&quot;https://registry.terraform.io/modules/terraform-google-modules/kubernetes-engine/google&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;&lt;code&gt;kubernetes-engine&lt;/code&gt;&lt;/a&gt;Â module, which implements many of these practices for you&lt;br /&gt;
å°±è©¦è©¦çœ‹äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼Œsubmoduleèˆ‡ä¸»è¦moduleçš„sourceä¸ä¸€æ¨£ï¼Œæœ‰äº›åƒæ•¸åœ¨ä¸»moduleæ˜¯æ²’æœ‰çš„ã€‚&lt;/p&gt;
&lt;h4 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h4&gt;
&lt;p&gt;éƒ¨ç½²GKEæ™‚ï¼Œç™¼ç¾æˆ‘æ²’è¾¦æ³•å¾Google Artifact Registry ä¸‹è¼‰imageã€‚&lt;br /&gt;
æœ€å¾Œç™¼ç¾æ˜¯ æ²’æœ‰è¨­å®š å­˜å–æ¬Šç¯„åœï¼Œ&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/access-scopes&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Access scopes in GKE&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/Terraform/183-fig.1.jpg&quot; alt=&quot;183-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€™å€‹éœ€è¦åœ¨ &lt;code&gt;node_pools_oauth_scopes&lt;/code&gt; è£é¢è£œä¸Šå…è¨±çš„apiç¶²å€ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Terraform/183. Terrafrom å»ºç«‹private cluster/" />
        </entry>
        <entry>
            <title>
                149. terraform éƒ¨ç½²VMï¼Œå•“å‹•dockerå®‰è£metadata_startup_script
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Terraform/149. terraform éƒ¨ç½²VMï¼Œå•“å‹•dockerå®‰è£metadata_startup_script/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;ç”±æ–¼å‰äººå¼„å‘Let&#39;s encrypt ç”³è«‹çš„sslæ†‘è­‰ï¼Œå¶çˆ¾æœƒå‡ºå•é¡Œï¼Œ&lt;br /&gt;
æ­¥é©Ÿç¹ç‘£ï¼Œå¸¸å¸¸æ”¹äº†é€™å€‹ï¼Œå¿˜è¨˜è¦é‡å•“é‚£å€‹ï¼Œé‚£å°±é‡æ–°åšä¸€å¥—å§ã€‚&lt;br /&gt;
ç‚ºäº†æˆ‘æƒ³å·æ‡¶..(^__^)&lt;br /&gt;
ä½†åœ¨é‚£ä¹‹å‰ï¼Œå…ˆç”Ÿå€‹æ©Ÿå™¨ä¾†æ¸¬è©¦çœ‹çœ‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡ç”¨terraforméƒ¨ç½²vmæ©Ÿå™¨ï¼Œ&lt;br /&gt;
é€™é‚Šè¦æ³¨æ„çš„æ˜¯ backend &amp;quot;gcs&amp;quot;ï¼Œ&lt;br /&gt;
æˆ‘ç›´æ¥å°‡tfstateå‚³åˆ°gcsä¸Šé¢äº†ï¼Œå¯ä»¥åƒè€ƒä¸Šä¸€ç¯‡&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Terraform/148.%20Terraform%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/&quot;&gt;148. Terraformçš„åŸºæœ¬æ¦‚å¿µ&lt;/a&gt;ã€‚&lt;br /&gt;
åº•ä¸‹çš„metadata_startup_scriptï¼Œ&lt;br /&gt;
æŒ‡ä»¤å¾ˆé•·ï¼Œå°è‡´æˆ‘ä¸æƒ³æ”¾åœ¨åŒä¸€è¡Œï¼Œ&lt;br /&gt;
è·‘å»å•äº†ä¸‹chatGPTï¼Œèƒ½ä½¿ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; &amp;lt;&amp;lt;-EOT
 EOT
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™ç¨®æ–¹å¼å°‡ç¨‹å¼ç¢¼åŒ…åœ¨ä¸€èµ·ï¼Œå°±æ¯”è¼ƒæ–¹ä¾¿é–±è®€äº†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    terraform {
      required_providers {
        google = {
          source = &amp;quot;hashicorp/google&amp;quot;
          version = &amp;quot;4.63.1&amp;quot;
        }
      }
      backend &amp;quot;gcs&amp;quot; {

      }
    }
    
    provider &amp;quot;google&amp;quot; {
      project = &amp;quot;abc&amp;quot;
    }

    resource &amp;quot;google_compute_instance&amp;quot; &amp;quot;certificate-vm&amp;quot; {
      name         = &amp;quot;ca-service&amp;quot;
      machine_type = &amp;quot;f1-micro&amp;quot;
      zone         = &amp;quot;asia-east1-b&amp;quot;
      tags         = [&amp;quot;allow-admin-ip&amp;quot;]

      boot_disk {
        initialize_params {
          image = &amp;quot;debian-cloud/debian-11&amp;quot;
        }
      }

      # Install Docker
      metadata_startup_script = &amp;lt;&amp;lt;-EOT
        sudo apt-get update; sudo apt-get install ca-certificates curl gnupg; 
        sudo install -m 0755 -d /etc/apt/keyrings; 
        curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg; 
        sudo chmod a+r /etc/apt/keyrings/docker.gpg; 
        echo &amp;quot;deb [arch=&amp;quot;$(dpkg --print-architecture)&amp;quot; signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian &#92;
        &amp;quot;$(. /etc/os-release &amp;amp;&amp;amp; echo &amp;quot;$VERSION_CODENAME&amp;quot;)&amp;quot; stable&amp;quot; | &#92;
        sudo tee /etc/apt/sources.list.d/docker.list &amp;gt; /dev/null ; 
        sudo apt-get update;
        sudo apt-get -y install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin;
      EOT

      network_interface {
        # subnetwork = google_compute_subnetwork.default.id
        subnetwork = &amp;quot;default&amp;quot;
        access_config {
          # Include this section to give the VM an external IP address
        }
      }
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;troubleshooting&lt;/h1&gt;
&lt;p&gt;å¦‚æœåŸ·è¡Œäº†startup-scriptï¼Œä½†æ²’è·‘ï¼Œè©²æ€éº¼é™¤éŒ¯ï¼Ÿ&lt;br /&gt;
åˆ°vmè£é¢åŸ·è¡Œä¸‹é¢æŒ‡ä»¤ï¼Œå°±å¯ä»¥æŸ¥logäº†&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;sudo journalctl -u google-startup-scripts.service
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://docs.docker.com/engine/install/debian/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Install Docker Engine on Debian&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Terraform/149. terraform éƒ¨ç½²VMï¼Œå•“å‹•dockerå®‰è£metadata_startup_script/" />
        </entry>
        <entry>
            <title>
                148. Terraformçš„åŸºæœ¬æ¦‚å¿µ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Terraform/148. Terraformçš„åŸºæœ¬æ¦‚å¿µ/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;ç¶“æ­·ä¸Šä¸€ç¯‡çš„å¤±æ•—ï¼Œ&lt;br /&gt;
é‚„æ˜¯å…ˆå¾åŸºæœ¬è§€å¿µé–‹å§‹å§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h4 id=&quot;tf&quot; tabindex=&quot;-1&quot;&gt;tfåŸºæœ¬çµ„æˆ&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢æŒ‡ä»¤è¼¸å…¥æ™‚ï¼Œæœƒç”¨tfå–ä»£terraform&lt;/p&gt;
&lt;h6 id=&quot;å®£å‘Š&quot; tabindex=&quot;-1&quot;&gt;å®£å‘Š&lt;/h6&gt;
&lt;ol&gt;
&lt;li&gt;terraform&lt;br /&gt;
å®£å‘Šterraformä»¥åŠç’°å¢ƒçš„ç‰ˆæœ¬&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;terraform {
  required_version = &amp;quot;~&amp;gt;0.13.5&amp;quot;
  required_providers {
    ucloud = {
      source  = &amp;quot;ucloud/ucloud&amp;quot;
      version = &amp;quot;~&amp;gt;1.22.0&amp;quot;
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;provider&lt;br /&gt;
å‘¼å«è©²ç’°å¢ƒapiæ™‚éœ€è¦çš„åƒæ•¸&lt;br /&gt;
k8s&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;provider &amp;quot;kubernetes&amp;quot; {
  config_path = &amp;quot;~/.kube/config&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ucloud&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;provider &amp;quot;ucloud&amp;quot; {
  public_key  = &amp;quot;JInqRnkSY8eAmxKFRxW9kVANYThg1pcvjD2Aw5f5p&amp;quot;
  private_key = &amp;quot;IlJn6GlmanYI1iDVEtrPyt5R9noAGz41B8q5TML7abqD8e4YjVdylwaKWdY61J5TcA&amp;quot;
  project_id  = &amp;quot;org-tgqbvi&amp;quot;
  region      = &amp;quot;cn-bj2&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;h6 id=&quot;å®šç¾©&quot; tabindex=&quot;-1&quot;&gt;å®šç¾©&lt;/h6&gt;
&lt;ol&gt;
&lt;li&gt;data&lt;br /&gt;
å–å¾—terraformä»¥å¤–çš„è³‡è¨Šï¼Œä¸åŒçš„proivderæä¾›ä¸åŒçš„data sourcesã€‚&lt;br /&gt;
&lt;a href=&quot;https://registry.terraform.io/browse/providers&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;provider åˆ—è¡¨&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;data &amp;quot;ucloud_security_groups&amp;quot; &amp;quot;default&amp;quot; {
  type = &amp;quot;recommend_web&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;resource&lt;br /&gt;
è¦å»ºç«‹çš„è³‡æº&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	resource &amp;quot;ucloud_eip&amp;quot; &amp;quot;web-eip&amp;quot; {
	  internet_type = &amp;quot;bgp&amp;quot;
	  charge_mode   = &amp;quot;bandwidth&amp;quot;
	  charge_type   = &amp;quot;dynamic&amp;quot;
	  name          = &amp;quot;web-eip&amp;quot;
	}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;output&lt;br /&gt;
è¼¸å‡º&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;		output &amp;quot;eip&amp;quot; {
		  value = ucloud_eip.web-eip.public_ip
		} 
&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;h4 id=&quot;tfstate&quot; tabindex=&quot;-1&quot;&gt;ç‹€æ…‹æª”æ¡ˆ(tfstate)&lt;/h4&gt;
&lt;p&gt;ç•¶terrformè¦åŸ·è¡Œè®Šæ›´æ™‚ï¼Œæœƒç”¢ç”Ÿtfstateçš„æª”æ¡ˆï¼Œ&lt;br /&gt;
ä¸Šé¢è¨˜è¼‰äº†ç›®å‰é›²ä¸Šçš„è³‡æºç‹€æ…‹ï¼Œæ­¤æª”æ¡ˆä¸å»ºè­°ç·¨è¼¯ï¼Œ&lt;br /&gt;
ç•¶æœ‰ä»»ä½•è³‡æºè®Šæ›´æ™‚ï¼ŒæœƒåŒæ­¥åˆ¤æ–·ç›®å‰é›²ä¸Šçš„è³‡æºç‹€æ…‹æ˜¯å¦ä¸€è‡´ã€‚&lt;br /&gt;
å¯ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ï¼ŒåŒ¯å…¥ç›®å‰é›²ç«¯ä¸Šçš„è³‡æºç‹€æ…‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; terraform import kubernetes_deployment.websocketclient default/websocketclient
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;kubernetes_deployment.websocketclient ç‚ºtfçš„è³‡æºåç¨±&lt;br /&gt;
default/websocketclient æ˜¯é›²ä¸Šçš„è³‡æº&lt;/p&gt;
&lt;p&gt;æ­¤tfstateçš„æª”æ¡ˆæ˜¯æ˜ç¢¼ï¼Œä¸”å¤šäººä½¿ç”¨æœƒé€ æˆç°½å…¥æ™‚ç™¼ç”Ÿè¡çªï¼Œ&lt;br /&gt;
æ‰€ä»¥è¦é€ébackendä¾†è§£æ±ºé€™å€‹å•é¡Œ&lt;/p&gt;
&lt;p&gt;æª”æ¡ˆè£é¢æœƒçœ‹åˆ°ä¸€äº›ç‹€æ…‹ï¼Œä»£è¡¨çš„æ„æ€å¦‚ä¸‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;+&lt;/code&gt; ä»£è¡¨æ–°å¢çš„è³‡æº (Resource added)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-&lt;/code&gt; ä»£è¡¨åˆªé™¤çš„è³‡æº (Resource deleted)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;~&lt;/code&gt; ä»£è¡¨ä¿®æ”¹çš„è³‡æº (Resource modified)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;=&lt;/code&gt; ä»£è¡¨è³‡æºåƒæ•¸çš„å€¼æ²’æœ‰æ”¹è®Šï¼Œåªæ˜¯èª¿æ•´äº†æ’åº (Resource parameter unchanged, only ordering changed)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-/+&lt;/code&gt; åŒæ™‚å‡ºç¾ï¼Œè¡¨ç¤ºæ¯€å£æ€§è®Šæ›´ï¼Œå…ˆåˆªé™¤å¾Œå»ºç«‹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/Terraform/148-fig.2.jpg&quot; alt=&quot;148-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.cloudskillsboost.google/focuses/15842?locale=zh_TW&amp;amp;parent=catalog&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨åŸºç¤æ¶æ§‹å³ç¨‹å¼ç¢¼å·¥å…· Terraform&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&quot;backend&quot; tabindex=&quot;-1&quot;&gt;é ç«¯ç‹€æ…‹å„²å­˜æ©Ÿåˆ¶(Backend)&lt;/h4&gt;
&lt;p&gt;Terraform Remote Backendåˆ†ç‚ºå…©ç¨®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¨™æº–ï¼šæ”¯æ´é ç«¯ç‹€æ…‹å„²å­˜èˆ‡ç‹€æ…‹é–
&lt;blockquote&gt;
&lt;p&gt;ç‹€æ…‹é–æ˜¯æŒ‡ï¼Œç•¶é‡å°ä¸€å€‹tfstateé€²è¡Œè®Šæ›´æ“ä½œæ™‚ï¼Œå¯ä»¥é‡å°è©²ç‹€æ…‹æª”æ¡ˆæ–°å¢ä¸€æŠŠå…¨åŸŸé–ï¼Œç¢ºä¿åŒä¸€æ™‚é–“åªèƒ½æœ‰ä¸€å€‹è®Šæ›´è¢«åŸ·è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;å¢å¼·ï¼šåœ¨æ¨™æº–çš„åŸºç¤ä¸Šæ”¯æ´é ç«¯æ“ä½œ(åœ¨é ç«¯ä¼ºæœå™¨ä¸ŠåŸ·è¡Œplanã€applyç­‰æ“ä½œ)
&lt;blockquote&gt;
&lt;p&gt;åªå­˜åœ¨æ–¼Terraform Cloud&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç›®å‰æ”¯æ´çš„backend list&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/Terraform/148-fig.1.jpg&quot; alt=&quot;148-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è¦å…±ç”¨ backendçš„è©±ï¼Œ&lt;br /&gt;
å…ˆå»ºç«‹ä¸€å€‹ backend.hcl&lt;br /&gt;
è£é¢è¼¸å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   bucket  = &amp;quot;98c2c8-terraform-backend&amp;quot;
   prefix  = &amp;quot;terraform/state&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢çš„prefixä»£è¡¨çš„æ„æ€ç‚º&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;GCS prefix inside the bucket. Named states for workspaces are stored in an object calledÂ &lt;code&gt;&amp;lt;prefix&amp;gt;/&amp;lt;name&amp;gt;.tfstate&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨main.tfçš„required_providerså¾Œé¢å¡«ä¸Š backend &amp;quot;gcs&amp;quot; { }ï¼Œ&lt;br /&gt;
æ ¼å¼å¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;terraform {
  required_providers {
    google = {
      source = &amp;quot;hashicorp/google&amp;quot;
      version = &amp;quot;4.63.1&amp;quot;
    }
  }
  backend &amp;quot;gcs&amp;quot; {

  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œåœ¨åˆå§‹åŒ–çš„æ™‚å€™ï¼Œè¼¸å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;terraform init -backend-config=backend.hcl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://lonegunmanb.github.io/introduction-terraform/2.2.Terraform%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5%E2%80%94%E2%80%94%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86.html#backend%E9%85%8D%E7%BD%AE%E7%9A%84%E5%8A%A8%E6%80%81%E8%B5%8B%E5%80%BC&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Backendçµ„æ…‹çš„å‹•æ…‹è³¦å€¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.hashicorp.com/terraform/language/settings/backends/gcs&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;tf-gcs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h4 id=&quot;workspace&quot; tabindex=&quot;-1&quot;&gt;å»ºç«‹workspace&lt;/h4&gt;
&lt;p&gt;ç›¸æ¯”èµ·å¤šè³‡æ–™å¤¾éš”é›¢çš„æ–¹å¼ä¾†èªªï¼ŒåŸºæ–¼Workspaceçš„éš”é›¢æ›´åŠ ç°¡å–®ï¼Œåªéœ€è¦ä¿å­˜ä¸€ä»½ç¨‹å¼ç¢¼ï¼Œåœ¨ç¨‹å¼ç¢¼ä¸­ä¸éœ€è¦ç‚ºWorkspaceç·¨å¯«é¡å¤–ç¨‹å¼ç¢¼ï¼Œç”¨å‘½ä»¤åˆ—å°±å¯ä»¥åœ¨ä¸åŒå·¥ä½œå€ä¹‹é–“ä¾†å›åˆ‡æ›ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹åˆ—æŒ‡ä»¤åˆ†åˆ¥çˆ²ï¼Œå»ºç«‹ã€åˆ—è¡¨ã€é¸æ“‡åŠé¡¯ç¤ºç›®å‰çš„workspace&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;terraform workspace new qa
terraform workspace list
terraform workspace select qa
terraform worspace show

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://lonegunmanb.github.io/introduction-terraform/2.2.Terraform%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5%E2%80%94%E2%80%94%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç‹€æ…‹ç®¡ç†&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&quot;terraform&quot; tabindex=&quot;-1&quot;&gt;æª¢æŸ¥terraform çš„è¨ˆåŠƒ&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;terraform plan -out=out.tfplan
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;-outçš„æŒ‡å®šè¨ˆç•«çš„è¼¸å‡ºæª”ï¼Œç¢ºä¿æ‚¨æ‰€æª¢é–±çš„æ–¹æ¡ˆå°±æ˜¯æ‰€å¥—ç”¨çš„æ–¹æ¡ˆã€‚&lt;br /&gt;
ä¹‹å¾Œä½¿ç”¨applyåŸ·è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;terraform apply out.tfplan
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å»ºç«‹å®Œæˆå¾Œï¼Œä½¿ç”¨showçœ‹ç›®å‰ç‹€æ…‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;terraform show
&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;h4 id=&quot;count&quot; tabindex=&quot;-1&quot;&gt;count&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;èˆ‰ä¾‹ä¾†èªª, å…©å€‹VMæ˜¯ä¸€éš»ç‹—ä¸€éš»è²“ï¼Œ&lt;a href=&quot;http://xn--dog-ww0f445bb75d.tf/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é‚£å°±æ˜¯dog.tf&lt;/a&gt; &lt;a href=&quot;http://cat.tf/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;cat.tf&lt;/a&gt;&lt;br /&gt;
å¦‚æœæ˜¯å…©éš»ç‹— å°±å¯ä»¥å¯«ä¸€å€‹ &lt;a href=&quot;http://dog.tf/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;dog.tf&lt;/a&gt;&lt;br /&gt;
è£¡é¢ç”¨&lt;br /&gt;
resources ec2&lt;br /&gt;
Count = 2&lt;br /&gt;
é€™æ¨£&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;console&quot; tabindex=&quot;-1&quot;&gt;console&lt;/h3&gt;
&lt;p&gt;åŸ·è¡Œ console ï¼Œçœ‹ç¨‹å¼åŸ·è¡Œçµæœ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;terraform console 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;cidrsubnet å¾Œé¢çš„ç¬¬äºŒå€‹åƒæ•¸è¡¨ç¤ºäºŒé€²ä½è¦ä½ç§»å¤šå°‘ï¼Œç¬¬ä¸‰å€‹åƒæ•¸è¡¨ç¤ºï¼Œè¦è¨­å®šä½ç§»çš„æ•¸å­—ç‚ºå¤šå°‘ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ 10  =  1010&lt;br /&gt;
ä½ç§»4bitï¼Œæ‰€ä»¥æ˜¯ 1010 0000  = 160&lt;br /&gt;
6 =  0110&lt;br /&gt;
ä½ç§»4bit ï¼Œæ‰€ä»¥æ˜¯ 0110 0000 = 96&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tf console
&amp;gt; cidrsubnet(&amp;quot;10.1.0.0/24&amp;quot;,4,0)
&amp;quot;10.1.0.0/28&amp;quot;
&amp;gt; cidrsubnet(&amp;quot;10.1.0.0/24&amp;quot;,4,10)
&amp;quot;10.1.0.160/28&amp;quot;
&amp;gt; cidrsubnet(&amp;quot;10.1.0.0/24&amp;quot;,4,6)
&amp;quot;10.1.0.96/28&amp;quot;
&amp;gt; cidrsubnet(&amp;quot;10.1.0.0/24&amp;quot;,4,12)
&amp;quot;10.1.0.192/28&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://ntwobike.medium.com/how-cidrsubnet-works-in-terraform-f6ccd8e1838f&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How cidrsubnet works in Terraform&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;variable&quot; tabindex=&quot;-1&quot;&gt;variableè®Šæ•¸å®£å‘Š&lt;/h3&gt;
&lt;p&gt;å…ˆçŸ¥é“è®Šæ•¸çš„ç¹¼æ‰¿é †åºï¼Œ&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç¨®é¡&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;th&gt;ç¯„ä¾‹&lt;/th&gt;
&lt;th&gt;å„ªå…ˆ&lt;/th&gt;
&lt;th&gt;å»ºè­°ä½¿ç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å‘½ä»¤åˆ—åƒæ•¸&lt;/td&gt;
&lt;td&gt;è¼¸å…¥å‘½ä»¤æ™‚ï¼ŒæŒ‡å®šè®Šæ•¸&lt;/td&gt;
&lt;td&gt;&lt;code&gt; tf apply -var=&amp;quot;gcp_region=asia-east&amp;quot;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;ç‰¹æ®Šæƒ…æ³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç’°å¢ƒè®Šæ•¸&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ TF_VAR_ ç’°å¢ƒè®Šæ•¸å®šç¾©&lt;/td&gt;
&lt;td&gt;&lt;code&gt;TF_VAR_gcp_region=asia_east2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è®Šæ•¸æ–‡ä»¶&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨tfvarsè®Šæ•¸æ–‡ä»¶å®šç¾©&lt;/td&gt;
&lt;td&gt;&lt;code&gt;gcp_region=asia_east2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;é–‹ç™¼è€…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¨­å®šæ–‡ä»¶&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨variableså€å¡Šå®šç¾©&lt;/td&gt;
&lt;td&gt;&lt;code&gt;variable &amp;quot;gcp_region&amp;quot; {default = &amp;quot;asia-east1&amp;quot;}&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;ç¨‹å¼ç¢¼&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;tfçš„è®Šæ•¸è¦å…ˆå®£å‘Šï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-variable.tf&quot;&gt;variable &amp;quot;gcp_region&amp;quot; {
  default = &amp;quot;asia-east1&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœå¾ŒçºŒè¦æ”¹å€¼ï¼Œå¯ä»¥æ”¹æˆ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-terraform.tfvars&quot;&gt;gcp_region = &amp;quot;asia-east2&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœè¦æ¸¬è©¦ï¼Œå¯ä»¥åŸ·è¡Œ &lt;code&gt;terraform console&lt;/code&gt;&lt;br /&gt;
å†è¼¸å…¥è®Šæ•¸åç¨±é©—è­‰ã€‚&lt;/p&gt;
&lt;p&gt;è®Šæ•¸æ–‡ä»¶è¼‰å…¥æ–¹å¼&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æª”æ¡ˆåç¨±ç‚ºÂ &lt;code&gt;terraform.tfvars&lt;/code&gt;Â orÂ &lt;code&gt;terraform.tfvars.json&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å‰¯æª”åç‚ºÂ &lt;code&gt;.auto.tfvars&lt;/code&gt;Â orÂ &lt;code&gt;.auto.tfvars&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¿…é ˆåœ¨åŒä¸€å€‹&lt;code&gt;tf init&lt;/code&gt;çš„è³‡æ–™å¤¾å…§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/Terraform/148-fig.4.jpg&quot; alt=&quot;148-fig.4.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é‚„æœ‰å…¶ä»–è¼‰å…¥æ–¹å¼ï¼Œåœ¨apply æ™‚è¼‰å…¥è®Šæ•¸æª”ï¼Œæˆ–æ˜¯ç’°å¢ƒè®Šæ•¸è¼‰å…¥ã€‚&lt;br /&gt;
è©³ç´°åƒè€ƒ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://godleon.github.io/blog/DevOps/terraform-input-variables/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[Terraform] Input Variables&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.oracle.com/zh-TW/learn/technical-articles/4-variables&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Terraform è®Šæ•¸&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=Fn3M8ll5sC4&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;(Youtube)Terraform å¾é›¶é–‹å§‹ åŸºç¤ | 9-Variablesï¼ˆè®Šæ•¸ï¼‰çš„ç¨®é¡èˆ‡ä½¿ç”¨é †åº&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;å¸¸ç”¨æŒ‡ä»¤&quot; tabindex=&quot;-1&quot;&gt;å¸¸ç”¨æŒ‡ä»¤&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;tf console&lt;/code&gt; å¯ä»¥ç¶“ç”±é€™é‚Šå»é©—è­‰è®Šæ•¸&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/Terraform/148-fig.3.jpg&quot; alt=&quot;148-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;tf fmt&lt;/code&gt; &lt;a href=&quot;http://xn--main-kk0g674d1vo.tf/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ ¼å¼åŒ–main.tf&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;tf validate&lt;/code&gt; é©—è­‰terraform&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Terraform/148. Terraformçš„åŸºæœ¬æ¦‚å¿µ/" />
        </entry>
        <entry>
            <title>
                147. ç”¨chatGPTå­¸Terraform
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/Terraform/147. ç”¨chatGPTå­¸Terraform/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;çµ‚æ–¼è¦ä¾†è©¦è©¦çœ‹terraormäº†ï¼Œ&lt;br /&gt;
ç¾åœ¨å…¬å¸å¥½åƒå¾ˆå°‘å…¨éƒ¨k8sï¼Œ&lt;br /&gt;
å¤§éƒ¨åˆ†é‚„æ˜¯ç”¨è™›æ“¬æ©Ÿï¼Œé€™æ¨£è®Šæˆé‚„æ˜¯è¦æŠŠterraformå­¸ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h4 id=&quot;terraform-ansible&quot; tabindex=&quot;-1&quot;&gt;Terraformè·Ÿansibleçš„å·®ç•°&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å·®ç•°é»&lt;/th&gt;
&lt;th&gt;Terraform&lt;/th&gt;
&lt;th&gt;Ansible&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;çµ„æ…‹æª”æ¡ˆç®¡ç† vs çµ„æ…‹&lt;/td&gt;
&lt;td&gt;Terraformä½¿ç”¨çµ„æ…‹æª”æ¡ˆç®¡ç†åŸºç¤è¨­æ–½ï¼Œæè¿°å…¶ç‹€æ…‹ï¼Œè€Œä¸æ˜¯é…ç½®ã€‚&lt;/td&gt;
&lt;td&gt;AnsibleåŸºæ–¼ä¸»æ©Ÿçš„ç®¡ç†ï¼Œç›´æ¥é…ç½®åŸºç¤è¨­æ–½ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¯è®ŠåŸºç¤è¨­æ–½ vs ä¸å¯è®ŠåŸºç¤è¨­æ–½&lt;/td&gt;
&lt;td&gt;Terraformä»¥å¯è®Šçš„æ–¹å¼ç®¡ç†åŸºç¤è¨­æ–½ï¼Œå¯ä»¥å°åŸºç¤è¨­æ–½é€²è¡Œæ›´æ”¹ã€‚&lt;/td&gt;
&lt;td&gt;Ansibleé€šå¸¸å°‡åŸºç¤è¨­æ–½è¦–ç‚ºä¸å¯è®Šçš„ï¼Œä¸€æ—¦é…ç½®ï¼Œå®ƒå€‘å°±ä¸å†æ›´æ”¹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;éç¨‹å¼çš„ vs è²æ˜å¼çš„&lt;/td&gt;
&lt;td&gt;Terraformæ˜¯éç¨‹å¼çš„ï¼Œæœƒå¾ªåºæ¼¸é€²åœ°åŸ·è¡Œå‰µå»ºã€ä¿®æ”¹å’Œåˆªé™¤æ“ä½œã€‚&lt;/td&gt;
&lt;td&gt;Ansibleæ˜¯è²æ˜å¼çš„ï¼Œæè¿°äº†æœŸæœ›çš„æœ€çµ‚ç‹€æ…‹ï¼Œè€Œä¸æ˜¯åŸ·è¡Œä¸€ç³»åˆ—æ­¥é©Ÿä¾†å¯¦ç¾å®ƒã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Master vs Masterless&lt;/td&gt;
&lt;td&gt;Terraformé€šå¸¸ä½¿ç”¨å–®ä¸€ä¸»ç¯€é»ç®¡ç†åŸºç¤è¨­æ–½ç‹€æ…‹ã€‚&lt;/td&gt;
&lt;td&gt;Ansibleå¯ä»¥åœ¨ä¸»ç¯€é»å’Œç„¡ä¸»ç¯€é»ï¼ˆå³agentlessï¼‰æ¨¡å¼ä¸‹é‹è¡Œã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Agent vs Agentless&lt;/td&gt;
&lt;td&gt;Terraformä¸éœ€è¦åœ¨ç›®æ¨™åŸºç¤è¨­æ–½ä¸Šå®‰è£ä»»ä½•ä»£ç†ã€‚&lt;/td&gt;
&lt;td&gt;Ansibleéœ€è¦åœ¨ç›®æ¨™åŸºç¤è¨­æ–½ä¸Šå®‰è£ä¸€å€‹ä»£ç†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æˆç†Ÿ vs å‰æ²¿&lt;/td&gt;
&lt;td&gt;Terraformæ˜¯æˆç†Ÿçš„åŸºç¤è¨­æ–½è‡ªå‹•åŒ–å·¥å…·ï¼Œå·²è¢«å»£æ³›ä½¿ç”¨ã€‚&lt;/td&gt;
&lt;td&gt;Ansibleæ˜¯ä¸€å€‹æ–°èˆˆçš„åŸºç¤è¨­æ–½è‡ªå‹•åŒ–å·¥å…·ï¼Œä¸¦ä¸”æ­£åœ¨ç©æ¥µç™¼å±•ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç¶œåˆä½¿ç”¨å¤šç¨®å·¥å…·&lt;/td&gt;
&lt;td&gt;Terraformèˆ‡å…¶ä»–å·¥å…·é›†æˆï¼Œå¦‚Packerã€Dockerå’ŒAWS CloudFormationç­‰ã€‚&lt;/td&gt;
&lt;td&gt;Ansibleèˆ‡å…¶ä»–å·¥å…·é›†æˆï¼Œå¦‚Jenkinsã€Dockerå’ŒKubernetesç­‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;å®‰è£&quot; tabindex=&quot;-1&quot;&gt;å®‰è£&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://developer.hashicorp.com/terraform/downloads&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®˜ç¶²&lt;/a&gt;å®‰è£æœ€å¿«äº†ï¼Œä¸Šé¢æœ‰å„å€‹å¹³è‡ºçš„å®‰è£æ–¹å¼ã€‚&lt;/p&gt;
&lt;h4 id=&quot;è© å”±&quot; tabindex=&quot;-1&quot;&gt;è© å”±&lt;/h4&gt;
&lt;p&gt;æˆ‘å…ˆå•äº†ä¸€ä¸‹chatGPTæ€éº¼å­¸Terraformï¼Œç„¶å¾Œçµ¦äº†æˆ‘å¾ˆæ¨™æº–çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é–±è®€Terraformå®˜æ–¹æ–‡æª”ï¼Œç†Ÿæ‚‰å…¶åŸºç¤çµæ§‹ã€åŠŸèƒ½å’Œæ¦‚å¿µã€‚&lt;/li&gt;
&lt;li&gt;å®‰è£Terraformï¼Œä¸¦å­¸ç¿’å¦‚ä½•ä½¿ç”¨å®ƒä¾†å‰µå»ºåŸºç¤è¨­æ–½ã€‚&lt;/li&gt;
&lt;li&gt;é–‹å§‹ä½¿ç”¨Terraformçš„ç¤ºä¾‹é …ç›®ï¼Œä¸¦å˜—è©¦ä½¿ç”¨å®ƒå€‘å‰µå»ºç°¡å–®çš„åŸºç¤è¨­æ–½ã€‚&lt;/li&gt;
&lt;li&gt;å­¸ç¿’å¦‚ä½•ä½¿ç”¨Terraformç®¡ç†ä¸åŒçš„åŸºç¤è¨­æ–½æä¾›è€…ï¼Œå¦‚AWSã€Azureã€Google Cloudç­‰ã€‚&lt;/li&gt;
&lt;li&gt;é–±è®€Terraformçš„æ¨¡å¡ŠåŒ–æ–‡æª”ï¼Œä¸¦å­¸ç¿’å¦‚ä½•ä½¿ç”¨æ¨¡å¡ŠåŒ–è¨­è¨ˆä¾†ç®¡ç†è¤‡é›œçš„åŸºç¤è¨­æ–½ã€‚&lt;/li&gt;
&lt;li&gt;å­¸ç¿’å¦‚ä½•ä½¿ç”¨Terraformå‘½ä»¤åˆ—å·¥å…·ä¾†æ¸¬è©¦å’Œèª¿è©¦åŸºç¤è¨­æ–½ä»£ç¢¼ã€‚&lt;/li&gt;
&lt;li&gt;ç ”ç©¶Terraformçš„æœ€ä½³å¯¦è¸ï¼ŒåŒ…æ‹¬å¦‚ä½•ç®¡ç†æ©Ÿå¯†ã€ç·¨å¯«å¯é‡ç”¨çš„ä»£ç¢¼å’Œè¨­è¨ˆå¯æ“´å±•çš„åŸºç¤è¨­æ–½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æˆ‘é‚„æ˜¯ç›´æ¥å¾å¯¦éš›æ¡ˆä¾‹ä¾†çœ‹å¥½äº†ï¼Œ&lt;/p&gt;
&lt;p&gt;Q: å¹«æˆ‘å»ºç«‹ä¸€å€‹éƒ¨ç½²deploymentçš„terrformç¨‹å¼ç¢¼&lt;br /&gt;
A:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# å®šç¾©Kubernetes provider
provider &amp;quot;kubernetes&amp;quot; {
  config_context_cluster = &amp;quot;my-cluster&amp;quot;
}

# å®šç¾©deployment
resource &amp;quot;kubernetes_deployment&amp;quot; &amp;quot;my_deployment&amp;quot; {
  metadata {
    name = &amp;quot;my-deployment&amp;quot;
    labels = {
      app = &amp;quot;my-app&amp;quot;
    }
  }

  spec {
    replicas = 3

    selector {
      match_labels = {
        app = &amp;quot;my-app&amp;quot;
      }
    }

    template {
      metadata {
        labels = {
          app = &amp;quot;my-app&amp;quot;
        }
      }

      spec {
        container {
          image = &amp;quot;my-image:latest&amp;quot;
          name  = &amp;quot;my-container&amp;quot;
        }
      }
    }
  }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çœ‹äº†ä¸€ä¸‹ä»–æä¾›çš„ç¨‹å¼ç¢¼ï¼Œæœ‰é»å•é¡Œï¼Œç„¶å¾Œæ¥ç€å•&lt;br /&gt;
Qï¼šresouce å®£å‘Š kubernetes_deployment my_deployment æ˜¯è¦è·Ÿdeploymentçš„nameä¸€æ¨£å—&lt;br /&gt;
A:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ˜¯çš„ï¼Œ&lt;code&gt;kubernetes_deployment&lt;/code&gt;çš„&lt;code&gt;metadata&lt;/code&gt;å€å¡Šä¸­çš„&lt;code&gt;name&lt;/code&gt;å±¬æ€§æœƒå®šç¾©Kubernetes deploymentçš„åç¨±ï¼Œæ‚¨éœ€è¦å°‡å…¶è¨­å®šç‚ºèˆ‡å¯¦éš›çš„deploymentåç¨±ç›¸åŒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç„¶å¾Œåœ¨å¾ŒçºŒçš„å°è«‡éç¨‹ä¸­ï¼Œç™¼ç¾å¦ä¸€å€‹æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;terraform import 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ç·Šæ¥ç€å•ï¼Œé€™å€‹çš„åŠŸç”¨æ˜¯ä»€éº¼ã€‚&lt;/p&gt;
&lt;p&gt;A:&lt;br /&gt;
&lt;code&gt;terraform import&lt;/code&gt;æ˜¯Terraformæä¾›çš„ä¸€å€‹å‘½ä»¤ï¼Œç”¨æ–¼å°‡ç¾æœ‰çš„è³‡æºå¼•å…¥Terraformç®¡ç†çš„ç‹€æ…‹ä¸­ã€‚ä½¿ç”¨&lt;code&gt;terraform import&lt;/code&gt;å¯ä»¥è®“Terraformç­è§£ç¾æœ‰è³‡æºçš„ç‹€æ…‹ï¼Œä¸¦å…è¨±ä½ ä½¿ç”¨Terraformç®¡ç†é€™äº›è³‡æºï¼Œä¸¦åœ¨éœ€è¦æ™‚é€²è¡Œæ›´æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸æƒ…æ³ä¸‹ï¼ŒTerraformæœƒå¾é ­é–‹å§‹å‰µå»ºå’Œç®¡ç†æ‰€æœ‰è³‡æºã€‚ç„¶è€Œï¼Œåœ¨å¯¦éš›ç’°å¢ƒä¸­ï¼Œæœ‰æ™‚å€™æœƒå­˜åœ¨ä¸€äº›å·²ç¶“å­˜åœ¨çš„è³‡æºï¼Œé€™äº›è³‡æºå¯èƒ½æ˜¯æ‰‹å‹•å‰µå»ºçš„ï¼Œæˆ–è€…æ˜¯ç”±å…¶ä»–å·¥å…·å‰µå»ºçš„ã€‚é€™äº›è³‡æºå¯èƒ½åŒ…æ‹¬Kubernetes deploymentã€AWS EC2å¯¦ä¾‹ã€GCPè™›æ“¬æ©Ÿç­‰ç­‰ã€‚åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œä½¿ç”¨&lt;code&gt;terraform import&lt;/code&gt;å‘½ä»¤å¯ä»¥å°‡é€™äº›ç¾æœ‰è³‡æºå¼•å…¥åˆ°Terraformç®¡ç†çš„ç‹€æ…‹ä¸­ï¼Œä»¥ä¾¿Terraformèƒ½å¤ ç®¡ç†å®ƒå€‘ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;terraform import&lt;/code&gt;å‘½ä»¤æ™‚ï¼Œéœ€è¦æŒ‡å®šè¦å¼•å…¥çš„è³‡æºçš„é¡å‹å’ŒIDï¼Œä»¥åŠè¦å°æ‡‰åˆ°Terraformçš„å“ªå€‹è³‡æºã€‚Terraformå°‡ä½¿ç”¨æä¾›çš„è³‡æºé¡å‹å’ŒIDå°‹æ‰¾ç¾æœ‰è³‡æºçš„ç‹€æ…‹ï¼Œä¸¦å°‡å…¶å°æ‡‰åˆ°Terraformçµ„æ…‹æª”æ¡ˆä¸­çš„ç›¸æ‡‰è³‡æºã€‚ä¸€æ—¦è³‡æºæˆåŠŸè¢«å¼•å…¥ï¼ŒTerraformå°±å¯ä»¥é–‹å§‹ç®¡ç†å®ƒå€‘ï¼Œä¸¦å°‡å®ƒå€‘çš„ç‹€æ…‹ä¿å­˜åˆ°ç‹€æ…‹æª”æ¡ˆä¸­ï¼Œé€™æ¨£å°±å¯ä»¥ä½¿ç”¨&lt;code&gt;terraform plan&lt;/code&gt;ã€&lt;code&gt;terraform apply&lt;/code&gt;ç­‰å‘½ä»¤é€²è¡Œæ›´æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸çŸ¥é“æ€éº¼ç”¨æ²’é—œä¿‚ï¼Œ&lt;br /&gt;
å†å•ä¸€ä¸‹ï¼Œ&lt;br /&gt;
Qï¼šè©²æ€éº¼ä½¿ç”¨terraform import&lt;br /&gt;
Aï¼š&lt;br /&gt;
ä½¿ç”¨&lt;code&gt;terraform import&lt;/code&gt;å‘½ä»¤å¼•å…¥ç¾æœ‰è³‡æºåˆ°Terraformç®¡ç†çš„ç‹€æ…‹ä¸­ï¼Œé€šå¸¸éœ€è¦ä»¥ä¸‹æ­¥é©Ÿï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨Terraformçµ„æ…‹æª”æ¡ˆä¸­å®šç¾©è³‡æºçš„çµ„æ…‹ï¼Œä¾‹å¦‚ä½¿ç”¨&lt;code&gt;kubernetes_deployment&lt;/code&gt;å®šç¾©Kubernetes deploymentçš„çµ„æ…‹ã€‚&lt;/li&gt;
&lt;li&gt;åŸ·è¡Œ&lt;code&gt;terraform init&lt;/code&gt;åˆå§‹åŒ–Terraformï¼Œä»¥è¨­ç½®Terraformçš„å·¥ä½œç›®éŒ„å’Œç›¸é—œå¤–æ›ã€‚&lt;/li&gt;
&lt;li&gt;åŸ·è¡Œ&lt;code&gt;terraform import&lt;/code&gt;å‘½ä»¤å¼•å…¥ç¾æœ‰è³‡æºã€‚ä¾‹å¦‚ï¼Œè¦å¼•å…¥Kubernetes deploymentï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;terraform import kubernetes_deployment.systemservice deployment2k7
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™è£¡çš„&lt;code&gt;kubernetes_deployment.systemservice&lt;/code&gt;æŒ‡çš„æ˜¯åœ¨Terraformçµ„æ…‹æª”æ¡ˆä¸­å®šç¾©çš„Kubernetes deploymentè³‡æºï¼Œ&lt;code&gt;deployment2k7&lt;/code&gt;å‰‡æ˜¯ç¾æœ‰Kubernetes deploymentçš„åç¨±æˆ–IDã€‚é€šéé€™æ¨£çš„æ–¹å¼ï¼ŒTerraformå°±æœƒå°‡ç¾æœ‰çš„Kubernetes deploymentå¼•å…¥åˆ°Terraformç®¡ç†çš„ç‹€æ…‹ä¸­ã€‚&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;æª¢æŸ¥Terraformçš„ç‹€æ…‹ï¼Œä½¿ç”¨&lt;code&gt;terraform state list&lt;/code&gt;å‘½ä»¤å¯ä»¥åˆ—å‡ºTerraformç›®å‰ç®¡ç†çš„æ‰€æœ‰è³‡æºï¼Œå¯ä»¥ç¢ºèªå¼•å…¥çš„è³‡æºæ˜¯å¦å·²ç¶“è¢«æˆåŠŸç®¡ç†ã€‚&lt;/li&gt;
&lt;li&gt;æ›´æ–°Terraformçµ„æ…‹æª”æ¡ˆï¼Œé€šé&lt;code&gt;terraform plan&lt;/code&gt;å’Œ&lt;code&gt;terraform apply&lt;/code&gt;å‘½ä»¤å°è³‡æºé€²è¡Œæ›´æ”¹ã€‚ç•¶Terraformç®¡ç†ç¾æœ‰è³‡æºæ™‚ï¼Œå®ƒæœƒæ¯”è¼ƒTerraformçµ„æ…‹æª”æ¡ˆå’Œç¾æœ‰è³‡æºçš„ç‹€æ…‹ï¼Œä¸¦ç”Ÿæˆä¸€å€‹è¨ˆåŠƒï¼Œé¡¯ç¤ºè¦å°‡è³‡æºå¸¶åˆ°Terraformæ‰€éœ€çš„æ›´æ”¹ã€‚é€šéåŸ·è¡Œ&lt;code&gt;terraform apply&lt;/code&gt;å‘½ä»¤ï¼ŒTerraformå°±å¯ä»¥å°‡é€™äº›æ›´æ”¹æ‡‰ç”¨åˆ°ç¾æœ‰çš„è³‡æºä¸­ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h4&gt;
&lt;p&gt;å…‰çœ‹æ²’æœ‰ç”¨ï¼Œæœ€é‡è¦çš„é‚„æ˜¯å¯¦ä½œï¼Œ&lt;br /&gt;
ä¸€é–‹å§‹æ²’ç¢°terraformæ˜¯ä¸çŸ¥é“å¯«å£äº†ï¼Œæœƒä¸æœƒå½±éŸ¿ç·šä¸Šçš„æœå‹™ï¼Œ&lt;br /&gt;
ç¾åœ¨æˆ‘èƒ½å¤ å…ˆimportï¼Œçœ‹ç›®å‰æœå‹™å»ºè¨­çš„ç¨‹å¼å¾Œï¼Œå†ä¾†ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;h3 id=&quot;æ„Ÿæƒ³&quot; tabindex=&quot;-1&quot;&gt;æ„Ÿæƒ³&lt;/h3&gt;
&lt;p&gt;å¯¦ä½œå¾Œå®Œå…¨å´©æ‰ï¼Œæœ‰å¾ˆå¤šæ±è¥¿é‚„æ˜¯è¦å¾é ­é–‹å§‹çœ‹ä¸€ä¸‹ã€‚&lt;br /&gt;
åƒæ˜¯ï¼Œ terraform çš„backend ï¼Œè·Ÿtfstate é€™äº›è§€å¿µã€‚&lt;br /&gt;
ä¸Šé¢ä¹Ÿæœ‰æåˆ°å¼•å…¥è³‡æºï¼Œä½†å¯¦éš›ä¸Šå¯èƒ½è·Ÿä½ æƒ³å¾—ä¸å¤ªä¸€æ¨£ï¼Œ&lt;br /&gt;
å¼•å…¥å¾Œæ˜¯è®Šæˆä¸€å€‹tfstateï¼Œè€Œä¸æ˜¯tfï¼Œ&lt;br /&gt;
é‚£tf è·Ÿ tfstateåˆæœ‰ä»€éº¼ä¸åŒå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘å€‘é‚„æ˜¯çœ‹ä¸‹ä¸€ç¯‡ï¼Œå¾é ­ä¾†éå§ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kknews.cc/zh-tw/code/amvkzax.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç‚ºä»€éº¼æˆ‘å€‘ä½¿ç”¨Terraform è€Œä¸ä½¿ç”¨Puppet, Ansible &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/Terraform/147. ç”¨chatGPTå­¸Terraform/" />
        </entry>
        <entry>
            <title>
                71.gitlab on GKE ç½å®³é‚„åŸç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/GKE/71.gitlab on GKE ç½å®³é‚„åŸç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¹‹å‰ä¸€ç›´æ²’å¯«çš„gitlab yamlï¼Œå†æ–‡ç« çš„æœ€ä¸‹æ–¹ã€‚&lt;br /&gt;
æœ¬ç‰‡æ–‡ç« éƒ½æ˜¯ä½¿ç”¨é€™å€‹yamlåšå»ºç«‹åŠä½ˆç½²ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;Step 0.&lt;/p&gt;
&lt;p&gt;ä¹‹å‰ä¸€ç›´æ²’å¯«çš„gitlab yamlï¼Œå†æ–‡ç« çš„æœ€ä¸‹æ–¹ã€‚&lt;br /&gt;
æœ¬ç‰‡æ–‡ç« éƒ½æ˜¯ä½¿ç”¨é€™å€‹yamlåšå»ºç«‹åŠä½ˆç½²ã€‚&lt;/p&gt;
&lt;p&gt;Step 1.&lt;/p&gt;
&lt;p&gt;å…ˆåƒè€ƒä¸Šç¯‡ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/70.%20GKE%20pvc%E9%82%84%E5%8E%9F/&quot;&gt;70. GKE pvcé‚„åŸ&lt;/a&gt;ï¼Œå»ºç«‹å¥½PVCã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦è¤‡è£½Gitlabçš„ä½ç½®ç‚º&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- name: config
  mountPath: /etc/gitlab
- name: gitlab-data
  mountPath: /var/opt/gitlab/git-data
- name: postgres-data
  mountPath: /var/opt/gitlab/postgresql
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”±æ–¼æˆ‘ä¹‹å‰å»ºç«‹çš„imageç‚º lastç‰ˆæœ¬ï¼ˆæ‡‰è©²æ˜¯å¿«ä¸€å¹´å‰çš„äº‹ï¼‰ï¼Œ&lt;br /&gt;
é€™æ¬¡æˆ‘ç”¨lastç‰ˆæœ¬çš„è©±ï¼Œç‰ˆæœ¬è¶…å‰å¤ªå¤šï¼Œå°è‡´ä¸€ç›´é‡é–‹æ©Ÿã€‚&lt;/p&gt;
&lt;p&gt;å¾Œä¾†æŸ¥æˆ‘çš„gitlabç‰ˆæœ¬ç‚º 14.0.1ï¼Œ&lt;br /&gt;
ä½†è£ä¸Šå»å¾Œä¸€ç›´ç¢°åˆ°é€™å€‹éŒ¯èª¤&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;relation &amp;quot;services&amp;quot; does not exist after upgrade to 14.2.0&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è§£æ±ºæ–¹å¼ï¼š&lt;br /&gt;
å¾Œä¾†å°‡ç‰ˆæœ¬å‡ç´šåˆ° 14.1.1 å¾Œå°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://gitlab.com/gitlab-org/omnibus-gitlab/-/issues/6352&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ERROR: relation &amp;quot;services&amp;quot; does not exist after upgrade to 14.2.0&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Step 2.&lt;/p&gt;
&lt;p&gt;ç”¨æœ¬ä¾†çš„å¸³è™Ÿå¯†ç¢¼èƒ½ç™»å…¥ï¼Œæ²’å•é¡Œã€‚&lt;br /&gt;
å¢åŠ æ–°çš„git remote ä½ç½®ï¼Œ&lt;br /&gt;
ç„¶å¾Œè©¦è‘—æ¨ä¸€å€‹ç‰ˆæœ¬ä¸Šå»æ™‚ï¼Œåˆå‡ºç¾éŒ¯èª¤äº†ã€‚é€™æ¬¡æ¯”è¼ƒå¥½ç†è§£ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;remote: HTTP Basic: Access denied&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è§£æ±ºæ–¹å¼ï¼š&lt;br /&gt;
è·‘å»å¦ä¸€å€‹ç©ºç›®éŒ„ï¼Œgit clone ï¼Œæœƒè¦è¼¸å…¥å¸³è™Ÿå¯†ç¢¼ï¼Œè¼¸å…¥å¾Œå°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;Step 3.&lt;/p&gt;
&lt;p&gt;å¦‚æœçœ‹éä¹‹å‰çš„æ–‡ç« ï¼Œå¯èƒ½çŸ¥é“æˆ‘æœ‰åœ¨ç”¨istioï¼Œ&lt;br /&gt;
æœƒç¢°åˆ°è¦ç”¨ä¸€å€‹ipæš´éœ²ä¸åŒçš„æœå‹™ã€‚&lt;/p&gt;
&lt;p&gt;è§£æ±ºæ–¹å¼ï¼š&lt;br /&gt;
external_url &amp;quot;http://{ip}/gitlab&amp;quot;&lt;br /&gt;
virtualserviceç›´æ¥æ”¹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;spec:
  hosts: []
  http:
    - match:
        - uri:
            prefix: /gitlab
      name: gitlab
      route:
        - destination:
            host: gitlab-svc.default.svc.cluster.local
            port:
              number: 80
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.gitlab.com/omnibus/settings/configuration.html#configure-a-relative-url-for-gitlab&quot; title=&quot;Permalink&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Configure a relative URL for GitLab&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;gitlab-yaml&quot; tabindex=&quot;-1&quot;&gt;Gitlab yaml&lt;/h3&gt;
&lt;p&gt;ç¾åœ¨ä¹Ÿæœ‰&lt;a href=&quot;https://docs.gitlab.com/charts/installation/operator.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gitlab operator&lt;/a&gt;è·Ÿ &lt;a href=&quot;https://docs.gitlab.com/charts/installation/deployment.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;helm&lt;/a&gt; å¯ä»¥åšï¼Œæœ‰èˆˆè¶£çš„å¯ä»¥åƒè€ƒä¸€ä¸‹å®˜æ–¹æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
kind: Service
metadata:
  name: gitlab-svc
spec:
  ports:
  - name: &amp;quot;web&amp;quot;
    port: 80
    targetPort: 80
  - name: &amp;quot;ssh&amp;quot;
    port: 22
    targetPort: 22
  - name: &amp;quot;ssl&amp;quot;
    port: 443
    targetPort: 443
  selector:
    io.kompose.service: web
    drone: gitlab
  type: LoadBalancer
  loadBalancerIP: 123.123.123.123
  loadBalancerSourceRanges:
  - 192.168.0.0/16
  - 172.16.0.0/12
  - 10.0.0.0/8


---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: gitlab
  labels:
    io.kompose.service: web
spec:
  replicas: 1
  selector:
    matchLabels:      
      io.kompose.service: web
  template:
    metadata:
      labels:
        io.kompose.service: web
    spec:
      containers:
      - env:
        - name: GITLAB_TIMEZONE
          value: Taipei
        - name: GITLAB_OMNIBUS_CONFIG
          value: |            
            external_url &amp;quot;http://123.123.123.123/gitlab&amp;quot;
            gitlab_rails[&#39;gitlab_default_projects_features_builds&#39;] = false
        image: gitlab/gitlab-ce:14.1.1-ce.0
        name: web
        ports:
        - containerPort: 80
        resources: {}
        volumeMounts:
        - name: config
          mountPath: /etc/gitlab
        - name: gitlab-data
          mountPath: /var/opt/gitlab/git-data
        - name: postgres-data
          mountPath: /var/opt/gitlab/postgresql
      restartPolicy: Always
      serviceAccountName: &amp;quot;&amp;quot;
      volumes:
      - name: config
        persistentVolumeClaim:
          claimName: gke-drone-web-claim0
      - name: gitlab-data
        persistentVolumeClaim:
          claimName: gke-drone-repository-data
      - name: postgres-data
        persistentVolumeClaim:
          claimName: gke-drone-gitlab-postgresql
      
        
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;PVCçš„å»ºç«‹ï¼Œè«‹åƒè€ƒ&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/70.%20GKE%20pvc%E9%82%84%E5%8E%9F/&quot;&gt;70. GKE pvcé‚„åŸ&lt;/a&gt;ï¼Œå¦‚è¦å»ºç«‹ç©ºçš„ï¼Œ&lt;br /&gt;
åƒè€ƒä¸‹æ–¹yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  creationTimestamp: null
  labels:
    io.kompose.service: web-claim0
  name: gke-drone-web-claim0
spec:
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 20Gi
status: {}
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    gitlab-data: gitlab
  name: gke-drone-repository-data
spec:
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 100Gi
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    gitlab-data: postgresql
  name: gke-drone-gitlab-postgresql
spec:
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 100Gi  
 
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/GKE/71.gitlab on GKE ç½å®³é‚„åŸç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                70. GKE pvcé‚„åŸ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/GKE/70. GKE pvcé‚„åŸ/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¹‹å‰çš„Gitlabå»ºåœ¨GKEçš„å…¬é–‹å¢é›†ä¸Šï¼Œ&lt;/p&gt;
&lt;p&gt;é›–ç„¶æœ‰é™å®šIPè¨ªå•ï¼Œä¸€ç›´è¦æ”¹åˆ°ç§æœ‰å¢é›†ä¸Šï¼Œ&lt;/p&gt;
&lt;p&gt;ä½†ä¸€ç›´æ²’æ™‚é–“å‹•ï¼Œç¾åœ¨çµ‚æ–¼æœ‰ç©ºå¼„äº†ï¼Œé¦–å…ˆè¦è§£æ±ºçš„æ˜¯è³‡æ–™é‚„åŸçš„å•é¡Œã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆåœ¨GCEä¸Šé¢è¤‡è£½ä¸€å€‹ç£ç¢Ÿï¼Œ&lt;br /&gt;
å¯ä»¥å…ˆå¾GKEä¸Šé¢çš„podæ‰¾åˆ°ç•¶åˆå»ºç«‹çš„pvcåç¨±ï¼Œ&lt;br /&gt;
å†æ ¹æ“šé€™å€‹åç¨±å»æ‰¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/70-fig.1.jpg&quot; alt=&quot;70-fig.1.jpg&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/70-fig.2.jpg&quot; alt=&quot;70-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å†ä¾†å°±å»ºç«‹pv è·Ÿ pvcäº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
kind: PersistentVolume
metadata:
  name: test-pv
  namespace: default
spec:
  # persistentVolumeReclaimPolicy: Delete
  storageClassName: &amp;quot;standard&amp;quot;
  capacity:
    storage: 300G
  accessModes:
    - ReadWriteOnce
  claimRef:
    namespace: default
    name: test-upload
  gcePersistentDisk:
    pdName: test-upload
    fsType: ext4
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: test-upload
  namespace: default
spec:
  storageClassName: &amp;quot;standard&amp;quot;
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 300G

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;pvçš„ gcePersistentDisk ï¼Œæ˜¯å‰›å‰›è¤‡è£½çš„ç¡¬ç¢Ÿåç¨±ã€‚&lt;/p&gt;
&lt;p&gt;å°‡è£¡é¢çš„åƒæ•¸æ”¹ä¸€æ”¹ï¼Œ&lt;br /&gt;
è¦å»ºç«‹çš„ name,namespace,storage, claimRef ï¼Œ&lt;br /&gt;
çµæŸã€‚&lt;/p&gt;
&lt;p&gt;deploymentä½¿ç”¨æ­£å¸¸æ–¹å¼ç›´æ¥æ›è¼‰å³å¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  template:
    metadata:
      creationTimestamp: null
      labels:
        app: video-admin
        version: v1
    spec:
      containers:
      - name: video
        ...
        volumeMounts:
        - mountPath: /upload
          name: source
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      terminationGracePeriodSeconds: 30
      volumes:
      - name: source
        persistentVolumeClaim:
          claimName: test-upload
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœæ˜¯statefuleSetçš„è©±ï¼Œ&lt;br /&gt;
pvçš„åç¨±éœ€è¦æ”¹æˆ statefulSetçš„å‘½åè¦å‰‡ã€‚&lt;br /&gt;
statefulSetä¸æœƒç”¨åˆ°pvcã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;VC_TEMPLATE_NAME-STATEFULSET_NAME-REPLICA_INDEX
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;VC_TEMPLATE_NAME&lt;/code&gt;ï¼šæ–° PersistentVolumeClaim æ¨¡æ¿çš„åç¨±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;STATEFULSET_NAME&lt;/code&gt;ï¼šæ–° StatefulSet çš„åç¨±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;REPLICA_INDEX&lt;/code&gt;ï¼šStatefulSet å‰¯æœ¬çš„ç´¢å¼•ã€‚æ­¤ç¤ºä¾‹ä½¿ç”¨çš„æ˜¯ &lt;code&gt;0&lt;/code&gt; å’Œ &lt;code&gt;1&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;pvc-pv&quot; tabindex=&quot;-1&quot;&gt;æ³¨æ„ï¼Œåˆªé™¤pvcæ™‚ï¼Œæœ€å¥½å°‡pvä¹Ÿåˆªé™¤ï¼Œé¿å…ç™¼ç”ŸæœªçŸ¥æƒ…æ³ã€‚&lt;/h3&gt;
&lt;p&gt;å¦‚ç¢°åˆ°ä¸‹åœ–æƒ…æ³ï¼Œè¡¨ç¤ºpvæœ‰å•é¡Œï¼Œè«‹åˆªé™¤é‡å»ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/70-fig.3.jpg&quot; alt=&quot;70-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/preexisting-pd&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å°‡åŸæœ‰æ°¸ä¹…æ€§ç£ç›¤ç”¨ä½œ PersistentVolume&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/concepts/persistent-volumes&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ°¸ä¹…æ€§å·å’Œå‹•æ…‹é é…&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/GKE/70. GKE pvcé‚„åŸ/" />
        </entry>
        <entry>
            <title>
                56. GKEè¨˜éŒ„ nginx log
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/GKE/56. GKEè¨˜éŒ„ nginx log/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å› å‰é™£å­è¢«äººç”¨DDOSæ”»æ“Šï¼Œ&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œå…¬å¸æœ‰ä¸€å€‹å–®ä½å°±è·‘å‡ºä¾†äº†ï¼Œèªªä»–å€‘è¦nginxçš„logï¼Œ&lt;/p&gt;
&lt;p&gt;ç™¼ç”Ÿç•¶ä¸‹æ‰èƒ½ä½œç‚ºåˆ†æç”¨é€”ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;nginx ç‰ˆæœ¬  1.21.4&lt;/p&gt;
&lt;p&gt;æ›´æ”¹nginx config ï¼Œ&lt;br /&gt;
å°‡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;       access_log  /dev/stdout   main;
        error_log /dev/stderr;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ”¾åœ¨  http åº•ä¸‹çš„ serviceå…§ã€‚&lt;/p&gt;
&lt;p&gt;é€™æ¨£å°±æœƒæŠŠlog è¨Šæ¯ï¼Œä½¿ç”¨æ¨™æº–è¼¸å‡ºçš„æ–¹å¼åˆ—å°åˆ°æ©Ÿå™¨ä¸Šã€‚&lt;br /&gt;
GKEå°±èƒ½æŠ“åˆ°è¨˜éŒ„äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œä½¿ç”¨ ECKçš„filebeat ï¼Œé è¨­æ˜¯æœƒå»æŠ“å„å€‹logçš„è³‡æ–™ã€‚&lt;br /&gt;
ä½†å‰ææ˜¯è¦æœ‰æ¨™æº–è¼¸å‡ºï¼Œæ‰€ä»¥é€™é‚Šå°±ä¸ç”¨è¨­å®šäº†ã€‚&lt;/p&gt;
&lt;p&gt;å®Œæ•´config å¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
&lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#user&quot;&gt;#user&lt;/a&gt;  nobody;
worker_processes  1;

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  &#39;$remote_addr - $remote_user [$time_local] , &#39;
                      &#39;http-host: &amp;quot;$http_host&amp;quot; , URL: &amp;quot;$request&amp;quot;  , request-status : &amp;quot;$status&amp;quot;  ,   &#39;
                      &#39;body-byte: $body_bytes_sent  ,http-referer: &amp;quot;$http_referer&amp;quot;  ,&#39;
                      &#39;user-agent: &amp;quot;$http_user_agent&amp;quot; , X-Forwarded-For : &amp;quot;$http_x_forwarded_for&amp;quot; ,  &#39;
                      &#39; request-time: &amp;quot;$request_time&amp;quot;  , response_time : &amp;quot;$upstream_response_time&amp;quot;  &#39;;




    sendfile        on;
    &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#tcp_nopush&quot;&gt;#tcp_nopush&lt;/a&gt;     on;

    keepalive_timeout  65;

    &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#gzip&quot;&gt;#gzip&lt;/a&gt;  on;
    
    server {
        listen 80;
        listen [::]:80;
        root   /app;
        listen 443 ssl;
        listen [::]:443 ssl;
        
        server_name _;

        ssl off;
        ssl_certificate /etc/nginx/nginxssl.crt;
        ssl_certificate_key /etc/nginx/nginxssl.key;

        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;

        access_log  /dev/stdout   main;
        error_log /dev/stderr;
       

        location / {
            try_files $uri /index.php$is_args$query_string;
        }
    
        location ~ &#92;.php$ {
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            include        fastcgi_params;
        }
    }

}


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/weixin_36750623/article/details/85008043&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Nginxé…ç½®ä¸­çš„log_format&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://benjr.tw/22380&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Linux â€“ Nginx log æ ¼å¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/weifeng1463/p/10277178.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;dockeré‹è¡Œnginxç‚ºä»€éº¼è¦ä½¿ç”¨ daemon off&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/22541333/have-nginx-access-log-and-error-log-log-to-stdout-and-stderr-of-master-process&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Have nginx access_log and error_log log to STDOUT and STDERR of master process&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/GKE/56. GKEè¨˜éŒ„ nginx log/" />
        </entry>
        <entry>
            <title>
                50.GKE workload Identity å¯¦åœ°æ¼”ç·´
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/GKE/50.GKE workload Identity å¯¦åœ°æ¼”ç·´/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æŸä½å¤§ç¥èªªï¼ŒGKEä½¿ç”¨ IAMçš„è§’è‰²èªè­‰å®‰å…¨æ€§ä¸å¤ªå¤ ï¼Œ&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¸Œæœ›æœªä¾†éƒ½æ”¹ç”¨é€™ç¨®ï¼Œworkload Ideneityï¼Œ&lt;/p&gt;
&lt;p&gt;å°±é–‹å§‹äº†æ¡å‘ä¹‹æ—…ï¼Œæ˜¯èªªé€™å€‹å‘æ²’æƒ³åƒä¸­çš„æ·±ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æŸ¥è©¢clusteræ˜¯å¦æœ‰ workload Identity&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud container clusters describe yaboxxx-test -z asia-east1-b
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/50-fig.1.jpg&quot; alt=&quot;50-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å»ºè­°æœ€å¥½ç›´æ¥åŠ ä¸Šåœ°å€ï¼Œä¸ç„¶çœ‹éŒ¯èª¤è¨Šæ¯ä¹Ÿæ˜¯å¯ä»¥ã€‚&lt;br /&gt;
æœƒèªªåœ¨æŸå€‹åœ°å€æ‰¾ä¸åˆ°æ­¤cluster&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹cluster ï¼Œå•Ÿç”¨ Workload Identity&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud container clusters update istio-test -z asia-east1-b &#92;Â  Â  --workload-pool=rd7-project.svc.id.goog
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¿®æ”¹ node-pool&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud container node-pools update defaultpool -z asia-east1-b &#92;Â  Â  --cluster=istio-test &#92;Â  Â  --workload-metadata=GKE_METADATA
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœæˆåŠŸçš„è©±ï¼Œæœƒçœ‹åˆ°&lt;br /&gt;
GKE ä¸­ç¹¼è³‡æ–™ä¼ºæœå™¨ ï¼š å·²å•Ÿç”¨&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/50-fig.2.jpg&quot; alt=&quot;50-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å»ºç«‹ns&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl create ns token-proxy
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å»ºç«‹kubernetes å¸³è™Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; kubectl create serviceaccount -n token-proxy proxy-user
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”³è«‹ Google service accoutçš„ IAM æœå‹™å¸³è™Ÿï¼Œ&lt;br /&gt;
ç„¶å¾Œç¶å®š kubernetes service account èˆ‡ Google service account ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud iam service-accounts add-iam-policy-binding &#92;Â  Â  --role roles/iam.workloadIdentityUser &#92;Â  Â  --member &amp;quot;serviceAccount: project.svc.id.goog[token-proxy/proxy-user]&amp;quot; &#92;Â  Â  token-proxy@rd7-project.iam.gserviceaccount.com
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/50-fig.3.jpg&quot; alt=&quot;50-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ kubernet service accountä¸Šé¢ï¼Œå¢åŠ è¨»é‡‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl annotate serviceaccount &#92;Â  Â  --namespace token-proxy proxy-user &#92;Â  Â  iam.gke.io/gcp-service-account=token-proxy@rd7-project.iam.gserviceaccount.com
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨ Workload Identity&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/GKE/50.GKE workload Identity å¯¦åœ°æ¼”ç·´/" />
        </entry>
        <entry>
            <title>
                44.srs å½±éŸ³ä¸²æµ on GKE
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/GKE/44.srs å½±éŸ³ä¸²æµ on GKE/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆä»‹ç´¹ä¸€ä¸‹srsï¼Œé€™å€‹å°±æ˜¯ä¸€å€‹å½±éŸ³ä¸²æµï¼Œ&lt;br /&gt;
æœ¬ä¾†æ˜¯ä¹–ä¹–å†ç”¨EFK on GKEï¼Œç„¶å¾Œèªªç¶²è·¯æœ‰å•é¡Œï¼Œ&lt;br /&gt;
å°±åˆè¢«æŠ“å»å”åŠ©äº†ï¼Œæƒ³è£æ­»é‚„ä¸è¡Œ T_T  ï¼Œ&lt;br /&gt;
æˆ‘çš„æ±è¥¿é‚„ä¸å¤ å¤šå—  (â•¯â€µâ–¡â€²)â•¯ï¸µâ”´â”€â”´&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;é€™æ¬¡ä¸»è¦æ˜¯å”åŠ©é™¤éŒ¯ï¼Œ&lt;br /&gt;
æ‰€ä»¥ä¸‹é¢å°±ç›´æ¥åˆ—å‡ºç¢°åˆ°çš„å•é¡Œé»ã€‚&lt;br /&gt;
ç”±æ–¼æˆ‘æ²’ç©éç›´æ’¥ï¼Œæœ‰äº›æ¦‚å¿µæ˜¯å¾Œä¾†æ‰çŸ¥é“çš„ã€‚&lt;br /&gt;
ä¹Ÿæœƒé †ä¾¿åˆ—åœ¨ä¸‹é¢ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;webrtcæ¨æµæ™‚ï¼Œå‡ºç¾ getUserMedia  error&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;éœ€è¦åˆ°chromeä¸Šé¢ä¿®æ”¹è¨­å®šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://blog.clarence.tw/wp-content/uploads/2020/10/%E6%88%AA%E5%9C%96-2020-10-29-%E4%B8%8B%E5%8D%8812.50.41-1024x653.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://blog.clarence.tw/2020/10/29/solve-the-undefined-problem-of-getusermedia/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è§£æ±º â€˜GETUSERMEDIAâ€™ OF UNDEFINED å•é¡Œ&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;rtmp æ¨æ‹‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;èµ°TCPçš„å”å®š&lt;br /&gt;
ä½¿ç”¨rtmpæ’­æ”¾çš„è©±ï¼Œæ‰€æœ‰çš„é€£ç·šéƒ½æœƒåœ¨ä¼ºæœå™¨ä¸Šé¢ç•™ä¸€ä»½ã€‚&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;webrtcæ’­æ”¾&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;éœ€è¦åˆ°srs 4.0.14ä»¥å¾Œçš„ç‰ˆæœ¬&lt;br /&gt;
æœ‰TCPè·Ÿ UDPçš„å”å®šï¼Œ&lt;br /&gt;
ä¼ºæœå™¨åªè² è²¬å° ç›´æ’¥è€…è·Ÿè§€çœ‹è€…åšé©—è­‰ï¼Œ&lt;br /&gt;
webrtcï¼Œæ˜¯ç›´æ’¥è€…è·Ÿè§€çœ‹è€…ç›´æ¥é€£ç·šï¼Œä¹Ÿå°±æ˜¯é»å°é»çš„é€£æ¥æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.yasssssblog.com/2020/09/15/ithome-30-01-webrtc/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½•è¬‚WebRTC&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;webrtcè§€çœ‹æ–¹å¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¹Ÿæ˜¯é€™ä¸€éƒ¨åˆ†çš„ç¶²è·¯æ¶æ§‹ï¼Œå°è‡´æˆ‘ä¸å¾—ä¸è·³ä¸‹å»å”åŠ©è™•ç†ã€‚&lt;br /&gt;
å› ç‚ºGKEçš„service è² è¼‰å¹³è¡¡ç›®å‰é‚„ä¸æ”¯æ´æ··åˆçš„ç¶²è·¯æ¶æ§‹ï¼Œ&lt;br /&gt;
ä¹Ÿå°±æ˜¯TCPè·Ÿ UDP æ··åˆä½¿ç”¨ã€‚åªèƒ½ä½¿ç”¨å–®ä¸€å€‹å”å®šã€‚&lt;br /&gt;
æ‰€ä»¥æ²’è¾¦æ³•åƒå‚³çµ±æ©Ÿå™¨ä¸€æ¨£ï¼Œç›´æ¥ä¸€å€‹ipï¼ŒåŒæ™‚é–‹å•ŸTCPè·ŸUDPçš„ç¶²è·¯å”å®šã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æœƒè®Šæˆ TCP ä¸€å€‹IPï¼ŒUDPåˆæ˜¯ä¸€å€‹IP(fig.1)ï¼Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/44-fig.1.jpg&quot; alt=&quot;44-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ™‚åœ¨SRSä¸Šé¢çš„ Candidate ï¼Œå¿…é ˆè¦è¨­å®š *&lt;br /&gt;
ç„¶å¾Œå†æ¨æµçš„æ™‚å€™ï¼Œæ¨æµç¶²å€è¦æ›´æ”¹æˆ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;webrtc://35.2.3.1/live/ray123?eip=35.3.3.50
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;35.2.3.1 æ˜¯ åªé–‹TCPçš„å¤–ç¶²ä½ç½®ã€‚&lt;br /&gt;
35.3.3.50 æ˜¯ åªé–‹UDPçš„å¤–ç¶²ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://github.com/ossrs/srs/wiki/v4_CN_WebRTC#config-candidate&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;v4_CN_WebRTC&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.cxymm.net/article/wltsysterm/119380486&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[SRS+docker]å¯¦ç¾ç›´æ’­æœå‹™å™¨ 3 åŸºæ–¼webRTCå”è­°çš„srsä½å»¶é²ç›´æ’­ç ”ç©¶_wltsystermçš„åšå®¢-ç¨‹åºå“¡ç§˜å¯†&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;å…¶ä»–åƒè€ƒæ–‡ä»¶&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç•¶ç„¶æœ€å¥½çš„æ–¹å¼ï¼Œæ˜¯æŠŠè£¡é¢çš„æ–‡ä»¶å¤§ç´„æƒéä¸€ä¸‹ã€‚&lt;br /&gt;
ä½†é€™è³‡æ–™æœ‰é»å¤šï¼Œæˆ‘ä¹ŸåªæŒ‘äº†å¹¾å€‹é‡é»çœ‹ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/ossrs/srs/wiki/v4_CN_K8s&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;v4_CN_K8S&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.tencent.com/developer/article/1588947&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç•¶SRSé‡åˆ°K8sï¼šå¦‚ä½•å¯¦ç¾é«˜å¯ç”¨ã€å›æ»¾èˆ‡ç°åº¦ç™¼å¸ƒï¼Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://shengyu7697.github.io/linux-nc/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨ Linux nc æ¸¬è©¦UDPæœ‰æ²’æœ‰é€š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://gitee.com/ossrs/srs/wikis/Home&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SRSå…¨æ–‡ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/ossrs/srs/blob/4.0release/trunk/conf/full.conf&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SRS full.conf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/GKE/44.srs å½±éŸ³ä¸²æµ on GKE/" />
        </entry>
        <entry>
            <title>
                41.GKEç¯€é»ç„¡æ³•è‡ªå‹•ç¸®å°
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/GKE/41.GKEç¯€é»ç„¡æ³•è‡ªå‹•ç¸®å°/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœç„¶æ±è¥¿ç©©å®šä¹‹å¾Œï¼Œä¸Šé¢çš„éƒ½æœƒæƒ³è¦costDownï¼Œ&lt;br /&gt;
ä¸éé€™ä¹Ÿç®—æ˜¯ç•¶åˆå»ºç«‹çš„äººæ²’è¨­å®šå¥½ï¼Œ&lt;br /&gt;
æœƒç™¼ç”Ÿé€™å€‹æƒ…æ³ï¼Œå¾ŒçºŒä¹ŸæŸ¥æ˜äº†ï¼Œç•¶åˆåœ¨æ¯å€‹ç¯€é»ä¸Šåªå…è¨±æ”¾64å€‹podï¼Œ&lt;br /&gt;
æ‰€ä»¥å°±ç®—æ”¾æ»¿ï¼Œä¹Ÿåƒä¸åˆ°é‚£éº¼å¤šã€‚&lt;br /&gt;
ä½†æ²’æœ‰è‡ªå‹•ç¸®å°ï¼Œé€™å…¶å¯¦ä¹Ÿæ˜¯å€‹å•é¡Œï¼Œä½†è¦è‡ªå‹•ç¸®å°ï¼Œ&lt;br /&gt;
é‚„è¦çœ‹é€™å€‹æœå‹™æ˜¯å¦åˆé©...ã€‚&lt;/p&gt;
&lt;p&gt;åæ­£æˆ‘ä¹‹å¾Œåè€Œæ²’åœ¨ç³¾çµé€™å€‹ç‹€æ³äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘ç™¼ç¾ä¸€å€‹æ±è¥¿ï¼Œåœ¨GKEä¸Šé¢çš„ç¯€é»ï¼Œcpuåˆ†é…å¾ˆå¥‡æ€ªã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/41-fig.1.jpg&quot; alt=&quot;41-fig.1.jpg&quot; /&gt;&lt;br /&gt;
(fig.1)&lt;/p&gt;
&lt;p&gt;æ¯å€‹nodeçš„ç¯€é»éƒ½åªä½”äº†ä¸€åŠçš„CPUå°±å»é–‹æ–°çš„ç¯€é»äº†ã€‚&lt;br /&gt;
æœ¬ä¾†æ‡·ç–‘æ˜¯è‡ªå‹•æ“´å±•æœ‰å•é¡Œï¼Œ&lt;br /&gt;
å¾Œä¾†ç™¼ç¾æ‡‰è©²æ˜¯è‡ªå‹•ç¸®å°æœ‰å•é¡Œã€‚&lt;/p&gt;
&lt;p&gt;é€™å€‹ç‹€æ³åœ¨æ–°å»ºä¸€å€‹å¢é›†ï¼Œç„¶å¾Œè¨­å®šç¯€é»è‡ªå‹•ä¼¸ç¸®å°±æœƒç™¼ç”Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬ä¾†èªªï¼Œç¯€é»åªè¦æ²’æœ‰podåœ¨è£¡é¢ï¼Œå¤§ç´„åªè¦ååˆ†é˜å°±æœƒæŠŠå¤šé¤˜çš„ç¯€é»ç§»é™¤äº†ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-autoscaler#how_cluster_autoscaler_works&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é›†ç¾¤è‡ªå‹•æ“´ç¸®ç¨‹åºçš„å·¥ä½œåŸç†&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ–°å»ºäº†ä¸€å€‹ç¯€é»æ± ï¼Œè£¡é¢éƒ½ç©ºçš„ã€‚ä»–ä¸¦æ²’æœ‰ç¸®å°åˆ°æœ€å°ç¯€é»ã€‚&lt;/p&gt;
&lt;p&gt;è©¢å•å¾Œå¾—çŸ¥ï¼Œé ˆå…ˆçœ‹ä¸€ä¸‹logæ‰èƒ½çŸ¥é“ç‚ºä»€éº¼æ²’æœ‰è‡ªå‹•ç¸®å°ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆé–‹å•Ÿ GCPçš„æ—¥èªŒæŸ¥çœ‹å™¨ï¼Œ&lt;br /&gt;
a. è³‡æºé¸æ“‡ Kubernetes Cluster&lt;br /&gt;
b. æ—¥èªŒé¡å‹åˆ—è¡¨é¸æ“‡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;container.googleapis.com/cluster-autoscaler-visibility
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;c. å†é¸æ“‡è¦æŸ¥çœ‹çš„cluster name&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/41-fig.2.jpg&quot; alt=&quot;41-fig.2.jpg&quot; /&gt;&lt;br /&gt;
(fig.2)&lt;/p&gt;
&lt;p&gt;d. å±•é–‹ noDecisionStatus&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/41-fig.3.jpg&quot; alt=&quot;41-fig.3.jpg&quot; /&gt;&lt;br /&gt;
(fig.3)&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°éŒ¯èª¤äº†ï¼Œå°±æ˜¯é€™å€‹å®³å¾—podç„¡æ³•è‡ªå‹•ç¸®æ¸›ã€‚&lt;br /&gt;
é€™é‚Šçš„éŒ¯èª¤è¨Šæ¯æ˜¯&lt;br /&gt;
node.pod.has.local.storageï¼Œ&lt;br /&gt;
æ–°å»ºç¯€é»ç„¡æ³•ç¸®æ¸›æœƒå‡ºç¾çš„éŒ¯èª¤è¨Šæ¯é€šå¸¸æ˜¯&lt;br /&gt;
node.kube.system.unmovable&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/41-fig.4.jpg&quot; alt=&quot;41-fig.4.jpg&quot; /&gt;&lt;br /&gt;
(fig.4)&lt;/p&gt;
&lt;p&gt;ç¢°åˆ° node.pod.has.local.storageçš„è§£æ³•æ˜¯åœ¨deployçš„yamlä¸Šé¢åŠ ä¸Šè¨»é‡‹ï¼Œä½ç½®ä½æ–¼ metadataåº•ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;annotations:
	cluster-autoscaler.kubernetes.io/safe-to-evict: &amp;quot;true&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/41-fig.5.jpg&quot; alt=&quot;41-fig.5.jpg&quot; /&gt;&lt;br /&gt;
(fig.5)&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-autoscaler-visibility#cluster-not-scalingdown&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é›†ç¾¤æœªç¸±å‘ç¸®å®¹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/63871413/how-to-make-sure-kubernetes-autoscaler-not-deleting-the-nodes-which-runs-specifi&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How to make sure Kubernetes autoscaler not deleting the nodes which runs specific pod&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è‡³æ–¼ç¢°åˆ° node.kube.system.unmovable çš„è§£æ³•ï¼Œ&lt;br /&gt;
éœ€å»ºç«‹ PDB ï¼Œè®“åœ¨ namespace çš„ kube-systemå¯ä»¥è¢«é©…é€ã€‚PDBæ˜¯ä»€éº¼å¯åƒè€ƒ  &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/42.k8s%20PDB%EF%BC%88pod%E4%B8%AD%E6%96%B7%E9%A0%90%E7%AE%97%EF%BC%89/&quot;&gt;42.k8s PDBï¼ˆpodä¸­æ–·é ç®—ï¼‰&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl create poddisruptionbudget &amp;lt;pdb name&amp;gt; --namespace=kube-system --selector app=&amp;lt;app name&amp;gt; --max-unavailable 1

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¦æ³¨æ„ï¼Œselectorçš„labelä¸ä¸€å®šæ˜¯appé–‹é ­ï¼Œ&lt;br /&gt;
è¦çœ‹å„deployè£¡é¢çš„è¨­å®šã€‚&lt;br /&gt;
æœ€è¿‘ç¢°åˆ°åœ¨GKEçš„kube-systemè£¡é¢pod labelï¼Œ&lt;br /&gt;
åè€Œæ˜¯å« k8s-app:kube-dnsï¼Œselectorå¯ä»¥éš¨æ„é¸æ“‡ï¼Œåªè¦æœ‰è¾¦æ³•å°åˆ°deployå³å¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/41-fig.6.jpg&quot; alt=&quot;41-fig.6.jpg&quot; /&gt;&lt;br /&gt;
(fig.6)&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/kubernetes/autoscaler/blob/master/cluster-autoscaler/FAQ.md#how-to-set-pdbs-to-enable-ca-to-move-kube-system-pods&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How to set PDBs to enable CA to move kube-system pods?&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½†å¾Œä¾†æœ‰ç™¼ç¾ä¸€å€‹å•é¡Œï¼Œç•¶è§£äº†ä¸€å€‹ node.kube.system.unmovable ï¼Œå¾ŒçºŒå¯èƒ½æœƒå‡ºç¾ node.pod.has.local.storageçš„å•é¡Œï¼Œ&lt;br /&gt;
é€™æ¨£æœƒè®Šæˆå¿…é ˆé‡å°æ¯å€‹deployéƒ½é¡å¤–åšè¨­å®šã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æœ€å¾Œæˆ‘é¸æ“‡äº†ï¼Œç›´æ¥æ‰‹å‹•é©…é€ç¯€é»å…§çš„podï¼Œ&lt;br /&gt;
ä½†pdbçš„è¨­å®šè¦å…ˆçœ‹ä¸€ä¸‹ï¼Œ&lt;br /&gt;
istioåœ¨å®‰è£æ™‚ï¼ŒingressgatewayæœƒåŒæ™‚è¨­å®špdbï¼Œ&lt;br /&gt;
ç•¶podåªæœ‰1å€‹çš„æ™‚å€™ï¼Œæ˜¯æ²’è¾¦æ³•é©…é€çš„ï¼Œ&lt;br /&gt;
æ‰€ä»¥æœ€å¥½æ˜¯é è¨­ingressgateway ç‚º 2å€‹podï¼Œé€™æ¨£æ‰èƒ½é¿å…pdbçš„å¹²æ“¾ï¼Œè€Œå°è‡´ç„¡æ³•é©…é€ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl drain [node-name] --force --ignore-daemonsets --delete-local-data
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;drainçš„åƒæ•¸&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--force&lt;/code&gt;&lt;br /&gt;
ç•¶ä¸€äº›podä¸æ˜¯ç¶“ ReplicationController, ReplicaSet, Job, DaemonSet æˆ–è€… StatefulSet ç®¡ç†æ™‚&lt;br /&gt;
å°±éœ€è¦ç”¨&lt;code&gt;--force&lt;/code&gt;ä¾†å¼·åˆ¶åŸ·è¡Œ (ä¾‹å¦‚:&lt;strong&gt;kube-proxy&lt;/strong&gt;)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--ignore-daemonsets&lt;/code&gt;&lt;br /&gt;
ç„¡è¦–DaemonSetç®¡ç†ä¸‹çš„Pod&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--delete-local-data&lt;/code&gt;&lt;br /&gt;
å¦‚æœæœ‰mount local volumnçš„podï¼Œæœƒå¼·åˆ¶æ®ºæ‰è©²podä¸¦æŠŠè³‡æ–™æ¸…é™¤æ‰&lt;br /&gt;
å¦å¤–å¦‚æœè·Ÿæœ¬èº«çš„é…ç½®è¨Šæ¯æœ‰è¡çªæ™‚ï¼Œdrainå°±ä¸æœƒåŸ·è¡Œ&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.nandiheath.com/2018/09/19/k8s-drain-pod-inside-node/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubernetesä¸­æ¸…ç©ºä¸€å€‹nodeçš„æ‰€æœ‰pod&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/tutorials/migrating-node-pool&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ–‡ä»¶-é·ç§»å·¥ä½œè² è¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/GKE/41.GKEç¯€é»ç„¡æ³•è‡ªå‹•ç¸®å°/" />
        </entry>
        <entry>
            <title>
                4. GKEä½¿ç”¨GPU
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/GKE/4. GKEä½¿ç”¨GPU/</id>
            <content type="html">
                &lt;h2 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;æ¥äº†ä¸€å€‹å·¥ä½œï¼Œè¦å¹«äººåœ¨GKEä¸Šé¢ç”Ÿä¸€å€‹èƒ½å¤ ä½¿ç”¨GPUçš„å¢é›†ï¼Œä¸¦ä¸”ä½ˆç½²ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h2&gt;
&lt;p&gt;è¦ä½¿ç”¨Googleä¸Šé¢çš„ GPUï¼ŒGKEç‰ˆæœ¬è¦åˆ°1.9ä»¥ä¸Šï¼Œ&lt;br /&gt;
ç¯€é»æ± è¦åˆ°1.11.3ä»¥ä¸Šã€‚&lt;br /&gt;
å¦å¤–ï¼ŒGPUåªæ”¯æ´é€šç”¨N1çš„æ©Ÿå™¨æ”¯æ´ï¼Œå…¶ä»–ç´°é … è«‹è©³é–± &lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/gpus?_ga=2.80461332.-2097975552.1599111033#availability&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Google é‹è¡Œ GPU&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯ç”¨æ€§å»ºè­°å…ˆç”¨&lt;br /&gt;
gcloud compute accelerator-types list&lt;br /&gt;
çœ‹ä¸€ä¸‹ä½ çš„å€åŸŸæ”¯æ´å“ªäº›é¡¯å¡ï¼Œ&lt;br /&gt;
åƒæˆ‘é€™é‚Šçš„æ˜¯  asia-east1-a ï¼Œå°±åªæ”¯æ´ç‰¹å®šé¡¯å¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/4.%20fig-1.jpg&quot; alt=&quot;4. fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åˆ° &lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/gpus?_ga=2.80461332.-2097975552.1599111033#installing_drivers&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®‰è£ NVIDIA GPU è¨­å‚™é©…å‹•ç¨‹åº&lt;/a&gt;ï¼Œé€™é‚ŠåŸºæœ¬ä¸Šéƒ½æ²’å•é¡Œã€‚&lt;/p&gt;
&lt;p&gt;kubectl apply -f &lt;a href=&quot;https://raw.githubusercontent.com/GoogleCloudPlatform/container-engine-accelerators/master/nvidia-driver-installer/cos/daemonset-preloaded.yaml&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://raw.githubusercontent.com/GoogleCloudPlatform/container-engine-accelerators/master/nvidia-driver-installer/cos/daemonset-preloaded.yaml&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é€™ä¸»è¦æœƒè£åœ¨æ¯å€‹ç¯€é»ä¸Šçš„Daemonsetï¼Œç•¶podèµ·ä¾†å¾Œï¼Œæœƒè‡ªå‹•åœ¨podä¸Šé¢å®‰è£é©…å‹•ç¨‹å¼ã€‚&lt;br /&gt;
æ‰€ä»¥å¿…é ˆæª¢æŸ¥ä¸€ä¸‹ï¼Œçœ‹podæ˜¯å¦æœ‰èµ·ä¾†ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/4.%20fig-2.jpg&quot; alt=&quot;4. fig-2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥åŸ·è¡Œ&lt;br /&gt;
kubectl describe node -l &lt;a href=&quot;http://cloud.google.com/gke-accelerator&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;cloud.google.com/gke-accelerator&lt;/a&gt; | grep &lt;a href=&quot;http://nvidia.com/gpu&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;nvidia.com/gpu&lt;/a&gt;&lt;br /&gt;
çœ‹é¡¯å¡çš„ä½¿ç”¨æƒ…æ³&lt;/p&gt;
&lt;p&gt;ç•¶åŸ·è¡Œä¸‹ä¸€æ­¥é©Ÿ&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/gpus?_ga=2.80461332.-2097975552.1599111033#pods_gpus&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é…ç½® Pod ä»¥ä½¿ç”¨ GPU&lt;/a&gt;æ™‚ï¼Œé€™é‚Šå°±æœƒæœ‰å•é¡Œäº†ã€‚&lt;br /&gt;
ä»–çš„image(nvidia/cuda:10.0-runtime-ubuntu18.04)æœƒç„¡æ³•å•Ÿå‹•ï¼Œä¸€ç›´åœ¨crashLoopbackoffã€‚&lt;/p&gt;
&lt;p&gt;æ›´æ–°&lt;br /&gt;
åœ¨12/24æœ‰é–‹å·¥å–®è©¢å•ï¼Œä»–å€‘é‚£é‚Šçµ¦å‡ºäº†è§£æ³•ã€‚å¾ŒçºŒæ‡‰è©²æœƒæ”¹ä»–å€‘çš„æ–‡ä»¶ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/4.%20fig-4.jpg&quot; alt=&quot;4. fig-4.jpg&quot; /&gt;&lt;br /&gt;
googleçš„å›è¦†å¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;æŒ‰ç…§æ–‡æª”ç°¡å–®ä½¿ç”¨â€œcommand: [&amp;quot;/bin/bash&amp;quot;]â€æ¸¬è©¦ã€‚æ­¤æ™‚bashåŸ·è¡Œå¾Œç«‹åˆ»é€€å‡ºï¼Œæ•…podè¢«é‡å•Ÿã€‚&lt;br /&gt;
ä½ å€‘å¯ä»¥å˜—è©¦ä½¿ç”¨ä»¥ä¸‹æ­»å¾ªç’°é¿å…é€™å€‹å•é¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;        command: [ &amp;quot;/bin/sh&amp;quot;, &amp;quot;-c&amp;quot;, &amp;quot;--&amp;quot; ]
        args: [ &amp;quot;while true; do sleep 600; done;&amp;quot; ]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œå¯ä»¥æ”¹æˆä¸‹é¢çš„YAMLï¼Œå°±èƒ½æ­£å¸¸åŸ·è¡Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;apiVersion: v1&lt;br /&gt;
kind: Pod&lt;br /&gt;
metadata:&lt;br /&gt;
name: gpu-pod&lt;br /&gt;
spec:&lt;br /&gt;
containers:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;name: digits-container&lt;br /&gt;
image: nvidia/cuda:10.0-runtime-ubuntu18.04&lt;br /&gt;
command: [ &amp;quot;/bin/sh&amp;quot;, &amp;quot;-c&amp;quot;, &amp;quot;--&amp;quot; ]&lt;br /&gt;
args: [ &amp;quot;while true; do sleep 600; done;&amp;quot; ]&lt;br /&gt;
resources:&lt;br /&gt;
limits:&lt;br /&gt;
&lt;a href=&quot;http://nvidia.com/gpu:&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;nvidia.com/gpu:&lt;/a&gt; 1&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸‹ä¹Ÿå¯ä»¥ä½¿ç”¨&lt;br /&gt;
æœ€å¾Œçš„è§£æ³•æ˜¯ï¼Œä¸è¦ç”¨ä»–çš„imageã€‚&lt;br /&gt;
å®Œæ•´ YAML&lt;/p&gt;
&lt;p&gt;apiVersion: v1&lt;br /&gt;
kind: Pod&lt;br /&gt;
metadata:&lt;br /&gt;
name: gpu-pod&lt;br /&gt;
spec:&lt;br /&gt;
containers:&lt;br /&gt;
- name: digits-container&lt;br /&gt;
image: nvidia/digits:6.0&lt;br /&gt;
resources:&lt;br /&gt;
limits:&lt;br /&gt;
&lt;a href=&quot;http://nvidia.com/gpu:&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;nvidia.com/gpu:&lt;/a&gt; 1&lt;/p&gt;
&lt;p&gt;ä½ˆç½²å®Œå¾Œï¼ŒåŸ·è¡Œ&lt;br /&gt;
kubectl exec gpu-pod  -- nvidia-smi&lt;br /&gt;
é€™æ®µè©±çš„æ„æ€æ˜¯ï¼Œåœ¨gpu-podè£¡é¢åŸ·è¡Œ nvidia-smiçš„æŒ‡ä»¤&lt;br /&gt;
æ­£å¸¸çš„è©±ï¼Œæœƒé¡¯ç¤ºå¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/4.%20fig-3.jpg&quot; alt=&quot;4. fig-3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢åƒè€ƒçš„æ–‡ä»¶ï¼Œå¯ä»¥çœ‹çœ‹ï¼Œä½†ç›®å‰åªéœ€è¦åšåˆ°ä¸Šé¢é‚£æ®µã€å®‰è£ NVIDIA GPU è¨­å‚™é©…å‹•ç¨‹åºã€çš„æŒ‡ä»¤å³å¯&lt;br /&gt;
ref.&lt;br /&gt;
&lt;a href=&quot;https://github.com/NVIDIA/k8s-device-plugin/issues/106&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;CrashLoopBackOff message wen running GPU Jobs example and others&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://gist.github.com/danisla/77afbb88f215d116f1905f723d3d879d&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GPU Sharing on GKE DaemonSet&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.hwchiu.com/gpu-gke.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Install GPU in GKE(Google Kubernetes Engine)ï¼ˆä¸­ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥è©¢å„æœ‰å“ªäº›VMä½¿ç”¨GPUçš„æŒ‡ä»¤&lt;br /&gt;
gcloud compute instances list --format=&amp;quot;table(guestAccelerators.acceleratorCount, name)&amp;quot;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/GKE/4. GKEä½¿ç”¨GPU/" />
        </entry>
        <entry>
            <title>
                39.solrCloudçš„åˆé«”é©—
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/GKE/39.solrCloudçš„åˆé«”é©—/</id>
            <content type="html">
                &lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å‚»ç“œæ“ä½œï¼Œéƒ½æ˜¯åœ¨UIä¸Šé¢åŸ·è¡Œã€‚&lt;br /&gt;
ä½†solréƒ½æ˜¯ä½¿ç”¨apiçš„æ–¹å¼åšå‹•ä½œã€‚&lt;br /&gt;
æ‰€ä»¥ä¸‹é¢çš„æ“ä½œæ”¹æˆapiæ˜¯ä¹Ÿå¯è¡Œçš„ã€‚&lt;/p&gt;
&lt;h2 id=&quot;åŸºæœ¬ç¯‡&quot; tabindex=&quot;-1&quot;&gt;åŸºæœ¬ç¯‡&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ–°å¢è³‡æ–™&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/39-fig.1.jpg&quot; alt=&quot;39-fig.1.jpg&quot; /&gt;&lt;/li&gt;
&lt;li&gt;æŸ¥è©¢è³‡æ–™&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/39-fig.2.jpg&quot; alt=&quot;39-fig.2.jpg&quot; /&gt;&lt;br /&gt;
åŸºæœ¬çš„æŸ¥è©¢æ–¹å¼ï¼Œ&lt;br /&gt;
å¦‚æœè¦æŸ¥ç­†æ•¸çš„è©±ï¼Œå°‡rows æ”¹æˆ 0 ï¼Œå°±æœƒåˆ—å‡ºæ‰€æœ‰ç­†æ•¸ã€‚&lt;br /&gt;
ä½†ä¸æœƒé¡¯ç¤ºä»»ä½•è³‡æ–™ã€‚&lt;/li&gt;
&lt;li&gt;åˆªé™¤æ‰€æœ‰è³‡æ–™&lt;br /&gt;
å¦‚æœè¦åˆªé™¤å–®ç­†ï¼Œåªè¦ä¿®æ”¹æ¢ä»¶å³å¯&lt;br /&gt;
å°‡ &lt;em&gt;:&lt;/em&gt; æ”¹æˆè¦æœå°‹çš„æ¢ä»¶ï¼Œ&lt;br /&gt;
(e.g. videoId: 28748)&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/39-fig.3.jpg&quot; alt=&quot;39-fig.3.jpg&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	&amp;lt;delete&amp;gt;&amp;lt;query&amp;gt;*:*&amp;lt;/query&amp;gt;&amp;lt;/delete&amp;gt;  
	&amp;lt;commit/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://www.itread01.com/content/1548988760.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;solråˆªé™¤è³‡æ–™çš„å››ç¨®æ–¹æ³•&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.w3cschool.cn/solr_doc&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Solrå®˜æ–¹æ–‡æª”&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;é€²éšç¯‡&quot; tabindex=&quot;-1&quot;&gt;é€²éšç¯‡&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥è©¢æŒ‡ä»¤&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/39-fig.4.jpg&quot; alt=&quot;39-fig.4.jpg&quot; /&gt;&lt;br /&gt;
ref.&lt;br /&gt;
&lt;a href=&quot;https://blog.csdn.net/wbcg111/article/details/47863261&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Solr æŸ¥è©¢åƒæ•¸&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/496373/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;solræœå°‹è©³è§£&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://www.w3cschool.cn/solr_doc/solr_doc-kcas2fx9.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SolræŸ¥è©¢ç•Œé¢&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥çœ‹collectionçš„æ¶æ§‹&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	http http://&amp;lt;host&amp;gt;:&amp;lt;port&amp;gt;/solr/&amp;lt;collectionName&amp;gt;/schema/fields
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://solr.apache.org/guide/6_6/schema-api.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Schema API&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;æœå°‹ä¸­æ–‡å­—ï¼Œæ¬„ä½çµæ§‹ text_general vs string&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸€èˆ¬æˆ‘å€‘æœå°‹ä¸­æ–‡è¦é¡å¤–å®‰è£ä¸­æ–‡åˆ†è©ï¼Œé€™æ¨£æœå°‹é—œéµå­—çš„æ™‚å€™ï¼Œæ‰æœƒæ­£ç¢ºã€‚&lt;br /&gt;
æ²’è£çš„è©±ï¼Œæœƒæœ‰ä¸‹é¢çš„æƒ…æ³ã€‚&lt;br /&gt;
ä¾‹å¦‚ï¼Œæœå°‹ ã€ä¸­æ–‡ã€ ï¼Œä½†é€™æ¨£æœƒå°‡æ¬„ä½è£¡é¢é™¤äº†æœ‰ã€ä¸­æ–‡ã€çš„è³‡æ–™æ’ˆå‡ºä¾†ä»¥å¤–ï¼Œé‚„æœƒå°‡è³‡æ–™ä¸­æœ‰ã€ä¸­ã€çš„å­—å–å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ä½†å¾Œä¾†åŒäº‹æœ‰ç™¼ç¾å¦ä¸€ç¨®è§£æ³•ï¼Œå»ºç«‹çµæ§‹çš„æ™‚å€™ï¼Œä¸èƒ½é¸æ“‡ text_generalï¼Œå¿…é ˆè¦é¸ stringã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨stringçš„è©±ï¼Œè¦æ³¨æ„çš„æ˜¯åªæ¥å—å®Œæ•´çš„æ–‡å­—æœå°‹ã€‚ä¹Ÿå°±æ˜¯ä¸€ä¸²æ–‡å­—ä¸­ï¼Œæœå°‹çš„é—œéµå­—è¦å®Œå…¨ç¬¦åˆæ‰æœƒé¡¯ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;è€Œtext_generalï¼Œå¯æ¥å—éƒ¨åˆ†çš„æ–‡å­—æœå°‹ï¼Œä½†ç¼ºé»å°±æ˜¯æœå°‹ä¸­æ–‡æ™‚ï¼Œæœƒæœ‰ä¸Šé¢çš„ç‹€æ³ã€‚&lt;/p&gt;
&lt;p&gt;çµæ§‹ä½¿ç”¨stringçš„è©±ï¼Œå¦‚æœæ”¹ä½¿ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;	*ä¸­æ–‡*
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™ç¨®æœå°‹æ–¹å¼ï¼Œå°±åªæœƒæœå°‹è³‡æ–™ä¸­æœ‰ã€ä¸­æ–‡ã€é—œéµå­—çš„è³‡æ–™ï¼Œå­—ä¸²ä¸æœƒè¢«æ‹†é–‹æŸ¥è©¢ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬ä¾†æ˜¯è¦ä½¿ç”¨&lt;a href=&quot;https://wiki.shileizcc.com/confluence/pages/viewpage.action?pageId=40567076&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä¸­æ–‡åˆ†è©&lt;/a&gt;ï¼Œä½†å¾Œä¾†ä¹Ÿä¸ç”¨äº†ã€‚&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;solrçš„å¤–æ›å¥—ä»¶&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ¬ä¾†å®˜æ–¹æ˜¯æä¾›&lt;a href=&quot;https://solr.apache.org/guide/6_6/adding-custom-plugins-in-solrcloud-mode.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;blob store APIå®‰è£å¥—ä»¶&lt;/a&gt;ï¼Œ&lt;br /&gt;
ä½†åœ¨ solrCloud 8.4 ï¼Œæœ‰å¤šå‡ºäº†ä¸€å€‹åŠŸèƒ½ package managr&lt;br /&gt;
å¯ä½¿ç”¨ç°¡å–®ä¸”å¿«é€Ÿçš„æ–¹å¼å®‰è£pluginã€‚&lt;/p&gt;
&lt;p&gt;ä½†å› ç‚ºä¸Šé¢çš„ç¬¬ä¸‰é»ï¼Œæ‰€ä»¥ä¹Ÿä¸ç”¨ç ”ç©¶é€™å¡Šäº†ã€‚&lt;br /&gt;
ç•™ä¸‹ä¸€äº›åƒè€ƒç¶²å€ï¼Œç•™ç€ä»¥å¾ŒæŸ¥è©¢ã€‚&lt;/p&gt;
&lt;p&gt;åˆæ­¥çœ‹éƒ½æ˜¯åœ¨solr å•Ÿå‹•æ™‚è¦åŠ ä¸€å€‹æŒ‡ä»¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-Denable.packages=true
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™å€‹æ‡‰è©²æ˜¯åœ¨yamlä½ˆç½²çš„æ™‚å€™ï¼Œå°±è¦åŠ ä¸Šå»äº†ã€‚&lt;br /&gt;
yamlä½ˆç½²æ™‚ï¼Œ&lt;a href=&quot;https://kubernetes.io/zh/docs/tasks/inject-data-application/define-command-argument-container/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç‚ºå®¹å™¨è¨­ç½®å•Ÿå‹•æ™‚è¦åŸ·è¡Œçš„å‘½ä»¤å’Œåƒæ•¸&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿæœ‰åœ¨çŒœæ¸¬ï¼Œæœªä¾†æ‡‰è©²æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨ solr operatorå®‰è£çš„æ™‚å€™ä¸€ä¸¦è¨­å®šï¼Œä½†ç›®å‰åƒæ•¸æ²’æœ‰çœ‹åˆ°ï¼Œçœ‹æœªä¾†æœƒä¸æœƒæ–°å¢ã€‚&lt;a href=&quot;https://artifacthub.io/packages/helm/apache-solr/solr-operator/0.3.0&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Solr Operator&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://solr.apache.org/guide/8_4/package-manager.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Package Management&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://solr.pl/en/2020/04/13/solr-8-4-0-plugin-management/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Solr 8.4.0 â€“ Plugin Management&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://sematext.com/blog/solr-plugins-system/#toc-solr-plugin-management-0&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Working with Solr Plugins System&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.w3cschool.cn/solr_doc/solr_doc-ez8q2i2v.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åœ¨SolrCloudæ¨¡å¼ä¸‹æ·»åŠ è‡ªå®šç¾©æ’ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/GKE/39.solrCloudçš„åˆé«”é©—/" />
        </entry>
        <entry>
            <title>
                37.SolrCloud on GKE
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/GKE/37.SolrCloud on GKE/</id>
            <content type="html">
                &lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h2 id=&quot;solr&quot; tabindex=&quot;-1&quot;&gt;Solrçš„æ¶æ§‹&lt;/h2&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.itread01.com/content/1550200885.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ·ºè«‡Solrå¢é›†æ¶æ§‹&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®Œæ•´æ¶æ§‹&lt;br /&gt;
&lt;img src=&quot;https://solr.apache.org/images/operator/k8s-primary-components.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
SolrCloudæ˜¯åŸºæ–¼ Solr èˆ‡ &lt;a class=&quot;internal-link is-unresolved&quot; href=&quot;https://daimom.github.io/404&quot;&gt;blog.36.åˆ†ä½ˆå¼ç³»çµ±-Zookeeper&lt;/a&gt;æœå°‹æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹è‰²åŠŸèƒ½æœ‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é›†ä¸­å¼çš„é…ç½®è³‡è¨Š&lt;/li&gt;
&lt;li&gt;è‡ªå‹•å®¹éŒ¯&lt;/li&gt;
&lt;li&gt;è¿‘å¯¦æ™‚æœå°‹&lt;/li&gt;
&lt;li&gt;æŸ¥è©¢æ™‚è‡ªå‹•è² è¼‰å¹³è¡¡&lt;/li&gt;
&lt;li&gt;è‡ªå‹•åˆ†ç™¼&lt;/li&gt;
&lt;li&gt;æ—¥èªŒè·Ÿè¹¤&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;solrCloudçš„æ¶æ§‹ï¼Œå¯ä»¥çœ‹çœ‹ä»¥ä¸‹å¹¾ç¯‡ã€‚&lt;br /&gt;
ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://solr.apache.org/operator/articles/explore-v030-gke.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Exploring the Apache Solr Operator v0.3.0 on GKE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/Hello_World_QWP/article/details/98726379&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SolrCloudåˆ†ä½ˆå¼ä¼æ¥­æœç´¢å¼•æ“æ¶æ§‹åŸç†è§£æ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.itread01.com/content/1548041589.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;solrCloudæ¶æ§‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/qq_41030039/article/details/100539704&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SolrCloudé›†ç¾¤æ¶æ§‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€™é‚Šç›´æ¥é–‹å§‹å®‰è£å§ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆç¢ºå®šä½ çš„é›»è…¦æœ‰helm ï¼Œæˆ‘è©¦è‘—æ‰¾æœ‰æ²’æœ‰å–®ç´”å¯ä»¥ç”¨ kubectl applyçš„æ–¹å¼å®‰è£ï¼Œä½†æ²’æ‰¾åˆ°ã€‚æ‰€ä»¥ï¼Œç”¨helmå§ã€‚&lt;br /&gt;
ref.&lt;a href=&quot;https://artifacthub.io/packages/helm/apache-solr/solr-operator&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;solr-operator&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆå¢åŠ solrçš„å€‰åº«&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	helm repo add apache-solr https://solr.apache.org/charts

	helm repo update	
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å®‰è£ solr-operatorï¼ŒæŒ‡å®šå®‰è£åœ¨ solrçš„ namespaceï¼Œé¿å…istioçš„istio-proxyå®‰è£é€²å»&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;
	kubectl create -f https://solr.apache.org/operator/downloads/crds/v0.3.0/all-with-dependencies.yaml

	helm install solr-operator apache-solr/solr-operator &#92;
  --version 0.3.0 --namespace solr

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;operator å®‰è£å®Œæˆ (fig.1)&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/37-fig.1.jpg&quot; alt=&quot;37-fig.1.jpg&quot; /&gt;&lt;br /&gt;
(fig.1)&lt;br /&gt;
3. solrCloud.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: solr.apache.org/v1beta1
kind: SolrCloud
metadata:
  name: video
  namespace: solr
spec:
  customSolrKubeOptions:
    podOptions:
      resources:
        limits:
          memory: 3Gi
        requests:
          cpu: 700m
          memory: 3Gi
  dataStorage:
    persistent:
      pvcTemplate:
        spec:
          resources:
            requests:
              storage: 2Gi
      reclaimPolicy: Delete
  replicas: 3
  solrImage:
    repository: solr
    tag: 8.8.2
  solrJavaMem: -Xms500M -Xmx500M
  updateStrategy:
    method: StatefulSet
  zookeeperRef:
    provided:
      chroot: /explore
      image:
        pullPolicy: IfNotPresent
        repository: pravega/zookeeper
        tag: 0.2.9
      persistence:
        reclaimPolicy: Delete
        spec:
          accessModes:
          - ReadWriteOnce
          resources:
            requests:
              storage: 2Gi
      replicas: 3
      zookeeperPodPolicy:
        resources:
          limits:
            memory: 500Mi
          requests:
            cpu: 250m
            memory: 500Mi
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;ä½ˆç½² solrCloud.yamlï¼Œé€™é‚Šçš„ç³»çµ±è³‡æºè¦æ±‚é —é«˜ï¼Œè³‡æºä¸å¤ è«‹å¤šé–‹ä¸€äº›cpu æˆ– memoryã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;	kubectl apply -f solrCloud.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;ç”±æ–¼æˆ‘æ˜¯ç›´æ¥ä½ˆç½²åœ¨istioä¸Šé¢ï¼Œæ‰€ä»¥é–‹å•Ÿç¶²é çš„è©±ï¼Œæˆ‘æ˜¯ç›´æ¥æ–°å¢ virtualServiceçš„è¨­å®šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kind: VirtualService
metadata:
  name: istio-virtualservice-tools
  namespace: tools
spec:
  hosts:
  - &amp;quot;*&amp;quot;
  gateways:
    - istio-gateway-tools.istio-system.svc.cluster.local
  http:
  - match:
        - uri:
            exact: /
        - uri:
            prefix: /solr
    name: solr
    route:
        - destination:
            host: video-solrcloud-common.solr.svc.cluster.local
            port:
              number: 80  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥ç›´æ¥åœ¨æœ¬æ©Ÿä¸Šä½¿ç”¨port-forwardè½‰ç™¼é–‹å•Ÿç¶²é ã€‚å¦‚ä»¥ä¸‹æŒ‡ä»¤ï¼Œé–‹å•Ÿ ç¶²é  &lt;a href=&quot;http://localhost:8080/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;http://localhost:8080&lt;/a&gt;   (fig.2)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;	kubectl port-forward service/video-solrcloud-common -n solr 8080:80
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/37-fig.2.jpg&quot; alt=&quot;37-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;h1 id=&quot;solr-cloud&quot; tabindex=&quot;-1&quot;&gt;ç›£æ§ solrCloud&lt;/h1&gt;
&lt;p&gt;æœ¬ä¾†çš„solrCloudèˆŠæœ‰ç°¡æ˜“çš„ç›£æ§ç•«é¢äº†ï¼Œ&lt;br /&gt;
é€™éƒ¨åˆ†æ˜¯çœ‹è¨˜æ†¶é«”çš„ä½¿ç”¨é‡ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/37-fig.3.jpg&quot; alt=&quot;37-fig.3.jpg&quot; /&gt;&lt;br /&gt;
ä½†å¯æœ‰ç™¼ç¾è³‡æ–™ä¸¦ä¸æ˜¯éå¸¸å¾—å¤šã€‚&lt;br /&gt;
ä¹‹å‰åœ¨GKEçš„å¢é›†ä¸Šå·²ç¶“æœ‰æ¶è¨­prometheusäº†ï¼Œ&lt;br /&gt;
æ‰€ä»¥é€™æ¬¡ä¹Ÿè¦å°‡è³‡æ–™ä¸Ÿé€²å»prometheusè£¡é¢ã€‚&lt;/p&gt;
&lt;p&gt;é€™é‚Šè¦å…ˆexport solrçš„metricï¼Œ&lt;br /&gt;
å®˜æ–¹ githubä¸Šé¢æœ‰å»ºè­°çš„æ–¹æ³• ï¼Œä½†éœ€å®‰è£ prometheus operatorã€‚å¦‚æœæ²’æœ‰å®‰è£ï¼Œprometheus åœ¨æ¢ç´¢metricsæ™‚ï¼Œæ˜¯æ‰¾ä¸åˆ°é€™å€‹exporterçš„ã€‚&lt;br /&gt;
ref.&lt;a href=&quot;https://apache.github.io/solr-operator/docs/solr-prometheus-exporter/#deploy-prometheus-exporter-for-solr-metrics&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Deploy Prometheus Exporter for Solr Metrics&lt;/a&gt;ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: solr.apache.org/v1beta1
kind: SolrPrometheusExporter
metadata:
 labels:
   controller-tools.k8s.io: &amp;quot;1.0&amp;quot;
 name: explore-prom-exporter
 namespace: solr
spec:
 customKubeOptions:
   podOptions:
     resources:
       requests:
         cpu: 300m
         memory: 800Mi
 solrReference:
   cloud:
     name: &amp;quot;video&amp;quot;
 numThreads: 6
 image:
   repository: solr
   tag: 8.8.2
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
 name: solr-metrics
 labels:
   release: prometheus-stack
spec:
 selector:
   matchLabels:
     solr-prometheus-exporter: explore-prom-exporter
 namespaceSelector:
   matchNames:
   - solr
 endpoints:
 - port: solr-metrics
   interval: 15s
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å› ç‚ºæˆ‘ä¸æƒ³è£ prometheus operatorï¼Œæ‰€ä»¥è¤‡è£½ä¸Šé¢å®‰è£çš„deploy yamlï¼Œè‡ªå·±ç”¢ç”Ÿä¸€å€‹solr exporter çš„deployè·Ÿ serviceçµ¦ prometheusæŠ“è³‡æ–™ã€‚&lt;/p&gt;
&lt;p&gt;æˆ–è¨±æœ‰äººæœƒå•ï¼Œç‚ºä»€éº¼ä¸åˆ©ç”¨ä¸Šé¢çš„éƒ¨å±¬å®Œå¾Œå»ä¿®æ”¹service.yamlæŠŠ&lt;br /&gt;
&lt;a href=&quot;http://prometheus.io/port:&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;prometheus.io/port:&lt;/a&gt; &amp;quot;80&amp;quot;&lt;br /&gt;
æ”¹æˆ&lt;br /&gt;
&lt;a href=&quot;http://prometheus.io/port:&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;prometheus.io/port:&lt;/a&gt; &amp;quot;8080&amp;quot;&lt;br /&gt;
å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;å› ç‚ºï¼Œæ”¹äº†å¾Œä»–æœƒä¸€ç›´é‚„åŸæˆèˆŠçš„ç‹€æ…‹ã€‚&lt;br /&gt;
é€™æ‡‰è©²æ˜¯ solrOperatorçš„é—œä¿‚ï¼Œæœƒä¸€ç›´è¦†è“‹æ‰‹å‹•ä¿®æ”¹çš„è¨­å®šï¼Œå› ç‚ºæˆ‘ä¹Ÿæ‰¾ä¸åˆ°å»ä¿®æ”¹å¢åŠ solrOperatorçš„è¨­å®šï¼Œè®“80æ”¹æˆ8080ï¼Œæ‰€ä»¥æ‡‰è©²é€éä¸Šé¢çš„  ServiceMonitor ä¾†è®“prometheuså¯ä»¥å–å¾—è³‡æ–™ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: apps/v1
kind: Deployment
metadata:
 namespace: solr
 name: explore-prom-exporter
 annotations:
   deployment.kubernetes.io/revision: &amp;quot;1&amp;quot;
 # generation: 1
 labels:
   controller-tools.k8s.io: &amp;quot;1.0&amp;quot;
   solr-prometheus-exporter: explore-prom-exporter
   technology: solr-prometheus-exporter
spec:
 progressDeadlineSeconds: 600
 replicas: 1
 revisionHistoryLimit: 10
 selector:
   matchLabels:
     solr-prometheus-exporter: explore-prom-exporter
     technology: solr-prometheus-exporter
 strategy:
   rollingUpdate:
     maxSurge: 25%
     maxUnavailable: 25%
   type: RollingUpdate
 template:
   metadata:
     creationTimestamp: null
     labels:
       controller-tools.k8s.io: &amp;quot;1.0&amp;quot;
       solr-prometheus-exporter: explore-prom-exporter
       technology: solr-prometheus-exporter
   spec:
     containers:
     - args:
       - -p
       - &amp;quot;8080&amp;quot;
       - -n
       - &amp;quot;6&amp;quot;
       - -z
       - video-solrcloud-zookeeper-0.video-solrcloud-zookeeper-headless.solr.svc.cluster.local:2181,video-solrcloud-zookeeper-1.video-solrcloud-zookeeper-headless.solr.svc.cluster.local:2181,video-solrcloud-zookeeper-2.video-solrcloud-zookeeper-headless.solr.svc.cluster.local:2181/explore
       - -f
       - /opt/solr/contrib/prometheus-exporter/conf/solr-exporter-config.xml
       command:
       - /opt/solr/contrib/prometheus-exporter/bin/solr-exporter
       image: solr:8.8.2
       imagePullPolicy: IfNotPresent
       livenessProbe:
         failureThreshold: 3
         httpGet:
           path: /metrics
           port: 8080
           scheme: HTTP
         initialDelaySeconds: 20
         periodSeconds: 10
         successThreshold: 1
         timeoutSeconds: 1
       name: solr-prometheus-exporter
       ports:
       - containerPort: 8080
         name: solr-metrics
         protocol: TCP
       resources:
         requests:
           cpu: 300m
           memory: 800Mi
       terminationMessagePath: /dev/termination-log
       terminationMessagePolicy: File
     dnsPolicy: ClusterFirst
     restartPolicy: Always
     schedulerName: default-scheduler
     securityContext:
       fsGroup: 8080
     terminationGracePeriodSeconds: 10    

--- 

apiVersion: v1
kind: Service
metadata:
 namespace: solr
 name: explore-prom-exporter
 annotations:
   prometheus.io/path: /metrics
   prometheus.io/port: &amp;quot;8080&amp;quot;
   prometheus.io/scheme: http
   prometheus.io/scrape: &amp;quot;true&amp;quot;
 creationTimestamp: &amp;quot;2021-09-03T05:52:23Z&amp;quot;
 labels:
   controller-tools.k8s.io: &amp;quot;1.0&amp;quot;
   service-type: metrics
   solr-prometheus-exporter: explore-prom-exporter
spec:
 ports:
 - name: solr-metrics
   port: 80
   protocol: TCP
   targetPort: 8080
 selector:
   solr-prometheus-exporter: explore-prom-exporter
   technology: solr-prometheus-exporter
 sessionAffinity: None
 type: ClusterIP    
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€å¾Œåˆ°prometheusçœ‹ä¸€ä¸‹æœ‰æ²’æœ‰é—œæ–¼solrçš„è³‡æ–™(fig.4)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/GKE/37-fig.4.jpg&quot; alt=&quot;37-fig.4.jpg&quot; /&gt;&lt;br /&gt;
(fig.4)&lt;/p&gt;
&lt;p&gt;æœ‰è³‡æ–™äº†ï¼Œä½†æˆ‘å€‘ä¸çŸ¥é“è¦æ‹¿å“ªäº›metricsä¾†ä½œçˆ²ç›£æ§çš„è³‡æ–™ï¼Œå°±å…ˆå»grafana dashboardæ‰¾æ‰¾å§ã€‚&lt;br /&gt;
&lt;a href=&quot;https://grafana.com/grafana/dashboards/12456&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Solr Dashboard&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹è¼‰ï¼ŒåŒ¯å…¥grafanaæ”¶å·¥ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://apache.github.io/solr-operator/docs/solr-prometheus-exporter/#deploy-prometheus-exporter-for-solr-metrics&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Solr Prometheus Exporter&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;çµå°¾&quot; tabindex=&quot;-1&quot;&gt;çµå°¾&lt;/h1&gt;
&lt;p&gt;å†ä¾†å°±æ˜¯ï¼Œå¯¦éš›æ“ä½œ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/39.solrCloud%E7%9A%84%E5%88%9D%E9%AB%94%E9%A9%97/&quot;&gt;39.solrCloudçš„åˆé«”é©—&lt;/a&gt;äº†&lt;/p&gt;
&lt;p&gt;é¡å¤–åƒè€ƒï¼Œé›–ç„¶æ­¤é€£çµå·²ç¶“ä¸é©ç”¨ï¼Œä½†åŸºæœ¬çš„å®‰è£æ–¹å¼æ˜¯å¯ä»¥åƒè€ƒã€‚&lt;br /&gt;
&lt;a href=&quot;https://cloud.tencent.com/developer/article/1580031&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Running Solr on Kubernetes&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/GKE/37.SolrCloud on GKE/" />
        </entry>
        <entry>
            <title>
                76. k8s error,The node was low on resource..
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/76. k8s error,The node was low on resource../</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¹‹å‰ç™¼ç”Ÿéçš„ï¼Œ&lt;br /&gt;
prometheusæœƒé€™æ¨£ã€gitlabæœ€è¿‘åœ¨å¼„æ–°ç‰ˆçš„CI/CDä¹Ÿè·‘é€™å€‹å‡ºä¾†ã€‚&lt;br /&gt;
æœ¬ä¾†æƒ³è¦ä¹‹å¾Œæœ‰ç©ºå†è§£æ±ºï¼Œä½†æœ€è¿‘è¢«DDOSæ”»æ“Šæ™‚ï¼Œ&lt;br /&gt;
ç™¼ç¾ç›£æ§çš„grafanaæœƒå¡ä½ï¼Œå› ç‚ºä»–çš„prometheus ramçˆ†äº†~~&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/blog.76-fig.1.jpg&quot; alt=&quot;blog.76-fig.1.jpg&quot; /&gt;&lt;br /&gt;
å¾å­—é¢ä¸Šçœ‹ä¾†ï¼Œå…¶å¯¦è »å¥½ç†è§£çš„ï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The node was low on resource: memory. Container web was using 4236080Ki, which exceeds its request of 0.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;nodeçš„è³‡æºä¸å¤ äº†ï¼Œcontainer ä½¿ç”¨é‡é”åˆ°ä¸Šé™ã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç›´è¦ºçš„æ–¹å¼å°±æ˜¯ï¼Œè³‡æºä¸å¤ ï¼Œé‚£å°±åŠ é–‹è³‡æºé˜¿ã€‚&lt;br /&gt;
ä½†é–‹è³‡æºå‰è¦å…ˆæƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘é–‹äº†ï¼Œé‚£æœªä¾†è³‡æºå°±ä¸€å®šå¤ å—ï¼Ÿ&lt;br /&gt;
é–‹çš„è³‡æºåˆä¸ä¸€å®šæ˜¯å®Œå…¨çµ¦prometheusç”¨ï¼Œä»–ä¾›æ‡‰çš„æ˜¯å…¨é«”çš„podã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¦å…ˆåšçš„æ˜¯ï¼ŒæŠŠ resources request çš„åŠ é€²å» podè£¡é¢ã€‚&lt;br /&gt;
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;template:
  metadata:
    creationTimestamp: null
    labels:
      app: webhook
      version: v1
  spec:
    containers:
    - image: prom/prometheus:v2.28.0
      imagePullPolicy: Always
      name: prometheus
      ports:
      - containerPort: 80
        protocol: TCP
      resources:
        requests:
          cpu: 30m
          memory: 30Mi
        limits:
          memory: &amp;quot;128Mi&amp;quot;
          cpu: &amp;quot;500m&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šè¦ç‰¹åˆ¥æ³¨æ„ limitï¼Œç•¶limitè¸©åˆ°ä¸Šé™æ™‚ï¼Œé€™å€‹podå°±æœƒè¢«çµ‚æ­¢&lt;br /&gt;
ï¼Œä¸¦å¼•ç™¼è¨˜æ†¶é«”ä¸è¶³(OOM)çš„éŒ¯èª¤ã€‚&lt;br /&gt;
æ‰€ä»¥ limit è¦è¨­å—ï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;p&gt;é€™é‚Šè¦å¾æ›è¼‰çš„æœå‹™å»æ±ºå®šï¼Œ&lt;br /&gt;
å¦‚æœä»Šå¤©æ›è¼‰çš„æœå‹™ ramçš„ä½¿ç”¨é‡é€šå¸¸ä¸å¤šï¼Œ&lt;br /&gt;
é‚£çªç„¶é”åˆ°ä¸Šé™ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥åˆ¤æ–·é€™å€‹æœå‹™æœ‰å•é¡Œäº†ï¼Œå¿…é ˆè¦é‡å•Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä½†å¦‚æœæ˜¯ä½¿ç”¨prometheusï¼Œè¨˜æ†¶é«”çš„é‡æœ¬ä¾†å°±æœƒéš¨ç€metricçš„é‡è€Œå¢åŠ ï¼Œ&lt;br /&gt;
é‚£å°±ä¸é©åˆåŠ ä¸Šå»äº†ï¼Œä¸ç„¶åªæœƒä¸€ç›´çœ‹åˆ° è¨˜æ†¶é«”ä¸è¶³çš„éŒ¯èª¤ã€‚&lt;/p&gt;
&lt;p&gt;å¾Œé¢çš„å–®ä½ï¼Œå¯è¨­å®š Ki, Mi ,Gi...&lt;/p&gt;
&lt;p&gt;è£œå……ï¼Œ&lt;/p&gt;
&lt;p&gt;ç•¶nodeè³‡æºä¸è¶³æ™‚ï¼Œåˆªé™¤podçš„å…ˆå¾Œé †åºç‚ºï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ²’æœ‰è¨­å®š request è·Ÿ limitçš„ pod&lt;/li&gt;
&lt;li&gt;åªè¦æœ‰podè¨­å®š request æˆ– limit ï¼Œä½†ä½¿ç”¨çš„è³‡æºæ˜¯æ¯”åœ¨è³‡æºä¸Šè¨­ç½®çš„è«‹æ±‚é‚„å¤šã€‚&lt;/li&gt;
&lt;li&gt;åªè¦æœ‰podè¨­å®š request æˆ– limit ï¼Œä½†ä½¿ç”¨çš„è³‡æºæ˜¯æ¯”åœ¨è³‡æºä¸Šè¨­ç½®çš„è«‹æ±‚é‚„å°‘ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h2&gt;
&lt;p&gt;å…ˆè¨­å®š request ï¼Œå› nodeæ©Ÿå™¨çš„æ“´å±•ï¼Œæ˜¯æ ¹æ“š requestçš„å€¼ï¼Œ&lt;br /&gt;
ä¾†åˆ¤æ–·è¦ä¸è¦å¢åŠ nodeæ•¸é‡ï¼Œå¦‚æœæ²’è¨­å®šrequestï¼Œ&lt;br /&gt;
ç³»çµ±æœƒèªçˆ²ï¼Œæ²’æœ‰æ“´å±•çš„å¿…è¦ã€‚å°±æœƒå°è‡´å‰é¢çš„å•é¡Œã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.padok.fr/en/blog/kubernetes-pods-evicted&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Why my pods are evicted on Kubernetes?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/zh/docs/concepts/scheduling-eviction/node-pressure-eviction/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç¯€é»å£“åŠ›é©…é€&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/zh/docs/concepts/configuration/manage-resources-containers/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç‚ºå®¹å™¨ç®¡ç†è³‡æº&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/kubernetes/autoscaler/blob/master/cluster-autoscaler/FAQ.md#how-does-scale-up-work&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;How does scale-up work?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/76. k8s error,The node was low on resource../" />
        </entry>
        <entry>
            <title>
                42.k8s PDBï¼ˆpodä¸­æ–·é ç®—ï¼‰
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/42.k8s PDBï¼ˆpodä¸­æ–·é ç®—ï¼‰/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;K8SçœŸæ˜¯ TXDåšå¤§ç²¾æ·±......ï¼Œ&lt;/p&gt;
&lt;p&gt;æ²’æƒ³åˆ°å†è¿½&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/41.GKE%E7%AF%80%E9%BB%9E%E7%84%A1%E6%B3%95%E8%87%AA%E5%8B%95%E7%B8%AE%E5%B0%8F/&quot;&gt;41.GKEç¯€é»ç„¡æ³•è‡ªå‹•ç¸®å°&lt;/a&gt;çš„æ™‚å€™ï¼Œæœƒåˆ°é€™é‚Šä¾†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç°¡å–®ä¾†èªªï¼Œé€™å€‹è¨­å®šæ˜¯ç”¨ä¾†é¿å…podè¢«ç„¡é è­¦çš„åˆªé™¤ã€‚&lt;br /&gt;
ç•¶ç™¼ç”Ÿè‡ªé¡˜ä¸­æ–·çš„æ™‚å€™ï¼Œè®“æ­¤podä¸æœƒå› ç‚ºpodçš„æ•¸é‡éå°‘ï¼Œ&lt;br /&gt;
è€Œå°è‡´æœå‹™ä¸­æ–·ã€‚&lt;/p&gt;
&lt;p&gt;é€™å€‹è·Ÿ HPAæœ‰é»åƒï¼Œä½†HPAæ˜¯æ ¹æ“šè¨­å®šï¼Œä¾†æ±ºå®špodè¦ä¸è¦å¢åŠ æˆ–æ¸›å°‘ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªé¡˜ä¸­æ–·é€šå¸¸æ˜¯ä¸‹é¢ä¸‰ç¨®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ’ç©ºï¼ˆdrainï¼‰ç¯€é»é€²è¡Œä¿®å¾©æˆ–å‡ç´š&lt;/li&gt;
&lt;li&gt;å¾é›†ç¾¤ä¸­æ’ç©ºç¯€é»ä»¥ç¸®å°é›†ç¾¤ï¼ˆç­è§£é›†ç¾¤è‡ªå‹•æ“´ç¸®ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¾ç¯€é»ä¸­ç§»é™¤ä¸€å€‹ Podï¼Œä»¥å…è¨±å…¶ä»– Pod ä½¿ç”¨è©²ç¯€é»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘å€‘ä¸€èˆ¬ç›´æ¥ä¸‹æŒ‡ä»¤çœ‹æœ‰å“ªäº›pdbåœ¨ç³»çµ±å…§&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get pdb -A
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/42-fig.1.jpg&quot; alt=&quot;42-fig.1.jpg&quot; /&gt;&lt;br /&gt;
(fig.1)&lt;/p&gt;
&lt;p&gt;å»ºç«‹pdbï¼Œä¸»è¦æœ‰å…©å€‹åƒæ•¸ çœ‹æ˜¯è¦è¨­å®š minAvailable (æœ€å°å¯ç”¨)æˆ– maxUnavailable(æœ€å¤§ä¸å¯ç”¨)ã€‚&lt;/p&gt;
&lt;p&gt;å»ºå®Œå¾Œï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ALLOWED DISRUPTIONS é€™å€‹æ¬„ä½ï¼Œ&lt;br /&gt;
é€™å€‹æ¬„ä½è¡¨ç¤ºç›®å‰è©²podå¯ä»¥è¢«ä¸­æ–·çš„podæ•¸é‡ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¦‚æœç‚º0çš„è©±ï¼Œæ‚¨çš„è‡ªé¡˜ä¸­æ–·é‚£äº›æ“ä½œï¼Œ&lt;br /&gt;
æ˜¯ä¸æœƒå‹•ä½œçš„ï¼Œæœƒä¸€ç›´waitingï¼Œç›´åˆ°é€™å€‹å€¼ä¸ç‚º0ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/zh/docs/concepts/workloads/pods/disruptions/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¹²æ“¾(Disruptions)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/zh/docs/tasks/run-application/configure-pdb/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç‚ºæ‡‰ç”¨ç¨‹åºè¨­ç½®å¹²æ“¾é ç®—(Disruption Budget)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/tylerzhou/p/10987576.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kubernetesä¹‹PDB&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.itread01.com/content/1559872864.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kubernetesä¹‹PDB&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/42.k8s PDBï¼ˆpodä¸­æ–·é ç®—ï¼‰/" />
        </entry>
        <entry>
            <title>
                27.K8sçš„ç¯€é»é¸æ“‡èˆ‡æ±¡æŸ“
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/27.K8sçš„ç¯€é»é¸æ“‡èˆ‡æ±¡æŸ“/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘ç¢°åˆ°çš„å•é¡Œï¼Œèµ·å› æ˜¯å–®å°çš„å°å¤–é€£ç·šæ•¸éå¤§ï¼Œå°è‡´ç¨‹å¼ç™¼ç”Ÿå•é¡Œï¼Œç„¡æ³•å†é€£ç·šåˆ°å¤–éƒ¨ç¶²è·¯ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;åœ¨ GCPç¶²è·¯å°å¤–çš„æ–¹å¼è£¡é¢æœ‰æåˆ°ï¼Œå°å¤–é€£ç·šæ™‚ï¼Œå¦‚æœæ˜¯ç§æœ‰å¢é›†æœƒä½¿ç”¨Cloud NATï¼Œ&lt;br /&gt;
æœ¬æ¬¡çš„æƒ…å½¢ï¼Œæ˜¯å› ç‚ºå†è©²ç¯€é»å…§ï¼ŒæŸä¸€å€‹deployç–‘ä¼¼å°‡é€£ç·šæ•¸åƒæ»¿ï¼Œæœ€è¿‘æƒ³é€šäº†ï¼Œæ‡‰è©²æ˜¯ç¯€é»æ•¸é‡çš„å•é¡Œã€‚&lt;/p&gt;
&lt;h2 id=&quot;node-selector&quot; tabindex=&quot;-1&quot;&gt;nodeSelector&lt;/h2&gt;
&lt;p&gt;æ‰€ä»¥è¦å°‡æŸä¸€å€‹æœå‹™ï¼Œç¨ç«‹æ›åœ¨å–®ä¸€çš„ç¯€é»æ± ä¸Šé¢ã€‚&lt;br /&gt;
æœ€ç°¡å–®çš„ç”¨æ³•æ˜¯  nodeSelectorï¼Œåœ¨ spec.template.spec çš„ä¸‹ä¸€å±¤ã€‚&lt;/p&gt;
&lt;p&gt;app : websocket  é€™å€‹æ˜¯label åœ¨å»ºç«‹nodepoolæ™‚ï¼Œä¸€ä½µå»ºç«‹çš„ã€‚&lt;br /&gt;
ä¹Ÿå¯åœ¨å»ºç«‹nodepoolå¾Œï¼Œåœ¨æ‰‹å‹•æ–°å¢labelã€‚ç•¶ç„¶ä¹Ÿå¯ä»¥ç›´æ¥æŒ‡å®šgoogleè³¦äºˆçš„labelã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/27-fig.1.jpg&quot; alt=&quot;27-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  æŸ¥è©¢label
  kubectl get nodes --show-label
  æ–°å¢label
  kubectl label node &amp;lt;node name&amp;gt; &amp;lt;label&amp;gt;=&amp;lt;value&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://tachingchen.com/tw/blog/kubernetes-assigning-pod-to-nodes/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubernetes åˆ†æ´¾ Pod åˆ°æŒ‡å®šç¯€é»&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;deployçš„ç¯„ä¾‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: apps/v1
kind: Deployment
metadata:
  name: deployabc
spec:
  replicas: 10
  template:
    spec:
      .......
      nodeSelector:
        app: websocket
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/node-pools#deploy&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å°‡ Pod éƒ¨ç½²åˆ°ç‰¹å®šç¯€é»æ± &lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://kubernetes.io/zh/docs/concepts/scheduling-eviction/assign-pod-node/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å°‡ Pod åˆ†é…çµ¦ç¯€é»&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;ç¯€é»æ±¡é»&quot; tabindex=&quot;-1&quot;&gt;ç¯€é»æ±¡é»&lt;/h2&gt;
&lt;p&gt;å‰›ä¸Šé¢æœ‰æåˆ°ï¼Œdeployå¯ä»¥æŒ‡å®špodåˆ°ç‰¹å®šçš„ç¯€é»ï¼Œä½†æ˜¯ç•¶å‰é¢çš„ç¯€é»æ»¿äº†å¾Œï¼Œå…¶ä»–çš„deployé‚„æ˜¯æœ‰å¯èƒ½æœƒåˆ°ç‰¹å®šçš„ç¯€é»ä¸Šã€‚&lt;br /&gt;
k8så¯ä»¥è¨­å®šç¯€é»ç‚º æ±¡é»(Taint)ï¼Œä½¿æ­¤æ±¡æŸ“çš„ç¯€é»ï¼Œåªèƒ½æ¥å—æœ‰å®¹å¿åº¦çš„podã€‚&lt;/p&gt;
&lt;p&gt;æ±¡é»çš„è¨­å®šä¸èƒ½äº‹å¾Œæ›´æ–°ï¼Œæ‰€ä»¥è¦åœ¨ä¸€é–‹å§‹å»ºç«‹æ™‚å°±è¨­å®šå¥½ã€‚è«‹æ³¨æ„(fig.2)çš„Taintã€‚&lt;br /&gt;
å¦å¤–å»ºè­°çµ±ä¸€ç”±GKEçš„ç¯€é»æ±¡é»ï¼Œå¾æ§åˆ¶å°å»ºç«‹æˆ–ä½¿ç”¨æŒ‡ä»¤å»ºç«‹ã€‚&lt;br /&gt;
å¦å‰‡ç•¶nodeè‡ªå‹•æ–°å¢æ™‚ï¼Œè©²ç¯€é»ä¸¦ä¸æœƒç”¢ç”Ÿ Taits&lt;br /&gt;
è¨­å®šæ™‚ï¼Œè¦æŒ‡å®š key èˆ‡ value ä»¥åŠ æ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/27-fig.2.jpg&quot; alt=&quot;27-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ•ˆæœæœ‰ä»¥ä¸‹ä¸‰ç¨®ï¼š&lt;/p&gt;
&lt;p&gt;- NoScheduleï¼šä¸èƒ½å®¹å¿æ­¤æ±¡é»çš„ Pod ä¸æœƒè¢«èª¿åº¦åˆ°ç¯€é»ä¸Šï¼›ç¾æœ‰ Pod ä¸æœƒå¾ç¯€é»ä¸­é€å‡ºã€‚&lt;br /&gt;
- PreferNoScheduleï¼šKubernetes æœƒé¿å…å°‡ä¸èƒ½å®¹å¿æ­¤æ±¡é»çš„ Pod å®‰æ’åˆ°ç¯€é»ä¸Šã€‚&lt;br /&gt;
- NoExecuteï¼šå¦‚æœ Pod å·²åœ¨ç¯€é»ä¸Šé‹è¡Œï¼Œå‰‡æœƒå°‡è©² Pod å¾ç¯€é»ä¸­é€å‡ºï¼›å¦‚æœå°šæœªåœ¨ç¯€é»ä¸Šé‹è¡Œï¼Œå‰‡ä¸æœƒå°‡å…¶å®‰æ’åˆ°ç¯€é»ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/node-taints?hl=zh-cn#gcloud_1&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç”¨ç¯€é»æ±¡é»æ§åˆ¶èª¿åº¦&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹å¾Œåœ¨deployä¸Šé¢å»ºç«‹å®¹å¿(toleration)æ±¡é»ï¼Œ åœ¨ spec.template.spec çš„ä¸‹ä¸€å±¤&lt;br /&gt;
å…¶ä¸­ key èˆ‡ value ç‚ºè‡ªè¨‚ï¼Œæ•ˆæœè«‹åƒè€ƒä¸Šé¢é¸æ“‡ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: apps/v1
kind: pod
metadata:
  name: deployabc
spec:
  replicas: 10
  template:
    spec:
		container:
	      .......
		tolerations:
		- key: &amp;quot;visible&amp;quot;
		  operator: &amp;quot;Equal&amp;quot;
		  value: &amp;quot;private&amp;quot;
		  effect: &amp;quot;NoExecute&amp;quot;
		  tolerationSeconds: 3600
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è£œå……ï¼Œå¦‚æœæ˜¯èˆŠçš„ç¯€é»é›†å€ï¼Œåœ¨GKEä¸Šé¢ï¼Œå¯ä»¥æ”¹ä½¿ç”¨é€™å€‹labelå»é¸æ“‡ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cloud.google.com/gke-nodepool: &amp;lt;ç¯€é»æ± çš„åç¨±&amp;gt;   
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;toleration-seconds&quot; tabindex=&quot;-1&quot;&gt;tolerationSecondsä¸è¦äº‚è¨­&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç•¶è¨­å®šäº†ä»¥å¾Œï¼Œæ­¤podå°±ç®—ç¬¦åˆæ¢ä»¶ï¼Œä¹Ÿæœƒåœ¨ç‰¹å®šæ™‚é–“å…§è¢«é©…é€å¾Œé‡å»ºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨GKEçš„ç‰ˆæœ¬ &lt;code&gt;1.30.5-gke.1443001&lt;/code&gt; ï¼Œé‡å°äº†æŸå€‹deployå¢åŠ æ­¤è¨­å®šï¼Œ&lt;br /&gt;
ç„¶å¾Œä»–æœƒæ¯å€‹å°æ™‚ç æ‰podï¼Œé‡å»ºä¸€æ¬¡ï¼Œä½†é‚„æœƒåœ¨ç›¸åŒçš„nodeä¸Šé¢ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;br /&gt;
&lt;a href=&quot;https://kubernetes.io/zh/docs/concepts/scheduling-eviction/taint-and-toleration/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ±¡é»å’Œå®¹å¿åº¦&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10221929&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;k8sé€²éšç¯‡ï¼ˆå››ï¼‰ï¼šAffinity and Anti-Affinityã€Taints and Tolerations&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/27.K8sçš„ç¯€é»é¸æ“‡èˆ‡æ±¡æŸ“/" />
        </entry>
        <entry>
            <title>
                254. StatefulSetå‘¼å«podçš„æ–¹æ³•
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/254. StatefulSetå‘¼å«podçš„æ–¹æ³•/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;å»¶çºŒä¸Šç¯‡ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/252.%20k8s%E4%B8%AD%E7%9A%84pod%E5%91%BC%E5%8F%AB/&quot;&gt;252. k8sä¸­çš„podå‘¼å«&lt;/a&gt; ï¼Œé‚£ç¯‡æ–‡ç« ä¸­ï¼Œ&lt;br /&gt;
è¦ç›´æ¥å»call statefulSetçš„podï¼Œ&lt;br /&gt;
é€éipåæŸ¥ï¼Œæ‰¾åˆ°DNSï¼Œ&lt;br /&gt;
ä½†å¦‚æœIPåæŸ¥ä¹Ÿæ‰¾ä¸åˆ°DNSå‘¢ï¼Ÿ&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;åœ¨å»ºç«‹srsæœå‹™æ™‚ï¼Œ&lt;br /&gt;
æ ¹æ“šä¹‹å‰çš„æ¸¬è©¦æ–¹å¼ï¼Œæä¾›RD æºé€šçš„ç¶²å€ï¼Œ&lt;br /&gt;
ä½†ä¸Šç·šæ™‚ï¼Œä¸€æŸ¥ é€™å€‹ç¶²å€æ²’æœ‰æŒ‡å®šï¼Œ&lt;br /&gt;
IPä¹Ÿæ²’æœ‰å°æ‡‰çš„FQDNã€‚&lt;/p&gt;
&lt;p&gt;æ–¼æ˜¯ï¼Œæ‰ç™¼ç¾æ˜¯sts(StatefulSetçš„ç¸®å¯«ï¼‰çš„è¨­å®šå•é¡Œã€‚&lt;br /&gt;
å¦‚æœè¦ç›´æ¥è·Ÿstsçš„podé€£ç·šæ™‚ï¼Œéœ€è¦ä½¿ç”¨&lt;a href=&quot;https://kubernetes.io/zh-cn/docs/concepts/services-networking/service/#headless-services&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;headless service&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç„¡é ­ Service ä¸ä½¿ç”¨è™›æ“¬ IP åœ°å€å’Œä»£ç†Â çµ„æ…‹è·¯ç”±å’Œå°åŒ…è½‰ç™¼ï¼›ç›¸åï¼Œç„¡é ­ Service é€šéå…§éƒ¨ DNS è¨˜éŒ„å ±å‘Šå„å€‹ Pod çš„ç«¯é» IP åœ°å€ï¼Œé€™äº› DNS è¨˜éŒ„æ˜¯ç”±å¢é›†çš„Â DNS æœå‹™æ‰€æä¾›çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¦ä½¿ç”¨Headless serviceçš„è©±ï¼Œå‰‡éœ€è¨­å®š &lt;code&gt;clusterIP: none&lt;/code&gt;&lt;br /&gt;
ä½† stsæŒ‡å®šçš„service nameè¦æŒ‡å®šæ˜¯æœ‰è¨­å®š Headless serviceçš„serviceã€‚&lt;/p&gt;
&lt;p&gt;sts.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: srs-edge
  namespace: srs-qa
spec:
  replicas: 2
  serviceName: srs-edge
  selector:
    matchLabels:
      app: srs-edge

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;service.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
kind: Service
metadata:
  name: srs-edge
  namespace: srs-qa
spec:
  clusterIP: None
  selector:
    app: srs-edge
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æ¨£å°±èƒ½å¤ ä½¿ç”¨ &lt;code&gt;&amp;lt;podName&amp;gt;.&amp;lt;serviceName&amp;gt;.&amp;lt;nameSpace&amp;gt;.svc.cluster.local&lt;/code&gt; å»å‘¼å«podäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸æ”¾å¿ƒï¼Œå¯ä»¥åƒè€ƒä¸Šä¸€ç¯‡&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/252.%20k8s%E4%B8%AD%E7%9A%84pod%E5%91%BC%E5%8F%AB/&quot;&gt;252. k8sä¸­çš„podå‘¼å«&lt;/a&gt;ç”¨nslookupé©—è­‰FQDN&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://kubernetes.io/zh-cn/docs/concepts/workloads/controllers/statefulset/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;StatefulSet&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/254. StatefulSetå‘¼å«podçš„æ–¹æ³•/" />
        </entry>
        <entry>
            <title>
                196. httpå¥åº·åº¦åµæ¸¬
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/196. httpå¥åº·åº¦åµæ¸¬/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘ç¢°åˆ°ä¸€å€‹æ€ªå•é¡Œï¼Œpodæ´»å¾—å¥½å¥½çš„ï¼Œä½†è£é¢çš„æœå‹™å°±æ›äº†ã€‚&lt;br /&gt;
å› ç‚ºæˆ‘é‚„èƒ½é€£é€²å»podè£é¢ï¼Œè£ä¸€å †æ±è¥¿ï¼Œä½†æœå‹™å°±çœŸçš„æ²’è¾¦æ³•äº†ã€‚&lt;br /&gt;
åªå¥½ï¼Œè·Ÿé–‹ç™¼æºé€šï¼Œä¸ç„¶å°±å¼„å€‹å¥åº·åº¦åµæ¸¬å§ï¼Œ&lt;br /&gt;
ä½†è¦æ³¨æ„ï¼Œä¸€å®šè¦éå¸¸ç¢ºå®šé€™å€‹æœå‹™éš¨æ™‚é‡å•“æ²’é—œä¿‚ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;livenessProbe:
  httpGet:
    path: /Info/LivenessCheck
    port: 80
    scheme: HTTP
  initialDelaySeconds: 120
  timeoutSeconds: 1
  periodSeconds: 5
  successThreshold: 1
  failureThreshold: 2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç•¶http å›æ‡‰çš„ç‹€æ…‹ç¢¼æ˜¯ 200~400 çš„è©±ï¼Œé»˜èªç‚ºæ­£å¸¸ã€‚&lt;br /&gt;
ä¸æ˜¯é€™å€‹ä»¥å¤–çš„ï¼Œå°±èªçˆ²å¤±æ•—ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„åƒæ•¸&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;initialDelaySeconds: podå•“å‹•å¾Œå¹¾ç§’æ‰é–‹å§‹åŸ·è¡Œ&lt;/li&gt;
&lt;li&gt;timeoutSeconds: timeoutæ™‚é–“&lt;/li&gt;
&lt;li&gt;periodSeconds: é–“éš”å¹¾ç§’å‘¼å«ä¸€æ¬¡&lt;/li&gt;
&lt;li&gt;successThreshold: åœ¨æª¢æŸ¥å¤±æ•—å¾Œ, æ¥ä¸‹ä¾†è¦å¤šå°‘æ¬¡é€£çºŒåˆ¤å®šæˆåŠŸæ‰ç®—æˆåŠŸ&lt;/li&gt;
&lt;li&gt;failureThreshold: å¤±æ•—æ¬¡æ•¸&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/learn-or-die/kubernetes-%E5%81%A5%E5%BA%B7%E6%AA%A2%E6%9F%A5-59ee2a798115&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubernetes â€” å¥åº·æª¢æŸ¥&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;çµ„æ…‹å­˜æ´»ã€å°±ç·’å’Œå•Ÿå‹•æ¢é‡&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/196. httpå¥åº·åº¦åµæ¸¬/" />
        </entry>
        <entry>
            <title>
                194. pod debugæ–¹å¼
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/194. pod debugæ–¹å¼/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;é€™é™£å­å»ºäº†ä¸€å€‹æ–°ç’°å¢ƒï¼Œ&lt;br /&gt;
ç„¶å¾Œpodåœ¨ç¬¬ä¸€æ¬¡å•“å‹•æ™‚ï¼Œéƒ½æœƒé‡å•“ï¼Œ&lt;br /&gt;
ä½†ä¸€æ—¦é‡å•“å°±çœ‹ä¸åˆ°ä¹‹å‰çš„logã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;log&quot; tabindex=&quot;-1&quot;&gt;çœ‹ä¸Šä¸€æ¬¡çš„logè¨˜éŒ„&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;kubectl logs {PODNAME} --previous
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…¶ä»–ç”¨æ³•&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Return snapshot logs from pod nginx with only one container
kubectl logs nginx

# Return snapshot of previous terminated ruby container logs from pod web-1
kubectl logs -p -c ruby web-1

# Begin streaming the logs of the ruby container in pod web-1
kubectl logs -f -c ruby web-1

# Display only the most recent 20 lines of output in pod nginx
kubectl logs --tail=20 nginx

# Show all logs from pod nginx written in the last hour
kubectl logs --since=1h nginx
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref .&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/@tasslin/k8s%E5%A6%82%E4%BD%95%E6%96%B9%E4%BE%BF%E6%9F%A5%E6%89%BE%E4%BA%8B%E4%BB%B6%E7%99%BC%E7%94%9F%E6%88%96%E6%98%AF%E5%8F%96%E5%BE%97%E5%B7%B2%E6%B6%88%E9%80%9D%E7%9A%84log%E7%B4%80%E9%8C%84-8bb7ee2505f8&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;K8så¦‚ä½•æ–¹ä¾¿å°‹æ‰¾äº‹ä»¶ç™¼ç”Ÿæˆ–æ˜¯å–å¾—å·²æ¶ˆé€çš„LOGç´€éŒ„&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://jamesdefabia.github.io/docs/user-guide/kubectl/kubectl_logs/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kubectl logs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;pod&quot; tabindex=&quot;-1&quot;&gt;é€£é€²å»podè£é¢ç›£æ§&lt;/h3&gt;
&lt;p&gt;æœ‰æ™‚æœƒç¢°åˆ°é€™å€‹podæ²’æœ‰æ¬Šé™å¯ä»¥å®‰è£htopæˆ– topç­‰ç­‰ï¼Œ&lt;br /&gt;
é€™äº›çœ‹ç³»çµ±æ•ˆèƒ½çš„æ±è¥¿ï¼Œ&lt;br /&gt;
æ­¤æ™‚å¯ä»¥é€éé€™ç¨®æ–¹å¼ï¼Œç›´æ¥å¤–æ›ä¸€å€‹debugçš„imageï¼Œ&lt;br /&gt;
å°±èƒ½éš¨ä¾¿ä½ äº‚æäº†ï¼Œé‚„ä¸æ€•æœƒå½±éŸ¿åˆ°æ­£åœ¨åŸ·è¡Œçš„podã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æŒ‡ä»¤çš„æ„æ€æ˜¯ï¼Œé€£å» filebeatçš„podã€‚&lt;br /&gt;
å¦‚æœè¦æŒ‡å®šcontainerçš„è©±ï¼Œå¢åŠ  &lt;code&gt;--target=filebeat&lt;/code&gt;çš„æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    kubectl debug -it &#92;
    --container=debug-container &#92;
    --image=alpine &#92;
    filebeat-beat-filebeat-bcb666b79-vm6dt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://medium.com/datamindedbe/debugging-running-pods-on-kubernetes-2ba160c47ef5&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Debugging Running Pods on Kubernetes&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/194. pod debugæ–¹å¼/" />
        </entry>
        <entry>
            <title>
                192. è‡ªå»ºçš„k8sæ‹‰å–private registry
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/192. è‡ªå»ºçš„k8sæ‹‰å–private registry/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;é–‹ç™¼ç’°å¢ƒä¸Šï¼Œä¹‹å‰æ‹‰å¾—éƒ½æ˜¯å¦ä¸€å€‹å°ˆæ¡ˆçš„registryï¼Œ&lt;br /&gt;
ç¾åœ¨æœ‰å€‹å…¨æ–°çš„å°ˆæ¡ˆï¼Œç†æ‰€ç•¶ç„¶imageæ‡‰è©²æ‹‰å»å¦ä¸€å€‹åœ°æ–¹çš„GARã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆåˆ°IAMè£é¢ï¼Œç”³è«‹ä¸€å€‹ServiceAccountï¼Œ&lt;br /&gt;
ç„¶å¾Œçµ¦æ¬Šé™ï¼Œå¯ä»¥åªçµ¦ &lt;code&gt;Artifact Registryè®€å–è€…&lt;/code&gt;å°±å¥½ã€‚&lt;br /&gt;
ç„¶å¾Œç”¢ç”Ÿé‡‘é‘°ï¼Œåç¨±ç‚º&lt;code&gt;gar-push-bms.json&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/192-fig.1.jpg&quot; alt=&quot;192-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å»ºç«‹screctï¼Œåç¨±å–åçˆ²&lt;code&gt;gar-pull&lt;/code&gt;&lt;br /&gt;
stackoverflowçš„èªªæ˜æŒ‡å‡ºï¼Œè©²emailæ˜¯æ²’åœ¨ç”¨çš„ï¼Œæ‰€ä»¥å¯ä»¥éš¨ä¾¿æ‰“ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl create secret docker-registry gar-pull &#92;
  --docker-server &amp;quot;https://asia-east1-docker.pkg.dev&amp;quot; &#92;
  --docker-username _json_key &#92;
  --docker-email gar-pull@.iam.gserviceaccount.com &#92;
  --docker-password=&amp;quot;$(cat gar-push-bms.json)&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;deploymentçš„yamlè¨­å®š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;  imagePullSecrets:
  - name: gar-pull
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¨˜å¾—ï¼Œå¦‚æœåœ¨ä¸åŒçš„namespaceï¼Œéœ€é‡æ–°å»ºç«‹æ–°çš„secretã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/36283660/creating-image-pull-secret-for-google-container-registry-that-doesnt-expire&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Creating image pull secret for google container registry that doesn&#39;t expire?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/artifact-registry/docs/docker/authentication?hl=zh-cn#linux-macos&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç‚º Docker è¨­å®šèº«ä»½é©—è­‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/192. è‡ªå»ºçš„k8sæ‹‰å–private registry/" />
        </entry>
        <entry>
            <title>
                190. cert-managerå®‰è£
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/190. cert-managerå®‰è£/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¸Šæ¬¡é–‹æ–°å°ˆæ¡ˆçš„å»¶ä¼¸ï¼Œ&lt;br /&gt;
è¨­å®šdomainæ™‚ï¼Œå°æ–¼cloudflareä¸å¤ ç†Ÿï¼Œ&lt;br /&gt;
é‚„å¥½æœ‰å€‹å‰ç«¯åŒäº‹ï¼Œç†Ÿæ­¤é–€è·¯ï¼Œå› çˆ²ä»–ä¹Ÿè¸©éã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h2 id=&quot;cert-manager&quot; tabindex=&quot;-1&quot;&gt;å®‰è£cert-manager&lt;/h2&gt;
&lt;p&gt;åƒç…§&lt;a href=&quot;https://cert-manager.io/docs/installation/kubectl/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®˜ç¶²&lt;/a&gt;èªªæ˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢èªæ³•ä¸ä¸€å®šæ˜¯æœ€æ–°çš„&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.3/cert-manager.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ä¾†å°±æ˜¯å»ºç«‹  &lt;code&gt;ClusterIssuer&lt;/code&gt; è·Ÿ &lt;code&gt;Certificate&lt;/code&gt;&lt;br /&gt;
åœ¨æ­¤ä¹‹å‰ï¼Œè¦å…ˆåˆ°cloudflareç”¢ç”Ÿä¸€çµ„tokenï¼Œ&lt;br /&gt;
æ‰æœ‰æ¬Šé™å°é€™å€‹domainåšé©—è­‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘çš„domainæ˜¯åœ¨cloud domainè³¼è²·ï¼Œç„¶å¾Œå†cloudflareè¨—ç®¡ã€‚&lt;br /&gt;
ç‚ºä»€éº¼ä¸ç›´æ¥åœ¨google cloudè¨—ç®¡ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œä¹‹å‰å°±é€™æ¨£äº†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;User Profile &amp;gt; API Tokens &amp;gt; API Tokens&lt;/strong&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/190-fig.1.jpg&quot; alt=&quot;190-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/190-fig.2.jpg&quot; alt=&quot;190-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åƒç…§å®˜æ–¹æ–‡ä»¶ï¼Œè¨­å®šæ¬Šé™ï¼Œå–å¾—token&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/190-fig.3.jpg&quot; alt=&quot;190-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å°‡tokenå­˜åˆ° secret&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: v1
kind: Secret
metadata:
  name: cloudflare-api-token-ezio-com
  namespace: cert-manager
type: Opaque
stringData:
  api-token: &amp;lt;token&amp;gt;
---
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: cloudflare-issuer-ezio-com
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    privateKeySecretRef:
      name: cloudflare-issuer-ezio-com
    solvers:
    - dns01:
        cloudflare:
          email: ezio@abc.com
          apiTokenSecretRef:
            name: cloudflare-api-token-ezio-com
            key: api-token
---
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: ezio-com-tls
  namespace: istio-system
spec:
  secretName: ezio-com-tls
  issuerRef:
    name: cloudflare-issuer-ezio-com
    kind: ClusterIssuer
  commonName: &amp;quot;*.ezio.com&amp;quot;
  dnsNames:
    - &amp;quot;*.ezio.com&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™é‚Šæ³¨æ„ä¸€ä¸‹ï¼Œæª”æ¡ˆä¹‹é–“çš„é—œè¯æ€§ã€‚&lt;br /&gt;
ä¸Šé¢å¯«çš„ç¯„ä¾‹domainæ˜¯ &lt;code&gt;*.ezio.com&lt;/code&gt; ï¼Œè«‹æ”¹çˆ²è‡ªå·±å¯¦éš›ä½¿ç”¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;éƒ¨ç½²ä¸Šå»å¾Œï¼Œæª¢æŸ¥ç‹€æ…‹ï¼Œæœ‰æ²’æœ‰Readyï¼Œé€šå¸¸ä¸æœƒè¶…é5åˆ†é˜ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get certificate -A
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/190-fig.4.jpg&quot; alt=&quot;190-fig.4.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœå•“å‹•å¤±æ•—çš„è©±ï¼Œä½¿ç”¨ä¸‹é¢æŒ‡ä»¤æª¢æŸ¥log&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl describe certificate ezio-com-tls
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœæ˜¯ä¸‹é¢é€™å€‹å¤±æ•—è¨Šæ¯ï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Found no Zones for domain _acme-challenge.aplusmanagex.com. (neither in the sub-domain nor in the SLD) please make sure your domain-entries in the config are correct and the API key is correctly setup with Zone.read rights.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¡¨ç¤ºä½ çš„tokenæ²’æœ‰ç›¸é—œæ¬Šé™ï¼Œé€™å€‹å‘æˆ‘è¸©å®Œäº†orzã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://cert-manager.io/docs/configuration/acme/dns01/cloudflare/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Cloudflare&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cert-manager.io/docs/installation/kubectl/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kubectl apply&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/190. cert-managerå®‰è£/" />
        </entry>
        <entry>
            <title>
                172. è‡ªå»ºk8sç‰ˆæœ¬å‡ç´š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/172. è‡ªå»ºk8sç‰ˆæœ¬å‡ç´š/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å”¸&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å”¸&lt;/h1&gt;
&lt;p&gt;æœ‰äººèªªä»–è¦æ¸¬è©¦&lt;a href=&quot;https://airensoft.com/ome.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;OME(OverMediaEngine)&lt;/a&gt;ï¼Œä¸²æµç›´æ’­è»Ÿé«”ï¼Œèªªæ¯”&lt;a href=&quot;https://github.com/ossrs/srs&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SRS&lt;/a&gt;å¥½ä¸€äº›ï¼Œä½†è‡ªå»ºçš„k8sç‰ˆæœ¬ä¸å¤ ï¼Œä¸èƒ½ä¸Šgateway APIï¼Œæ‰€ä»¥å‡ç´šå§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æ›´æ–°å‰è«‹å…ˆç¢ºèªç‰ˆæœ¬æ›´æ–°å¾Œï¼Œä½ çš„æœå‹™ä¸æœƒæ›æ‰ã€‚&lt;br /&gt;
æ›´æ–°å¤§ç‰ˆæœ¬æ™‚ï¼Œæœƒæœ‰APIæ£„ç”¨çš„ç‹€æ³ï¼Œ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/162.%E6%9F%A5%E8%A9%A2%E5%B7%B2%E6%A3%84%E7%94%A8%E7%9A%84API/&quot;&gt;162.æŸ¥è©¢å·²æ£„ç”¨çš„API&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;ç›®æ¨™&quot; tabindex=&quot;-1&quot;&gt;ç›®æ¨™&lt;/h2&gt;
&lt;p&gt;æ›´æ–°k8sçš„masterä¸€è‡ºèˆ‡nodeå…©è‡ºçš„ç‰ˆæœ¬&lt;/p&gt;
&lt;h2 id=&quot;æ­¥é©Ÿ&quot; tabindex=&quot;-1&quot;&gt;æ­¥é©Ÿ&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æŸ¥è©¢ç›®å‰çš„ç‰ˆæœ¬&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;kuberctl version
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆé€™æ˜¯ç›®å‰ç‰ˆæœ¬ï¼Œå‡ç´šç•¶æ™‚çš„ç‰ˆæœ¬ç‚º1.22.?)&lt;br /&gt;
serverçš„ç‰ˆæœ¬ç‚º1.25.14&lt;/p&gt;
&lt;blockquote Major:1,=&quot;&quot; Minor:25,=&quot;&quot; GitVersion:v1.25.14,=&quot;&quot; GitCommit:a5967a3c4d0f33469b7e7798c9ee548f71455222,=&quot;&quot; GitTreeState:clean,=&quot;&quot; BuildDate:2023-09-13T09:04:55Z,=&quot;&quot; GoVersion:go1.20.8,=&quot;&quot; Compiler:gc,=&quot;&quot; Platform:linuxamd64=&quot;&quot;&gt;
&lt;p&gt;Server Version:  &lt;a href=&quot;http://version.info/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;version.Info&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å‡ç´škubeadm&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„kubeadmçš„ç‰ˆæœ¬
yum list --showduplicates kubeadm --disableexcludes=kubernetes
# ç„¶å¾Œå‡ç´škubeadmçš„ç‰ˆæœ¬åˆ°1.23.0
yum install -y kubeadm-1.23.0-0 --disableexcludes=kubernetes
# æŸ¥çœ‹kubeadmç‰ˆæœ¬
kubeadm version
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;å‡ç´šmasteræ§åˆ¶&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;kubeadm upgrade plan
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/172-fig.1.jpg&quot; alt=&quot;172-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€™é‚Šç¢°åˆ°ä¸€å€‹å•é¡Œï¼Œæˆ‘æœ¬ä¾†åªæƒ³å‡ç´šåˆ°1.23.0ï¼Œ&lt;br /&gt;
ä½†ä¸Šé¢é€™å¼µåœ–ï¼Œä»–è¦æ±‚ç›´æ¥åˆ°1.23.17ï¼Œ&lt;br /&gt;
ä¸ç…§åšè¡Œä¸è¡Œï¼Œã€ä¸è¡Œã€ï¼Œå‡ç´šæœƒå‡ºéŒ¯ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å›åˆ°ç¬¬äºŒæ­¥ï¼Œå†åº¦æ›´æ–°kubeadmåˆ°1.23.17&lt;/p&gt;
&lt;p&gt;å†ä¾†ä¸€æ¬¡&lt;code&gt;kubeam upgrade plan&lt;/code&gt;&lt;br /&gt;
é€™æ¬¡æ²’å‡ºç¾è­¦å‘Šäº†&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/172-fig.2.jpg&quot; alt=&quot;172-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åŸ·è¡Œä¸Šé¢åŸ·è¡Œå®Œ&lt;code&gt;upgrade plan&lt;/code&gt;æä¾›å‡ç´šæŒ‡ä»¤&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;kubeadm upgrade apply v1.23.17 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®Œæˆå¾Œæœƒçœ‹åˆ°&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;SUCCESS! Your cluster was upgraded to &amp;quot;v1.23.17&amp;quot;. Enjoy!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/172-fig.3.jpg&quot; alt=&quot;172-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;å‡ç´škubectl èˆ‡ kubelet&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æŸ¥çœ‹ç›®å‰ç¯€é»ç‰ˆæœ¬&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;kubectl get node -o wide
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é©…é€ç•¶ä¸‹ç¯€é»çš„podï¼ˆé€™æ®µèˆ‡åƒè€ƒä¾†æºçš„æŒ‡ä»¤ä¸ä¸€æ¨£ï¼Œé€™å€‹æ¯”è¼ƒæš´åŠ›ï¼‰&lt;br /&gt;
$masterç‚ºç¯€é»çš„åç¨±&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;kubectl drain --force --ignore-daemonsets --delete-local-data --grace-period=10 &amp;quot;$master&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç­‰é©…é€å®Œå¾Œï¼Œç¢ºèªnodeç‚º&lt;code&gt;SchedulingDisabled&lt;/code&gt;ç‹€æ…‹ï¼Œå°±å¯å·²é–‹å§‹å‡ç´šäº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;yum install -y kubelet-1.23.17-0 kubectl-1.23.17-0 --disableexcludes=kubernetes
# é‡å•“æœå‹™
sudo systemctl daemon-reload
sudo systemctl restart kubelet

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŸ¥è©¢nodeç‰ˆæœ¬æ˜¯å¦å·²ç¶“æ›´æ–°ï¼Œç„¶å¾Œè§£é™¤å°é–ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;kubectl uncordon $node
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;å‡ç´šnodeçš„ç‰ˆæœ¬&lt;br /&gt;
é‡è¤‡ç¬¬å››æ­¥é©Ÿï¼Œåªæœ‰æ›´æ–°é‚£ä¸€æ®µ&lt;code&gt;yum install....&lt;/code&gt;éœ€è¦åˆ°ç›®æ¨™çš„nodeæ©Ÿå™¨ä¸Šåšã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰€ä»¥æŒ‡ä»¤å¦‚ä¸‹&lt;br /&gt;
$nodeç‚ºè¦æ›´æ–°çš„nodeä¸»æ©Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;# masterä¸»æ©Ÿ
kubectl drain --force --ignore-daemonsets --delete-local-data --grace-period=10 &amp;quot;$node&amp;quot;
# nodeä¸»æ©Ÿ
yum install -y kubelet-1.23.17-0 kubectl-1.23.17-0 --disableexcludes=kubernetes
# é‡å•“æœå‹™
sudo systemctl daemon-reload
sudo systemctl restart kubelet
# masterä¸»æ©Ÿ
kubectl uncordon $node
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://tinychen.com/20221224-k8s-12-kubeadm-upgrade-cluster/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;k8sç³»åˆ—12-kubeadmå‡ç´šk8så¢é›†Â &lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Upgrading kubeadm clusters&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/172. è‡ªå»ºk8sç‰ˆæœ¬å‡ç´š/" />
        </entry>
        <entry>
            <title>
                162.æŸ¥è©¢å·²æ£„ç”¨çš„API
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/162.æŸ¥è©¢å·²æ£„ç”¨çš„API/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;é€™ä»¶äº‹èªªä¾†çªç„¶ï¼Œ&lt;br /&gt;
æŸä¸€å¤©æˆ‘å°±ç™¼ç¾åœ¨GKEä¸Šé¢å‡ºç¾äº†è­¦å‘Šè¨Šæ¯ï¼Œ&lt;br /&gt;
èªªæˆ‘çš„GKEä»åœ¨ä½¿ç”¨å·²æ£„ç”¨çš„APIï¼Œ&lt;br /&gt;
ä½†æˆ‘æ¬åˆ°1.25ç‰ˆæœ¬å·²ç¶“æ˜¯ä¸€å€‹å¤šæœˆå‰çš„äº‹æƒ…äº†ï¼Œ&lt;br /&gt;
ä¹Ÿæ²’è½åˆ°æœ‰äººåœ¨èªªæœå‹™æ›æ‰ï¼Œ&lt;br /&gt;
ç™¾æ€ä¸å¾—å…¶è§£ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/162-fig.1.jpg&quot; alt=&quot;162-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å†ä¾†ä½¿ç”¨äº† &lt;a href=&quot;https://github.com/doitintl/kube-no-trouble&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kubent&lt;/a&gt; ï¼Œä¾†å°‹æ‰¾åˆ°åº•æ˜¯å“ªä¸€å€‹æœå‹™å¡ä½ï¼Œ&lt;br /&gt;
ä½†å¾ˆéºæ†¾çš„éƒ½æ²’æœ‰æœå°‹åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;éäº†å¹¾å¤©å¾Œï¼Œç™¼ç¾ä¹‹å‰æ‹¿ä¾†æ¸¬è©¦çš„QAç’°å¢ƒï¼Œ&lt;br /&gt;
ä¹Ÿè·³å‡ºä¾†äº†å·²æ£„ç”¨APIè­¦å‘Šé€šçŸ¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/162-fig.2.jpg&quot; alt=&quot;162-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç™¼ç¾GKEå°±æœ‰æç¤ºæ˜¯ä»€éº¼å‘¼å«çš„äº†ï¼Œ&lt;br /&gt;
åœ¨QAç’°å¢ƒå¾ˆæ¸…æ¥šçš„å¯«ç€kubentï¼Œ&lt;br /&gt;
ä½†æœ¬ä¾†çš„é‚£å€‹å‘¢ï¼Ÿ&lt;br /&gt;
åªæœ‰ v2.1.0 ï¼Œ&lt;br /&gt;
æ–¼æ˜¯æ ¹æ“šé€™å€‹é—œéµå­—å»æ‰¾å“ªå€‹imageæœ‰é€™å€‹ç‰ˆæœ¬è™Ÿã€‚&lt;/p&gt;
&lt;p&gt;åœ¨kube-state-metricä¸Šé¢æ‰¾åˆ°äº†é€™å€‹é—œéµå­—ï¼Œ&lt;br /&gt;
é€™ä¹Ÿç¬¦åˆç‚ºä»€éº¼å‡ºéŒ¯äº†æ²’äººçŸ¥é“ï¼Œ&lt;br /&gt;
å› çˆ²æ²’äººçœ‹ï¼ˆï¼Ÿï¼‰&lt;br /&gt;
ä½†å› çˆ²metricä¾†æºæœ‰è‡³å°‘ä¸‰å¥—ï¼Œæ‰€ä»¥ä¸å¥½ç™¼ç¾ã€‚&lt;br /&gt;
ä¸éé€™å€‹å‰ä»»å»ºç½®çš„ä¹Ÿæœ‰é»å¥‡æ€ªï¼Œ&lt;br /&gt;
æˆ‘æŸ¥äº†å®˜æ–¹çš„&lt;a href=&quot;https://github.com/kubernetes/kube-state-metrics&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kube-state-metrics&lt;/a&gt;ï¼Œ&lt;br /&gt;
æ²’æ‰¾åˆ°æœ‰ç”¨stså»ºç«‹éçš„æ–¹å¼ï¼Œ&lt;br /&gt;
æœ‰é»ç¥å¥‡ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/162-fig.3.jpg&quot; alt=&quot;162-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å…ˆæ‹¿QAä¾†é©—è­‰æ”¹æ”¹çœ‹äº†ï¼Œ&lt;br /&gt;
çœ‹å¾ŒçºŒæœƒä¸æœƒå†è·³å‡ºä¾†è­¦å‘Š&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/162.æŸ¥è©¢å·²æ£„ç”¨çš„API/" />
        </entry>
        <entry>
            <title>
                151. kubeadmé‡æ–°ç”¢ç”Ÿé©—è­‰
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/151. kubeadmé‡æ–°ç”¢ç”Ÿé©—è­‰/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;äº‹æƒ…ç™¼ç”Ÿåœ¨æŸä¸€å¤©ï¼Œ&lt;br /&gt;
çªç„¶æœ‰å€‹äººè·‘ä¾†è·Ÿæˆ‘èªªï¼Œä»–è©²æ€éº¼é€£æ¨“ä¸Šè‡ªå»ºçš„k8sï¼Œ&lt;br /&gt;
é‚£æ™‚åœ¨è™•ç†å…¶ä»–æ±è¥¿ï¼Œå°±èªªæˆ‘ç­‰ç­‰çµ¦ä½ ã€‚&lt;br /&gt;
å†ä¾†ï¼Œçªç„¶ç™¼ç¾æˆ‘è‡ªå·±é€£ä¸ä¸Šå»ï¼Œä¸€ç›´è·³éŒ¯èª¤ã€‚&lt;br /&gt;
unable to connect to server: x509: certificate has expired or is not yet valid&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨openLené€£ç·šæ™‚ï¼Œå‡ºç¾éŒ¯èª¤ã€‚ç•¶ä¸‹èªçˆ²æ‡‰è©²æ˜¯é‡‘é‘°æœ‰å•é¡Œï¼Œ&lt;br /&gt;
ä½†é‚£è‡ºæ©Ÿå™¨æ‡‰è©²å¾ˆä¹…æ²’å‹•äº†ï¼Œç•¶åˆk8sä¹Ÿä¸æ˜¯æˆ‘æ¶èµ·ä¾†çš„ï¼Œ&lt;br /&gt;
é ­ç—›é˜¿ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;proxy_server.go:147 Error while proxying request: x509: certificate has expired or is not yet valid&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¾é€™ç¯‡&lt;a href=&quot;https://blog.51cto.com/u_13963804/6055113&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;K8Sè‡ªå»ºå¢é›†æ›´æ›è­‰æ›¸&lt;/a&gt;çŸ¥é“äº†ä¸€ä»¶äº‹æƒ…&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šékubeadmè‡ªå»ºçš„å¢é›†ï¼Œåˆå§‹åŒ–å¾Œæœƒç”Ÿæˆä¸€å¹´çš„è­‰æ›¸ï¼Œç°½ç™¼çš„CAè­‰æ›¸æœ‰æ•ˆæœŸé»˜èªæ˜¯10å¹´ï¼Œç°½ç™¼çš„apiserverè­‰æ›¸æœ‰æ•ˆæœŸé»˜èªæ˜¯1å¹´&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å†å•ä¸€ä¸‹å…¶ä»–å–®ä½çš„åŒäº‹ï¼Œé‚£å€‹ç’°å¢ƒæ˜¯ä¸æ˜¯å·²ç¶“æ¶ä¸€å¹´äº†ï¼Ÿ&lt;br /&gt;
çµæœå‡ºä¾†ï¼Œå·®ä¸å¤šä¸€å¹´äº†ï¼Œé‚£å¯ä»¥åˆ¤æ–·æ˜¯é‡‘é‘°éæœŸï¼Œä½†é‚„æ˜¯å¿…é ˆåˆ°æ©Ÿå™¨è£é¢æª¢æŸ¥ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨sshæˆ–ä»»æ„æ–¹å¼é€£åˆ°masterä¸»æ©Ÿä¸Šï¼Œ&lt;br /&gt;
è¦–æ¬Šé™è®Šæ›´ä½¿ç”¨è€…ï¼Œ&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;&lt;strong&gt;æˆ‘åœ¨åŸ·è¡Œkubeadmçš„æ™‚å€™ï¼Œå…¨ç¨‹ä½¿ç”¨rootçš„å¸³è™Ÿ&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;æª¢æŸ¥æ†‘è­‰åˆ°æœŸæ—¥&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;kubeadm certs check-expiration
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç™¼ç¾çœŸçš„éæœŸäº†ï¼Œé‡å»ºå§ã€‚&lt;br /&gt;
åƒè€ƒä¸‹é¢é€£çµç™¼ç¾æœ‰é»å•é¡Œï¼Œå¯èƒ½æ˜¯å› ç‚ºç‰ˆæœ¬æœ‰æ›´æ–°ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://juejin.cn/post/7068909995701567501&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è§£æ±ºkubernetesè­‰æ›¸éæœŸå•é¡Œ&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;kubeadm certs renew # é€™æ¨£æœ‰å•é¡Œï¼Œæœƒç™¼ç”ŸéŒ¯èª¤
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;kubeadm missing subcommand; &amp;quot;renew&amp;quot; is not meant to be run on its own&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æŸ¥è©¢&lt;a href=&quot;https://kubernetes.io/zh-cn/docs/reference/setup-tools/kubeadm/kubeadm-certs/#cmd-certs-renew&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®˜æ–¹æ–‡ä»¶&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;kubeadm certs renew all
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŸ·è¡Œå®Œæˆå¾Œï¼Œåœ¨æª¢æŸ¥ä¸€æ¬¡åˆ°æœŸæ—¥ï¼Œæ˜¯å¦å·²ç¶“è®Šæ›´ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;kubeadm certs check-expiration
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†æ­¤æ™‚é‚„æ˜¯æ²’è¾¦æ³•é€£ç·šï¼Œéœ€æ›´æ–°kube configï¼Œ&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;&lt;strong&gt;é€™é‚Šä½¿ç”¨ä¸€èˆ¬ä½¿ç”¨è€…å¸³è™Ÿ&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mv config config.old 
cp -i /etc/kubernetes/admin.conf $HOME/.kube/config 
chown $(id -u):$(id -g) $HOME/.kube/config 
sudo chmod 644 $HOME/.kube/config
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;p.s ä¸Šé¢çš„æ–‡ç« èªªè¦é‡å•Ÿkube-apiserver,kube-controller,kube-scheduler,etcd é€™å››å€‹å®¹å™¨ï¼Œä½†æˆ‘æ²’é‡å•“ï¼Œå› ç‚ºæˆ‘é€™å°masterä¸»æ©Ÿæ ¹æœ¬æ²’æ‰¾åˆ°dockerï¼Œé€™éƒ¨åˆ†æˆ‘ä¹Ÿå¾ˆç–‘æƒ‘ã€‚&lt;br /&gt;
ä½†ä¸€åˆ‡éƒ½æ­£å¸¸äº†ï¼Œå°±å…ˆé€™æ¨£å§ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;çµå°¾&quot; tabindex=&quot;-1&quot;&gt;çµå°¾&lt;/h3&gt;
&lt;p&gt;å¦‚æœè¦å¾å…¶ä»–åœ°æ–¹é€£åˆ°k8s masterï¼Œæª”æ¡ˆå°±åœ¨&lt;code&gt;/etc/kubernetes/admin.conf&lt;/code&gt;è£é¢äº†ã€‚&lt;br /&gt;
ä¸éå®˜æ–¹å¼·çƒˆå»ºè­°ï¼Œä¸è¦å°‡admin.confèˆ‡å…¶ä»–äººå…±äº«ã€‚&lt;br /&gt;
æœ€å¥½æ˜¯å¦å¤–é–‹ä¸€å€‹ä½¿ç”¨è€…ï¼Œ&lt;br /&gt;
é€™éƒ¨åˆ†æˆ‘ç ”ç©¶ä¸‹ï¼Œæ”¹å¤©åœ¨å¯«ç¯‡æ–‡ç« äº†å§&lt;/p&gt;
&lt;p&gt;ç›¸é—œè³‡è¨Šï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/kubeadm/kubeadm-certs/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨ kubeadm é€²è¡Œæ†‘è­‰ç®¡ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/zh-cn/docs/setup/best-practices/certificates/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; PKI è­‰æ›¸å’Œè¦æ±‚&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/151. kubeadmé‡æ–°ç”¢ç”Ÿé©—è­‰/" />
        </entry>
        <entry>
            <title>
                144. k8s çš„sercretè¤‡è£½
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/144. k8s çš„sercretè¤‡è£½/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;æœ¬åœ°çš„k8sæ©Ÿå™¨ï¼Œè¦å»google artifact registry pull image ï¼Œç™¼ç¾æ²’æ¬Šé™ã€‚&lt;br /&gt;
ä»¥å‰çš„æ¬Šé™åœ¨namespaceçš„ defaultä¸Šé¢ï¼Œ&lt;br /&gt;
defaultå¤ªè‚¥äº†ï¼Œå¯¦åœ¨ä¸æƒ³å†å¾€é‚£é‚Šå¡ï¼Œ&lt;br /&gt;
è¦éº»è‡ªå·±å‰µå€‹SAå†æŠŠjsonä¸Ÿå»é©—è­‰ï¼Œ&lt;br /&gt;
ä¸ç„¶çœ‹èƒ½ä¸èƒ½æŠŠèˆŠçš„æ‹¿ä¾†ç”¨ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;è¤‡è£½&quot; tabindex=&quot;-1&quot;&gt;è¤‡è£½&lt;/h3&gt;
&lt;p&gt;åƒè€ƒ  &lt;a href=&quot;https://fabianlee.org/2021/04/09/kubernetes-copying-a-secret-from-one-namespace-to-another/&quot; title=&quot;Kubernetes: copying a secret from one namespace to another&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubernetes: copying a secret from one namespace to another&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get secret my-tlssecret --namespace=default -o yaml | sed &#39;s/namespace: .*/namespace: gameservice/&#39; | kubectl apply -f -
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ¬ä¾†my-tlssecret åœ¨ defaulä¸Š ï¼Œè¦æ”¹åˆ°gamerservice&lt;/p&gt;
&lt;p&gt;é€™æ¨£å°±ä¸ç”¨å†ç”³è«‹ä¸€å€‹saå¸³è™Ÿæèªè­‰äº†ï¼Œ&lt;br /&gt;
å¦‚æœè¦å¾é ­é–‹å§‹çš„è©±ï¼Œ&lt;br /&gt;
åƒè€ƒgoogleå®˜æ–¹æ–‡ä»¶&lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/artifact-registry/docs/docker/authentication?hl=zh-cn#linux_1&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç‚º Docker è¨­å®šèº«ä»½é©—è­‰&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;è§£å¯†&quot; tabindex=&quot;-1&quot;&gt;è§£å¯†&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;kubectl get secret test-grafana -n monitoring -o jsonpath=&#39;{.data.admin-user}&#39; |base64 --decode; echo
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/144. k8s çš„sercretè¤‡è£½/" />
        </entry>
        <entry>
            <title>
                143. k8så–å¾—ç™»å…¥æ†‘è­‰
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/143. k8så–å¾—ç™»å…¥æ†‘è­‰/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;å¹«åŒäº‹æ–°å»ºä¸€çµ„drone è‡ªå‹•éƒ¨ç½²çš„æ–°å°ˆæ¡ˆï¼Œ&lt;br /&gt;
è¦ç™¼ç‰ˆåˆ°è‡ªå»ºçš„k8sä¸Šé¢ï¼Œ&lt;br /&gt;
çµ‚æ–¼ç¢°åˆ°æˆ‘ä¸æƒ³é¢å°çš„æ±è¥¿äº†ã€‚&lt;br /&gt;
kube_ca ï¼Œkube_token  ï¼Œæˆ‘å“ªçŸ¥é“é€™å…©å€‹æ±è¥¿åœ¨å“ªè£é˜¿&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å¾ &lt;a href=&quot;https://github.com/vallard/drone-kube/blob/master/DOCS.md&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Drone Kubernetes&lt;/a&gt;å¯ä»¥çŸ¥é“ï¼Œä¸€å€‹æ˜¯ä½¿ç”¨è€…ï¼Œä¸€å€‹æ˜¯caèªè­‰çš„keyï¼Œ&lt;br /&gt;
ä½†æˆ‘é‚„ä¸çŸ¥é“å»å“ªç”Ÿé€™å…©å€‹æ±è¥¿å‡ºä¾†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;KUBE_TOKEN&lt;/strong&gt;Â This plugin has one authentication method and that is to use the token to authorize the user.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;KUBE_CA&lt;/strong&gt;Â This should be the base64 encoding of your certificate authority. You can get this string by running the command:&lt;/p&gt;
&lt;p&gt;è·‘å»å•äº†ä¸€ä¸‹chatGPTï¼Œå¾—åˆ°ç­”æ¡ˆã€‚&lt;br /&gt;
åŸ·è¡ŒæŒ‡ä»¤å‰ï¼Œå¿…é ˆå…ˆé€£åˆ°ä½ è¦å–å¾—çš„clusterä¸Šã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep cluster-admin | awk &#39;{print $1}&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘çš„åˆ—å‡ºæœ‰å¾ˆå¤šå€‹ï¼Œå°±æ‹¿ç¬¬ä¸€å€‹çœ‹èµ·ä¾†ä¹Ÿæœ€åƒçš„ä¾†ç”¨äº†ã€‚&lt;br /&gt;
admin-user-token-tm7g4&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/143-fig.1.jpg&quot; alt=&quot;143-fig.1.jpg&quot; /&gt;&lt;br /&gt;
é€™é‚Šå°±æœƒçœ‹åˆ°tokenã€‚&lt;/p&gt;
&lt;p&gt;å†ä¾†æ˜¯ca&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl config view --raw --minify --flatten -o jsonpath=&#39;{.clusters[].cluster.certificate-authority-data}&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/143-fig.2.jpg&quot; alt=&quot;143-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ”¾åˆ°droneä¸Šé¢ï¼Œé©—è­‰ï¼Œæ”¶å·¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/143-fig.3.jpg&quot; alt=&quot;143-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/authentication/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨è€…èªè­‰&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/143. k8så–å¾—ç™»å…¥æ†‘è­‰/" />
        </entry>
        <entry>
            <title>
                139. openlens add pod shell or logs button
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/139. openlens add pod shell or logs button/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;lenåœ¨6.Xç‰ˆæœ¬å¾Œï¼Œè¦ç™»å…¥æ‰èƒ½ç”¨ã€‚&lt;br /&gt;
é‚£å€‹æ™‚å€™ä¹Ÿæ­£å¥½è·³å»openlensï¼Œåœ¨é‚£ä¹‹å‰éƒ½å¯ä»¥å¾podå³ä¸Šè§’çš„æŒ‰éˆ•ï¼Œ&lt;br /&gt;
å¿«é€Ÿé€²å…¥åˆ°podè£é¢ï¼Œæˆ–æ˜¯æŸ¥pod logï¼Œä½†åœ¨6.2.4ä¹‹å¾Œå°±æ¶ˆå¤±äº†ã€‚&lt;br /&gt;
ç›´åˆ°ç¾åœ¨6.4.10(å¯«é€™ç¯‡æ™‚çš„ç‰ˆæœ¬)ï¼Œé‚„æ˜¯æ²’æœ‰ã€‚&lt;br /&gt;
æœ€å¾Œå¾—çŸ¥æ˜¯å› ç‚ºLensæ‰æŠŠé‚£æ®µç§»æ‰ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;å®‰è£æ–¹å¼&quot; tabindex=&quot;-1&quot;&gt;å®‰è£æ–¹å¼&lt;/h3&gt;
&lt;p&gt;åˆ° Extensions  ç›´æ¥è²¼ä¸Šä¸‹é¢çš„ä¾†æº&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@alebcay/openlens-node-pod-menu
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/139-fig.2.jpg&quot; alt=&quot;139-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;ä¾†æº&quot; tabindex=&quot;-1&quot;&gt;ä¾†æº&lt;/h3&gt;
&lt;p&gt;ä¸»è¦æ˜¯æ¡†èµ·ä¾†çš„åŠŸèƒ½ï¼Œ&lt;br /&gt;
å°æ–¼æ¯”è¼ƒä¸ç†Ÿæ‚‰çš„kubectlæŒ‡ä»¤çš„äººä¾†èªªï¼Œéå¸¸å¯¦ç”¨ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/139-fig.1.jpg&quot; alt=&quot;139-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç•¶åˆæ²’æœ‰çš„æ™‚å€™ï¼Œåè€Œæ˜¯æˆ‘åŒäº‹ç„¡æ³•æ¥å—ã€‚&lt;br /&gt;
è‡³å°‘æˆ‘é‚„èƒ½ç”¨æŒ‡ä»¤çš„æ–¹å¼æŸ¥æˆ‘è¦çš„æ±è¥¿ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl exec -it pod_name bash
kubectl logs pod_name 
...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»Šå¤©å¿ƒè¡€ä¾†æ½®æŸ¥æŸ¥çœ‹æœ‰æ²’æœ‰ç›¸é—œå•é¡Œï¼Œæ˜¯bugé‚„æ˜¯å·²ç§»é™¤ã€‚&lt;br /&gt;
æ‰çŸ¥é“äº†ï¼ŒåŸä¾†æ˜¯LensæŠŠå®ƒå¾openLensç§»é™¤ï¼Œ&lt;br /&gt;
è©³ç´°å¯åƒè€ƒä¸‹é¢é€£çµ&lt;br /&gt;
&lt;a href=&quot;https://github.com/lensapp/lens/issues/6819&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://github.com/lensapp/lens/issues/6819&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://github.com/lensapp/lens/issues/6823&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;OpenLens 6.3.0 - No Logs or Shell buttons&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹å¾Œå†è©¦è©¦å…¶ä»–çš„ &lt;a href=&quot;https://github.com/devtron-labs/devtron&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; devtron&lt;/a&gt; æˆ– &lt;a href=&quot;https://github.com/kubeshop/monokle&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Monokle&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/139. openlens add pod shell or logs button/" />
        </entry>
        <entry>
            <title>
                137. kubecolor ç›´è§€çš„kubectl
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/137. kubecolor ç›´è§€çš„kubectl/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;å‰›å¥½çœ‹åˆ°æœ‰äººçš„æ–‡ç« èªª kubecolorç¾ç¾çš„kubectlå°±ä¾†è©¦ç”¨äº†XD&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;mac  or linux å®‰è£&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;brew install hidetatz/tap/kubecolor
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç›´æ¥ä½¿ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;kubecolor get pod 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/137-fig.1.jpg&quot; alt=&quot;137-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä½†æˆ‘å¹³å¸¸æ‰“kubectlæ‰“ç¿’æ…£äº†ï¼Œçªç„¶è¦æ”¹ç”¨é‚£å€‹è¦ºå¾—å¥½éº»ç…©ï¼Œ&lt;br /&gt;
æ”¹åˆ¥åå§&lt;/p&gt;
&lt;p&gt;æ–°å¢åˆ¥å&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;alias kubectl=&amp;quot;kubecolor&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç§»é™¤åˆ¥å&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;unalias kubectl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†é€™å€‹åªæœ‰æš«æ™‚ï¼Œè¦æ°¸ä¹…çš„è©±ï¼Œéœ€è¦åˆ°.bash_profileè¨­å®š&lt;br /&gt;
mac æ˜¯åœ¨ å€‹äººç›®éŒ„åº•ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;vim ~/.bash_profile
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ²’æœ‰çš„è©±ï¼Œå°±æ–°å»ºæª”æ¡ˆï¼Œç„¶å¾Œè¼¸å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alias kubectl=&amp;quot;kubecolor&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;p.s mac çš„ç’°å¢ƒè®Šæ•¸è¼‰å…¥é †åºç‚º&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;/etc/profile -&amp;gt;  /etc/paths -&amp;gt;  ~/.bash_profile -&amp;gt;  ~/.bash_login -&amp;gt;  ~/.profile -&amp;gt;  ~/.bashrc&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ref&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/hidetatz/kubecolor&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kubecolor&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.796t.com/p/1133106.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;mac çµ„æ…‹ç’°å¢ƒè®Šæ•¸ï¼Œè¬›çš„å¤ªä»”ç´°äº†ï¼Œéå¸¸æ£’&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/137. kubecolor ç›´è§€çš„kubectl/" />
        </entry>
        <entry>
            <title>
                123.Helm ä½¿ç”¨æ–¹å¼
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/123.Helm ä½¿ç”¨æ–¹å¼/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¡ç¡å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¡ç¡å¿µ&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘è¦ç”¨coturnï¼Œçœ‹åˆ°æœ‰äººç”¨helm æ¶åœ¨k8sä¸Šé¢ï¼Œå°±é †ä¾¿ä¾†è©¦è©¦äº†ã€‚&lt;br /&gt;
ä¹‹å‰å‰›é–‹å§‹æ¥è§¸k8sï¼Œç¢°åˆ°helmä¸€å †éŒ¯èª¤ï¼Œç„¡æ³•åŸ·è¡Œã€‚&lt;br /&gt;
ç¾åœ¨æƒ³æ‡‰è©²æ˜¯è£é¢æœ‰äº›è¨­å®šè¦ä¿®æ”¹çš„é—œä¿‚ï¼Œ&lt;br /&gt;
ç¾åœ¨æ‡‰è©²æœƒæ¯”è¼ƒå¥½äº†å§ï¼ï¼Ÿ&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h2 id=&quot;æ¶æ§‹&quot; tabindex=&quot;-1&quot;&gt;æ¶æ§‹&lt;/h2&gt;
&lt;p&gt;helmçš„æ¶æ§‹ï¼Œå¯å…ˆç”¢ç”Ÿä¸€å€‹ç¯„ä¾‹æª”ï¼Œ&lt;br /&gt;
çœ‹æœ‰å“ªäº›æ±è¥¿ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;helm create ezio
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨Helmè£é¢ï¼Œå°‡kubernetesçš„æ‡‰ç”¨ç¨‹å¼ç¨±ç‚ºChart&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;tree ezio

ezio
â”œâ”€â”€ Chart.yaml
â”œâ”€â”€ charts
â”œâ”€â”€ templates
â”‚Â Â  â”œâ”€â”€ NOTES.txt
â”‚Â Â  â”œâ”€â”€ _helpers.tpl
â”‚Â Â  â”œâ”€â”€ deployment.yaml
â”‚Â Â  â”œâ”€â”€ hpa.yaml
â”‚Â Â  â”œâ”€â”€ ingress.yaml
â”‚Â Â  â”œâ”€â”€ service.yaml
â”‚Â Â  â”œâ”€â”€ serviceaccount.yaml
â”‚Â Â  â””â”€â”€ tests
â”‚Â Â      â””â”€â”€ test-connection.yaml
â””â”€â”€ values.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Chart.yaml ï¼šåŒ…å«äº†chartçš„å…§å®¹æè¿°&lt;/li&gt;
&lt;li&gt;charts(folder) ï¼šæ­¤ç›®éŒ„å¯èƒ½åŒ…å«äº†å…¶ä»–ä¸åŒçš„ chartï¼Œä¹Ÿå¯ç¨±ç‚ºÂ &lt;code&gt;subcharts&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;templates(folder)ï¼šæ­¤ç›®éŒ„ç‚ºè¦éƒ¨ç½²çš„æ‰€æœ‰é¡å‹ç¯„æœ¬&lt;/li&gt;
&lt;li&gt;values.yaml ï¼š åƒæ•¸è¨­å®šæª”ï¼Œæ‰€æœ‰çš„è®Šæ•¸éƒ½å¯«åœ¨é€™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;templateså…§å¯«çš„åƒæ•¸ï¼Œé€šå¸¸ç‚º&lt;/p&gt;
&lt;p&gt;&lt;code&gt;.Values.replicas&lt;/code&gt;ï¼šè¡¨ç¤ºvalues.yamlè£é¢çš„replicasåƒæ•¸&lt;/p&gt;
&lt;p&gt;å…¶ä»–évaluesçš„å–å¾—æ–¹å¼ï¼Œåƒè€ƒ &lt;a href=&quot;https://godleon.github.io/blog/DevOps/Helm-v3-Chart-Template-Guide/#Built-in-Objects&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Built-in Objects&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;templateæœ‰ä¸€äº›å¯èƒ½æœƒç”¨åˆ°çš„å‡½æ•¸ï¼Œ&lt;br /&gt;
ä¸»è¦æœ‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;pipeline ( linux è£é¢å¸¸è¦‹åˆ°çš„ &lt;code&gt;|&lt;/code&gt; )&lt;/li&gt;
&lt;li&gt;if/else&lt;/li&gt;
&lt;li&gt;withï¼ˆ&lt;a href=&quot;http://xn--vb-xm3cq78y.net/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é¡ä¼¼vb.net&lt;/a&gt; çš„withï¼‰&lt;/li&gt;
&lt;li&gt;range(for loop)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;cheatsheet&quot; tabindex=&quot;-1&quot;&gt;Cheatsheet&lt;/h2&gt;
&lt;h4 id=&quot;dry-run&quot; tabindex=&quot;-1&quot;&gt;dry-run&lt;/h4&gt;
&lt;p&gt;å…ˆæŸ¥çœ‹helmæ‰€ç”¢ç”Ÿçš„yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;helm install --dry-run coturn ./coturn 
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;è¨­å®šåƒæ•¸&quot; tabindex=&quot;-1&quot;&gt;è¨­å®šåƒæ•¸&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;helm install coturn ./conturn --set certificate.enabled=false 

&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;values-yaml&quot; tabindex=&quot;-1&quot;&gt;æŒ‡å®švalues.yaml&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;helm install coturn ./conturn -f myval.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;namespace&quot; tabindex=&quot;-1&quot;&gt;æŒ‡å®šnamespace&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;helm install coturn ./conturn -n tools
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;helm&quot; tabindex=&quot;-1&quot;&gt;çœ‹helmåˆ—è¡¨&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;  helm ls
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;chart&quot; tabindex=&quot;-1&quot;&gt;æ›´æ–°chart&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;helm upgrade coturn ./coturn
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;chart-1&quot; tabindex=&quot;-1&quot;&gt;ç§»é™¤chart&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;helm uninstall coturn
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
- &lt;a href=&quot;https://godleon.github.io/blog/DevOps/Helm-v3-Chart-Template-Guide/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[Helm] Helm v3 ä½¿ç”¨ç°¡ä»‹&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10238998&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Helmä»‹ç´¹&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/123.Helm ä½¿ç”¨æ–¹å¼/" />
        </entry>
        <entry>
            <title>
                118. kubernetes Dashboard
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/118. kubernetes Dashboard/</id>
            <content type="html">
                &lt;h1 id=&quot;ç¢ç¢å¿µ&quot; tabindex=&quot;-1&quot;&gt;ç¢ç¢å¿µ&lt;/h1&gt;
&lt;p&gt;ä»¥å‰GKEç”¨ç¿’æ…£äº†ï¼Œç¾åœ¨è®Šæˆè‡ªå»ºçš„k8sï¼Œåªèƒ½ç”¨lensç®¡ï¼Œ&lt;br /&gt;
é›–ç„¶èªªä¸ä¸Šæœ‰å“ªä¸è¶³ï¼Œä½†ç¸½æ˜¯æ€ªæ€ªçš„ã€‚&lt;br /&gt;
ä»Šå¤©æŸ¥è³‡æ–™çœ‹åˆ°æœ‰é€™å€‹UIï¼Œå°±æ¶ä¾†çœ‹çœ‹äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;æœ¬æ©Ÿè¨ªå•&quot; tabindex=&quot;-1&quot;&gt;æœ¬æ©Ÿè¨ªå•&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/web-ui-dashboard/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®˜æ–¹æ–‡ä»¶&lt;/a&gt;ï¼Œå®‰è£ä¸‹å»å°±å¥½äº†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.6.1/aio/deploy/recommended.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŸ·è¡Œè½‰ç™¼ä¾†é€£åˆ°dashboard&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl proxy
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;kubectl æœƒä½¿å¾— Dashboard å¯ä»¥é€šéÂ &lt;a href=&quot;http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/&lt;/a&gt;Â è¨ªå•ã€‚&lt;/p&gt;
&lt;p&gt;ç™»å…¥ç•«é¢å¦‚ä¸‹&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/118-fig.1.jpg&quot; alt=&quot;118-fig.1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å†ä¾†å°±éœ€è¦ç”¢ç”Ÿä¸€çµ„tokenä¾†åšç™»å…¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå»ºç«‹ä¸€çµ„serviceAccount&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;cat &amp;lt;&amp;lt;EOF | kubectl create -f -  
apiVersion: v1  
kind: ServiceAccount  
metadata:  
  name: admin
  namespace: kube-system  
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¶å®šserviceAccount èˆ‡ è§’è‰²&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;cat &amp;lt;&amp;lt;EOF | kubectl create -f -  
apiVersion: rbac.authorization.k8s.io/v1 
kind: ClusterRoleBinding  
metadata:  
  name: admin-user  
roleRef:  
  apiGroup: rbac.authorization.k8s.io  
  kind: ClusterRole  
  name: cluster-admin  
subjects:  
- kind: ServiceAccount  
  name: admin
  namespace: kube-system  
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Service Accountå»ºç«‹å®Œå¾Œï¼ŒKubernetes Token Controller å°±æœƒè‡ªå‹•çš„ç‚ºå…¶ç”¢ç”Ÿä¸€å€‹Â &lt;strong&gt;secret&lt;/strong&gt;Â resource(åç¨±ç‚ºÂ &lt;code&gt;[SERVICE_ACCOUNT_NAME]-token-[RANDOM_STRING]&lt;/code&gt;)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep admin | awk &#39;{print $1}&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/118-fig.2.jpg&quot; alt=&quot;118-fig.2.jpg&quot; /&gt;&lt;br /&gt;
é€™é‚Šå–å¾—çš„tokenå³å¯åœ¨  Dashboard ä¸Šç™»å…¥ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://godleon.github.io/blog/Kubernetes/k8s-Deploy-and-Access-Dashboard/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; ä½ˆç½² &amp;amp; å­˜å– Kubernetes Dashboard&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;å¤–éƒ¨è¨ªå•&quot; tabindex=&quot;-1&quot;&gt;å¤–éƒ¨è¨ªå•&lt;/h3&gt;
&lt;p&gt;æ›´æ”¹service å…§çš„ kubernetes-dashboard.kubenetes-dashboards&lt;br /&gt;
å°‡clusteræ”¹æˆNodePort ï¼Œç„¶å¾Œçœ‹å°æ‡‰çš„portå¤šå°‘å°±èƒ½ç™»å…¥äº†ã€‚&lt;br /&gt;
è¨˜å¾—ç”¨https&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/118-fig.3.jpg&quot; alt=&quot;118-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref.  &lt;a href=&quot;https://github.com/kubernetes/dashboard/tree/master/docs/user/accessing-dashboard&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;accessing-dashboard&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/118. kubernetes Dashboard/" />
        </entry>
        <entry>
            <title>
                105. linuxç³»çµ±æ™‚é–“èˆ‡k8s
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/105. linuxç³»çµ±æ™‚é–“èˆ‡k8s/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘å¼„ä¹‹å‰çš„äººè‡ªå»ºçš„k8sï¼Œ&lt;br /&gt;
æ‰ç¢°åˆ°ä¸€å †å•é¡Œï¼Œ&lt;br /&gt;
æˆ‘çš„linuxæœç„¶éœ€è¦åŠ å¼·orz&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;linux&quot; tabindex=&quot;-1&quot;&gt;ä¸€èˆ¬çš„linuxå…§çš„æ™‚é–“é¡¯ç¤º&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;timedatectl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/105.fig-1.jpg&quot; alt=&quot;105.fig-1.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Local time  ï¼šæœ¬æ©Ÿæ™‚é–“&lt;br /&gt;
Universal time ï¼š UTCæ™‚é–“&lt;br /&gt;
RTC timeï¼š ç¡¬é«”æ™‚é–“&lt;br /&gt;
NTP service : è‡ªå‹•æ•ˆæ™‚&lt;br /&gt;
Time Zone: æ™‚å€&lt;/p&gt;
&lt;p&gt;ç•¶æ™‚é–“ä¸å°æ™‚ï¼Œå¯ä»¥è¨­å®šæ™‚é–“çš„è‡ªå‹•æ•ˆæ­£&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;timedatectl set-ntp yes 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¨­å®šå®Œå¾Œï¼Œç­‰ä¸€ä¸‹ï¼ˆå¤šä¹…ä¸ç¢ºå®šï¼Œä½†ä¸æœƒç«‹å³ï¼‰ï¼Œ&lt;br /&gt;
UTCçš„æ™‚é–“æ‡‰è©²å°±æœƒè‡ªå·±æ•ˆå°ã€‚&lt;/p&gt;
&lt;p&gt;NTPä¼ºæœå™¨ï¼ˆæœ‰éœ€è¦å†è¨­å®šï¼‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://time.google.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;time.google.com&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æŸ¥è©¢å„æ™‚å€&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;timedatectl list-timezones
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¨­å®šæ™‚å€&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;timedatectl set-timezone Asia/Taipei
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://officeguide.cc/ubuntu-linux-timedatectl-time-synchronization-tutorial/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Ubuntu Linux ä½¿ç”¨ timedatectl æ ¡æ­£æ™‚é–“ã€æ™‚å€æ•™å­¸èˆ‡ç¯„ä¾‹&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;pod&quot; tabindex=&quot;-1&quot;&gt;Podçš„æ™‚å€è¨­å®š&lt;/h3&gt;
&lt;p&gt;podçš„æ™‚é–“æœƒè·Ÿä»–æ‰€åœ¨çš„nodeæ™‚é–“ä¸€è‡´ï¼Œ&lt;br /&gt;
æ‰€ä»¥ç•¶ä½ çš„node ä¸»æ©Ÿæ™‚é–“éŒ¯æ™‚ï¼Œ&lt;br /&gt;
podçš„æ™‚é–“ä¹Ÿæœƒè·Ÿç€éŒ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä½†åŸºæœ¬ä¸Šéƒ½æ˜¯UTCï¼Œ&lt;br /&gt;
å¦‚æœè¦æŒ‡å®šæ™‚å€çš„è©±ï¼Œ&lt;br /&gt;
å¯ä»¥ç”¨volumeæ›è¼‰æˆç‰¹å®šåœ°å€ã€‚&lt;br /&gt;
æˆ–æ˜¯ç›´æ¥åœ¨build imageæ™‚ï¼Œä¸€ä½µæ›´æ”¹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;pvc æ›è¼‰&lt;br /&gt;
æ™‚å€æª”æ¡ˆçš„ä½ç½®&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: v1
kind: Pod
metadata:
  name: busybox-sleep
spec:
  containers:
  - name: busybox
    image: busybox
    args:
    - sleep
    - &amp;quot;1000000&amp;quot;
    volumeMounts:
    - name: tz-config
      mountPath: /etc/localtime
  volumes:
    - name: tz-config
      hostPath:
        path: /usr/share/zoneinfo/Europe/Prague
        type: File
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Dockerfileæ›´æ”¹&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;RUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &#92;
		 &amp;amp;&amp;amp; echo &amp;quot;Asia/Shanghai&amp;quot; &amp;gt; /etc/timezone
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.gushiciku.cn/pl/gSGc/zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;k8sç’°å¢ƒä¸‹è™•ç†å®¹å™¨æ™‚é–“å•é¡Œçš„å¤šç¨®å§¿å‹¢&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/61947696/date-and-time-synchronization-among-the-pods-and-host-in-kubernetes&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;date and time synchronization among the pods and host in kubernetes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/105. linuxç³»çµ±æ™‚é–“èˆ‡k8s/" />
        </entry>
        <entry>
            <title>
                104. rabbitmq operatorå®‰è£
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/104. rabbitmq operatorå®‰è£/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ¥åˆ°åŒäº‹èªªè¦è£rabbitmqï¼Œ&lt;br /&gt;
èªªä¹‹å‰åœ¨devæœ‰è£éï¼Œä½†åœ¨k8sä¸Šé¢æ²’çœ‹åˆ°ï¼Œ&lt;br /&gt;
ç”¨ä¹‹å‰ç•™ä¸‹çš„yamlï¼Œæœƒè£ä¸èµ·ä¾†ï¼Œåªå¥½å¾é ­ä¾†äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;ol start=&quot;0&quot;&gt;
&lt;li&gt;æœ¬ä¾†æ˜¯æƒ³åƒè€ƒä»–çš„&lt;a href=&quot;https://github.com/rabbitmq/diy-kubernetes-examples&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é€™ç¯‡&lt;/a&gt;ï¼Œçµæœçœ‹åˆ°ç¬¬ä¸€æ®µèªª
&lt;h3 id=&quot;stop-there-is-a-better-way&quot; tabindex=&quot;-1&quot;&gt;Stop! There is a Better Way!&lt;/h3&gt;
æ‰çŸ¥é“rabbitmqæœ‰å‡ºäº†operatorå¯ä¾›å®‰è£ã€‚&lt;/li&gt;
&lt;li&gt;å®‰è£rabbitmq operator&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl apply -f &amp;quot;https://github.com/rabbitmq/cluster-operator/releases/latest/download/cluster-operator.yml&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.rabbitmq.com/kubernetes/operator/install-operator.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Installing RabbitMQ Cluster Operator in a Kubernetes Cluster&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;éƒ¨ç½²yaml&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: rabbitmq.com/v1beta1
kind: RabbitmqCluster
metadata:
  name: dev-rabbitmq
spec:
  replicas: 3
  rabbitmq:
    additionalConfig: |
      default_user=admin
      default_pass=abc123
  service:
    type: NodePort

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å› ç‚ºæ˜¯è‡ªå»ºçš„k8sï¼Œæ²’æœ‰lbï¼Œæ‰€ä»¥å°±ç”¨NodePortäº†ã€‚&lt;br /&gt;
æ›´è©³ç´°çš„åƒæ•¸è«‹åƒè€ƒä¸‹é¢é€£çµã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://www.rabbitmq.com/kubernetes/operator/using-operator.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Using RabbitMQ Cluster Kubernetes Operator&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;å•é¡Œæ’é™¤&quot; tabindex=&quot;-1&quot;&gt;å•é¡Œæ’é™¤&lt;/h2&gt;
&lt;p&gt;ä¸­é–“æœ‰ç™¼ç”Ÿå°æ’æ›²ï¼Œk8så…§æ²’æœ‰é è¨­çš„storeageClass&lt;br /&gt;
å°è‡´å»ºç«‹pvcæ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œ&lt;br /&gt;
é›–ç„¶åœ¨ä¸Šé¢çš„yamlä¸Šé¢èƒ½å¤ æŒ‡å®šï¼Œ&lt;br /&gt;
ä½†å¯èƒ½æ˜¯æ ¼å¼æ²’å¯«å¥½ï¼Œå°è‡´æ²’æœ‰ç”¢ç”ŸstatefuleSet çš„pvcã€‚&lt;br /&gt;
æœ€å¾Œå…ˆæŒ‡å®šç›®å‰çš„storageClassç‚ºé è¨­çš„ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl patch storageclass &amp;lt;your_storageclass_name&amp;gt; -p &#39;{&amp;quot;metadata&amp;quot;: {&amp;quot;annotations&amp;quot;:{&amp;quot;storageclass.kubernetes.io/is-default-class&amp;quot;:&amp;quot;true&amp;quot;}}}&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://jeff-yen.medium.com/install-rabbitmq-in-kubernetes-8b009c28959f&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;install RabbitMQ in kubernetes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://zamhuang.medium.com/rabbitmq-%E4%BA%94%E5%88%86%E9%90%98%E8%BC%95%E9%AC%86%E4%BA%86%E8%A7%A3-rabbitmq-%E9%81%8B%E4%BD%9C-fcaecbaa69d4&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;RabbitMQã€‘äº”åˆ†é˜è¼•é¬†ç­è§£ RabbitMQ é‹ä½œ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/104. rabbitmq operatorå®‰è£/" />
        </entry>
        <entry>
            <title>
                101. æ‰¹æ¬¡ä¿®æ”¹hpa
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/101. æ‰¹æ¬¡ä¿®æ”¹hpa/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;é€™åˆæ˜¯å› ç‚ºæ‡¶æƒ°è€Œè¡ç”Ÿå‡ºä¾†çš„ä¸€ç¯‡ï¼Œ&lt;/p&gt;
&lt;p&gt;æ‡¶å¾—ä¸€å€‹ä¸€å€‹é»é€²å»æ”¹HPAçš„æ•¸é‡ï¼Œ&lt;/p&gt;
&lt;p&gt;å°±å¯«shæå®šå§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;åƒè€ƒ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/88.%E6%89%B9%E6%AC%A1%E4%BF%AE%E6%94%B9GCP%E7%9A%84label/&quot;&gt;88.æ‰¹æ¬¡ä¿®æ”¹GCPçš„label&lt;/a&gt;ï¼Œå»ºç«‹ä¸€å€‹æ–‡å­—æª” hpa.txtï¼Œ&lt;br /&gt;
å…ˆç”¨æŒ‡ä»¤ï¼Œå°‡hpaçš„nameå–å‡ºå­˜åˆ°æ–‡å­—æª”å…§ï¼Œå› ç‚ºæ˜¯é‡å°ç‰¹å®šå¹¾å€‹ä¿®æ”¹ï¼Œæ‰€ä»¥ä¸¦æ²’æœ‰å…¨æ‹‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get hpa;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ–‡å­—æª”å…§å®¹å¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;istio-yabo-api-prod-external
istio-yabo-api-prod-internal
istio-yabo-frontend-external-demo
istio-yabo-frontend-internal-demo
istio-yabo-frontend-prod-external
istio-yabo-frontend-prod-internal
istio-yabo-frontpage-external-prod
istio-yabo-frontpage-internal-prod
istio-yabo-huanggua-external-beta
istio-yabo-huanggua-external-prod
istio-yabo-huanggua-internal-beta
istio-yabo-huanggua-internal-prod
istio-yabo-landingpage-external-demo
istio-yabo-landingpage-external-prod
istio-yabo-landingpage-internal-demo
istio-yabo-landingpage-internal-prod
istio-yabo-pwa-external-prod
istio-yabo-pwa-internal-prod
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸»è¦æ˜¯ kubectl patch hpa åšä¿®æ”¹ã€‚&lt;br /&gt;
patché€™åŠŸèƒ½çœ‹ä¾†é —å¼·å¤§ï¼Œç¬¬ä¸€æ¬¡è¦‹åˆ°ï¼Œ&lt;br /&gt;
æ”¹å¤©å¯ç ”ç©¶çœ‹çœ‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;while read p; do                                                                                                                                             
  echo &amp;quot;$p&amp;quot;; kubectl patch hpa -p &#39;{&amp;quot;spec&amp;quot;:{&amp;quot;minReplicas&amp;quot;: 2}}&#39; -n istio-system $p; echo &amp;quot;done&amp;quot;;
done &amp;lt;hpa.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;br /&gt;
-  &lt;a href=&quot;https://stackoverflow.com/questions/51808297/kubenetes-change-hpa-min-replica&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubenetes: change hpa min-replica&lt;/a&gt;&lt;br /&gt;
- &lt;a href=&quot;https://kubernetes.io/zh-cn/docs/tasks/manage-kubernetes-objects/update-api-object-kubectl-patch/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨ kubectl patch æ›´æ–° API å°è±¡&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/101. æ‰¹æ¬¡ä¿®æ”¹hpa/" />
        </entry>
        <entry>
            <title>
                0.K8s MOC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/âˆ k8s/0.K8s MOC/</id>
            <content type="html">
                &lt;h1 id=&quot;åŸºæœ¬æ¦‚å¿µ&quot; tabindex=&quot;-1&quot;&gt;åŸºæœ¬æ¦‚å¿µ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/27.K8s%E7%9A%84%E7%AF%80%E9%BB%9E%E9%81%B8%E6%93%87%E8%88%87%E6%B1%A1%E6%9F%93/&quot;&gt;27.K8sçš„ç¯€é»é¸æ“‡èˆ‡æ±¡æŸ“&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/41.GKE%E7%AF%80%E9%BB%9E%E7%84%A1%E6%B3%95%E8%87%AA%E5%8B%95%E7%B8%AE%E5%B0%8F/&quot;&gt;41.GKEç¯€é»ç„¡æ³•è‡ªå‹•ç¸®å°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/42.k8s%20PDB%EF%BC%88pod%E4%B8%AD%E6%96%B7%E9%A0%90%E7%AE%97%EF%BC%89/&quot;&gt;42.k8s PDBï¼ˆpodä¸­æ–·é ç®—ï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/105.%20linux%E7%B3%BB%E7%B5%B1%E6%99%82%E9%96%93%E8%88%87k8s/&quot;&gt;105. linuxç³»çµ±æ™‚é–“èˆ‡k8s&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/123.Helm%20%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F/&quot;&gt;123.Helm ä½¿ç”¨æ–¹å¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/172.%20%E8%87%AA%E5%BB%BAk8s%E7%89%88%E6%9C%AC%E5%8D%87%E7%B4%9A/&quot;&gt;172. è‡ªå»ºk8sç‰ˆæœ¬å‡ç´š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/192.%20%E8%87%AA%E5%BB%BA%E7%9A%84k8s%E6%8B%89%E5%8F%96private%20registry/&quot;&gt;192. è‡ªå»ºçš„k8sæ‹‰å–private registry&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/194.%20pod%20debug%E6%96%B9%E5%BC%8F/&quot;&gt;194. pod debugæ–¹å¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/196.%20http%E5%81%A5%E5%BA%B7%E5%BA%A6%E5%81%B5%E6%B8%AC/&quot;&gt;196. httpå¥åº·åº¦åµæ¸¬&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;terraform&quot; tabindex=&quot;-1&quot;&gt;Terraform&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Terraform/82.%20Terraform%20vs%20Ansible/&quot;&gt;82. Terraform vs Ansible&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Terraform/147.%20%E7%94%A8chatGPT%E5%AD%B8Terraform/&quot;&gt;147. ç”¨chatGPTå­¸Terraform&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Terraform/148.%20Terraform%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/&quot;&gt;148. Terraformçš„åŸºæœ¬æ¦‚å¿µ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Terraform/149.%20terraform%20%E9%83%A8%E7%BD%B2VM%EF%BC%8C%E5%95%93%E5%8B%95docker%E5%AE%89%E8%A3%9Dmetadata_startup_script/&quot;&gt;149. terraform éƒ¨ç½²VMï¼Œå•“å‹•dockerå®‰è£metadata_startup_script&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Terraform/189.%20%E5%B0%8E%E5%85%A5Terraform/&quot;&gt;189. å°å…¥Terraform&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;tools&quot; tabindex=&quot;-1&quot;&gt;Tools&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/118.%20kubernetes%20Dashboard/&quot;&gt;118. kubernetes Dashboard&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/137.%20kubecolor%20%E7%9B%B4%E8%A7%80%E7%9A%84kubectl/&quot;&gt;137. kubecolor ç›´è§€çš„kubectl&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/139.%20openlens%20add%20pod%20shell%20or%20logs%20button/&quot;&gt;139. openlens add pod shell or logs button&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/162.%E6%9F%A5%E8%A9%A2%E5%B7%B2%E6%A3%84%E7%94%A8%E7%9A%84API/&quot;&gt;162.æŸ¥è©¢å·²æ£„ç”¨çš„API&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;yaml&quot; tabindex=&quot;-1&quot;&gt;yaml&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Yaml/2.%20k8s%20yaml%E6%92%B0%E5%AF%AB%20volume%20%E8%B8%A9%E5%9D%91%E7%AF%87/&quot;&gt;2. k8s yamlæ’°å¯« volume è¸©å‘ç¯‡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Yaml/12.%20k8s%20YAML%20%E5%B0%8F%E7%B4%B0%E7%AF%80/&quot;&gt;12. k8s YAML å°ç´°ç¯€&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Yaml/85.%20gke-cronjob%E7%AD%86%E8%A8%98/&quot;&gt;85. gke-cronjobç­†è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Yaml/87.kustomize%20%E5%85%B1%E7%94%A8label(optional%EF%BC%89/&quot;&gt;87.kustomize å…±ç”¨label(optionalï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Yaml/94.%20k8s%20%E7%B4%B0%E7%AF%80%E8%A3%9C%E5%85%85/&quot;&gt;94. k8s ç´°ç¯€è£œå……&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Yaml/98.%20k8s%E4%B8%AD%E7%9A%84command%E8%88%87dockerfile%E7%9A%84%20CMD/&quot;&gt;98. k8sä¸­çš„commandèˆ‡dockerfileçš„ CMD&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Yaml/136.%20%E4%B8%80%E6%AD%A5%E6%AD%A5%E7%AF%A9%E9%81%B8k8s%E7%9A%84deploy%E5%85%A7%E5%AE%B9/&quot;&gt;136. ä¸€æ­¥æ­¥ç¯©é¸k8sçš„deployå…§å®¹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;gke&quot; tabindex=&quot;-1&quot;&gt;GKE&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/4.%20GKE%E4%BD%BF%E7%94%A8GPU/&quot;&gt;4. GKEä½¿ç”¨GPU&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/37.SolrCloud%20on%20GKE/&quot;&gt;37.SolrCloud on GKE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/39.solrCloud%E7%9A%84%E5%88%9D%E9%AB%94%E9%A9%97/&quot;&gt;39.solrCloudçš„åˆé«”é©—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/44.srs%20%E5%BD%B1%E9%9F%B3%E4%B8%B2%E6%B5%81%20on%20GKE/&quot;&gt;44.srs å½±éŸ³ä¸²æµ on GKE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/50.GKE%20workload%20Identity%20%E5%AF%A6%E5%9C%B0%E6%BC%94%E7%B7%B4/&quot;&gt;50.GKE workload Identity å¯¦åœ°æ¼”ç·´&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/56.%20GKE%E8%A8%98%E9%8C%84%20nginx%20log/&quot;&gt;56. GKEè¨˜éŒ„ nginx log&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/70.%20GKE%20pvc%E9%82%84%E5%8E%9F/&quot;&gt;70. GKE pvcé‚„åŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/GKE/71.gitlab%20on%20GKE%20%E7%81%BD%E5%AE%B3%E9%82%84%E5%8E%9F%E7%AD%86%E8%A8%98/&quot;&gt;71.gitlab on GKE ç½å®³é‚„åŸç­†è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/101.%20%E6%89%B9%E6%AC%A1%E4%BF%AE%E6%94%B9hpa/&quot;&gt;101. æ‰¹æ¬¡ä¿®æ”¹hpa&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/104.%20rabbitmq%20operator%E5%AE%89%E8%A3%9D/&quot;&gt;104. rabbitmq operatorå®‰è£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/43.%E8%87%AA%E5%BB%BAECK%20on%20GKE/&quot;&gt;43.è‡ªå»ºECK on GKE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/190.%20cert-manager%E5%AE%89%E8%A3%9D/&quot;&gt;190. cert-managerå®‰è£&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/Yaml/74.%20kubernetes%20%E6%89%B9%E6%AC%A1%E6%AA%A2%E6%9F%A5yaml%E7%89%B9%E5%AE%9A%E5%AD%97%E5%85%83/&quot;&gt;74. kubernetes æ‰¹æ¬¡æª¢æŸ¥yamlç‰¹å®šå­—å…ƒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/76.%20k8s%20error,The%20node%20was%20low%20on%20resource../&quot;&gt;76. k8s error,The node was low on resource..&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/144.%20k8s%20%E7%9A%84sercret%E8%A4%87%E8%A3%BD/&quot;&gt;144. k8s çš„sercretè¤‡è£½&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/151.%20kubeadm%E9%87%8D%E6%96%B0%E7%94%A2%E7%94%9F%E9%A9%97%E8%AD%89/&quot;&gt;151. kubeadmé‡æ–°ç”¢ç”Ÿé©—è­‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/%E2%8E%88%20k8s/troubleshooting-kubernetes.zh_cn.v2.png&quot; alt=&quot;troubleshooting-kubernetes.zh_cn.v2.png&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/âˆ k8s/0.K8s MOC/" />
        </entry>
        <entry>
            <title>
                README
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/</id>
            <content type="html">
                &lt;h1 id=&quot;åº¦ä¼°è¨˜äº‹æœ¬&quot; tabindex=&quot;-1&quot;&gt;åº¦ä¼°è¨˜äº‹æœ¬&lt;/h1&gt;
&lt;h2 id=&quot;åº§å³éŠ˜&quot; tabindex=&quot;-1&quot;&gt;åº§å³éŠ˜&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;&lt;strong&gt;æ‡¶äººï¼Œå§‹çµ‚ç›¸ä¿¡ç§‘æŠ€å§‹çµ‚ä¾†è‡ªæ–¼äººé¡çš„æƒ°æ€§ã€‚&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&lt;strong&gt;æ‡¶æ˜¯ä¸€ç¨®æ–¹å¼ï¼Œå»ä¸æ˜¯ä¸€ç¨®æ…‹åº¦ã€‚&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&lt;strong&gt;ä½ å¦‚æœæƒ³è¦æœ‰æ›´å¤šçš„æ™‚é–“å·æ‡¶ï¼Œå°±ä¸€å®šè¦æœ‰æœ€é«˜çš„æ•ˆç‡ã€‚&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;æœ€æ–°æ–‡ç« &quot; tabindex=&quot;-1&quot;&gt;æœ€æ–°æ–‡ç« &lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/276.%20GKE%E7%A7%81%E6%9C%89%E5%8F%A2%E9%9B%86%E8%A8%AD%E5%AE%9A%20Authorized%20networks%EF%BC%8C%E5%87%BA%E7%8F%BE%E9%8C%AF%E8%AA%A4%20private_endpoint_enforcement_enabled%20cannot%20be%20disabled%20on%20VPC%20peering%20based%20clusters/&quot;&gt;276. GKEç§æœ‰å¢é›†è¨­å®š Authorized networksï¼Œå‡ºç¾éŒ¯èª¤ private_endpoint_enforcement_enabled cannot be disabled on VPC peering based clusters&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/218.%20Go%20GUI%E5%A5%97%E4%BB%B6%20fyne%E7%AD%86%E8%A8%98/&quot;&gt;218. Go GUIå¥—ä»¶ fyneç­†è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/277.%20elastic%20%EF%BC%8Cindex%20%E6%B6%88%E5%A4%B1%E7%9B%B8%E9%97%9C%E6%9F%A5%E8%A9%A2%E6%96%B9%E5%BC%8F/&quot;&gt;277. elastic ï¼Œindex æ¶ˆå¤±ç›¸é—œæŸ¥è©¢æ–¹å¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/278.Golang%E7%B0%A1%E7%95%A5%E7%AD%86%E8%A8%98%EF%BC%88%E4%BA%8C%EF%BC%89/&quot;&gt;278.Golangç°¡ç•¥ç­†è¨˜ï¼ˆäºŒï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;obsidian-github&quot; tabindex=&quot;-1&quot;&gt;ç”¨Obsidianç™¼ä½ˆåˆ°Github&lt;/h1&gt;
&lt;p&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/193.%20Obsidian%E7%99%BC%E4%BD%88%E5%88%B0github.io%E5%80%8B%E4%BA%BA%E7%B6%B2%E7%AB%99/&quot;&gt;193. Obsidianç™¼ä½ˆåˆ°github.ioå€‹äººç¶²ç«™&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;é›»å½±è©•åˆ†è¡¨&quot; tabindex=&quot;-1&quot;&gt;é›»å½±è©•åˆ†è¡¨&lt;/h1&gt;
&lt;p&gt;åšå¥½ç©çš„ &lt;a href=&quot;https://daimom.github.io/movieRating/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é›»å½±è©•åˆ†è¡¨&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;tag&quot; tabindex=&quot;-1&quot;&gt;Tagåˆ—è¡¨&lt;/h1&gt;
&lt;p&gt;ğŸ’¡ï¼šMap Of Content&lt;br /&gt;
ğŸ’»ï¼š&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/0.Code%20MOC/&quot;&gt;0.Code MOC&lt;/a&gt;&lt;br /&gt;
ğŸ³ï¼š&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%B3%20Container/0.Container%20MOC/&quot;&gt;Container MOC&lt;/a&gt;&lt;br /&gt;
ğŸ—„ï¼š&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%84%20Database/0.Database%20MOC/&quot;&gt;0.Database MOC&lt;/a&gt;&lt;br /&gt;
â±ï¼š&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8F%B1%20Drone/0.Drone%20MOC/&quot;&gt;0.Drone MOC&lt;/a&gt;&lt;br /&gt;
ğŸ—’ï¼š&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/0.EFK%20MOC/&quot;&gt;EFK MOC&lt;/a&gt;&lt;br /&gt;
â˜ï¸ï¼š&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/0.GCP%20MOC/&quot;&gt;GCP MOC&lt;/a&gt;&lt;br /&gt;
ğŸ“¥ï¼šinbox&lt;br /&gt;
â›µï¸ï¼š&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/0.istio%20MOC/&quot;&gt;istio MOC&lt;/a&gt;&lt;br /&gt;
âˆï¼š&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%8E%88%20k8s/0.K8s%20MOC/&quot;&gt;k8s MOC&lt;/a&gt;&lt;br /&gt;
ğŸ§ï¼š&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/0.Linux%20MOC/&quot;&gt;Linux MOC&lt;/a&gt;&lt;br /&gt;
ğŸï¼šApple&lt;br /&gt;
ğŸŒï¼š&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%8C%90%20Network/0.Network%20MOC/&quot;&gt;Network MOC&lt;/a&gt;&lt;br /&gt;
ğŸ‘ï¼š&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%91%81%20Observability/0.Observability%20MOC/&quot;&gt;0.Observability MOC&lt;/a&gt;&lt;br /&gt;
ğŸ®ï¼šGame&lt;br /&gt;
ğŸ†’ï¼šSide Project&lt;/p&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;what-is-moc&quot; tabindex=&quot;-1&quot;&gt;What is MOC ?&lt;/h1&gt;
&lt;p&gt;ç•¶å–®ä¸€ç­†è¨˜çš„æ•¸é‡è¶Šä¾†è¶Šå¤šæ™‚ï¼Œå°±èƒ½å¤ æ§‹æˆä¸€å€‹MOC(Map of Contens)&lt;br /&gt;
è©³ç´°è«‹åƒè€ƒä¸‹é¢é€£çµï¼Œ&lt;br /&gt;
&lt;a href=&quot;https://medium.com/pm%E7%9A%84%E7%94%9F%E7%94%A2%E5%8A%9B%E5%B7%A5%E5%85%B7%E7%AE%B1/%E6%95%B8%E4%BD%8D%E7%AD%86%E8%A8%98%E5%A4%AA%E5%A4%9A%E5%BE%88%E5%87%8C%E4%BA%82%E6%80%8E%E9%BA%BC%E8%BE%A6-451a6cb4ab17&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ•¸ä½ç­†è¨˜å¤ªå¤šå¾ˆå‡Œäº‚æ€éº¼è¾¦ï¼Ÿä½¿ç”¨ MOC æ¶æ§‹æœ‰ç³»çµ±åœ°ç®¡ç†æ•¸ç™¾å‰‡çš„æ•¸ä½ç­†è¨˜&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;æŠ€è¡“æ–‡ç« å¯«æ³•è¦é»&quot; tabindex=&quot;-1&quot;&gt;æŠ€è¡“æ–‡ç« å¯«æ³•è¦é»&lt;/h1&gt;
&lt;h4 id=&quot;strong-strong&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;æ–‡ç« æ¡ç”¨å–®ç·šçµæ§‹&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;ä¸€é»æ¥ç€ä¸€é»ï¼Œå°±æ˜¯ä¸€å¼µå¡ç‰‡æ¥ç€ä¸€å€‹å¡ç‰‡ï¼Œ&lt;br /&gt;
æŠŠå•é¡Œæ‹†æˆå¤šç¯‡æ–‡ç« ï¼Œ&lt;br /&gt;
è®“æ–‡ç« ä¸€ç¯‡å°±åªæœ‰ä¸€å€‹è¦é»ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.ruanyifeng.com/blog/2024/01/weekly-issue-288.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;# ç§‘æŠ€æ„›å¥½è€…é€±åˆŠï¼ˆç¬¬ 288 æœŸï¼‰ï¼šæŠ€è¡“å¯«ä½œçš„é¦–è¦è¨£ç«…&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;èˆŠç­†è¨˜&quot; tabindex=&quot;-1&quot;&gt;èˆŠç­†è¨˜&lt;/h1&gt;
&lt;p&gt;2021å¹´ä»¥å‰æ–‡ç« è«‹è‡³ &lt;a href=&quot;https://daimom3020.blogspot.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åº¦ä¼°è¨˜äº‹æœ¬&lt;/a&gt; æŸ¥è©¢&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/" />
        </entry>
        <entry>
            <title>
                285. BigQuery çœéŒ¢å¤§ä½œæˆ°
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/285. BigQuery çœéŒ¢å¤§ä½œæˆ°/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;åˆä¾†ç©æ–°æ±è¥¿äº†ï¼Œé€™æ¬¡æ˜¯BigQueryã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;p&gt;BigQueryçš„è²»ç”¨è¨ˆç®—æ–¹å¼ï¼Œå„²å­˜ç©ºé–“+åˆ†æã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;BigQuery æ¡ç”¨&lt;a href=&quot;https://en.wikipedia.org/wiki/Column-oriented_DBMS&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è³‡æ–™æ¬„å¼è³‡æ–™çµæ§‹&lt;/a&gt;ã€‚ç³»çµ±æœƒæ ¹æ“šæ‚¨æ‰€é¸è³‡æ–™æ¬„ä¸­è™•ç†çš„è³‡æ–™ç¸½é‡å‘æ‚¨æ”¶è²»ï¼Œæ¯å€‹è³‡æ–™æ¬„ä¸­çš„è³‡æ–™ç¸½é‡å‰‡æ˜¯æŒ‰ç…§è³‡æ–™æ¬„ä¸­è³‡æ–™çš„é¡å‹è¨ˆç®—ã€‚å¦‚è¦é€²ä¸€æ­¥ç­è§£è³‡æ–™é‡çš„è¨ˆç®—æ–¹å¼ï¼Œè«‹åƒé–±&lt;a href=&quot;https://cloud.google.com/bigquery/docs/best-practices-costs?hl=zh-tw#estimate-query-costs&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä¼°ç®—æŸ¥è©¢è²»ç”¨&lt;/a&gt;ä¸€ç¯€ã€‚&lt;/li&gt;
&lt;li&gt;æ‚¨åªéœ€æ”¯ä»˜æŸ¥è©¢å…±ç”¨è³‡æ–™çš„è²»ç”¨ã€‚è³‡æ–™æ“æœ‰è€…ä¸æœƒåœ¨è³‡æ–™å­˜å–æ™‚æ”¶è²»&lt;/li&gt;
&lt;li&gt;å¦‚æœæŸ¥è©¢ä½œæ¥­å‚³å›éŒ¯èª¤è¨Šæ¯æˆ–æ˜¯&lt;a href=&quot;https://cloud.google.com/bigquery/docs/cached-results?hl=zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¾å¿«å–ä¸­æ“·å–çµæœ&lt;/a&gt;ï¼Œå‰‡æ‚¨ä¸å¿…ä»˜è²»ã€‚ ä»¥Â &lt;a href=&quot;https://cloud.google.com/bigquery/docs/reference/standard-sql/procedural-language?hl=zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç¨‹åºèªè¨€å·¥ä½œ&lt;/a&gt;ä¾†èªªï¼Œç³»çµ±æœƒåœ¨å€‹åˆ¥é™³è¿°å¼å±¤ç´šæ¡ç”¨é€™å€‹è¨ˆåƒ¹æ¨¡å¼ã€‚&lt;/li&gt;
&lt;li&gt;è³‡æ–™é‡æœƒå››æ¨äº”å…¥è‡³æœ€æ¥è¿‘çš„ MB æ•¸ã€‚é‡å°æŸ¥è©¢æ‰€åƒç…§çš„æ¯å€‹è³‡æ–™è¡¨ï¼Œç³»çµ±è™•ç†çš„è³‡æ–™é‡åŸºæœ¬é¡åº¦ç‚º 10 MBï¼Œæ¯é …æŸ¥è©¢ä½œæ¥­è™•ç†çš„è³‡æ–™é‡åŸºæœ¬é¡åº¦ä¹ŸåŒæ¨£æ˜¯ 10 MBã€‚&lt;/li&gt;
&lt;li&gt;å³ä¾¿æ‚¨å–æ¶ˆæ­£åœ¨åŸ·è¡Œçš„æŸ¥è©¢å·¥ä½œï¼Œè©²é …ä½œæ¥­é‚„æ˜¯å¯èƒ½ç”¢ç”Ÿè²»ç”¨ï¼Œä¸”åƒ¹æ ¼æœ€é«˜ç­‰åŒæ–¼å®Œæ•´åŸ·è¡Œä½œæ¥­é ˆæ”¯ä»˜çš„å…¨é¡è²»ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ç•¶æ‚¨åŸ·è¡ŒæŸ¥è©¢æ™‚ï¼Œç³»çµ±æœƒæ ¹æ“šæ‚¨æ‰€é¸è³‡æ–™æ¬„ä¸­è™•ç†çš„è³‡æ–™é‡å‘æ‚¨æ”¶è²»ï¼Œå³ä½¿æ‚¨å·²æ˜ç¢ºå°çµæœè¨­å®šÂ &lt;code&gt;LIMIT&lt;/code&gt;Â ä¹Ÿæ˜¯å¦‚æ­¤ã€‚&lt;/li&gt;
&lt;li&gt;å°‡è³‡æ–™è¡¨&lt;a href=&quot;https://cloud.google.com/bigquery/docs/partitioned-tables?hl=zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åˆ†å€&lt;/a&gt;å’Œ&lt;a href=&quot;https://cloud.google.com/bigquery/docs/clustered-tables?hl=zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åˆ†ç¾¤&lt;/a&gt;æœ‰åŠ©æ–¼é™ä½æŸ¥è©¢è™•ç†çš„è³‡æ–™é‡ã€‚ç‚ºé”åˆ°æœ€ä½³åšæ³•çš„æˆæ•ˆï¼Œè«‹ç›¡å¯èƒ½æ¡ç”¨åˆ†å€å’Œåˆ†ç¾¤çš„åšæ³•ã€‚&lt;/li&gt;
&lt;li&gt;ä»¥é‡è¨ˆåƒ¹ (æ¯ TiB) çš„å®šåƒ¹æ˜¯æŒ‡Â &lt;a href=&quot;https://cloud.google.com/skus/?filter=bigquery&amp;amp;hl=zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Google Cloud SKU&lt;/a&gt;Â é é¢ä¸Šçš„åˆ†æåƒ¹æ ¼ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæ‚¨å°å¢é›†è³‡æ–™è¡¨åŸ·è¡ŒæŸ¥è©¢ï¼Œè€Œä¸”æŸ¥è©¢å«æœ‰å¢é›†è³‡æ–™æ¬„ç¯©é¸å™¨ï¼Œå‰‡ BigQuery æœƒä½¿ç”¨ç¯©é¸å™¨é‹ç®—å¼ä¾†ä¿®å‰ªæŸ¥è©¢æƒæçš„å€å¡Šã€‚é€™éº¼åšå¯ä»¥æ¸›å°‘æƒæçš„ä½å…ƒçµ„æ•¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/bigquery/pricing?hl=zh-tw#on_demand_pricing&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä»¥é‡è¨ˆåƒ¹çš„é‹ç®—åƒ¹æ ¼&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;æ³¨æ„äº‹é …&quot; tabindex=&quot;-1&quot;&gt;æ³¨æ„äº‹é …&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;é¿å…åè¦†è¦†è“‹è¡¨ï¼š ç³»çµ±æœƒåœ¨æ™‚é–“æ—…è¡Œå’Œæ•…éšœå®‰å…¨çª—å£æœŸé–“ä¿ç•™è¢«æ›¿æ›çš„è³‡æ–™ã€‚å¦‚æœæ‚¨ç¶“å¸¸è¦†è“‹è¡¨ï¼Œå‰‡æœƒç”¢ç”Ÿé¡å¤–çš„å„²å­˜ç©ºé–“è²»ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ä¸‹åˆ—æ–¹å¼æ¢ç´¢æˆ–é è¦½è³‡æ–™
&lt;ul&gt;
&lt;li&gt;åœ¨ Google Cloud æ§åˆ¶å°çš„è³‡æ–™è¡¨è©³ç´°è³‡æ–™é é¢ä¸­ï¼ŒæŒ‰ä¸€ä¸‹ã€ŒPreviewã€(é è¦½)Â åˆ†é æ¨™ç±¤ï¼Œå³å¯å–æ¨£è³‡æ–™ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ bq æŒ‡ä»¤åˆ—å·¥å…·ä¸­ï¼Œä½¿ç”¨Â &lt;a href=&quot;https://cloud.google.com/bigquery/docs/managing-table-data?hl=zh-tw#browse-table&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;&lt;code&gt;bq head&lt;/code&gt;&lt;/a&gt;Â æŒ‡ä»¤ä¸¦æŒ‡å®šè¦é è¦½çš„è³‡æ–™åˆ—æ•¸ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ API ä¸­ï¼Œä½¿ç”¨Â &lt;a href=&quot;https://cloud.google.com/bigquery/docs/reference/rest/v2/tabledata/list?hl=zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;&lt;code&gt;tabledata.list&lt;/code&gt;&lt;/a&gt;Â å¾ä¸€çµ„æŒ‡å®šçš„è³‡æ–™åˆ—æ“·å–è³‡æ–™è¡¨è³‡æ–™ã€‚&lt;/li&gt;
&lt;li&gt;è«‹é¿å…åœ¨éå¢é›†è³‡æ–™è¡¨ä¸­ä½¿ç”¨Â &lt;code&gt;LIMIT&lt;/code&gt;ã€‚å¦‚æœæ˜¯æœªç¶“å¢é›†çš„è³‡æ–™è¡¨ï¼Œ&lt;code&gt;LIMIT&lt;/code&gt;Â å­å¥ä¸æœƒé™ä½é‹ç®—è²»ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/bigquery/docs/clustered-tables?hl=zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å»ºç«‹å¢é›†è³‡æ–™è¡¨&lt;/a&gt;ï¼šåœ¨æ¯å€‹ä¿®æ”¹è³‡æ–™è¡¨çš„ä½œæ¥­ä¸­ï¼Œå¢é›†è³‡æ–™è¡¨éƒ½æœƒä¿ç•™å…¶æ’åºå±¬æ€§ã€‚ä¾å¢é›†åŒ–è³‡æ–™æ¬„ç¯©é¸æˆ–åŒ¯ç¸½çš„æŸ¥è©¢ï¼Œåªæœƒæ ¹æ“šå¢é›†åŒ–è³‡æ–™æ¬„æƒæç›¸é—œå€å¡Šï¼Œè€Œä¸æœƒæƒææ•´å€‹è³‡æ–™è¡¨æˆ–è³‡æ–™è¡¨åˆ†å€ã€‚æ„Ÿè¦ºä¸Šåƒæ˜¯index&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/bigquery/docs/partitioned-tables?hl=zh-tw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨åˆ†å€å°‡å¤§å‹è³‡æ–™è¡¨åˆ†å‰²&lt;/a&gt;ï¼šåˆ†å€è³‡æ–™è¡¨åŠƒåˆ†ç‚ºå¤šå€‹å€æ®µ (ç¨±ç‚ºåˆ†å€)ï¼Œå¯è®“æ‚¨æ›´å®¹æ˜“ç®¡ç†å’ŒæŸ¥è©¢è³‡æ–™ã€‚å°‡å¤§å‹è³‡æ–™è¡¨åˆ†æˆè¼ƒå°çš„åˆ†å€ï¼Œå¯ä»¥æé«˜æŸ¥è©¢æ•ˆèƒ½ï¼Œä¸¦ä¸”å¯ä»¥é€éæ¸›å°‘æŸ¥è©¢è®€å–çš„ä½å…ƒçµ„æ•¸ä¾†æ§åˆ¶è²»ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;a href=&quot;https://cloud.google.com/bigquery/pricing?hl=zh-tw#storage&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é•·æœŸå„²å­˜åƒ¹æ ¼&lt;/a&gt;ï¼Œé™ä½èˆŠè³‡æ–™çš„è²»ç”¨ï¼šè¶…é90å¤©æ²’ç”¨éçš„è³‡æ–™ï¼Œæœƒé™ä½50%çš„é‡‘é¡&lt;a href=&quot;https://cloud.google.com/bigquery/pricing?hl=zh-tw#storage&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å„²å­˜ç©ºé–“å®šåƒ¹&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç‚ºç›®çš„åœ°è³‡æ–™è¡¨ä½¿ç”¨è³‡æ–™è¡¨åˆ°æœŸæ™‚é–“ï¼šå¦‚æœæ‚¨å°‡å¤§å‹æŸ¥è©¢çµæœå¯«å…¥ç›®çš„åœ°è³‡æ–™è¡¨ï¼Œè«‹ä½¿ç”¨é è¨­è³‡æ–™è¡¨åˆ°æœŸæ™‚é–“ï¼Œç­‰åˆ°æ‚¨ä¸å†éœ€è¦é€™äº›è³‡æ–™æ™‚ï¼Œç³»çµ±ä¾¿æœƒä¾ç…§è¨­å®šçš„æ™‚é–“ä¾†åˆªé™¤è³‡æ–™&lt;/li&gt;
&lt;li&gt;å¯«å…¥è³‡æ–™æ–¹å¼ï¼šæ‰¹æ¬¡ä¸ç”¨éŒ¢ï¼Œä¸²æµéœ€è¦ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/285-fig.1.png&quot; alt=&quot;285-fig.1.png&quot; /&gt;&lt;br /&gt;
é¸æ“‡å“ªä¸€ç¨®æ–¹å¼ï¼Œåƒè€ƒä¸‹åœ–&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/285-fig.2.png&quot; alt=&quot;285-fig.2.png&quot; /&gt;&lt;br /&gt;
ref. &lt;a href=&quot;https://cloud.google.com/bigquery/docs/write-api?hl=zh-tw#default_stream&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;BigQuery Storage Write API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/285. BigQuery çœéŒ¢å¤§ä½œæˆ°/" />
        </entry>
        <entry>
            <title>
                282. Grafanaçš„label_replace
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/282. Grafanaçš„label_replace/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;åœ¨æGrafanaæ•´åˆæ™‚ï¼Œæ‰ç™¼ç¾ç¼ºå°‘å–®å€‹Nodeçš„CPU Usedï¼Œ&lt;br /&gt;
å¾Grafana Dashboardæ‰¾äº†å€‹é©åˆçš„æŠ“ä¸‹ä¾†ç”¨ï¼Œ&lt;br /&gt;
æœ‰äº›éŒ¯èª¤æ›´æ”¹æ™‚ï¼Œæ‰ç™¼ç¾ä»–ç”¨äº†Transformationï¼Œ&lt;br /&gt;
æ‰€ä»¥ä¸è«–æˆ‘æ€æ”¹éƒ½æ²’è³‡æ–™ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;p&gt;æˆ‘ä½¿ç”¨çš„dashboardæ˜¯ &lt;a href=&quot;https://grafana.com/grafana/dashboards/18447-gke-node-dashboard-ssdq/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GKE per Node dashboard&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;TransformationåŠŸèƒ½å¾ˆå¤šï¼Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/282-fig.1.png&quot; alt=&quot;282-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ–°å¢åŠŸèƒ½æ™‚ï¼Œç¢°åˆ°ä¸€å€‹å•é¡Œã€‚&lt;br /&gt;
æˆ‘æœ‰å…©å€‹ metrics&lt;/p&gt;
&lt;p&gt;CPU Used&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sum by (kubernetes_io_hostname)(rate(container_cpu_usage_seconds_total{id=&amp;quot;/&amp;quot;}[1m]))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;CPU Request&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sum by(node)(kube_node_status_allocatable{resource=&amp;quot;cpu&amp;quot;})
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…©é‚Šçš„å€¼éƒ½ä¸€æ¨£ï¼Œä½†å¦‚æœè¦é¡¯ç¤ºåœ¨åŒä¸€å€‹è¡¨æ ¼çš„è©±ï¼Œç„¡æ³•é¡¯ç¤ºï¼ï¼ï¼&lt;/p&gt;
&lt;p&gt;æœ€å¿«çš„æ–¹å¼ï¼Œå°±æ˜¯å°‡CPU Requestçš„ nodeæ”¹æ‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sum by (kubernetes_io_hostname)(
  label_replace(
    kube_node_status_allocatable{resource=&amp;quot;cpu&amp;quot;},
    &amp;quot;kubernetes_io_hostname&amp;quot;,
    &amp;quot;$1&amp;quot;,
    &amp;quot;node&amp;quot;,
    &amp;quot;(.*)&amp;quot;
  )
)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°‡nodeçš„å€¼å–å‡ºä¾†å¾Œï¼Œå†å°‡nodeçš„label æ”¹æˆ kubernetes_io_hostnameã€‚&lt;/p&gt;
&lt;p&gt;é€™æ¨£ç›´æ¥åœ¨transformationåº•ä¸‹çš„æ¬„ä½å¾€ä¸Šæ‹‰å°±å¥½ï¼Œ&lt;br /&gt;
åŸæœ¬é€£é¡¯ç¤ºéƒ½æ²’æœ‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/282-fig.2.png&quot; alt=&quot;282-fig.2.png&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/282. Grafanaçš„label_replace/" />
        </entry>
        <entry>
            <title>
                280. Promtail è¦å‰‡é †åº
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/280. Promtail è¦å‰‡é †åº/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;å…¨é¢ä½¿ç”¨istioçš„æ™‚å€™ï¼Œ&lt;br /&gt;
è¦å°‡ç¶²è·¯å…¥å£çš„logçµ±ä¸€ä¸Ÿå»lokiç®¡ç†ï¼Œ&lt;br /&gt;
ç¯©é¸æ™‚ç¢°åˆ°GPTçš„å¹»è¦ºï¼Œ&lt;br /&gt;
æœ€å¾Œä¸Ÿäº†æ¸¬è©¦çµæœï¼Œæ‰æ›´æ­£éä¾†ã€‚&lt;br /&gt;
Gemini å€’æ˜¯ä¸€é–‹å§‹å°±çµ¦æ­£ç¢ºçš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;p&gt;æœ¬ä¾†åªæœ‰æ‰“ç®—æŠ“istio-systemçš„logç´€éŒ„ï¼Œ&lt;br /&gt;
ä½†ç¿»äº†ä¸€ä¸‹ï¼Œæ¯å€‹podåº•ä¸‹çš„istio-proxyé‚£äº›logï¼Œ&lt;br /&gt;
å°æ–¼æ—¥å¾Œåˆ¤æ–·æ„Ÿè¦ºä¹Ÿé —é‡è¦ï¼Œå°±é€šé€šä¸€èµ·ç•™è‘—å§ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥é€™æ¬¡çš„ç›®æ¨™æ˜¯ï¼ŒæŠ“å– namespace (istio-system)çš„æ‰€æœ‰log&lt;br /&gt;
ä»¥åŠ namesapce(default)åº•ä¸‹çš„istio-proxyçš„container logã€‚&lt;/p&gt;
&lt;p&gt;åªä¿ç•™ ns ç‚º istio-systemçš„è©±ï¼Œæ²’ä»€éº¼çˆ­è­°ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;relabel_configs:
  # Rule 1: ä¿ç•™ namespace æ˜¯ istio-system 
  - source_labels: [__meta_kubernetes_namespace]
    regex: istio-system
    action: keep
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥åœ¨ä¸Šé¢ä½¿ç”¨é€™æ®µã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;scrape_configs:
- job_name: pod-logs
  kubernetes_sd_configs:
    - role: pod
      namespaces:
        names:
          - istio-system
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†ç•¶æœ‰å…©å€‹keepæ™‚ï¼Œ&lt;br /&gt;
å°±ç”¢ç”Ÿæ··äº‚äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯éŒ¯èª¤çš„ï¼Œç•¶å…©å€‹ä¸€èµ·æ›ä¸Šå»ï¼Œä¸æœƒæœ‰ä»»ä½•logåŒ¯å‡ºåˆ°loki&lt;/p&gt;
&lt;p&gt;GPTä¸€ç›´èªªï¼Œå…©å€‹keepè¦å‰‡ï¼Œåªè¦ä¸€å€‹ç¬¦åˆå°±å¥½ï¼Œ&lt;br /&gt;
å½¼æ­¤çš„é—œè¯æ˜¯ &lt;code&gt;OR&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/280-fig.1.png&quot; alt=&quot;280-fig.1.png&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/280-fig.2.png&quot; alt=&quot;280-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä½†å¯¦éš›ä¸Šï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ‰€æœ‰è¦å‰‡æ˜¯ä¾åºç”±ä¸Šè€Œä¸‹å¥—ç”¨ï¼Œç›®æ¨™åªæœ‰åœ¨é€šéæ‰€æœ‰ keepè¦å‰‡å¾Œï¼Œæœ€çµ‚æ‰æœƒä¿ç•™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¦å®Œæˆorçš„é¸é …ï¼Œæœ€å¥½å°±æ˜¯å¯«åœ¨åŒä¸€æ¢ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- source_labels: [__meta_kubernetes_namespace, __meta_kubernetes_pod_container_name]
  separator: &amp;quot;;&amp;quot;
  regex: (istio-system;.+)|(default;istio-proxy)
  action: keep

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Gemini å‰‡æœ‰æä¾›å¦ä¸€å€‹æ€è·¯ï¼Œ&lt;br /&gt;
åŠ ä¸Šä¸€å€‹è™›æ“¬çš„label ï¼Œè¨­å®šç‚ºtrueï¼Œä¹‹å¾Œå†å°‡étrueçš„dropã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;relabel_configs:
  # Rule 1: å¦‚æœ namespace æ˜¯ istio-systemï¼Œçµ¦ç›®æ¨™æ‰“ä¸Šä¸€å€‹æš«æ™‚æ¨™è¨˜ __temp_keep
  - source_labels: [__meta_kubernetes_namespace]
    regex: istio-system
    action: replace  # ä½¿ç”¨ replace action ä¾†æ·»åŠ /ä¿®æ”¹ label
    target_label: __temp_keep # è¨­ç½®ä¸€å€‹æš«æ™‚çš„ label åç¨±
    replacement: &amp;quot;true&amp;quot;      # çµ¦é€™å€‹ label ä¸€å€‹å€¼

  # Rule 2: å¦‚æœ namespace æ˜¯ default ä¸” container æ˜¯ istio-proxyï¼Œä¹Ÿçµ¦ç›®æ¨™æ‰“ä¸ŠåŒä¸€å€‹æš«æ™‚æ¨™è¨˜ __temp_keep
  - source_labels: [__meta_kubernetes_namespace, __meta_kubernetes_pod_container_name]
    regex: default;istio-proxy
    action: replace
    target_label: __temp_keep
    replacement: &amp;quot;true&amp;quot;

  # Rule 3: æœ€å¾Œï¼Œåªä¿ç•™å¸¶æœ‰ __temp_keep æ¨™è¨˜çš„ç›®æ¨™ï¼Œä¸Ÿæ£„æ²’æœ‰æ­¤æ¨™è¨˜çš„
  - source_labels: [__temp_keep]
    regex: &amp;quot;true&amp;quot; # regex åŒ¹é… __temp_keep çš„å€¼
    action: keep  # åªä¿ç•™åŒ¹é…çš„ç›®æ¨™ (å³å¸¶æœ‰ __temp_keep=true çš„)

  # (Optional) æ¸…ç†æš«æ™‚ labelï¼Œå¦‚æœä¸éœ€è¦å®ƒå‚³åˆ° Loki
  - source_labels: [__temp_keep]
    action: labeldrop
    regex: __temp_keep
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/280. Promtail è¦å‰‡é †åº/" />
        </entry>
        <entry>
            <title>
                278.Golangç°¡ç•¥ç­†è¨˜ï¼ˆäºŒï¼‰
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/278.Golangç°¡ç•¥ç­†è¨˜ï¼ˆäºŒï¼‰/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/218.%20Go%20GUI%E5%A5%97%E4%BB%B6%20fyne%E7%AD%86%E8%A8%98/&quot;&gt;218. Go GUIå¥—ä»¶ fyneç­†è¨˜&lt;/a&gt;ï¼Œ&lt;br /&gt;
æ˜¯ç”¨ChatGPTåŠ ä¸Šæ–‡ä»¶æå‡ºä¾†çš„ï¼Œ&lt;br /&gt;
æœ‰äº›å¯«æ³•çœŸçš„æ˜¯å²å®³å•Šï¼Œ&lt;br /&gt;
å€¼å¾—ç´€éŒ„ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;function å›å‚³ï¼Œå…©å€‹ä»¥ä¸Šçš„è©±éœ€è¦ &lt;code&gt;()&lt;/code&gt;ï¼Œä¸€å€‹å‰‡ä¸ç”¨&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;var db *sql.DB
func main() {
	var err error
	db, err = initDatabase(&amp;quot;./stickersInfo.db&amp;quot;)
	if err != nil {
		log.Fatalf(&amp;quot;åˆå§‹åŒ–è³‡æ–™åº«å¤±æ•—: %v&amp;quot;, err)
	}
	// ç•¶main å…¨éƒ¨çµæŸå¾Œï¼Œæœƒé—œé–‰db 
	defer db.Close()
}

func initDatabase(dbPath string) (*sql.DB, error) {
	....
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;åŒä¸€å€‹å°ˆæ¡ˆåº•ä¸‹ï¼Œä¸åŒæ–‡ä»¶ï¼Œä¸éœ€è¦å¦å¤–importï¼Œåªéœ€ä¸‹é¢é€™è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;package main
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;è®Šæ•¸or å‡½æ•¸ï¼Œé–‹é ­å¤§å¯«è¡¨ç¤ºæ˜¯å…¬æœ‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;var BasePath = &amp;quot;&#92;user&#92;daimom&amp;quot;

var BasePath string
BasePath = &amp;quot;&#92;user&#92;daimom&amp;quot;

BasePath := &amp;quot;&#92;user&#92;daimom&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;slice(å‹•æ…‹array)çš„ &lt;code&gt;...&lt;/code&gt; ï¼Œæ„æ€æ˜¯å°‡sliceæ‹†é–‹ï¼Œç•¶ä½œå¤šå€‹åƒæ•¸å‚³åˆ°å‡½å¼&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;// LoadImagesæœƒå›å‚³ []fyne.CanvasObject
grid := container.NewGridWithColumns(3, LoadImages(*imageLists, w)...)

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;å­—ä¸²è™•ç†&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;//åˆ†å‰²
p := strings.Split(imagePath, &amp;quot;/&amp;quot;)
//çµåˆ
alias = (strings.Join(*aliasList, &amp;quot;,&amp;quot;))
//è½‰string
a = string(number)
//æ›¿æ›æ–‡å­—
folderPath := strings.ReplaceAll(path, &amp;quot;productInfo.meta&amp;quot;, &amp;quot;&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;for range&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;// è¿´åœˆåŠ å…¥,
for i, id := range packageIDs {
  query += &amp;quot;?&amp;quot;
  if i &amp;lt; len(packageIDs)-1 {
    query += &amp;quot;,&amp;quot;
  }
  args[i] = id
}

// å¸¸ç”¨å–å¾—sliceçš„å€¼ã€‚products å‹åˆ¥ç‚º *[]Productã€‚
for _, p := range *products {
  if !existsMap[p.PackageID] {
    filtered = append(filtered, p)
  } else {
    fmt.Printf(&amp;quot;åˆªé™¤ PackageID: %d, StickerID: %d&#92;n&amp;quot;, p.PackageID, p.stickerId)
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;7&quot;&gt;
&lt;li&gt;æŒ‡æ¨™&lt;br /&gt;
å¦‚æœå‚³å…¥å¯¦é«”çš„å‹åˆ¥ç‚º &lt;code&gt;products []Prouduct&lt;/code&gt;ï¼Œ&lt;br /&gt;
é‚£&lt;code&gt;*products å‹åˆ¥ç‚º []Proudct&lt;/code&gt;ï¼Œå–å¯¦é«”&lt;br /&gt;
è€Œ &lt;code&gt;&amp;amp;products å‹åˆ¥ç‚º *[]Product&lt;/code&gt;ï¼ŒæŒ‡å‘é€™å€‹ slice çš„æŒ‡æ¨™&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;func checkDuplicate(products *[]Product){
	// æ­¤è™•çœ‹åˆ°products æ˜¯å€‹æŒ‡å‘[]Productçš„æŒ‡æ¨™ã€‚
	// è¦å–å€¼çš„è©±ï¼Œè®Šæˆ *productsï¼ˆå‹åˆ¥ []Product)
	// å¦‚æœè¦å–æŒ‡æ¨™ &amp;amp;products ï¼Œå› æœ¬ä¾†å·²ç¶“æ˜¯æŒ‡æ¨™äº†ï¼Œ
	// æœƒè®Šæˆ (å‹åˆ¥ **[]Product) ï¼Œå°±æœƒå‡ºéŒ¯
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;8&quot;&gt;
&lt;li&gt;mapé è¨­å›å‚³&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;map å‹åˆ¥&lt;/th&gt;
&lt;th&gt;ä¸å­˜åœ¨æ™‚å›å‚³å€¼&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;map[int]bool&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;false&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;map[string]int&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;0&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;map[string]string&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;&amp;quot;&amp;quot;&lt;/code&gt; (ç©ºå­—ä¸²)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;map[int]float64&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;0.0&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;9&quot;&gt;
&lt;li&gt;slice å–å€¼&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¯«æ³•&lt;/th&gt;
&lt;th&gt;æ„æ€&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;arr[2:]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¾ index 2 åˆ°çµå°¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;arr[:3]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¾é–‹é ­åˆ° index 3ï¼ˆä¸å«3ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;arr[1:4]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¾ index 1 åˆ° 4ï¼ˆä¸å«4ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;arr[:]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å…¨éƒ¨ï¼ˆcopy ä¸€ä»½ sliceï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;10&quot;&gt;
&lt;li&gt;makeç”¨æ³•&lt;br /&gt;
ç”¨ä¾†å»ºç«‹ slice, map, chan é€™ä¸‰ç¨®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç•¶ç”¨ä¾†å»ºç«‹sliceæ™‚ï¼Œå·®ç•°åœ¨&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç”¨æ³•æƒ…å¢ƒ&lt;/th&gt;
&lt;th&gt;å»ºè­°å¯«æ³•&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;è¦æ˜ç¢ºæ˜¯ç©º slice&lt;/td&gt;
&lt;td&gt;&lt;code&gt;a := []int{}&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¦ä¿ç•™ nil åˆ¤æ–·èªæ„&lt;/td&gt;
&lt;td&gt;&lt;code&gt;var a []int&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¦åˆå§‹åŒ–æœ‰å®¹é‡ä½†ç„¡è³‡æ–™&lt;/td&gt;
&lt;td&gt;&lt;code&gt;make([]int, 0, 100)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è€Œä¸‰ç¨®å‹åˆ¥çš„å·®ç•°&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‹åˆ¥&lt;/th&gt;
&lt;th&gt;æ˜¯å¦è¦æŒ‡å®šé•·åº¦ï¼Ÿ&lt;/th&gt;
&lt;th&gt;å‚™è¨»&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;slice&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âœ… è¦æŒ‡å®šé•·åº¦ï¼ˆ&lt;code&gt;len&lt;/code&gt;ï¼‰ï¼Œå¯é¸å®¹é‡ï¼ˆ&lt;code&gt;cap&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;make([]T, len)&lt;/code&gt; æˆ– &lt;code&gt;make([]T, len, cap)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;map&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âŒ å¯çœç•¥é•·åº¦ï¼ˆä½†å¯é¸æ“‡æ€§æŒ‡å®šåˆå§‹å®¹é‡ï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;make(map[K]V)&lt;/code&gt; æˆ– &lt;code&gt;make(map[K]V, hint)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;chan&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;âœ… è¦æŒ‡å®š buffer å¤§å°ï¼ˆ0 è¡¨ç¤ºç„¡ bufferï¼‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;make(chan T, bufferSize)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸Šéƒ½æ˜¯å¯«&lt;a href=&quot;https://github.com/daimom/LineStickerMapping&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;LineStickerMapping&lt;/a&gt; ï¼Œç„¶å¾Œå»¶ä¼¸å‡ºä¾†çš„ç­†è¨˜&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://willh.gitbook.io/build-web-application-with-golang-zhtw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨Golangæ‰“é€ Webæ‡‰ç”¨ç¨‹å¼&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/278.Golangç°¡ç•¥ç­†è¨˜ï¼ˆäºŒï¼‰/" />
        </entry>
        <entry>
            <title>
                277. elastic ï¼Œindex æ¶ˆå¤±ç›¸é—œæŸ¥è©¢æ–¹å¼
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/277. elastic ï¼Œindex æ¶ˆå¤±ç›¸é—œæŸ¥è©¢æ–¹å¼/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;åŒäº‹å•ï¼Œç‚ºä»€éº¼æˆ‘å‰äº”å¤©çš„indexæ¶ˆå¤±äº†ã€‚&lt;br /&gt;
æˆ‘éœ‡é©šï¼Œä¸æ‡‰è©²å•Šã€‚&lt;br /&gt;
é–‹å§‹æ¼«é•·çš„æŸ¥è©¢ä¹‹è·¯&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;NOTE&lt;/h1&gt;
&lt;h3 id=&quot;filebeat&quot; tabindex=&quot;-1&quot;&gt;filebeat é‡æ–°ä¸Šå‚³&lt;/h3&gt;
&lt;p&gt;ç›´æ¥çœ‹indicesçš„å…§å®¹ï¼Œ&lt;br /&gt;
çœŸçš„æ²’æœ‰å‰å¹¾å¤©çš„è³‡æ–™ï¼Œä½†æ–‡ä»¶é‚„åœ¨ï¼Œ&lt;br /&gt;
é‚£ä¸ç„¶å…ˆæŠŠæ–‡ä»¶é‡å‚³å›ä¾†å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;filebeaté registryåº•ä¸‹çš„æª”æ¡ˆ(k8så…§çš„è·¯å¾‘ç‚º&lt;code&gt;/usr/share/filebeat/data/registry/filebeat/data.json&lt;/code&gt;ï¼Œ&lt;br /&gt;
ä¾†åˆ¤æ–·é€™å€‹æ–‡ä»¶æœ‰æ²’æœ‰è®€å–éï¼Œ&lt;br /&gt;
æ‰€ä»¥å°‡é€™å€‹è³‡æ–™å¤¾åº•ä¸‹çš„æª”æ¡ˆæ¸…ç©ºï¼Œé‡å•ŸPodï¼Œå°±æœƒè§¸ç™¼å¼·åˆ¶é‡å‚³äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rm -rvf /usr/share/filebeat/data/registry
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é¡Œå¤–è©±ï¼Œç„¶å¾Œå› ç‚ºå‰é¢çš„æ–‡ä»¶å¤ªå¤šæ²’åˆªé™¤ï¼Œ&lt;br /&gt;
å°è‡´elkçš„ç¡¬ç¢Ÿç›´æ¥å¡æ»¿ã€‚&lt;/p&gt;
&lt;h3 id=&quot;index-ilm&quot; tabindex=&quot;-1&quot;&gt;æª¢æŸ¥indexçš„ILM æœ‰æ²’æœ‰ç”Ÿæ•ˆ&lt;/h3&gt;
&lt;p&gt;å…ˆç¢ºèªilmçš„æ”¿ç­–æ­£ç¢ºï¼Œä¸‹é¢æœƒåˆ—å‡ºå…¨éƒ¨çš„ilmï¼Œçœ‹æ˜¯ä¸æ˜¯è·Ÿä½ æƒ³åƒçš„ä¸€æ¨£ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET /_ilm/policy?pretty
or
GET _ilm/policy/delete-bms-indices-after-7days?pretty
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çµæœå¦‚ä¸‹ï¼Œ&lt;br /&gt;
å»ºç«‹indexæ™‚ï¼Œæœƒé¦¬ä¸Šé€²å…¥åˆ°hot çš„phasesï¼ˆæ ¹æ“šmin_age=0ms)ï¼Œ&lt;br /&gt;
ç„¶å¾Œ14å¤©å¾Œï¼Œæœƒåˆ°deleteçš„phasesï¼ˆmin_age=14d)ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  &amp;quot;delete-bms-indices-after-7days&amp;quot;: {
    &amp;quot;version&amp;quot;: 4,
    &amp;quot;modified_date&amp;quot;: &amp;quot;2024-10-23T08:49:16.681Z&amp;quot;,
    &amp;quot;policy&amp;quot;: {
      &amp;quot;phases&amp;quot;: {
        &amp;quot;hot&amp;quot;: {
          &amp;quot;min_age&amp;quot;: &amp;quot;0ms&amp;quot;,
          &amp;quot;actions&amp;quot;: {
            &amp;quot;set_priority&amp;quot;: {
              &amp;quot;priority&amp;quot;: 100
            }
          }
        },
        &amp;quot;delete&amp;quot;: {
          &amp;quot;min_age&amp;quot;: &amp;quot;14d&amp;quot;,
          &amp;quot;actions&amp;quot;: {
            &amp;quot;delete&amp;quot;: {
              &amp;quot;delete_searchable_snapshot&amp;quot;: true
            }
          }
        }
      }
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ä¾†çœ‹indexçš„ ilm&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET /qa-game-cold-back-gamecoldtransdata-2024.12/_ilm/explain
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…§å®¹å¦‚ä¸‹ï¼Œç›®å‰å»ºç«‹äº†5.23dï¼Œè¦åˆ°14då¯èƒ½é‚„è¦ä¸€é™£å­ï¼Œ&lt;br /&gt;
å…ˆæ”¾è‘—ä¹‹å¾Œçœ‹çµæœã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{
  &amp;quot;indices&amp;quot;: {
    &amp;quot;qa-game-cold-back-gamecoldtransdata-2024.12&amp;quot;: {
      &amp;quot;index&amp;quot;: &amp;quot;qa-game-cold-back-gamecoldtransdata-2024.12&amp;quot;,
      &amp;quot;managed&amp;quot;: true,
      &amp;quot;policy&amp;quot;: &amp;quot;delete-bms-indices-after-7days&amp;quot;,
      &amp;quot;index_creation_date_millis&amp;quot;: 1743131249510,
      &amp;quot;time_since_index_creation&amp;quot;: &amp;quot;5.23d&amp;quot;,
      &amp;quot;lifecycle_date_millis&amp;quot;: 1743131249510,
      &amp;quot;age&amp;quot;: &amp;quot;5.23d&amp;quot;,
      &amp;quot;phase&amp;quot;: &amp;quot;hot&amp;quot;,
      &amp;quot;phase_time_millis&amp;quot;: 1743131249629,
      &amp;quot;action&amp;quot;: &amp;quot;complete&amp;quot;,
      &amp;quot;action_time_millis&amp;quot;: 1743131249829,
      &amp;quot;step&amp;quot;: &amp;quot;complete&amp;quot;,
      &amp;quot;step_time_millis&amp;quot;: 1743131249829,
      &amp;quot;phase_execution&amp;quot;: {
        &amp;quot;policy&amp;quot;: &amp;quot;delete-bms-indices-after-7days&amp;quot;,
        &amp;quot;phase_definition&amp;quot;: {
          &amp;quot;min_age&amp;quot;: &amp;quot;0ms&amp;quot;,
          &amp;quot;actions&amp;quot;: {
            &amp;quot;set_priority&amp;quot;: {
              &amp;quot;priority&amp;quot;: 100
            }
          }
        },
        &amp;quot;version&amp;quot;: 4,
        &amp;quot;modified_date_in_millis&amp;quot;: 1729673356681
      }
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h3&gt;
&lt;p&gt;çªç„¶éˆå…‰ä¸€é–ƒï¼ŒçŒœæ¸¬æœ‰å¯èƒ½æ˜¯å› ç‚ºindexæˆ‘æ˜¯ä»¥æœˆç‚ºå–®ä½ç•™å­˜çš„ï¼Œ&lt;br /&gt;
ç‚ºä»€éº¼indexä¸ä»¥å¤©ç•™å­˜å‘¢ï¼Ÿå› ç‚ºä»¥å‰æ›¾ç¶“ç™¼ç”Ÿésharedæ•¸é‡å¤ªå¤šï¼Œ&lt;br /&gt;
å°è‡´æ©Ÿå™¨å¡ä½ã€‚&lt;br /&gt;
ä½†åˆªé™¤çš„å¤©æ•¸æ˜¯14å¤©ï¼Œ&lt;br /&gt;
æ‰€ä»¥ilmåŸ·è¡Œæ™‚å°±ç›´æ¥å°‡é€™å€‹indexåˆªæ‰ã€‚&lt;/p&gt;
&lt;h3 id=&quot;æœªé©—è­‰&quot; tabindex=&quot;-1&quot;&gt;æœªé©—è­‰&lt;/h3&gt;
&lt;p&gt;å¦‚æœILMæ›´æ”¹å¾ˆå¤§ï¼Œä½†èˆŠçš„indexæ²’æœ‰é€²å…¥åˆ°æ–°çš„éšæ®µï¼Œ&lt;br /&gt;
è®“ILMé‡æ–°è©•ä¼°ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST _ilm/run
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœé‚„æ˜¯æ²’æˆåŠŸï¼Œ&lt;br /&gt;
æ‰‹å‹•å°‡indexæ¨åˆ°æ–°çš„phase&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /&amp;lt;your-index&amp;gt;/_ilm/move
{
  &amp;quot;current_step&amp;quot;: { &amp;quot;phase&amp;quot;: &amp;quot;hot&amp;quot;, &amp;quot;action&amp;quot;: &amp;quot;complete&amp;quot;, &amp;quot;name&amp;quot;: &amp;quot;complete&amp;quot; },
  &amp;quot;next_step&amp;quot;: { &amp;quot;phase&amp;quot;: &amp;quot;delete&amp;quot;, &amp;quot;action&amp;quot;: &amp;quot;delete&amp;quot;, &amp;quot;name&amp;quot;: &amp;quot;delete&amp;quot; }
}

&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/277. elastic ï¼Œindex æ¶ˆå¤±ç›¸é—œæŸ¥è©¢æ–¹å¼/" />
        </entry>
        <entry>
            <title>
                276. GKEç§æœ‰å¢é›†è¨­å®š Authorized networksï¼Œå‡ºç¾éŒ¯èª¤ private_endpoint_enforcement_enabled cannot be disabled on VPC peering based clusters
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/276. GKEç§æœ‰å¢é›†è¨­å®š Authorized networksï¼Œå‡ºç¾éŒ¯èª¤ private_endpoint_enforcement_enabled cannot be disabled on VPC peering based clusters/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;3/25 çœ‹åˆ°ä¸€å€‹æ–‡ç« &lt;a href=&quot;https://www.ithome.com.tw/news/168061&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç”¨æ–¼K8sçš„Ingress Nginx Controllerå­˜åœ¨é‡å¤§æ¼æ´ï¼Œ6,500å€‹å¢é›†ææ›éšª&lt;/a&gt;ï¼Œ&lt;br /&gt;
ç„¶å¾Œå°±ç‚¸äº†ã€‚&lt;br /&gt;
å¾Œä¾†æŸ¥äº†ä¸€ä¸‹æ”»æ“Šçš„æ–¹å¼ï¼Œ&lt;br /&gt;
å°±å†æŠŠGKEçš„å®‰å…¨æ€§æ‹‰é«˜é»å§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;NOTE&lt;/h1&gt;
&lt;p&gt;å¦‚æœClusteræœ‰ VPC peeringï¼Œ&lt;br /&gt;
è¨­å®šå®Œ Authorized networks ï¼Œè¦å­˜æª”æ™‚æœƒç›´æ¥å™´éŒ¯ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/276-fig.1.png&quot; alt=&quot;276-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è¨˜å¾—è¦æŠŠ&lt;code&gt;Enforce authorized networks on the control plane&#39;s internal endpoint&lt;/code&gt; é–‹å•Ÿã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡ä»¤çš„è©±ï¼Œå‰‡æ˜¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud container clusters update &amp;lt;cluster_name&amp;gt; &#92;
  --project=&amp;lt;project&amp;gt; &#92;
  --enable-master-authorized-networks &#92;
  --master-authorized-networks=&amp;lt;YOUR_IP_RANGE&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/276. GKEç§æœ‰å¢é›†è¨­å®š Authorized networksï¼Œå‡ºç¾éŒ¯èª¤ private_endpoint_enforcement_enabled cannot be disabled on VPC peering based clusters/" />
        </entry>
        <entry>
            <title>
                275. VPC network peering
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/275. VPC network peering/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;å…©å€‹clusterè¦ç”¨å…§ç¶²äº’ç›¸é€£ç·šï¼Œ&lt;br /&gt;
é™¤äº†share VPCï¼Œæ‡‰è©²å°±åªå‰©ä¸‹network peeringäº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;NOTE&lt;/h1&gt;
&lt;p&gt;å…ˆçœ‹Googleæ–‡ä»¶ï¼Œ&lt;a href=&quot;https://cloud.google.com/vpc/docs/vpc-peering?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;VPC ç¶²è·¯å°ç­‰äº’é€£&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é–‹é ­æœ‰æ˜ç¢ºå®šç¾©ï¼Œä¸èƒ½å°‡å…©å€‹è‡ªå‹•çš„VPCç¶²è·¯é€£åœ¨ä¸€èµ·ã€‚&lt;/p&gt;
&lt;p&gt;ç‚ºä»€éº¼ï¼Ÿ å› ç‚ºç¶²æ®µæœƒäº’ç›¸å¡åˆ°ä½ æƒ³å“­ã€‚&lt;br /&gt;
ä½†å…¶å¯¦ï¼Œä¸€å€‹autoä¸€å€‹Customæˆ‘å°±å·²ç¶“å¡åˆ°ç©ä¸ä¸‹å»äº†ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/275-fig.1.png&quot; alt=&quot;275-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è€Œä¸”å»ºè­°ï¼Œè¨­å®šæœ€å¥½åœ¨å…¶ä»–æœå‹™éƒ½é‚„æ²’ç”¨ä¹‹å‰è¨­å®šå¥½ã€‚&lt;br /&gt;
å› ä¹‹å‰æœ‰è¨­å®šredis network peering ï¼Œ&lt;br /&gt;
å°è‡´ç¾åœ¨ç„¡æ³•è¨­å®šæœƒå‡ºç¾éŒ¯èª¤ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/275-fig.2.png&quot; alt=&quot;275-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä¸ç„¶è¨­å®šé‚„æŒºç°¡å–®çš„ï¼Œ&lt;br /&gt;
åªè¦å…ˆåˆ°A projectè¨­å®šã€‚&lt;br /&gt;
å†åˆ°B projectè¨­å®šå°±é€šäº†ã€‚&lt;/p&gt;
&lt;p&gt;å‰ææ˜¯æ²’æœ‰ç¢°åˆ°ç¶²æ®µäº’å’¬çš„æƒ…æ³ã€‚&lt;br /&gt;
æª¢æŸ¥ç¶²æ®µæ™‚ï¼Œè¨˜å¾—å°‡ç¶²æ®µå±•é–‹ï¼Œ&lt;br /&gt;
ä¸ç„¶å¯èƒ½æœƒæœ‰æ‡·ç–‘Googleæ˜¯ä¸æ˜¯å“ªè£¡æéŒ¯äº†ï¼Œ&lt;br /&gt;
æˆ‘æ˜æ˜æ²’é€™å€‹ç¶²æ®µï¼Œç‚ºä»€éº¼æœƒè¡çªã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/275-fig.3.png&quot; alt=&quot;275-fig.3.png&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/275. VPC network peering/" />
        </entry>
        <entry>
            <title>
                274. github actionå»ºç«‹ self-host runner
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/274. github actionå»ºç«‹ self-host runner/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘é€™å¹¾å¤©æœ€å¤§çš„æ¶ˆæ¯ï¼Œ&lt;br /&gt;
æ‡‰è©²ç®—æ˜¯Nginx-ingress controller å‡ºç¾é‡å¤§æ¼æ´ã€‚&lt;br /&gt;
ä¸çŸ¥é“çš„å¯ä»¥çœ‹&lt;a href=&quot;https://www.ithome.com.tw/news/168061&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ–‡ç« &lt;/a&gt;&lt;br /&gt;
åˆç¿»äº†ä¸€ä¸‹æ¼æ´ç”¢ç”Ÿçš„åŸå› &lt;a href=&quot;https://www.wiz.io/blog/ingress-nginx-kubernetes-vulnerabilities&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;IngressNightmare: 9.8 Critical Unauthenticated Remote Code Execution Vulnerabilities in Ingress NGINX&lt;/a&gt;&lt;br /&gt;
æ‰€å¹¸ï¼Œæœ¬ä¾†å°±æ˜¯Private Clusterï¼Œä½†APIé‚£å±¤çš„Public Endpointsæ²’æª”ï¼Œ&lt;br /&gt;
ä¸€æª”ä¸‹å»ï¼Œæ›å‰ç«¯çš„Github actionsç„¡æ³•éƒ¨å±¬ï¼Œä½†Githubçš„&lt;a href=&quot;https://api.github.com/meta&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;IPåå–®&lt;/a&gt;å¤ªå¤šäº†ï¼Œåªå¥½æƒ³å…¶ä»–æ–¹å¼ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;æœ¬ä¾†æƒ³äº†å¥½å¹¾ç¨®æ–¹å¼ï¼Œä½†ä¸æ˜¯å› ç‚ºå¤ªè¤‡é›œå°±æ˜¯æ²’è¾¦æ³•åšï¼ˆæ™‚é–“ä¸å…è¨±ï¼‰ã€‚&lt;br /&gt;
å¾Œä¾†æƒ³åˆ°github actionçš„è‡ªå»ºrunnerï¼Œ&lt;br /&gt;
åœ¨æœ¬åœ°æ©Ÿæˆ¿å»ºå€‹ runnerï¼Œéƒ¨å±¬æ™‚æ”¹ç”¨é€™å€‹runnerå»åŸ·è¡Œï¼Œ&lt;br /&gt;
é‚£GKEçš„allow IPå°±ä¸ç”¨å†é¡å¤–å¢åŠ äº†ã€‚&lt;/p&gt;
&lt;h3 id=&quot;runner&quot; tabindex=&quot;-1&quot;&gt;å»ºç½®Runner&lt;/h3&gt;
&lt;p&gt;å»ºç«‹æ–¹å¼ï¼Œ&lt;a href=&quot;https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners/adding-self-hosted-runners&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;github èªªæ˜æ–‡ä»¶&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç°¡å–®æµç¨‹ï¼Œå°±æ˜¯åˆ°è¨­å®šé–‹å•Ÿaction çš„runneré¸å–®ï¼Œå†é»é¸New Runner ï¼Œ&lt;br /&gt;
é¸æ“‡ Self-hosted runnerï¼Œè¨­å®šå¥½å¾Œæœƒçœ‹åˆ°æ©Ÿå™¨å‘ˆç¾Idleçš„ç‹€æ…‹ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/274-fig.1.png&quot; alt=&quot;274-fig.1.png&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/274-fig.2.png&quot; alt=&quot;274-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€²å»å¾Œï¼Œç…§è‘—ä¸Šé¢çš„æŒ‡ä»¤åŸ·è¡Œå³å¯ï¼ˆè¨˜å¾—é¸å°å¹³å°åŠArchitectureï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¨­å®šå®Œå¾Œï¼Œæœ€å¾Œæœ‰ä¸€è¡ŒåŸ·è¡Œçš„æŒ‡ä»¤&lt;br /&gt;
&lt;code&gt;./run.sh&lt;/code&gt;&lt;br /&gt;
é€™é‚Šå»ºè­°ä¿®æ”¹ä¸€ä¸‹ï¼Œ&lt;br /&gt;
å¦‚æœä½ æ˜¯sshé€²å»Linuxæ©Ÿå™¨ï¼Œé‚£ç•¶ä½ æ–·æ‰é€£ç·šé€™å€‹æŒ‡ä»¤å°±æœƒå¤±æ•ˆäº†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¦æ”¹ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nohup ./run.sh &amp;gt; runner.log 2&amp;gt;&amp;amp;1 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç•¶é—œé–‰sshå¾ŒæŒ‡ä»¤ä»å¯åŸ·è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦è®Šæˆç³»çµ±æœå‹™çš„è©±ï¼Œé¿å…é‡é–‹æ©Ÿå¾Œï¼Œé‚„è¦é‡ä¸‹æŒ‡ä»¤ï¼Œ&lt;br /&gt;
å»ºè­°ç”¨systemdçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;h3 id=&quot;github-action&quot; tabindex=&quot;-1&quot;&gt;ä¿®æ”¹github action&lt;/h3&gt;
&lt;p&gt;é–‹å•Ÿ.github/workflowsçš„è³‡æ–™å¤¾ï¼Œçœ‹è£¡é¢å“ªäº›æµç¨‹è¦æ”¹ç”¨è‡ªæ¶çš„æ©Ÿå™¨ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬ä¾†æ˜¯  &lt;code&gt;runs-on: ubuntu-latest&lt;/code&gt; ï¼Œé€™å€‹æ˜¯githubé è¨­çš„runner&lt;br /&gt;
æ”¹æˆ &lt;code&gt;runs-on: self-hosted&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners/adding-self-hosted-runners&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Adding self-hosted runners&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners/monitoring-and-troubleshooting-self-hosted-runners&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Monitoring and troubleshooting self-hosted runners&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners/using-self-hosted-runners-in-a-workflow&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Using self-hosted runners in a workflow&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/274. github actionå»ºç«‹ self-host runner/" />
        </entry>
        <entry>
            <title>
                273. GCPæopenTelemetryç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/273. GCPæopenTelemetryç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;è¦é–‹å§‹å¼„Google Manage Prometheuså¾Œé¢ç°¡ç¨±GMPï¼Œ&lt;br /&gt;
è¦ç”¨GMPçš„è©±ï¼Œè’é›†metricå¯ä»¥ç”¨Googleçš„å¥—ä»¶ï¼Œ&lt;br /&gt;
ä¹Ÿå¯ä»¥ç”¨OpenTelemetry ï¼Œ&lt;br /&gt;
å› ç‚ºOpenTelemetryå¾Œé¢ç°¡ç¨±Otel ï¼Œå¯ä»¥é©ç”¨æ–¼æœªä¾†é‚„è¦å¼„çš„traceï¼Œ&lt;br /&gt;
æ—©æ™šéƒ½è¦æœƒçš„ï¼Œé‚£ä¸å¦‚å°±ä¸€æ¬¡ç¡¬ä¸Šå§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;h3 id=&quot;gcp-a-href-https-cloud-google-com-stackdriver-docs-managed-prometheus-setup-otel-hl-zh-cn-target-blank-class-external-link-open-telemetry-a&quot; tabindex=&quot;-1&quot;&gt;å…ˆçœ‹GCPçš„æ–‡ä»¶- &lt;a href=&quot;https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-otel?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;OpenTelemetry æ”¶é›†å™¨ä½¿ç”¨å…¥é–€&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;åŸºæœ¬å¯åˆ†æˆå¹¾å€‹æ­¥é©Ÿ&lt;/p&gt;
&lt;h3 id=&quot;1-workload-identity-service-account-monitoring-metric-writer-namespace-default&quot; tabindex=&quot;-1&quot;&gt;1. å¯¦ä½œworkload Identityï¼›å»ºç«‹ä¸€å€‹ServiceAccountæˆäºˆmonitoring.metricWriterçš„æ¬Šé™ï¼Œä¸¦ä¸”ç¶åœ¨namespaceçš„defaultä¸Šé¢ã€‚&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;kubectl create ns otel &#92;
&amp;amp;&amp;amp; 
gcloud config set project &amp;lt;project&amp;gt; &#92;
&amp;amp;&amp;amp;
gcloud iam service-accounts create gmp-test-sa &#92;
&amp;amp;&amp;amp;
gcloud iam service-accounts add-iam-policy-binding &#92;
  --role roles/iam.workloadIdentityUser &#92;
  --member &amp;quot;serviceAccount:&amp;lt;project&amp;gt;.svc.id.goog[otel/default]&amp;quot; &#92;
  gmp-test-sa@&amp;lt;project&amp;gt;.iam.gserviceaccount.com &#92;
&amp;amp;&amp;amp;
kubectl annotate serviceaccount &#92;
  --namespace otel &#92;
  default &#92;
  iam.gke.io/gcp-service-account=gmp-test-sa@&amp;lt;project&amp;gt;.iam.gserviceaccount.com &#92;
&amp;amp;&amp;amp;
gcloud projects add-iam-policy-binding &amp;lt;project&amp;gt;&#92;
  --member=serviceAccount:gmp-test-sa@&amp;lt;project&amp;gt;.iam.gserviceaccount.com &#92;
  --role=roles/monitoring.metricWriter
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;2-otel&quot; tabindex=&quot;-1&quot;&gt;2. è¨­å®šOtel&lt;/h3&gt;
&lt;p&gt;GCPæ–‡ä»¶å…ˆå¯«configï¼Œä¹Ÿä¸æ˜¯ä¸å¯ä»¥ã€‚&lt;br /&gt;
ä½†æˆ‘å»ºè­°ç›´æ¥å…ˆä¸Šdeployè·Ÿè¨­å®šå§ã€‚&lt;br /&gt;
ä¸‹æ–¹æœ‰ç°¡å–®çš„èªªæ˜configè¨­å®šåŠä¿®æ”¹éçš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: otel:prometheus-test
rules:
- apiGroups: [&amp;quot;&amp;quot;]
  resources:
  - pods
  verbs: [&amp;quot;get&amp;quot;, &amp;quot;list&amp;quot;, &amp;quot;watch&amp;quot;]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: otel:prometheus-test
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: otel:prometheus-test
subjects:
- kind: ServiceAccount
  namespace: otel
  name: default
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: otel-collector
  namespace: otel
spec:
  replicas: 1
  selector:
    matchLabels:
      app: otel-collector
      app.kubernetes.io/name: otel-collector
  template:
    metadata:
      labels:
        app: otel-collector
        app.kubernetes.io/name: otel-collector
      annotations:
        prometheus.io/port: &amp;quot;8888&amp;quot;
    spec:
      containers:
      - name: otel-collector
        image: otel/opentelemetry-collector-contrib:0.120.0
        ports:  
            - name: metrics
              containerPort: 8888
              protocol: TCP
            - name: otlp
              containerPort: 4317
              protocol: TCP
            - name: otlp-http
              containerPort: 4318
              protocol: TCP     
        args:
        - --config
        - /etc/otel/config.yaml
        - --feature-gates=exporter.googlemanagedprometheus.intToDouble
        volumeMounts:
        - mountPath: /etc/otel/
          name: otel-config
      volumes:
      - name: otel-config
        configMap:
          name: otel-config
---
apiVersion: v1
kind: Service
metadata:
  name: otel-collector
  namespace: otel
spec:
  selector:
    app: otel-collector
  ports:
    - protocol: TCP
      port: 8888
      targetPort: 8888
      name: metrics
---
kind: ConfigMap
apiVersion: v1
metadata:
  name: otel-config
  namespace: otel
data:
  config.yaml: |-
    receivers:
      prometheus:
        config:
          scrape_configs:
          - job_name: &#39;otel_k8s&#39;
            kubernetes_sd_configs:
            - role: pod
            relabel_configs:
            - source_labels: [__meta_kubernetes_pod_label_app_kubernetes_io_name]
              action: keep
              regex: (prom-example|kube-state-metrics|otel-collector)
            - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]
              action: replace
              target_label: __metrics_path__
              regex: (.+)
            - source_labels: [__address__, __meta_kubernetes_pod_annotation_prometheus_io_port]
              action: replace
              regex: (.+):(?:&#92;d+);(&#92;d+)
              replacement: $$1:$$2
              target_label: __address__
            - action: labelmap
              regex: __meta_kubernetes_pod_label_(.+)

    processors:
      resourcedetection:
        detectors: [gcp]
        timeout: 10s

      transform:
        # &amp;quot;location&amp;quot;, &amp;quot;cluster&amp;quot;, &amp;quot;namespace&amp;quot;, &amp;quot;job&amp;quot;, &amp;quot;instance&amp;quot;, and &amp;quot;project_id&amp;quot; are reserved, and
        # metrics containing these labels will be rejected.  Prefix them with exported_ to prevent this.
        metric_statements:
        - context: datapoint
          statements:
          - set(attributes[&amp;quot;exported_location&amp;quot;], attributes[&amp;quot;location&amp;quot;])
          - delete_key(attributes, &amp;quot;location&amp;quot;)
          - set(attributes[&amp;quot;exported_cluster&amp;quot;], attributes[&amp;quot;cluster&amp;quot;])
          - delete_key(attributes, &amp;quot;cluster&amp;quot;)
          - set(attributes[&amp;quot;exported_namespace&amp;quot;], attributes[&amp;quot;namespace&amp;quot;])
          - delete_key(attributes, &amp;quot;namespace&amp;quot;)
          - set(attributes[&amp;quot;exported_job&amp;quot;], attributes[&amp;quot;job&amp;quot;])
          - delete_key(attributes, &amp;quot;job&amp;quot;)
          - set(attributes[&amp;quot;exported_instance&amp;quot;], attributes[&amp;quot;instance&amp;quot;])
          - delete_key(attributes, &amp;quot;instance&amp;quot;)
          - set(attributes[&amp;quot;exported_project_id&amp;quot;], attributes[&amp;quot;project_id&amp;quot;])
          - delete_key(attributes, &amp;quot;project_id&amp;quot;)

      batch:
        # batch metrics before sending to reduce API usage
        send_batch_max_size: 200
        send_batch_size: 200
        timeout: 5s

      memory_limiter:
        # drop metrics if memory usage gets too high
        check_interval: 1s
        limit_percentage: 65
        spike_limit_percentage: 20

    # Note that the googlemanagedprometheus exporter block is intentionally blank
    exporters:
      googlemanagedprometheus:

    service:
      # æŠ“logå¤±æ•—åŸå› 
      # telemetry:
      #     logs:
      #         level: DEBUG    
      pipelines:
        metrics:
          receivers: [prometheus]
          processors: [batch, memory_limiter, resourcedetection, transform]
          exporters: [googlemanagedprometheus]
    
      telemetry:
        metrics:
          level: detailed
          readers:
            - pull:
                exporter:
                  prometheus:
                    host: &amp;quot;0.0.0.0&amp;quot;
                    port: 8888 

&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;a-deployment&quot; tabindex=&quot;-1&quot;&gt;a. deploymentè¨­å®š&lt;/h4&gt;
&lt;p&gt;annotationsä¸­ &lt;code&gt;prometheus.io/port: &amp;quot;8888&amp;quot;&lt;/code&gt; ï¼Œ&lt;br /&gt;
æ˜¯ç”±æ–¼è¦æŠ“å–otelçš„metricsï¼Œæ‰€ä»¥ç‰¹åˆ¥æŒ‡å®šçš„æ“·å–metrics portï¼Œ&lt;br /&gt;
ä¸ç„¶prometheusé è¨­æ“·å–ç¬¬ä¸€å€‹port 4317ã€‚&lt;/p&gt;
&lt;h4 id=&quot;b-config&quot; tabindex=&quot;-1&quot;&gt;b. configè¨­å®š&lt;/h4&gt;
&lt;p&gt;relabel_configsçš„source_labels &lt;code&gt;__meta_kubernetes_pod_label_app_kubernetes_io_name&lt;/code&gt;ï¼Œ&lt;br /&gt;
é€™é‚ŠæŒ‡å®šè¦æŠ“çš„metricsï¼Œéœ€é¡å¤–è£&lt;a href=&quot;https://github.com/kubernetes/kube-state-metrics&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;kube-state-metrics&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;prom-exampleæ˜¯prometheusçš„ç¯„ä¾‹æª”ï¼Œç”¨æ­¤å‘½ä»¤éƒ¨å±¬&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n otel apply -f https://raw.githubusercontent.com/GoogleCloudPlatform/prometheus-engine/v0.13.0/examples/example-app.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ”¶é›†å™¨é–‹å•ŸLOGç´€éŒ„(é™¤éŒ¯)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;service:
    telemetry:
        logs:
            level: DEBUG
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://github.com/open-telemetry/opentelemetry-collector-contrib/issues/32976&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Failed to scrape Prometheus endpoint&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‰“é–‹otelçš„port 8888 ï¼Œç‚ºäº†æ¥æ”¶åˆ°metricsã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;      telemetry:
        metrics:
          level: detailed
          readers:
            - pull:
                exporter:
                  prometheus:
                    host: &amp;quot;0.0.0.0&amp;quot;
                    port: 8888 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;otelçš„ configåŸºæœ¬æ¶æ§‹å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è¨­å®š&lt;/th&gt;
&lt;th&gt;ä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;receivers&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ¥æ”¶æ•¸æ“šï¼ˆPrometheus, OTLP, KubeletStats ç­‰ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;processors&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è™•ç†æ•¸æ“šï¼ˆæ‰¹é‡è™•ç†ã€è½‰æ›ã€éæ¿¾ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;exporters&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç™¼é€æ•¸æ“šåˆ°ä¸åŒå¾Œç«¯ï¼ˆPrometheus, Loki, OTLPï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;service.pipelines&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å®šç¾©æ•¸æ“šæµå‘ï¼ˆæ±ºå®šå“ªäº›æ•¸æ“šè¦é€åˆ°å“ªäº›åœ°æ–¹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;receiversï¼ˆæ¥æ”¶å™¨ï¼‰&lt;br /&gt;
ä½œç”¨ï¼šè² è²¬æ¥æ”¶ä¾†è‡ªä¸åŒä¾†æºçš„æ•¸æ“šï¼Œä¾‹å¦‚æŒ‡æ¨™ (metrics)ã€æ—¥èªŒ (logs)ã€è¿½è¹¤ (traces)ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://opentelemetry.io/docs/collector/configuration/#receivers&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Receivers&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;processorsï¼ˆè™•ç†å™¨ï¼‰&lt;br /&gt;
å°æ•¸æ“šé€²è¡Œè™•ç†ï¼Œå¦‚éæ¿¾ã€å¢å¼·ã€èšåˆã€‚&lt;br /&gt;
ref.&lt;a href=&quot;https://opentelemetry.io/docs/collector/configuration/#processors&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;processors&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;exportersï¼ˆå°å‡ºå™¨ï¼‰&lt;br /&gt;
ä½œç”¨ï¼šå°‡æ•¸æ“šå°å‡ºåˆ°æŒ‡å®šå¾Œç«¯ï¼Œä¾‹å¦‚ Prometheusã€Lokiã€OTLP æœå‹™ç­‰ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://opentelemetry.io/docs/collector/configuration/#exporters&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;exporters&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;serviceï¼ˆç®¡é“çµ„åˆï¼‰&lt;br /&gt;
ä½œç”¨ï¼šå®šç¾©ä¸åŒé¡å‹çš„æ•¸æ“šæ‡‰è©²å¦‚ä½•æµå‹•ï¼Œè¨­å®šæ¥æ”¶å™¨ã€è™•ç†å™¨ã€å°å‡ºå™¨çš„çµ„åˆæ–¹å¼ã€‚&lt;br /&gt;
ref.&lt;a href=&quot;https://opentelemetry.io/docs/collector/configuration/#service&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;service&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;p.s. é™„ä¸ŠOtel demoçš„&lt;a href=&quot;https://raw.githubusercontent.com/open-telemetry/opentelemetry-demo/main/kubernetes/opentelemetry-demo.yaml&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;yaml&lt;/a&gt;ï¼Œæœ‰ä¸€äº›åŸºæœ¬çš„è¨­å®šå¯ä»¥åœ¨é€™åƒè€ƒã€‚&lt;/p&gt;
&lt;h3 id=&quot;3-otel&quot; tabindex=&quot;-1&quot;&gt;3. é©—è­‰Otelè³‡æ–™&lt;/h3&gt;
&lt;p&gt;ç¢ºèªOtel-collectoræ²’æœ‰éŒ¯èª¤ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ cloud Metrics Exporerè¼¸å…¥ &lt;code&gt;up&lt;/code&gt; æ²’çœ‹åˆ°ç›®æ¨™å¢é›†&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/273-fig.1.png&quot; alt=&quot;273-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰“é–‹ clusterï¼Œå°‡&lt;code&gt;Cloud Monitoring&lt;/code&gt;çš„é¸é …æ‰“é–‹ï¼Œåªè¨­å®šsystemã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹å¾Œå°±æœƒçœ‹åˆ°å°æ‡‰çš„metrics&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/273-fig.2.png&quot; alt=&quot;273-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;4-grafana-gmp&quot; tabindex=&quot;-1&quot;&gt;4. ç”¨GrafanaæŸ¥çœ‹GMP&lt;/h3&gt;
&lt;p&gt;é€™ä¸ç®—æ˜¯Otelçš„ç›¸é—œæµç¨‹ï¼Œ&lt;br /&gt;
ä½†è¿½æ ¹ç©¶åº•ï¼Œç”¨äº†Otelçµ±æ•´è³‡æ–™ï¼Œæœ€å¾Œé‚„æ˜¯è¦çµ¦Grafanaä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h4 id=&quot;grafana-gmp-a-href-https-cloud-google-com-stackdriver-docs-managed-prometheus-query-target-blank-class-external-link-grafana-a&quot; tabindex=&quot;-1&quot;&gt;ä½¿ç”¨GrafanaæŸ¥è©¢GMPçš„æ–¹æ³•ï¼Œæ–‡ä»¶-&lt;a href=&quot;https://cloud.google.com/stackdriver/docs/managed-prometheus/query&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨ Grafana é€²è¡ŒæŸ¥è©¢&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Otel çš„grafanaæµç¨‹åœ–&lt;a href=&quot;https://opentelemetry.io/docs/demo/collector-data-flow-dashboard/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;èªªæ˜&lt;/a&gt;ï¼ŒGrafana dashboardå¯è‡³&lt;br /&gt;
&lt;a href=&quot;https://grafana.com/grafana/dashboards/18309-opentelemetry-collector-data-flow/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;grafana dashboard&lt;/a&gt;ä¸‹è¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨2025/03/20æ™‚ï¼Œæˆ‘ä½¿ç”¨ä¸Šé¢çš„dashboardï¼Œé è¨­æœ‰å¾ˆå¤šchartæ˜¯éŒ¯èª¤çš„ï¼Œ&lt;br /&gt;
è¿½æŸ¥æ˜¯å› ç‚ºå¾ˆå¤šmetricsçš„åç¨±è¢«æ”¹æ‰ï¼Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;otelcol_receiver_accepted_spans&lt;/code&gt;è¢«æ”¹æˆ &lt;code&gt;otelcol_receiver_accepted_metric_points_total&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;otelcol_receiver_refused_spans&lt;/code&gt;æ”¹ &lt;code&gt;otelcol_receiver_refused_metric_points_total&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;otelcol_receiver_accepted_metric_points&lt;/code&gt;æ”¹&lt;code&gt;otelcol_receiver_accepted_metric_points_total&lt;/code&gt;&lt;br /&gt;
..&lt;br /&gt;
é¡ä¼¼çš„é‚„æœ‰ä¸å°‘ï¼Œç•¶æœ‰éŒ¯èª¤æ™‚ï¼Œå¯ä»¥ç¢ºèªä¸€ä¸‹å…§å®¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸Šé¢éƒ½æ˜¯æˆ‘æœå°‹otel metricsçŒœçš„metricsï¼Œ&lt;br /&gt;
ä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯æ­£ç¢ºï¼Œä½†çœ‹èµ·ä¾†å¾ˆåƒä¸€å›äº‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/273-fig.3.png&quot; alt=&quot;273-fig.3.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;é¡Œå¤–è©±&quot; tabindex=&quot;-1&quot;&gt;é¡Œå¤–è©±&lt;/h3&gt;
&lt;p&gt;åˆ©ç”¨GPTå•ç­”æ™‚ï¼Œ&lt;br /&gt;
ä¹Ÿæœ‰çœ‹åˆ°å¦ä¸€ç¨®æ¶æ§‹ï¼Œ&lt;br /&gt;
ç•¶receiverséå¤šæ™‚ï¼Œåœ¨DaemonSetå»ºç«‹Otel-collectorï¼Œ&lt;br /&gt;
å†åŒ¯å…¥åˆ°ä¸€å€‹Otel ï¼Œä¹‹å¾Œå†ç”±é€™å€‹Otelæ±ºå®šè¦åˆ°å“ªå€‹Exporterã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/273. GCPæopenTelemetryç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                272. istioå°‡401çš„éŒ¯èª¤ï¼Œè‡ªå‹•è½‰æˆ503
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/272. istioå°‡401çš„éŒ¯èª¤ï¼Œè‡ªå‹•è½‰æˆ503/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;é€™å…¶å¯¦æ˜¯è »å¼”è©­çš„ç‹€æ³ï¼Œ&lt;br /&gt;
å¾Œç«¯ç¨‹å¼ï¼Œåœ¨æœ¬åœ°æ¸¬è©¦æ˜¯å›401 (Unauthorized)ï¼Œ&lt;br /&gt;
ä½†åˆ°äº†QAå°±è®Šæˆäº†502ã€‚&lt;br /&gt;
é€™ä»¶äº‹æˆ‘ä¹Ÿåªèƒ½åäº†ï¼Œé–‹å§‹æŸ¥å§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆæŸ¥ä¸€ä¸‹ï¼Œä»€éº¼æƒ…æ³ä¸‹æœƒè‡ªå‹•è½‰æˆ503ã€‚&lt;br /&gt;
æœå‹™æ”¾åœ¨GKEä¸Šï¼Œä¸¦ä¸”å°‡ç›®æ¨™Podçš„sidecaré—œé–‰ã€‚&lt;br /&gt;
ç›®æ¨™çš„Podç‚ºAï¼ŒåŒNamespcaeä¸åŒçš„Podç‚ºBã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¾å“ªè£¡å‘¼å«&lt;/th&gt;
&lt;th&gt;ç›®æ¨™ä½ç½®&lt;/th&gt;
&lt;th&gt;Status Code&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å¤–éƒ¨&lt;/td&gt;
&lt;td&gt;ç¶²å€ï¼Œistio è½‰åˆ°A Service&lt;/td&gt;
&lt;td&gt;502&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;B&lt;/td&gt;
&lt;td&gt;Pod A ip&lt;/td&gt;
&lt;td&gt;502&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;B&lt;/td&gt;
&lt;td&gt;Service A ip&lt;/td&gt;
&lt;td&gt;502&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;A&lt;/td&gt;
&lt;td&gt;Pod A ip&lt;/td&gt;
&lt;td&gt;401&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;A&lt;/td&gt;
&lt;td&gt;Service A ip&lt;/td&gt;
&lt;td&gt;401&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä½†å¦‚æœå°‡Bçš„sidecarä¹Ÿé—œé–‰ï¼Œ å‰‡åœ¨Bå‘¼å«Pod æˆ– Service éƒ½æœƒå›å‚³401ã€‚&lt;br /&gt;
é€™é‚Šå°±ä¸ç”±å¾—çŒœæƒ³æ˜¯istioæœ¬èº«çš„å•é¡Œã€‚&lt;/p&gt;
&lt;p&gt;æ–¼æ˜¯è‡ªå·±å¯«äº†å€‹Golangçš„å°ç¨‹å¼ï¼Œè‡ªè¨‚å›å‚³ç‹€æ…‹ç¢¼401ã€‚&lt;br /&gt;
ä¸€æ¸¬è©¦ç™¼ç¾ï¼Œæˆ‘å¾å¤–éƒ¨å‘¼å«ï¼ŒStatus codeæ˜¯æ­£å¸¸çš„å›å‚³401ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹ä¾†istioæ²’å•é¡Œï¼Œé‚£å°±åªå‰©ä¸‹ç¨‹å¼å•é¡Œï¼ˆç”©é‹å¤§æˆåŠŸï¼‰ã€‚&lt;br /&gt;
ç”¨curl -v æŸ¥çœ‹ 401çš„éŒ¯èª¤è¨Šæ¯ç™¼ç¾headeræœ‰ä¸‹é¢è¨Šæ¯ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/272-fig.1.png&quot; alt=&quot;272-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è½‰äº¤çµ¦RDï¼Œè«‹ä»–å€‘ç¢ºèªé€™é‚Šçš„è¨Šæ¯ã€‚&lt;br /&gt;
å¾Œä¾†æ”¹å®Œç¨‹å¼å¾Œå°±æ­£å¸¸äº†ã€‚&lt;/p&gt;
&lt;p&gt;åˆæ­¥ç ”åˆ¤æ‡‰è©²æ˜¯istioåˆ¤æ–·åˆ° headeræœ‰ä¸æ˜çš„è¨Šæ¯ï¼ˆè¦‹ä¸Šåœ–ï¼‰ï¼Œ&lt;br /&gt;
è§¸ç™¼Retryæ©Ÿåˆ¶ï¼Œä½†è§¸ç™¼å¤ªå¤šæ¬¡ï¼Œistioå°±ç›´æ¥å›å‚³502çš„éŒ¯èª¤ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/272. istioå°‡401çš„éŒ¯èª¤ï¼Œè‡ªå‹•è½‰æˆ503/" />
        </entry>
        <entry>
            <title>
                271. IOTè¨­å‚™è£PrometheusæRemote write
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/271. IOTè¨­å‚™è£PrometheusæRemote write/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;ç›£æ§IOTè¨­å‚™çš„ä¸€äº›åŸºç¤æ•ˆèƒ½ï¼Œ&lt;br /&gt;
node_exporterè£å¥½äº†ï¼Œ&lt;br /&gt;
ä½†æ˜¯æ€éº¼æŠŠmetricsä¸Ÿå‡ºå»..ï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;SOLUTION&lt;/h1&gt;
&lt;h3 id=&quot;å‰ç½®ä½œæ¥­&quot; tabindex=&quot;-1&quot;&gt;å‰ç½®ä½œæ¥­&lt;/h3&gt;
&lt;h4 id=&quot;node-exporter&quot; tabindex=&quot;-1&quot;&gt;åŸ·è¡Œnode_exporter&lt;/h4&gt;
&lt;p&gt;è®“node_exporterèƒŒæ™¯åŸ·è¡Œã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nohup ./node_exporter &amp;gt; node_exporter.log 2&amp;gt;&amp;amp;1 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;prometheus-server&quot; tabindex=&quot;-1&quot;&gt;Prometheus Serverè¨­å®š&lt;/h4&gt;
&lt;p&gt;éœ€é–‹å•Ÿ &lt;code&gt;remote-write-receiver&lt;/code&gt;ï¼Œ&lt;br /&gt;
åœ¨åƒæ•¸çš„åœ°æ–¹åŠ ä¸Š &lt;code&gt;--web.enable-remote-write-receiver&lt;/code&gt;ï¼Œ&lt;br /&gt;
ç„¶å¾Œç”±æ–¼è¦å°å¤–ï¼Œçœ‹ä½ æ˜¯ä½¿ç”¨å“ªç¨®æ–¹å¼ï¼Œå°±è¨­å®šå°å¤–ã€‚&lt;br /&gt;
è¨˜å¾—å®‰å…¨è¦åšå¥½ï¼Œçœ‹æ˜¯æª”IPæˆ–æ˜¯è¦ç”¨&lt;a href=&quot;https://prometheus.io/docs/prometheus/latest/configuration/https/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åŸºæœ¬é©—è­‰&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- name: prometheus-server
  image: &amp;quot;prom/prometheus:v2.48.0&amp;quot;
  imagePullPolicy: &amp;quot;IfNotPresent&amp;quot;
  args:
    - --web.enable-remote-write-receiver
    - --storage.tsdb.retention.time=95d
    - --config.file=/etc/config/prometheus.yml
    - --storage.tsdb.path=/data
    - --web.console.libraries=/etc/prometheus/console_libraries
    - --web.console.templates=/etc/prometheus/consoles
    - --web.enable-lifecycle
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;iot&quot; tabindex=&quot;-1&quot;&gt;IOTè¨­å‚™&lt;/h3&gt;
&lt;h4 id=&quot;step-1-prometheus&quot; tabindex=&quot;-1&quot;&gt;Step 1.  å®‰è£Prometheus&lt;/h4&gt;
&lt;p&gt;ç”±æ–¼é€™å€‹IOTè£ç½®ï¼Œæœ¬èº«æ˜¯busyboxï¼Œå¾ˆå¤šæ±è¥¿ä¸èƒ½ç”¨ï¼Œ&lt;br /&gt;
(apt,yum,apké€™äº›é€šé€šä¸æ”¯æ´)&lt;br /&gt;
æ‰€ä»¥æ˜¯å…ˆæŠŠå£“ç¸®åŒ…æ”¾åˆ°ftpï¼Œ&lt;br /&gt;
(ä¸‹è¼‰æ™‚å»ºè­°å…ˆç”¨&lt;code&gt;uname -a&lt;/code&gt;æª¢æŸ¥ä¸€ä¸‹OSç‰ˆæœ¬ï¼Œæˆ‘é€™éƒ½æ˜¯è£armçš„ç‰ˆæœ¬)&lt;br /&gt;
å†ç”¨sftpçš„æŒ‡ä»¤ä¸‹è¼‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sftp -P 222  abc@123.123.13.13
get prometheus.tar.gz
tar -zxvf prometheus.tar.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;step-2-remote-write&quot; tabindex=&quot;-1&quot;&gt;Step 2. remote writeè¨­å®šæª”&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;global:
  scrape_interval: 15s  # æ¯ 15 ç§’æŠ“å–ä¸€æ¬¡æ•¸æ“š
  evaluation_interval: 15s  # æ¯ 15 ç§’åŸ·è¡Œè¦å‰‡è©•ä¼°

scrape_configs:
  - job_name: &#39;node_exporter&#39;
    static_configs:
      - targets: [&#39;localhost:9100&#39;]

remote_write:
  - url: &amp;quot;https://remotewrite.test.com/api/v1/write&amp;quot;
    remote_timeout: 30s
    queue_config:
      batch_send_deadline: 5s
      max_samples_per_send: 100
      max_shards: 1
    write_relabel_configs:
      - source_labels: [__name__]
        regex: &amp;quot;.*&amp;quot;
        action: replace
        target_label: &amp;quot;iot&amp;quot;
        replacement: &amp;quot;shining_iot&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://prometheus.io/docs/prometheus/latest/configuration/configuration/#remote_write&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Remote_write config&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;step-3-prometheus&quot; tabindex=&quot;-1&quot;&gt;Step 3. åŸ·è¡ŒPrometheus&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;./prometheus --config.file ../prometheus.yml
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&quot;step-3-1&quot; tabindex=&quot;-1&quot;&gt;Step 3-1. é™¤éŒ¯&lt;/h5&gt;
&lt;p&gt;ç„¶å¾Œï¼ŒPrometheus Client å°±å‡ºéŒ¯äº†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;tls: failed to verify certificate: x509: certificate signed by unknown authority&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;çœ‹éŒ¯èª¤æ˜¯æ†‘è­‰éŒ¯èª¤ï¼Œæ‰€ä»¥å…ˆç”¨curlé©—è­‰ä¸€ä¸‹ï¼Œ&lt;br /&gt;
é€™å°æ©Ÿå™¨ä¹Ÿæ²’è¾¦æ³•è£curlï¼Œæ‰€ä»¥é‚„æ˜¯åªèƒ½å»ä¸‹è¼‰curlåˆ°ftpå¾Œï¼Œ&lt;br /&gt;
å†å»ftpä¸‹è¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨&lt;code&gt;curl -v&lt;/code&gt; åœ¨IOTè¨­å‚™ï¼Œé©—è­‰promtheus serverå¾Œå‡ºç¾éŒ¯èª¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -v https://remotewrite.test.com/api/v1/write
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;error setting certificate file: /etc/ssl/certs/ca-certificates.crt&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é€™æ¨£çœ‹èµ·ä¾†æ‡‰è©²éƒ½æ˜¯IOTè¨­å‚™æ²’æœ‰è£æ†‘è­‰å°è‡´ã€‚&lt;br /&gt;
é€écurlä¸‹è¼‰letsencryptæ†‘è­‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -o /etc/ssl/certs/ISRG_Root_X1.pem https://letsencrypt.org/certs/isrgrootx1.pem
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œä¸Šé¢æœ‰æåˆ°&lt;code&gt;curl -v&lt;/code&gt; é©—è­‰httpsæœƒç™¼ç”ŸéŒ¯èª¤ï¼Œ&lt;br /&gt;
æ‰€ä»¥ï¼Œç„¡æ³•ä¸‹è¼‰ã€‚&lt;br /&gt;
æ­¤æ™‚ï¼Œå›æ­¸è€æ–¹æ³•ï¼Œä¸‹è¼‰å¾Œä¸Ÿå»ftpï¼Œåœ¨å‚³åˆ°IOTè¨­å‚™ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹è¼‰å¾Œï¼Œæ ¹æ“šä¸Šé¢çš„éŒ¯èª¤è¨Šæ¯ï¼Œå»ºç«‹è³‡æ–™å¤¾&lt;br /&gt;
å°‡&lt;code&gt;isrgrootx1.pem&lt;/code&gt; æ”¹åæˆ &lt;code&gt;ca-certificates.crt&lt;/code&gt;æ”¾åˆ° &lt;code&gt;/etc/ssl/certs&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mkdir -p /etc/ssl/certs
cp isrgrootx1.pem /etc/ssl/certs/ca-certificates.crt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†é©—è­‰ä¸€æ¬¡ ï¼Œæ­£å¸¸ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -v https://remotewrite.test.com/api/v1/write
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;step-4-prometheus&quot; tabindex=&quot;-1&quot;&gt;Step 4. å†åº¦åŸ·è¡ŒPrometheus&lt;/h4&gt;
&lt;p&gt;é€™æ¬¡åŸ·è¡Œå¾Œï¼Œå‡ºç¾å¦ä¸€å€‹éŒ¯èª¤&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;level=ERROR source=db.go:1109 msg=&amp;quot;compaction failed&amp;quot; component=tsdb err=&amp;quot;preallocate: no space left on device&amp;quot;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æª¢æŸ¥ç¡¬ç¢Ÿç©ºé–“èˆ‡inodeéƒ½æœ‰è¶³å¤ çš„ç©ºé–“ï¼Œ&lt;br /&gt;
ç™¼ç”Ÿé€™ç¨®æƒ…æ³æ˜¯ç”±æ–¼Prometheusçš„WAL(é å¯«æ—¥èªŒ)çš„æ©Ÿåˆ¶ï¼Œ&lt;br /&gt;
ç‚ºäº†ä¿è­‰æ•¸æ“šå¯é æ€§ï¼Œæ‰€ä»¥æœƒæ ¹æ“šå…¬å¼æ¨å‡ºéœ€è¦å„²å­˜çš„å®¹é‡ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;needed_disk_space = retention_time_seconds * ingested_samples_per_second * bytes_per_sample
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://prometheus.io/docs/prometheus/latest/storage/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Prometheus Storage&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½†IOTè¨­å‚™ç©ºé–“æœ¬ä¾†å°±å°ï¼Œ&lt;br /&gt;
æ‰€ä»¥åªå¥½ç¸®ï¼ï¼ï¼&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./prometheus --storage.tsdb.retention.time=10m --storage.tsdb.retention.size=1MB --config.file ../prometheus.yml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€å¾Œåˆ°Prometheus Serverçœ‹çœ‹æœ‰æ²’æœ‰è³‡æ–™å‚³ä¸Šå»å°±å¥½äº†ã€‚&lt;br /&gt;
å‚³ä¸ä¸Šå»çš„è©±å°±æ˜¯çœ‹ä¸Šå‚³çš„åœ°æ–¹æ˜¯å¦æœ‰åœ°æ–¹è¦æ›´æ”¹ã€‚&lt;/p&gt;
&lt;h4 id=&quot;é¡Œå¤–è©±&quot; tabindex=&quot;-1&quot;&gt;é¡Œå¤–è©±&lt;/h4&gt;
&lt;p&gt;çœ‹åˆ°æœ‰äººèªªï¼Œé–‹å•ŸRemote Writeçš„è©±ï¼Œ&lt;br /&gt;
æœƒå°è‡´Serverè¨˜æ†¶é«”ä½¿ç”¨é‡ä¸Šå‡ã€‚&lt;br /&gt;
ç›®å‰é‚„æ²’å¤§é‡ä½¿ç”¨ï¼Œä¹Ÿåªèƒ½ç­‰åˆ°æ™‚å†çœ‹çœ‹ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://tsunejui.github.io/posts/prometheus-remote-write-performance-issue/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Prometheus Remote Write Performance Issue&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/271. IOTè¨­å‚™è£PrometheusæRemote write/" />
        </entry>
        <entry>
            <title>
                269. PVC backup and restore
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/269. PVC backup and restore/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;åˆä¾†å€‹å•é¡Œï¼ŒPVCæœ‰è¾¦æ³•å‚™ä»½å—ï¼Ÿ&lt;br /&gt;
æœ¬ä¾†æ˜¯æƒ³ç”¨ç¬¬äºŒå€‹æ›è¼‰volumeçš„æ–¹å¼ï¼Œ&lt;br /&gt;
å°‡è³‡æ–™å‚™ä»½å‡ºä¾†ï¼Œä½†GKEçš„volumeåªæ”¯æ´ReadWriteOnceã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;h4 id=&quot;step-1-a-href-https-kubernetes-io-zh-cn-docs-concepts-storage-volume-snapshots-target-blank-class-external-link-volumesnapshot-a&quot; tabindex=&quot;-1&quot;&gt;Step 1. æª¢æŸ¥æœ‰æ²’æœ‰æ”¯æ´ &lt;a href=&quot;https://kubernetes.io/zh-cn/docs/concepts/storage/volume-snapshots/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;volumesnapshot&lt;/a&gt;&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;kubectl api-resources | grep volumesnapshot
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ‰çš„è©±ï¼Œæ‡‰è©²æœƒçœ‹åˆ°é¡ä¼¼é€™æ¨£çš„è¨Šæ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/269-fig.1.png&quot; alt=&quot;269-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;step-2-pvc-csi-driver&quot; tabindex=&quot;-1&quot;&gt;Step 2. ç¢ºèªè¦å‚™ä»½pvcçš„CSI driver&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;é¡¯ç¤ºå…¨éƒ¨çš„CSI driver
kubectl get csidrivers

æ ¹æ“šstorageclassæŸ¥è©¢ï¼ˆProvisioneræ¬„ä½ï¼‰
kubectl get sc -o wide

æŸ¥pvçš„CSI driver(CSI.driveræ¬„ä½)
kubectl get pv &amp;lt;volume-name&amp;gt; -o yaml

&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;step-3-volume-snapshot-class&quot; tabindex=&quot;-1&quot;&gt;Step 3. å»ºç«‹VolumeSnapshotClass&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;kind: VolumeSnapshotClass
apiVersion: snapshot.storage.k8s.io/v1
metadata:
  name: volume-snapshot-class
  annotations:
    snapshot.storage.kubernetes.io/is-default-class: &amp;quot;true&amp;quot;
driver: pd.csi.storage.gke.io
deletionPolicy: Delete
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å»ºå®Œå¾Œï¼Œä½¿ç”¨ä¸‹é¢æŒ‡ä»¤æŸ¥çœ‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get vsclass
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;p.s. å¯ç”¨ &lt;code&gt;kubectl api-resources&lt;/code&gt; æŸ¥è©¢ç¸®å¯«&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://kubernetes.io/docs/concepts/storage/volume-snapshot-classes/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Volume Snapshot Classes&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;step-4-volume-snapshot&quot; tabindex=&quot;-1&quot;&gt;Step 4. å»ºç«‹VolumeSnapshot&lt;/h4&gt;
&lt;p&gt;æŒ‡å®šè¦å‚™ä»½çš„pvc&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: snapshot.storage.k8s.io/v1
kind: VolumeSnapshot
metadata:
  name: postgres-snapshot
  namespace: database
spec:
  volumeSnapshotClassName: volume-snapshot-class # change your vsclass
  source:
    persistentVolumeClaimName: postgres-pvc # change your pvc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å»ºå®Œå¾Œä½¿ç”¨ä¸‹é¢æŒ‡ä»¤æŸ¥çœ‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get volumesnapshots -n database
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŸæœ¬æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨vsä½œç‚ºç¸®å¯«ä»£æ›¿ï¼Œ&lt;br /&gt;
ä½†è·Ÿæˆ‘çš„virtualserviceè¡çªã€‚&lt;/p&gt;
&lt;p&gt;VolumeSnapshotåŸ·è¡Œå®Œå¾Œï¼Œæœƒè‡ªå‹•å»ºç«‹ä¸€å€‹VolumeSnapshotContentã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kc get vsc -n database
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/269-fig.2.png&quot; alt=&quot;269-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;step-5&quot; tabindex=&quot;-1&quot;&gt;Step 5. é‚„åŸ&lt;/h4&gt;
&lt;p&gt;å»ºç«‹ä¸€å€‹pvcä½¿ç”¨dataSourceçš„æ–¹å¼é‚„åŸï¼Œ&lt;br /&gt;
åº•ä¸‹çš„ storageClassNameã€&lt;a href=&quot;http://datasource.name/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;dataSource.name&lt;/a&gt; æ ¹æ“šæƒ…æ³ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: restore-pvc
  namespace: database
spec:
  storageClassName: standard-rwo
  dataSource:
    name: postgres-snapshot
    kind: VolumeSnapshot
    apiGroup: snapshot.storage.k8s.io
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 10Gi
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å–®ç´”åŸ·è¡Œå»ºç«‹pvcæ™‚ï¼Œå¦‚å‡ºç¾éŒ¯èª¤&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;waiting for first consumer to be created before binding&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é€™æ˜¯ç”±æ–¼storageClassçš„volumeBindingModeæ˜¯ &lt;code&gt;WaitForFirstConsumer&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥éœ€è¦å°‡deployèˆ‡pvcç¶å®šï¼Œæ‰èƒ½å‰µå»ºPVã€‚&lt;/p&gt;
&lt;p&gt;ä½†é€™å€‹åªèƒ½å‚™ä»½ä¸€æ¬¡ï¼Œ&lt;br /&gt;
é‚„å¿…é ˆæ‰‹å‹•ï¼Œ&lt;br /&gt;
æ‰€ä»¥è¦å…¨è‡ªå‹•çš„è©±ï¼Œ&lt;br /&gt;
å†çœ‹çœ‹è¦æ€éº¼æäº†ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/zh-cn/docs/concepts/storage/volume-snapshots/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å·å¿«ç…§&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://ibrahimhkoyuncu.medium.com/kubernetes-complete-guide-to-kubernetes-volumesnapshot-pvc-backup-and-restore-and-automated-2aade2a3a90a&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kubernetes â€” Complete Guide to Kubernetes VolumeSnapshot, PVC Backup and Restore, and Automated PVC Backup for Data Management&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/269. PVC backup and restore/" />
        </entry>
        <entry>
            <title>
                268. DNSæª”å»£å‘Šä¼ºæœå™¨-AdguardHome
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/268. DNSæª”å»£å‘Šä¼ºæœå™¨-AdguardHome/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æœ‰å¤©çœ‹æ–‡ç« æ™‚ï¼Œçœ‹åˆ°æœ‰äººä»‹ç´¹  &lt;a href=&quot;https://pi-hole.net/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Pi-Hole&lt;/a&gt;ï¼Œ&lt;br /&gt;
é€™æ˜¯ä¸€æ¬¾ DNS Sinkholeï¼Œç°¡å–®èªªå°±æ˜¯ç›´æ¥åœ¨DNSéæ¿¾å»£å‘Šã€‚&lt;br /&gt;
ç„¶å¾ŒæŸ¥äº†ä¸€ä¸‹ç›¸é—œè¨Šæ¯ï¼Œç™¼ç¾å¦ä¸€å¥— &lt;a href=&quot;https://adguard.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Adguard&lt;/a&gt;ï¼Œ&lt;br /&gt;
é€™å¥—ä»¥å‰å°±æœ‰çœ‹éï¼Œä½†è¦ä»˜è²»ã€‚&lt;br /&gt;
ä½†æ˜¯ï¼ï¼ï¼ä»–æœ‰æä¾›å…è²»ç‰ˆæœ¬ï¼Œå¯ä»¥æ›¿ä»£Pi-Holeã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;p&gt;éš¨ä¾¿æ‰¾ä¸€å°æ©Ÿå™¨ï¼Œä½¿ç”¨dockerå®‰è£ã€‚&lt;br /&gt;
ä¸‹é¢æä¾›docker-composeç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;version: &#39;3.8&#39;

services:
  adguardhome:
    image: adguard/adguardhome
    container_name: adguardhome
    restart: unless-stopped
    volumes:
      - ./data/workdir:/opt/adguardhome/work
      - ./date/confdir:/opt/adguardhome/conf
    ports:
      - &amp;quot;53:53/tcp&amp;quot;
      - &amp;quot;53:53/udp&amp;quot;
      - &amp;quot;3000:3000/tcp&amp;quot;
      - &amp;quot;3310:3310/tcp&amp;quot;
      - &amp;quot;784:784/udp&amp;quot;  # run AdGuard Home as a DNS-over-QUICâ  server. 
      - &amp;quot;853:853/udp&amp;quot;   # run AdGuard Home as a DNS-over-QUICâ  server. 
      - &amp;quot;8853:8853/udp&amp;quot;  # run AdGuard Home as a DNS-over-QUICâ  server. 
    networks:
      - adguard_network

networks:
  adguard_network:
    driver: bridge

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”±æ–¼æˆ‘æ˜¯ä½¿ç”¨dockerå°æ˜ portè½‰ç™¼ï¼Œ&lt;br /&gt;
æ‰€ä»¥ä½¿ç”¨æ©Ÿå™¨çš„ipå¾Œé¢åŠ ä¸Šport 3000ï¼Œ&lt;br /&gt;
æ­¤æ™‚æœƒåˆ°è¨­å®šç•«é¢ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/268-fig.1.png&quot; alt=&quot;268-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å°‡ä¸Šé¢çš„portï¼Œç”±é è¨­çš„80æ”¹ç‚º3310ã€‚&lt;br /&gt;
(å› ç‚ºæˆ‘æ©Ÿå™¨çš„80è¢«ç”¨èµ°äº†)ï¼Œ&lt;br /&gt;
å†ä¾†è¨­å®šå¸³å¯†ï¼Œä¹‹å¾Œéƒ½ç›´æ¥ä¸‹ä¸€æ­¥å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä½†åˆ°äº†é–‹å•Ÿå„€è¡¨æ¿çš„æŒ‰éˆ•æ™‚ï¼Œéœ€æ‰‹å‹•æ›´æ”¹ä½ç½®ã€‚&lt;br /&gt;
å› ç‚ºé è¨­é–‹å•Ÿçš„ä½ç½®æ˜¯ &lt;code&gt;172.31.0.2:3310&lt;/code&gt; ï¼Œ&lt;br /&gt;
é€™æ˜¯adguardçš„container ipã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/268-fig.2.png&quot; alt=&quot;268-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ”¹æˆä¸Šé¢é–‹å•Ÿè¨­å®šé é¢çš„ip åŠ ä¸Šå‰›å‰›è¨­å®šçš„port 3310, &lt;code&gt;192.168.103.224:3310&lt;/code&gt;&lt;br /&gt;
å°±èƒ½é–‹å•Ÿç™»å…¥é äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/268-fig.3.png&quot; alt=&quot;268-fig.3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è©³æƒ…åƒè€ƒ&lt;a href=&quot;https://adguard-dns.io/kb/zh-CN/adguard-home/getting-started/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å…¥é–€&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸æƒ³ä½¿ç”¨docker composeï¼Œ&lt;br /&gt;
&lt;a href=&quot;https://hub.docker.com/r/adguard/adguardhome&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;dockerhub&lt;/a&gt;ä¸Šé¢æœ‰æŒ‡ä»¤ã€‚&lt;br /&gt;
å¦‚æœç”¨docker runçš„è©±ï¼Œå¯èƒ½è¦çœ‹ä¸€ä¸‹æ‰“ç®—ç”¨å“ªå€‹portå»é–‹å•Ÿå„€è¡¨æ¿ã€‚&lt;br /&gt;
ä¸‹é¢çš„åœ–å°±ä¸å¤ªé©åˆäº†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker run --name adguardhome&#92;
    --restart unless-stopped&#92;
    -v /my/own/workdir:/opt/adguardhome/work&#92;
    -v /my/own/confdir:/opt/adguardhome/conf&#92;
    -p 53:53/tcp -p 53:53/udp&#92;
    -p 67:67/udp -p 68:68/udp&#92;
    -p 80:80/tcp -p 443:443/tcp -p 443:443/udp -p 3000:3000/tcp&#92;
    -p 853:853/tcp&#92;
    -p 784:784/udp -p 853:853/udp -p 8853:8853/udp&#92;
    -p 5443:5443/tcp -p 5443:5443/udp&#92;
    -d adguard/adguardhome

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹‹å¾Œè¨˜å¾—åˆ°è¦ä½¿ç”¨çš„è£ç½®ä¸Šé¢æ›´æ”¹dnsã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://hub.docker.com/r/adguard/adguardhome&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;docker hub adguard/adguardhome&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/AdguardTeam/AdGuardHome&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;github AdGuardHome&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://adguard-dns.io/kb/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;manual&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/268. DNSæª”å»£å‘Šä¼ºæœå™¨-AdguardHome/" />
        </entry>
        <entry>
            <title>
                267. cloudflare  308-ERR_TOO_MANY_REDIRECTS
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/267. cloudflare  308-ERR_TOO_MANY_REDIRECTS/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;éå¹´å‰ç™¼ç”Ÿçš„äº‹æƒ…ï¼Œ&lt;br /&gt;
åªè¦ç¶“écloudflareçš„CDNï¼Œå°±æœƒæœ‰æŸäº›æª”æ¡ˆæŠ“ä¸åˆ°ï¼Œ&lt;br /&gt;
ç¶²ç«™å°±ç›´æ¥å¡ä½ï¼Œå°±ç®—æ¸…äº†cloudflareçš„å¿«å–ï¼Œ&lt;br /&gt;
éä¸€é™£å­é‚„æ˜¯åœ¨å…¶ä»–åœ–ç‰‡ä¸Šå¡ä½ã€‚&lt;/p&gt;
&lt;h1 id=&quot;troubleshoting&quot; tabindex=&quot;-1&quot;&gt;Troubleshoting&lt;/h1&gt;
&lt;p&gt;é‚£æ™‚æ‡·ç–‘æ˜¯CDNçš„å•é¡Œï¼Œ&lt;br /&gt;
æ‰€ä»¥ç›´æ¥åœ¨ç¶²å€å¾Œé¢æ¥ä¸Š &lt;code&gt;cdn-cgi/trace&lt;/code&gt;ï¼Œ&lt;br /&gt;
å®Œæ•´ç¶²å€ï¼š&lt;code&gt;domain.com/cdn-cgi/trace&lt;/code&gt;&lt;br /&gt;
é€™æ¨£å°±èƒ½çœ‹åˆ°é€™å€‹æ˜¯èµ°å»å“ªé‚Šå–å¿«å–è³‡æ–™ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;fl=447f46
h=domain.com
ip=123.123.123.123
ts=1738566177.011
visit_scheme=https
uag=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
colo=LAX
sliver=none
http=http/3
loc=TW
tls=TLSv1.3
sni=plaintext
warp=off
gateway=off
rbi=off
kex=X25519MLKEM768
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://developers.cloudflare.com/fundamentals/reference/cdn-cgi-endpoint/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;/cdn-cgi/ endpoint&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç·Šæ€¥ä¿®å¾©ï¼Œé–‹å•Ÿé–‹ç™¼è€…æ¨¡å¼&lt;br /&gt;
åªèƒ½æ’ä¸‰å°æ™‚ï¼Œåˆ‡è¨˜ã€åˆ‡è¨˜ã€åˆ‡è¨˜ï¼Œ&lt;br /&gt;
é™¤éä½ è¦ç‰¹åœ°å¯«å€‹apiï¼Œä¸æ–·å»é»é–‹é—œã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/267-fig.1.png&quot; alt=&quot;267-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é—œé–‰CDN&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SSL/TLSåŠ å¯†(å¾…é©—è­‰)&lt;br /&gt;
ä¹‹å¾ŒæŸ¥äº†ä¸€äº›&lt;a href=&quot;https://developers.cloudflare.com/ssl/troubleshooting/too-many-redirects/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è³‡æ–™&lt;/a&gt;ï¼Œé€™å€‹éŒ¯èª¤éƒ½æ˜¯å› ç‚ºsslæ†‘è­‰ç™¼ç”Ÿå•é¡Œï¼Œ&lt;br /&gt;
ä¾‹å¦‚åŸæœ¬ç‚ºhttpsè¦è½‰åˆ°httpå°±æœƒç™¼ç”Ÿæ­¤éŒ¯èª¤ï¼Œ&lt;br /&gt;
å¾ˆå‰›å¥½ï¼Œä¹‹å‰çš„sslæ†‘è­‰é€™ä¸€å¡Šéƒ½æ˜¯æ¡ç”¨éˆæ´»ã€‚&lt;br /&gt;
åªæœ‰ä¸€é‚Šæœ‰é–é ­ï¼Œä½†å¦ä¸€é‚Šæ²’æœ‰ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/267-fig.2.png&quot; alt=&quot;267-fig.2.png&quot; /&gt;&lt;br /&gt;
ä½†é€™å€‹åˆä¸èƒ½é¦¬ä¸Šèªªæ”¹å°±æ”¹ï¼Œ&lt;br /&gt;
æœ‰äº›æ±è¥¿è¦æå‰ä½œæ¥­(cloudstorageçš„LBè¦æ”¹æˆhttps)ã€‚&lt;br /&gt;
å¹´å¾Œæ¸¬è©¦ä¸‹å»ï¼Œå°±æ­£å¸¸äº†æ­£å¸¸äº†ï¼Œ&lt;br /&gt;
æ‰€ä»¥æˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯SSLçš„å•é¡Œã€‚&lt;br /&gt;
ä½†å…¨éƒ½SSLæ†‘è­‰é‚„æ˜¯æ¯”è¼ƒå¥½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/267. cloudflare  308-ERR_TOO_MANY_REDIRECTS/" />
        </entry>
        <entry>
            <title>
                266. Promtail æ“·å–docker log
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/266. Promtail æ“·å–docker log/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;ä¹‹å‰æ˜¯ç”¨filebeatå°‡logä¸Ÿåˆ°EFKè£¡é¢&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/244.%20%E5%9C%A8GCE%E4%BD%BF%E7%94%A8filebeat%E5%82%B3%E5%88%B0GKE%E7%9A%84ECK/&quot;&gt;244. åœ¨GCEä½¿ç”¨filebeatå‚³åˆ°GKEçš„ECK&lt;/a&gt;&lt;br /&gt;
æœ€è¿‘æœ‰äº›æ¡ˆå­é–‹å§‹æ”¹ç”¨lokiäº†ï¼Œ&lt;br /&gt;
æ‰€ä»¥GCEé€™é‚Šä¹Ÿè¦è·Ÿè‘—æ”¹ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;å°ˆæ¡ˆè¶Šä¾†è¶Šå¤šï¼Œ&lt;br /&gt;
ä¹Ÿé–‹å§‹æ€è€ƒè¦ä¸è¦é‚£éº¼å¤šgrafanaäº†ã€‚&lt;br /&gt;
æ‰€ä»¥lokiçµ±ä¸€ä¸Ÿåˆ°åŒä¸€å°ä¸Šé¢ï¼Œ&lt;br /&gt;
é›–ç„¶èªªLokiå°æ–¼å…¨æ–‡æª¢ç´¢ä¸å¤ªé©åˆï¼Œ&lt;br /&gt;
ä½†å¦‚æœæ˜¯é‡å°æ™‚é–“æˆ³è¨˜çš„è©±æ˜¯é‚„è »å¥½ç”¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;Docker-compose.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;version: &#39;3.8&#39;

services:
  promtail:
    image: grafana/promtail:3.2.1
    container_name: promtail
    command: --config.file=/mnt/config/promtail-config.yaml
    volumes:
      - ./promtail.yaml:/mnt/config/promtail-config.yaml
      - /var/lib/docker/containers:/var/lib/docker/containers
    networks:
      - zlm_network


networks:
  zlm_network:
    driver: bridge
    name: zlm_network

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç°¡å–®æ›è¼‰promtailï¼Œé›–ç„¶å®˜æ–¹æ–‡ç« ä¹Ÿæœ‰æåˆ°ä½¿ç”¨&lt;a href=&quot;https://grafana.com/docs/loki/latest/send-data/docker-driver/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;docker driver&lt;/a&gt; ã€‚&lt;br /&gt;
ä½†æœ‰é»æ‡¶å¾—å†å¼„å…¶ä»–å¥—äº†ã€‚&lt;/p&gt;
&lt;p&gt;promtail.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server:
  http_listen_port: 9080
  grpc_listen_port: 0

clients:
- url: http://10.60.16.12:3100/loki/api/v1/push

positions:
  filename: /tmp/positions.yaml
target_config:
  sync_period: 10s
scrape_configs:
  - job_name: container_scrape # Job Name
    pipeline_stages:
        - docker: {}
        - static_labels: 
            project: &amp;quot;gr-video-qa&amp;quot;  
    docker_sd_configs: # ä½¿ç”¨ Docker Service Discovery
      - host: unix:///var/run/docker.sock # Docker Socket çš„ä½ç½®
        refresh_interval: 5s # æ¯ 5 ç§’é‡æ–°æƒæä¸€æ¬¡ Docker Socket
    relabel_configs: # å°‡ Docker ç›¸é—œçš„è³‡è¨Šè½‰æ›æˆ Label
      - source_labels: [&#39;__meta_docker_container_name&#39;] # å°‡ __meta_docker_container_name è½‰ç‚ºæ–°çš„åç‚º container çš„ Label
        regex: &#39;/(.*)&#39; # ä½¿ç”¨æ­£è¦è¡¨é”å¼å–å‡º Container Name
        target_label: &#39;container&#39;
      - source_labels: [&#39;__meta_docker_container_log_stream&#39;] # å°‡ __meta_docker_container_log_stream è½‰ç‚ºæ–°çš„åç‚º logstream çš„ Label
        target_label: &#39;logstream&#39;        

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;promtailçš„è¨­å®šæª”ï¼Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://grafana.com/docs/loki/latest/send-data/promtail/configuration/#pipeline_stages&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;pipeline_stages&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://grafana.com/docs/loki/latest/send-data/promtail/stages/static_labels/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;static_labels&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://grafana.com/docs/loki/latest/send-data/promtail/configuration/#docker_sd_configs&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;docker_sd_configs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä»–éƒ¨åˆ†ï¼Œåƒè€ƒ&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10331661&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Promtail â€” Loki å¾¡ç”¨ Log æ”¶é›†å™¨&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/266. Promtail æ“·å–docker log/" />
        </entry>
        <entry>
            <title>
                265. Golangç°¡ç•¥ç­†è¨˜ï¼ˆäºŒï¼‰
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/265. Golangç°¡ç•¥ç­†è¨˜ï¼ˆäºŒï¼‰/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æ‡¶æ˜¯å·¥ç¨‹å¸«çš„åŸå‹•åŠ›ï¼Œ&lt;br /&gt;
èµ·å› æ˜¯æˆ‘ä¸æƒ³è¦æ‰‹å‹•æ¯”å°å…©ä»½GCPåƒ¹æ ¼çš„é‡‘é¡æœ‰å“ªäº›å·®è·ã€‚&lt;br /&gt;
ç”¨excel vlookup æ‡‰è©²ä¹Ÿæ˜¯èƒ½è™•ç†ï¼Œä½†å¯èƒ½éœ€è¦é‡è¤‡çš„å‰ªå‰ªè²¼è²¼ï¼Œ&lt;br /&gt;
æˆ–æ˜¯å¯«æˆvbaï¼Œéƒ½è¦å¯«codeçš„è©±ï¼Œå°±ç›´æ¥å¯«å§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;å›å‚³æ™‚ï¼Œå¯ä»¥ç”¨ &lt;code&gt;_&lt;/code&gt; çœç•¥å›å‚³çš„åƒæ•¸&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åªå–å¾—rowå€¼ï¼Œå‚™å¿˜ä¸€ä¸‹&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;cell&lt;/th&gt;
&lt;th&gt;col&lt;/th&gt;
&lt;th&gt;row&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;A1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;A8&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;B1&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code&gt;_, lastEndRow := parseCell(merge.GetEndAxis())

// parseCell: å°‡ Excel çš„å„²å­˜æ ¼åç¨± (å¦‚ &amp;quot;A1&amp;quot;) è§£æç‚ºåˆ—è™Ÿèˆ‡è¡Œè™Ÿ
func parseCell(cell string) (col int, row int) {
	col, row, err := excelize.CellNameToCoordinates(cell)
	if err != nil {
		log.Fatalf(&amp;quot;è§£æå„²å­˜æ ¼åç¨±å¤±æ•—: %v&amp;quot;, err)
	}
	return col, row
}

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;æ‹†funcæ™‚ï¼Œå‚³é€æŒ‡æ¨™&lt;br /&gt;
è§£æexcelï¼Œä¸å¯é¿å…çš„å°±æ˜¯é–‹æª”ï¼Œ&lt;br /&gt;
ç”¨æŒ‡æ¨™çš„è©±&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é¿å…è¤‡è£½å¤§å‹çµæ§‹é«”&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;excelize.File&lt;/code&gt; å…§éƒ¨å¯èƒ½åŒ…å«å¤§é‡è³‡æ–™ï¼Œä¾‹å¦‚å·¥ä½œè¡¨ã€å„²å­˜æ ¼çš„å€¼å’Œæ ¼å¼ç­‰ã€‚å¦‚æœå‚³éæ•´å€‹çµæ§‹é«”ï¼Œè€Œä¸æ˜¯æŒ‡æ¨™ï¼ŒGo æœƒå°‡æ•´å€‹ç‰©ä»¶è¤‡è£½ä¸€ä»½ï¼Œé€™æœƒæµªè²»è¨˜æ†¶é«”å’Œè™•ç†æ™‚é–“ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æŒ‡æ¨™å¯ä»¥ç›´æ¥æ“ä½œåŸå§‹è³‡æ–™ï¼Œé¿å…ä¸å¿…è¦çš„è¤‡è£½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…è¨±ä¿®æ”¹åŸå§‹è³‡æ–™&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœä½ éœ€è¦å° &lt;code&gt;excelize.File&lt;/code&gt; åšä¿®æ”¹ï¼ˆä¾‹å¦‚æ›´æ–°å„²å­˜æ ¼çš„å€¼æˆ–æ–°å¢å·¥ä½œè¡¨ï¼‰ï¼ŒæŒ‡æ¨™è®“ä½ èƒ½å¤ ç›´æ¥æ“ä½œåŸå§‹ç‰©ä»¶ï¼Œè€Œä¸éœ€è¦å‚³å›æ–°çš„å‰¯æœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è³‡æºç®¡ç†&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;excelize.File&lt;/code&gt; å¯èƒ½æœƒé–‹å•Ÿæª”æ¡ˆä¸¦ä½”ç”¨ç³»çµ±è³‡æºã€‚ä½¿ç”¨æŒ‡æ¨™å¯ä»¥ç¢ºä¿åŒä¸€ä»½è³‡æºä¸æœƒè¢«è¤‡è£½ï¼Œæ–¹ä¾¿æ­£ç¢ºé—œé–‰æˆ–é‡‹æ”¾è³‡æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸Šè¿°åŸè©±ä¾†è‡ªchatGPT&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
func insertData(f *excelize.File, sheetName string, db *sql.DB) {
....
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;æ•¸å­—è½‰å­—ä¸²&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;moneyCell := &amp;quot;H&amp;quot; + strconv.Itoa(lastEndRow)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;
&lt;p&gt;outputçš„å·®ç•°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½è¨­è¨ˆä¸åŒ&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;- &lt;code&gt;fmt&lt;/code&gt;ï¼šç”¨æ–¼æ™®é€šçš„è¼¸å‡ºå’Œæ ¼å¼åŒ–ï¼Œæ›´å¤šçš„æ˜¯ç”¨ä¾†è™•ç†ç¨‹åºæ­£å¸¸é‹è¡Œæ™‚çš„è¼¸å‡ºã€‚&lt;br /&gt;
- &lt;code&gt;log&lt;/code&gt;ï¼šå°ˆé–€ç”¨æ–¼è¨˜éŒ„äº‹ä»¶ã€éŒ¯èª¤å’Œè¨ºæ–·ç¨‹åºå•é¡Œï¼Œé€šå¸¸æœƒè‡ªå‹•æ·»åŠ æ™‚é–“æˆ³ï¼Œè®“è¨˜éŒ„æ›´æ–¹ä¾¿æª¢ç´¢ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨å ´æ™¯ä¸åŒ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;fmt&lt;/code&gt; é©åˆç”¨æ–¼æ ¼å¼åŒ–å’Œæ‰“å°æ™®é€šçš„è¼¸å‡ºå…§å®¹ï¼ˆå¦‚ç¨‹åºçš„æ­£å¸¸è¼¸å‡ºæˆ–è¼¸å…¥æç¤ºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;log&lt;/code&gt; é©åˆç”¨æ–¼è¨˜éŒ„é—œéµäº‹ä»¶ï¼ˆå¦‚éŒ¯èª¤æ—¥èªŒã€èª¿è©¦è³‡è¨Šï¼‰ï¼Œç‰¹åˆ¥æ˜¯éœ€è¦åŒ…å«æ™‚é–“æˆ³çš„æƒ…æ³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éŒ¯èª¤è™•ç†çš„éœ€æ±‚&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;fmt&lt;/code&gt; æ›´åå‘æ–¼ç°¡å–®çš„è¼¸å‡ºï¼Œä¸é—œæ³¨ç¨‹åºçš„é‹è¡Œç‹€æ…‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;log&lt;/code&gt; æä¾›å°ˆé–€çš„æ–¹æ³•ï¼ˆå¦‚ &lt;code&gt;log.Fatal&lt;/code&gt; å’Œ &lt;code&gt;log.Panic&lt;/code&gt;ï¼‰ï¼Œå¯ä»¥å¿«é€Ÿè¼¸å‡ºéŒ¯èª¤ä¸¦ä¸­æ­¢ç¨‹åºåŸ·è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸Šä¾†è‡ªChatGPT&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;å…©è€…éƒ½æœ‰Print,Printf,Println&lt;br /&gt;
åˆ†åˆ¥ä»£è¡¨ åˆ—å°ï¼Œæ ¼å¼åŒ–åˆ—å°(%s,%d)ï¼Œæ›è¡Œåˆ—å°ã€‚&lt;/p&gt;
&lt;p&gt;éŒ¯èª¤è¨Šæ¯  fmt.Errorf èˆ‡ log.Fatalf ï¼Œ&lt;br /&gt;
å‰è€…æ˜¯å›å‚³errorï¼Œå¾Œè€…å‰‡è¼¸å‡ºéŒ¯èª¤è¨Šæ¯ä¸¦çµæŸç¨‹å¼&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥SQLiteçš„è»Ÿé«”&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://sqlitebrowser.org/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;DB Browser for SQLite&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;brew install db-browser-for-sqlite
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&quot;conclusion&quot; tabindex=&quot;-1&quot;&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;ChatGPTå¾ˆå¥½ç”¨æ²’éŒ¯ï¼Œ&lt;br /&gt;
ä¸ç„¶é€™å€‹ç¨‹å¼èŠ±çš„æ™‚é–“å¯èƒ½è¦æ›´ä¹…ï¼Œ&lt;br /&gt;
éœ€è¦å…ˆæŸ¥è¦ç”¨å“ªå€‹å¥—ä»¶ï¼Œåˆ¤æ–·å“ªäº›å„²å­˜æ ¼æ˜¯åˆä½µçš„ï¼Œ&lt;br /&gt;
å†å–ä»–å¾Œé¢æ¬„ä½çš„å€¼ï¼Œå»ºç«‹sqliteã€tableï¼Œinsertï¼Œupdateã€‚&lt;br /&gt;
å› ç‚ºä¸åªä¸€å€‹sheetè¦åšï¼Œæ‰€ä»¥å°‡åŸæœ¬func mainåº•ä¸‹çš„ç¨‹å¼é‡æ§‹ã€‚&lt;br /&gt;
è®“ç¨‹å¼ç°¡æ½”é»ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼ŒGPTä¹Ÿæ˜¯æœ‰å¹»è¦ºï¼Œæˆ‘è¦è¨ˆç®—SQL Aè·ŸB æ¬„ä½çš„å·®è·(C)ï¼Œ&lt;br /&gt;
Aå·²ç¶“æœ‰å€¼ï¼ŒBæ˜¯updateå¾Œæ‰æœ‰å€¼ï¼Œ&lt;br /&gt;
åŒæ™‚è¨ˆç®—Cçš„è©±ï¼Œæœƒè®ŠæˆNULLã€‚&lt;br /&gt;
GPTè·Ÿæˆ‘èªªèƒ½åŒæ™‚è¨ˆç®—ï¼Œè·Ÿæˆ‘å°è±¡ä¸­çš„ä¸ä¸€æ¨£ï¼Œ&lt;br /&gt;
æˆ‘ä¸€å†ç¢ºèªï¼ŒGPTé‚„æ˜¯èªªå¯ä»¥(æšˆ)ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/265. Golangç°¡ç•¥ç­†è¨˜ï¼ˆäºŒï¼‰/" />
        </entry>
        <entry>
            <title>
                264. use golang debug on mac m3
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/264. use golang debug on mac m3/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;ä¹‹å‰çš„ç­†é›»æ˜¯mbp ï¼Œé‚£æ™‚é‚„æ˜¯intelçš„ç­†é›»ã€‚&lt;br /&gt;
æ›ä¾†mbaä¹‹å¾Œï¼Œè®Šæˆm3çš„è¨˜æ†¶é«”äº†ã€‚&lt;br /&gt;
åŸ·è¡Œgo çš„ç¨‹å¼éƒ½æ²’å•é¡Œï¼Œ&lt;br /&gt;
åªè¦ç”¨vscode debugå°±ç›´æ¥å™´éŒ¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Failed to launch: could not launch process: can not run under Rosetta, check that the installed build of Go is right for your CPU architecture.
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;p&gt;å…ˆç¢ºèª goçš„ç‰ˆæœ¬&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;go version
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœé¡¯ç¤ºçš„æ˜¯&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;go version go1.23.4 darwin/amd64&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;éœ€æ”¹å®‰è£ arm64ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœç”¨&lt;code&gt;brew install go&lt;/code&gt; ï¼Œæœƒè‡ªå‹•åˆ¤æ–·ä½ çš„golangç‰ˆæœ¬ï¼Œ&lt;br /&gt;
æ‰€ä»¥ä¸éœ€é¡å¤–ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå¦‚æœä½ ä¹‹å‰æ˜¯ç”¨pkgå®‰è£çš„è©±ï¼Œ&lt;br /&gt;
ä½ æœƒç™¼ç¾ç”¨brewæ€æ¨£å®‰è£ï¼Œç‰ˆæœ¬éƒ½æ”¹ä¸éå»ã€‚&lt;br /&gt;
å°±ç®—å®‰è£å¾Œç§»é™¤å†é‡è£ï¼Œä¹Ÿæ˜¯ä¸€æ¨£ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œç›´æ¥åˆ°&lt;a href=&quot;https://go.dev/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®˜ç¶²&lt;/a&gt;ä¸‹è¼‰æ­£ç¢ºç‰ˆæœ¬å§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;toubleshooting&quot; tabindex=&quot;-1&quot;&gt;Toubleshooting&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;go env&lt;/code&gt; æœƒçœ‹åˆ°GOPATH æ˜¯å»ºç«‹åœ¨ &lt;code&gt;/home/user/go&lt;/code&gt;ï¼Œ&lt;br /&gt;
ä½†&lt;code&gt;.zshrc&lt;/code&gt;è£¡é¢ä¸¦æ²’æœ‰é€™å€‹è¨­å®šæª”ï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ˜¯ç”±æ–¼ åœ¨ Go 1.11 ç‰ˆæœ¬ä¹‹åï¼ŒGo å¼•å…¥äº† &lt;strong&gt;Go Modules&lt;/strong&gt;ï¼Œä¸¦é»˜èªä¸åœ¨ä¾è³´ &lt;code&gt;GOPATH&lt;/code&gt; by ChatGPT&lt;/p&gt;
&lt;/blockquote&gt;

            </content>
            <link href="https://daimom.github.io/264. use golang debug on mac m3/" />
        </entry>
        <entry>
            <title>
                263. Linux æŸ¥çœ‹æ–‡ä»¶å…§å®¹
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/263. Linux æŸ¥çœ‹æ–‡ä»¶å…§å®¹/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;å…¶å¯¦å¾ˆå°‘ç”¨åˆ°ï¼Œ&lt;br /&gt;
ä½†æ–°æœå‹™å‰›æ¶èµ·ä¾†çš„æ™‚å€™ï¼Œ&lt;br /&gt;
å°±çœŸçš„å¾ˆéœ€è¦ä»–ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;h4 id=&quot;cat&quot; tabindex=&quot;-1&quot;&gt;Cat&lt;/h4&gt;
&lt;p&gt;æœ€åŸºç¤çš„ç”¨æ³•&lt;br /&gt;
ç¼ºé»æ˜¯ï¼Œç•¶å…§å®¹å¤ªå¤šæ™‚ï¼Œæœƒå¾ˆé›£çœ‹ï¼Œ&lt;br /&gt;
æ­¤æ™‚èƒ½æ­é…&lt;code&gt;grep&lt;/code&gt;åšå…§å®¹æœå°‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cat 123.log
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;head&quot; tabindex=&quot;-1&quot;&gt;head&lt;/h4&gt;
&lt;p&gt;å–æ–‡å­—æª”çš„æœ€ä¸Šé¢å¹¾è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;head -n 10 123.log
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;tail&quot; tabindex=&quot;-1&quot;&gt;tail&lt;/h4&gt;
&lt;p&gt;å–æ–‡å­—æª”çš„æœ€å¾Œé¢å¹¾è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tail -n 10 123.log
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;man&quot; tabindex=&quot;-1&quot;&gt;man&lt;/h4&gt;
&lt;p&gt;æŸ¥è©¢æŒ‡ä»¤ç”¨æ³•ï¼Œ&lt;br /&gt;
æœ‰æ™‚ç”¨ &lt;code&gt;&amp;lt;command&amp;gt; -h&lt;/code&gt; æœƒæ‰¾ä¸åˆ°ä½¿ç”¨æ–¹å¼ï¼Œ&lt;br /&gt;
æ­¤æ™‚å¯ç”¨ &lt;code&gt;man &amp;lt;command&amp;gt;&lt;/code&gt; å»æœå°‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;man find
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœè¦åšåˆ°å¾ŒçºŒçš„è™•ç†ï¼Œå¯«shellscriptï¼Œ&lt;br /&gt;
&lt;code&gt;awk&lt;/code&gt; èˆ‡ &lt;code&gt;xargs&lt;/code&gt; éƒ½æ˜¯å¸¸ç”¨çš„æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.trevorlasn.com/blog/10-essential-terminal-commands-every-developer-should-know&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;10 Essential Terminal Commands Every Developer Should Know&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/263. Linux æŸ¥çœ‹æ–‡ä»¶å…§å®¹/" />
        </entry>
        <entry>
            <title>
                262. PostgreSQL on k8s
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/262. PostgreSQL on k8s/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;RDèªªä»–çš„è³‡æ–™åº«ç”¨é‡æ‡‰è©²æ˜¯å¾ˆå°ã€éå¸¸å°ï¼Œ&lt;br /&gt;
æ‰€ä»¥ç”¨ä¸åˆ°GCPçš„Cloud SQLï¼Œ&lt;br /&gt;
åŠ ä¸Šä»–çš„è³‡æ–™ï¼Œæ ¹æ“šä»–æœ¬äººèªªæ³•ï¼Œä¸é‡è¦ï¼Œéš¨æ™‚å¯ä»¥åˆªé™¤ã€‚&lt;br /&gt;
æ‰€ä»¥å°±è‡ªå·±å»ºäº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;h3 id=&quot;å®‰è£&quot; tabindex=&quot;-1&quot;&gt;å®‰è£&lt;/h3&gt;
&lt;p&gt;æŸ¥äº†ä¸€å€‹ä¸Šåˆï¼Œ&lt;br /&gt;
é‚„æ˜¯ä¸€æ•´å€‹æ··äº‚ï¼Œçœ‹èµ·ä¾†å¤§éƒ¨åˆ†çš„äººéƒ½æ˜¯ç”¨Helmæ¶è¨­çš„ã€‚&lt;br /&gt;
ç„¶å¾Œéƒ½æ˜¯æœé«˜å¯ç”¨æ€§ä¸‹å»åŸ·è¡Œã€‚&lt;br /&gt;
ä½†æˆ‘æ‡‰è©²æ˜¯ç”¨ä¸åˆ°ï¼Œè¦åˆ°é”é«˜å¯ç”¨æ€§å°±ç”¨GCPåŸç”Ÿæ–¹æ¡ˆäº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ€å¾Œå•äº†GPTï¼Œæ­·ç¶“äº†ä¸€äº›éŒ¯èª¤ã€‚&lt;br /&gt;
æå‡ºäº†ä¸‹é¢çš„yamlã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
kind: Namespace
metadata:
  name: database
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: postgresql
  namespace: database
  labels:
    app: postgresql
spec:
  replicas: 1
  selector:
    matchLabels:
      app: postgresql
  template:
    metadata:
      labels:
        app: postgresql
    spec:
      containers:
      - name: postgres
        image: postgres:17
        ports:
        - containerPort: 5432
        env:
        - name: POSTGRES_USER
          value: admin
        - name: POSTGRES_PASSWORD
          value: ifQiD
        - name: POSTGRES_DB
          value: main
        - name: PGDATA
          value: /var/lib/postgresql/data/pgdata
        volumeMounts:
        - name: postgres-data
          mountPath: /var/lib/postgresql/data
      volumes:
      - name: postgres-data
        persistentVolumeClaim:
          claimName: postgres-pvc
---
apiVersion: v1
kind: Service
metadata:
  name: postgresql
  namespace: database
  labels:
    app: postgresql
spec:
  type: ClusterIP
  ports:
  - port: 5432
    targetPort: 5432
  selector:
    app: postgresql
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: postgres-pvc
  namespace: database
spec:
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 10Gi

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;é©—è­‰é€£ç·š&quot; tabindex=&quot;-1&quot;&gt;é©—è­‰é€£ç·š&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;apt update
apt install postgresql-client

&lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#é©—è­‰ç‰ˆæœ¬&quot;&gt;#é©—è­‰ç‰ˆæœ¬&lt;/a&gt;
psql --version

# connection
psql -h postgresql.database.svc.cluster.local -p 5432 -U admin -d main


# ç¢ºèªç›®å‰é€£æ¥çš„è³‡æ–™åº«
SELECT current_database();

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h3&gt;
&lt;p&gt;å¦‚æœè¦æ”¹ç”¨é«˜å¯ç”¨æ€§çš„è©±ï¼ŒGCPæ–‡ä»¶æœ‰æ•™å­¸ï¼Œ&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/tutorials/stateful-workloads/postgresql?hl=zh-cn#deploy-postgresql&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åœ¨ GKE ä¸Šéƒ¨ç½²é«˜å¯ç”¨æ€§ PostgreSQL è³‡æ–™åº«&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿæœ‰&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/tutorials/stateful-workloads/mysql?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åœ¨ GKE ä¸Šéƒ¨ç½²æœ‰ç‹€æ…‹ MySQL å¢é›†&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;è£œå……èªªæ˜&quot; tabindex=&quot;-1&quot;&gt;è£œå……èªªæ˜&lt;/h3&gt;
&lt;p&gt;Artifact Hub ï¼š CNCFåŸºé‡‘æœƒå­µåŒ–å°ˆé–€ç”¨ä¾†å°‹æ‰¾é›²ç«¯è»Ÿé«”çš„ç¶²é ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cncf.io/blog/2024/09/17/artifact-hub-becomes-a-cncf-incubating-project/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Artifact Hub becomes a CNCF incubating project&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://artifacthub.io/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Artifact Hub&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/262. PostgreSQL on k8s/" />
        </entry>
        <entry>
            <title>
                261. Lokiç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/261. Lokiç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;å¥½è¨˜æ€§ï¼Œä¸å¦‚çˆ›ç­†é ­ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;ol start=&quot;0&quot;&gt;
&lt;li&gt;
&lt;p&gt;Grafana  Observerbilityå®¶æ—&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Grafanaï¼šæä¾›å¼·å¤§å¯è¦–åŒ–å’Œç›£æ§åŠŸèƒ½çš„é–‹æºå¹³å°ï¼Œæ”¯æ´å¤šç¨®æ•¸æ“šä¾†æºå’Œå¤–æ›ï¼Œé©ç”¨æ–¼æ§‹å»ºå„é¡å„€è¡¨æ¿ã€‚&lt;/li&gt;
&lt;li&gt;Prometheusï¼šä¸€å€‹é–‹æºç³»çµ±ç›£æ§å’Œè­¦å ±å·¥å…·ï¼Œå°ˆé–€è¨­è¨ˆç”¨ä¾†æ”¶é›†æ™‚åºæ•¸æ“šï¼Œä¸¦èˆ‡ Grafana æ•´åˆï¼Œé©åˆç”¨æ–¼å¾®æœå‹™æ¶æ§‹çš„ç›£æ§ã€‚&lt;/li&gt;
&lt;li&gt;AlertManagerï¼šPrometheus çš„å‘Šè­¦ç®¡ç†å…ƒä»¶ï¼Œè² è²¬è™•ç†å‘Šè­¦çš„è·¯ç”±å’Œé€šçŸ¥ï¼Œç¢ºä¿åŠæ™‚éŸ¿æ‡‰ç³»çµ±ç•°å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;Grafana Lokiï¼šå°ˆç‚ºæ—¥èªŒèšåˆè¨­è¨ˆçš„ç³»çµ±ï¼Œèƒ½å¤ é«˜æ•ˆåœ°æ”¶é›†å’ŒæŸ¥è©¢æ—¥èªŒæ•¸æ“šï¼Œä¸¦èˆ‡ Grafana ç„¡ç¸«æ•´åˆï¼Œé©åˆç”¨æ–¼å¾®æœå‹™ç’°å¢ƒçš„æ—¥èªŒç›£æ§ã€‚&lt;/li&gt;
&lt;li&gt;Grafana Tempoï¼šåˆ†ä½ˆå¼è¿½è¹¤ç³»çµ±ï¼Œå°ˆé–€è¨­è¨ˆç”¨ä¾†è¿½è¹¤å’Œåˆ†æå¾®æœå‹™ä¹‹é–“çš„è«‹æ±‚è·¯å¾‘ï¼Œå¹«åŠ©è­˜åˆ¥æ€§èƒ½ç“¶é ¸ã€‚&lt;/li&gt;
&lt;li&gt;Grafana Mimirï¼šé«˜å¯æ“´å±•çš„æ™‚åºæ•¸æ“šå­˜å„²ç³»çµ±ï¼Œé©åˆè™•ç†å¤§è¦æ¨¡ç›£æ§æ•¸æ“šçš„å­˜å„²éœ€æ±‚ï¼Œæä¾›é«˜æ•ˆçš„æŸ¥è©¢æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;Grafana Alloyï¼šå¼·åŒ–å¯è§€æ¸¬æ€§çš„è§£æ±ºæ–¹æ¡ˆï¼Œå°ˆæ³¨æ–¼æä¾›çµ±ä¸€çš„æ•¸æ“šèšåˆå’Œåˆ†æèƒ½åŠ›ï¼Œå¹«åŠ©ä½¿ç”¨è€…æ›´å¥½åœ°ç†è§£å’Œå„ªåŒ–å…¶æ‡‰ç”¨æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10354224&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¾Œ Grafana æ™‚ä»£çš„ç¬¬äº”å¤© - æ¢è¨ Grafana å¤§è¦æ¨¡ä¸­å¿ƒåŒ–æ¶æ§‹çš„æ¼”è®Š&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Lokiä¸»è¦åˆ†æˆå…©ç¨®æª”æ¡ˆé¡å‹ï¼Œä¸€ç¨®æ˜¯indexï¼Œå¦ä¸€ç¨®æ˜¯chunkã€‚&lt;br /&gt;
å‰è€…ä½œç‚ºç´¢å¼•ç›®éŒ„è¡¨ï¼Œå¾Œè€…æ˜¯å„²å­˜logã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;TheÂ &lt;a href=&quot;https://grafana.com/docs/loki/latest/get-started/architecture/#index-format&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;&lt;strong&gt;index&lt;/strong&gt;&lt;/a&gt;Â is a table of contents of where to find logs for a specific set of labels.&lt;br /&gt;
TheÂ &lt;a href=&quot;https://grafana.com/docs/loki/latest/get-started/architecture/#chunk-format&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;&lt;strong&gt;chunk&lt;/strong&gt;&lt;/a&gt;Â is a container for log entries for a specific set of labels&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨schema_configè£¡é¢ä»£è¡¨çš„æ¬„ä½ç‚º &lt;code&gt;store&lt;/code&gt; èˆ‡ &lt;code&gt;object_store&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The simple scalable deployment mode can scale up to a few TBs of logs per day&lt;br /&gt;
helméƒ¨å±¬lokiæ˜¯æ¡ç”¨ç°¡å–®éƒ¨å±¬ï¼Œä½†ç°¡å–®éƒ¨å±¬å·²å¯é”åˆ°æ¯å¤©TBç­‰ç´šçš„è³‡æ–™ã€‚&lt;br /&gt;
è¶…ééœ€è¦æ”¹ç”¨microservicesã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://grafana.com/docs/loki/latest/get-started/deployment-modes/#simple-scalable&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;simple-scalable&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;Promtail&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;Promtail is feature complete. All future feature development will occur in Grafana Alloy.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‚³é€è³‡æ–™æ™‚ï¼Œ&lt;br /&gt;
å¯å…ˆç”¨dry-runé©—è­‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cat my.log | promtail --stdin --dry-run --inspect --client.url http://127.0.0.1:3100/loki/api/v1/push
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://grafana.com/docs/loki/latest/send-data/promtail/troubleshooting/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Troubleshooting Promtail&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10331661&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Promtail â€” Loki å¾¡ç”¨ Log æ”¶é›†å™¨&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;lokièªæ³•æŸ¥è©¢&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;|=&lt;/code&gt;Â (contains string) and&lt;/li&gt;
&lt;li&gt;&lt;code&gt;!=&lt;/code&gt;Â (does not contain string) over the regular expression filter operators:&lt;/li&gt;
&lt;li&gt;&lt;code&gt;|~&lt;/code&gt;Â (matches the regular expression)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;!~&lt;/code&gt;Â (does not match the regular expression)&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;Explorer Logs&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é…åˆLokiå¥½ç”¨çš„å¥—ä»¶ï¼Œå¯ç›´æ¥çœ‹åˆ°æ‰€æœ‰çš„Logã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/261-fig.1.png&quot; alt=&quot;261-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è¦ä½¿ç”¨&lt;a href=&quot;https://grafana.com/docs/loki/latest/visualize/grafana/#explore-logs&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Explore Logs&lt;/a&gt;](&lt;a href=&quot;https://grafana.com/docs/loki/latest/visualize/grafana/#explore-logs&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;https://grafana.com/docs/loki/latest/visualize/grafana/#explore-logs&lt;/a&gt;)ï¼Œéœ€æ›´æ–°åˆ° Grafana 11.3ã€‚&lt;/p&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;Lokiå¯ä»¥ç„¡ç¸«éŠœæ¥ä½¿ç”¨æ–°çš„å„²å­˜ç³»çµ±&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ç¯€éŒ„è‡ª &lt;a href=&quot;https://grafana.com/docs/loki/latest/operations/storage/tsdb/#single-store-tsdb-tsdb&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Single Store TSDB (tsdb)&lt;/a&gt;&lt;br /&gt;
æœ‰å…©å€‹storeçš„ç‰ˆæœ¬ï¼Œå‡è¨­ä»Šå¤©æ˜¯ 2023-01-04 ï¼Œ&lt;br /&gt;
å¯ä»¥æŒ‡å®š 2023-01-05å¾Œï¼Œæ”¹ä½¿ç”¨å¦ä¸€å€‹storeã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;schema_config:
  configs:
    # Old boltdb-shipper schema. Included in example for reference but does not need changing.
    - from: &amp;quot;2023-01-03&amp;quot; # &amp;lt;---- A date in the past
      index:
        period: 24h
        prefix: index_
      object_store: gcs
      schema: v12
      store: boltdb-shipper
    # New TSDB schema below
    - from: &amp;quot;2023-01-05&amp;quot; # &amp;lt;---- A date in the future
      index:
        period: 24h
        prefix: index_
      object_store: gcs
      schema: v13
      store: tsdb
...

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;7&quot;&gt;
&lt;li&gt;loki vs elastic search&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;lokiçš„æ¶æ§‹æ¯”è¼ƒé©åˆLow-cardinalityã€‚&lt;br /&gt;
elkå‰‡å¯ä»¥æ”¯æ´åˆ° High-cardinalityã€‚&lt;/p&gt;
&lt;p&gt;Low-cardinalityè¡¨ç¤ºä¸€åˆ—æœ‰å¾ˆå¤šé‡è¤‡çš„å€¼. æ€§åˆ¥/å§“åéƒ½ç®—æ˜¯ä½åŸºæ•¸.&lt;br /&gt;
High-cardinalityæ„å‘³è‘—è©²åˆ—åŒ…å«å¾ˆå¤§æ¯”ä¾‹çš„å”¯ä¸€å€¼. æ‰€ä»¥åƒUniqueID, UUIDé€™æ¨£çš„å€¼åœ¨è©²åˆ—å‰‡èƒ½ç¨±ç‚ºé«˜åŸºæ•¸.&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10287270&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;## æ·ºè«‡Observability(ä¸Š)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Loki ä¸å°Logå…§å®¹é€²è¡Œç´¢å¼•ï¼Œåƒ…ç´¢å¼•Logçš„labelã€‚&lt;br /&gt;
ELKå‰‡æœƒé‡å°æ¯å€‹å­—æ®µåšç´¢å¼•ï¼Œæ•…å¯ä»¥ç”¨å…¨æ–‡æª¢ç´¢ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ELKï¼ˆElasticsearchï¼‰é©åˆå ´æ™¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€è¦å°High-cardinalityå­—æ®µï¼ˆå¦‚å”¯ä¸€ IDã€IP åœ°å€ã€ç”¨æˆ¶åç­‰ï¼‰é€²è¡ŒæŸ¥è©¢å’Œåˆ†æã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒè¤‡é›œçš„å…¨æ–‡æª¢ç´¢ã€èšåˆå’Œç¯©é¸éœ€æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;é¡˜æ„æ¥å—æ›´é«˜çš„å­˜å„²å’Œé‹è¡Œæˆæœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Loki é©åˆå ´æ™¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é‡é»æ˜¯æ™‚é–“åºåˆ—æ—¥å¿—åˆ†æï¼Œæ¨™ç±¤æ•¸é‡æœ‰é™ï¼ˆLow-cardinalityï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸éœ€è¦å°æ—¥å¿—çš„è©³ç´°å­—æ®µé€²è¡Œé«˜å¡è«¾æ€§æŸ¥è©¢ï¼Œè€Œæ˜¯æ›´å¤šé—œæ³¨åŸºæ–¼æ™‚é–“ç¯„åœçš„æ—¥å¿—æœç´¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;8&quot;&gt;
&lt;li&gt;Lokiæ—¥èªŒä¿å­˜&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸»è¦æ˜¯ä¸‹é¢é€™äº›ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;limits_config:
  max_label_names_per_series: 20
  max_cache_freshness_per_query: 10m
  query_timeout: 300s
  reject_old_samples: true
  reject_old_samples_max_age: 168h
  split_queries_by_interval: 15m
  volume_enabled: true
  retention_period: 750h
compactor:
  working_directory: /var/loki/data/retention
  retention_enabled: true
  delete_request_store: filesystem
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;retention_enabledï¼š ä¸€å®šè¦è¨­&lt;br /&gt;
delete_request_storeï¼šçœ‹æ˜¯è¦åˆªé™¤é‚£é‚Šçš„æª”æ¡ˆï¼Œæˆ‘çš„object_storeä½¿ç”¨filesystemã€‚&lt;br /&gt;
retention_periodï¼šå°±çœ‹è¦ä¿ç•™å¤šä¹…äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œï¼Œlokiçš„ä½¿ç”¨é‡çœŸçš„ä½ï¼Œprometheueä½¿ç”¨é‡é‚„æ¯”ä»–é«˜ï¼ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://grafana.com/docs/loki/latest/operations/storage/retention/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Log retention&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;9&quot;&gt;
&lt;li&gt;å¤§å°å¯«å¿½ç•¥&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åœ¨dashboardçš„æ™‚å€™ï¼Œå¢åŠ ä¸€å€‹textboxä¾›ä½¿ç”¨è€…æŸ¥è©¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/261-fig.2.png&quot; alt=&quot;261-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦æœå°‹å¤šå€‹å­—ä¸²çš„è©±ï¼Œä¸èƒ½ç”¨ &lt;code&gt;|=&lt;/code&gt; è¦ä½¿ç”¨ &lt;code&gt;|~&lt;/code&gt; æ­£å‰‡è¡¨ç¤ºã€‚&lt;br /&gt;
å¿½ç•¥å¤§å°å¯«å‰‡æ˜¯ &lt;code&gt;(?i)&lt;/code&gt;&lt;br /&gt;
æ•´åˆèµ·ä¾†å°±æ˜¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{service_name=`control`} | json |~ &amp;quot;(?i)$search&amp;quot; | logfmt | drop __error__, __error_details__
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/261. Lokiç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                260. Grafana è®Šæ•¸é€£å‹•
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/260. Grafana è®Šæ•¸é€£å‹•/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;å»¶çºŒä¸Šä¸€ç¯‡ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/259.%20Loki%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E9%AB%94%E9%A9%97/&quot;&gt;259. Lokiå¿«é€Ÿä¸Šæ‰‹é«”é©—&lt;/a&gt; çš„æ•ˆæœã€‚&lt;br /&gt;
è¦è®“logæ›´å¥½ç”¨çš„è©±ï¼Œéœ€è¦å¹¾å€‹è®Šæ•¸ï¼Œ&lt;br /&gt;
åŸæœ¬æ˜¯æƒ³åšåˆ°ç•¶æŒ‰ä¸‹Labelæ™‚ï¼Œå¯ä»¥ç›´æ¥é€£å‹•è®Šæ•¸ï¼Œ&lt;br /&gt;
å¯æƒœé‚„æ²’æœ‰æ‰¾åˆ°ç›¸é—œè³‡æ–™ï¼Œåªå¥½å…ˆç”¨ä¸‹æ‹‰é¸å–®åšé€£å‹•è®Šæ•¸ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;é€£å‹•è®Šæ•¸ï¼Œé¦–å…ˆé‡å°çš„éƒ½æ˜¯æœ‰ç¬¬ä¸€å€‹ä¾†æºï¼Œ&lt;br /&gt;
ç¬¬äºŒå€‹æ‰èƒ½æ ¹æ“šç¬¬ä¸€å€‹çš„é¸æ“‡å»ä½œæŸ¥è©¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/260-fig.1.png&quot; alt=&quot;260-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€å€‹æ˜¯namespaceï¼Œç¬¬äºŒå€‹deploymentå°±æ˜¯filter namespaceçš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¾†æºæ˜¯Prometheusï¼Œ&lt;br /&gt;
å› ç‚ºå¦‚æœé¸Lokiçš„è©±ï¼Œæ²’æœ‰è¾¦æ³•ç”¨Query Resultå»åšï¼Œ&lt;br /&gt;
åªèƒ½ç”¨label nameæˆ– label valueã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/260-fig.2.png&quot; alt=&quot;260-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åœ–ç‰‡ä¸­é–“çš„Regexçš„æ„æ€æ˜¯ï¼Œ&lt;br /&gt;
å–å¾— kube_deployment_labelsåº•ä¸‹ deploymentçš„å€¼ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/260-fig.3.png&quot; alt=&quot;260-fig.3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰å±¤åŒæ¨£çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;è‡³æ–¼ç‚ºä»€éº¼æœƒåˆ°ä¸‰å±¤ï¼Œå› ç‚ºå¯¦å‹™ä¸Šæœ‰ç¢°åˆ°ï¼Œç•¶å¤šå€‹podçš„æ™‚å€™ï¼Œ&lt;br /&gt;
ä½ æœƒéœ€è¦çœ‹ç‰¹å®špodçš„logã€‚&lt;/p&gt;
&lt;p&gt;æœ€å¾Œ dashboardçš„metricsï¼ŒPanelé¸æ“‡Logsã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{namespace=&amp;quot;$namespace&amp;quot;, pod=~&amp;quot;.*$Deploy.*&amp;quot;, pod=~&amp;quot;$Pod&amp;quot;} |= ``
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/260-fig.4.png&quot; alt=&quot;260-fig.4.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é¸æ“‡Lokièˆ‡Grafanaçš„å¥½è™•åœ¨æ–¼ï¼Œ&lt;br /&gt;
ç•¶ä½ çœ‹åˆ°ç•°å¸¸é«˜å³°çš„metricsæ™‚ï¼Œ&lt;br /&gt;
å¯ä»¥ç›´æ¥çœ‹åˆ°logï¼Œä¸ç”¨å†è·‘å»å¦ä¸€å€‹åœ°æ–¹æŸ¥ï¼Œ&lt;br /&gt;
ä¹Ÿå¯ä»¥èªªæ˜¯ &lt;s&gt;æ‡¶äººçš„ä½œæ³•&lt;/s&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/260. Grafana è®Šæ•¸é€£å‹•/" />
        </entry>
        <entry>
            <title>
                259. Lokiå¿«é€Ÿä¸Šæ‰‹é«”é©—
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/259. Lokiå¿«é€Ÿä¸Šæ‰‹é«”é©—/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æ–°çš„æœå‹™åˆæ›ä¸Šå»äº†ï¼Œ&lt;br /&gt;
æœ¬ä¾†æƒ³ç¹¼çºŒæ›EFKçµ¦äººç”¨ï¼Œ&lt;br /&gt;
ä½†çœ‹äº†ä¸€ä¸‹ï¼Œå¦‚æœç›£æ§çš„åŒæ™‚å¯ä»¥é †ä¾¿çœ‹Logå¥½åƒä¹Ÿä¸éŒ¯ã€‚&lt;br /&gt;
ç›£æ§æ˜¯grafanaï¼Œé‚£logåªèƒ½æ˜¯ lokiäº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;p&gt;å…ˆä¾†çœ‹ä¸€ä¸‹æˆæœã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/259-fig.1.png&quot; alt=&quot;259-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;1-loki&quot; tabindex=&quot;-1&quot;&gt;1. éƒ¨å±¬ Loki&lt;/h3&gt;
&lt;p&gt;æˆ‘æ˜¯ç›´æ¥å¾istio(1.21.1)ï¼Œå°‡loki.yamlç›´æ¥æ‹¿å‡ºä¾†éƒ¨å±¬ã€‚&lt;br /&gt;
è·¯å¾‘åœ¨&lt;code&gt;istio-1.21.1/samples/addons/loki.yaml&lt;/code&gt;&lt;br /&gt;
&lt;a href=&quot;https://github.com/istio/istio/blob/1.21.1/samples/addons/loki.yaml&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;github&lt;/a&gt;&lt;br /&gt;
åŸæœ¬çš„æ²’æœ‰namespaceï¼Œéœ€è¦çš„è‡ªè¡Œå¢åŠ ï¼Œ&lt;br /&gt;
å¦å‰‡ç›´æ¥éƒ¨å±¬å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&quot;2-promtail&quot; tabindex=&quot;-1&quot;&gt;2. éƒ¨å±¬ Promtail&lt;/h3&gt;
&lt;p&gt;å†ä¾†ï¼Œéƒ¨å±¬Promtailå°‡ pod logä¸Ÿåˆ°lokiè£¡é¢ã€‚&lt;br /&gt;
k8sçš„è©±å»ºè­°ä½¿ç”¨ DaemonSetçš„æ–¹æ³•å»ºã€‚&lt;br /&gt;
å¦‚æœæƒ³ç”¨å…¶ä»–æ–¹å¼ï¼Œè«‹æ´½&lt;a href=&quot;https://grafana.com/docs/loki/latest/send-data/promtail/installation/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;install-promtail&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é€™é‚Šå”¯ä¸€è¦æ”¹çš„æ˜¯Lokiçš„ä½ç½®ï¼Œ&lt;br /&gt;
Configmapï¼špromtail-config&lt;br /&gt;
åº•ä¸‹çš„ &lt;code&gt;data.clients.url&lt;/code&gt; æ”¹ç‚ºä½ çš„loki ipã€‚&lt;br /&gt;
å»ºç«‹loki svcæ™‚çš„portç‚º3100ï¼Œ&lt;br /&gt;
æ–¼æ˜¯ &lt;code&gt;http://loki.istio-system.svc.cluster.local/loki/api/v1/push&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¸€é–‹å§‹æ¸¬è©¦æ™‚ï¼Œå¯ä»¥å…ˆåˆ°ä»»ä¸€podè£¡é¢ï¼Œå‘¼å« readyçš„apiï¼Œ&lt;br /&gt;
æ­£å¸¸çš„è©±æœƒå›å¾©ä¸€å€‹readyçš„å­—ä¸²ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl http://loki.istio-system.svc.cluster.local/ready
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://grafana.com/docs/loki/latest/reference/loki-http-api/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Loki HTTP API&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;--- # Daemonset.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: promtail-daemonset
spec:
  selector:
    matchLabels:
      name: promtail
  template:
    metadata:
      labels:
        name: promtail
    spec:
      serviceAccount: promtail-serviceaccount
      containers:
      - name: promtail-container
        image: grafana/promtail
        args:
        - -config.file=/etc/promtail/promtail.yaml
        env: 
        - name: &#39;HOSTNAME&#39; # needed when using kubernetes_sd_configs
          valueFrom:
            fieldRef:
              fieldPath: &#39;spec.nodeName&#39;
        volumeMounts:
        - name: logs
          mountPath: /var/log
        - name: promtail-config
          mountPath: /etc/promtail
        - mountPath: /var/lib/docker/containers
          name: varlibdockercontainers
          readOnly: true
      volumes:
      - name: logs
        hostPath:
          path: /var/log
      - name: varlibdockercontainers
        hostPath:
          path: /var/lib/docker/containers
      - name: promtail-config
        configMap:
          name: promtail-config
--- # configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: promtail-config
data:
  promtail.yaml: |
    server:
      http_listen_port: 9080
      grpc_listen_port: 0

    clients:
    - url: https://{YOUR_LOKI_ENDPOINT}/loki/api/v1/push

    positions:
      filename: /tmp/positions.yaml
    target_config:
      sync_period: 10s
    scrape_configs:
    - job_name: pod-logs
      kubernetes_sd_configs:
        - role: pod
      pipeline_stages:
        - docker: {}
      relabel_configs:
        - source_labels:
            - __meta_kubernetes_pod_node_name
          target_label: __host__
        - action: labelmap
          regex: __meta_kubernetes_pod_label_(.+)
        - action: replace
          replacement: $1
          separator: /
          source_labels:
            - __meta_kubernetes_namespace
            - __meta_kubernetes_pod_name
          target_label: job
        - action: replace
          source_labels:
            - __meta_kubernetes_namespace
          target_label: namespace
        - action: replace
          source_labels:
            - __meta_kubernetes_pod_name
          target_label: pod
        - action: replace
          source_labels:
            - __meta_kubernetes_pod_container_name
          target_label: container
        - replacement: /var/log/pods/*$1/*.log
          separator: /
          source_labels:
            - __meta_kubernetes_pod_uid
            - __meta_kubernetes_pod_container_name
          target_label: __path__

--- # Clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: promtail-clusterrole
rules:
  - apiGroups: [&amp;quot;&amp;quot;]
    resources:
    - nodes
    - services
    - pods
    verbs:
    - get
    - watch
    - list

--- # ServiceAccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: promtail-serviceaccount

--- # Rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: promtail-clusterrolebinding
subjects:
    - kind: ServiceAccount
      name: promtail-serviceaccount
      namespace: default
roleRef:
    kind: ClusterRole
    name: promtail-clusterrole
    apiGroup: rbac.authorization.k8s.io
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;3-log&quot; tabindex=&quot;-1&quot;&gt;3. çœ‹Log&lt;/h3&gt;
&lt;p&gt;å…ˆåˆ°Promtailçš„podçœ‹æœ‰æ²’æœ‰éŒ¯èª¤ï¼Œ&lt;br /&gt;
æ²’æœ‰çš„è©±åˆ°grafanaè£¡é¢ï¼Œ&lt;br /&gt;
å¦‚æœä½ çš„grafanaä¹Ÿæ˜¯istioè£¡é¢çš„yamlå®‰è£èµ·ä¾†çš„è©±ï¼Œ&lt;br /&gt;
é è¨­å°±æœƒæœ‰lokiçš„datasourceï¼Œ&lt;br /&gt;
ä¸ç”¨å†é¡å¤–è¨­å®šã€‚&lt;/p&gt;
&lt;p&gt;é–‹å•Ÿgrafanaï¼Œé–‹å•Ÿé¸å–®çš„explorerã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/259-fig.2.png&quot; alt=&quot;259-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;datasourceé¸ Loki&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/259-fig.3.png&quot; alt=&quot;259-fig.3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä¸€é–‹å§‹å¯ä»¥ç”¨labelé¸æ“‡ï¼Œé€™é‚Šçš„appæ˜¯æˆ‘å»ºç«‹æœå‹™æ™‚æ‰€ç”¨çš„labelã€‚&lt;br /&gt;
ä¹Ÿå¯ä»¥ç”¨deployæˆ–namespaceé¸æ“‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/259-fig.4.png&quot; alt=&quot;259-fig.4.png&quot; /&gt;&lt;br /&gt;
æœ€å¾ŒæŒ‰ä¸‹å³ä¸Šçš„Run Queryã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/259-fig.5.png&quot; alt=&quot;259-fig.5.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€™æ¨£å°±è¡¨ç¤ºæœ‰è³‡æ–™äº†ã€‚&lt;br /&gt;
æ­¤æ™‚ï¼Œä¹Ÿå¯ä»¥æŒ‰å³ä¸Šçš„Add dashboardï¼Œ&lt;br /&gt;
å¥—ç”¨åˆ°ç¾æœ‰çš„dashboardæˆ–æ˜¯å»ºç«‹ä¸€å€‹éƒ½å¯ä»¥ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/259. Lokiå¿«é€Ÿä¸Šæ‰‹é«”é©—/" />
        </entry>
        <entry>
            <title>
                258. GCPè²»ç”¨è©¦ç®—
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/258. GCPè²»ç”¨è©¦ç®—/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;ä¹‹å‰è½ä¸Šé¢çš„èªªï¼Œä»–å€‘æœ‰è²·GCPçš„è²»ç”¨æŠ˜æ‰£ã€‚&lt;br /&gt;
ç›´åˆ°æœ€è¿‘æˆ‘é–‹å§‹ç”³è«‹è²»ç”¨è¡¨å–®ï¼Œ&lt;br /&gt;
æ‰ç™¼ç¾ç”³è«‹çš„é‡‘é¡èˆ‡GCPä¸Šé¢çš„è²»ç”¨ä¸€è‡´ï¼Œ&lt;br /&gt;
æä¸æ‡‚æ€éº¼ä¸€å›äº‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆï¼Œè¦å…ˆåˆ° Billingè£¡é¢çš„Pricingï¼ŒæŸ¥çœ‹SKUçš„æŠ˜æ‰£ã€‚&lt;br /&gt;
é€™é‚Šå¾ˆå¤šé¸é …ï¼Œ&lt;br /&gt;
å»ºè­°æ˜¯å…ˆåˆ°Reportè£¡é¢ç›´æ¥æ‹¿SKU IDæœå°‹ï¼ŒGroup byé¸æ“‡ SKUã€‚&lt;br /&gt;
æˆ–æ˜¯åˆ° &lt;a href=&quot;https://cloud.google.com/skus/?currency=USD&amp;amp;hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Google Cloud Platform SKUs&lt;/a&gt; æœå°‹ SKU IDã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/258-fig.1.png&quot; alt=&quot;258-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æœ€å¾Œï¼Œåˆ°pricingè²¼ä¸Š SKU ID&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/258-fig.2.png&quot; alt=&quot;258-fig.2.png&quot; /&gt;&lt;br /&gt;
å°±èƒ½æŸ¥åˆ° Effective discountã€‚&lt;/p&gt;
&lt;p&gt;å†ä¾†ä»¥å‰ä¸‰é«˜çš„é‡‘é¡è©¦ç®—&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»¥ç¶²è·¯è²»ç”¨(Network Inter Region Data Transfer Out from Americas to APAC):12587.22Gï¼Œ&lt;br /&gt;
ä»¥&lt;a href=&quot;https://cloud.google.com/products/calculator?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GCP è¨ˆç®—æ©Ÿ&lt;/a&gt;è¨ˆç®—ç‚º $1006.9ï¼ŒæŠ˜æ‰£ 22% ï¼Œæ•… 785.382ï¼Œèˆ‡è²»ç”¨æ˜ç´°ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;è¨ˆç®—æ©Ÿè¨ˆç®—æ™‚ï¼Œè¦åˆ†æ¸…æ¥šæ˜¯å“ªä¸€é‚Šã€‚&lt;br /&gt;
ä»¥è²»ç”¨åç¨±ä¾†çœ‹æ˜¯å±¬æ–¼ Inter Region çš„è³‡æ–™è¼¸å‡ºï¼Œ&lt;br /&gt;
æ•…é¸æ“‡ä¸‹é¢çš„ Inter-Regionã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/258-fig.5.png&quot; alt=&quot;258-fig.5.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;GCPç¶²ç«™ä¸Šï¼Œä»¥CPUï¼šC2D ä½¿ç”¨æ™‚é–“ 36248.56ï¼Œæ¯å°æ™‚ 0.034231ï¼Œç‚º1240.82 ï¼ŒæŠ˜æ‰£ 26% æ•…é‡‘é¡ç‚º 918 ã€‚&lt;br /&gt;
èˆ‡è²»ç”¨æ˜ç´°ä¸Šä½¿ç”¨æ™‚é–“ç‚º 35281 hours ï¼Œé‡‘é¡ç‚º 893ã€‚è¦–ç‚ºä¸€è‡´ã€‚&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;ä»¥CPU:E2 Custom è¨ˆç®—ï¼Œä½¿ç”¨æ™‚é–“ç‚º 30550.16ï¼Œ æ¯å°æ™‚ 0.02651815ï¼Œç‚º810.133ï¼ŒæŠ˜æ‰£ 31.33% æ•…é‡‘é¡ç‚º 556.3188ï¼Œ&lt;br /&gt;
èˆ‡è²»ç”¨æ˜ç´°æ‹†æˆå…©ç­†ï¼Œä½¿ç”¨æ™‚é–“ç‚º11567.12+18983.043ï¼Œè²»ç”¨ç‚º 345.66+210.63 = 556.29ï¼Œè¦–ç‚ºä¸€è‡´ã€‚&lt;br /&gt;
(E2 çš„ç¶²ç«™è²»ç”¨æœ‰åˆ†æˆ Customèˆ‡ä¸€èˆ¬çš„ï¼Œæ¯å°æ™‚è²»ç”¨ä¸ä¸€æ¨£ã€‚)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/258-fig.3.png&quot; alt=&quot;258-fig.3.png&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/258-fig.4.png&quot; alt=&quot;258-fig.4.png&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/258. GCPè²»ç”¨è©¦ç®—/" />
        </entry>
        <entry>
            <title>
                257. istio-proxy Readiness probe failed
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/257. istio-proxy Readiness probe failed/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘åŒäº‹åœ¨å£“æ¸¬æœå‹™ï¼Œ&lt;br /&gt;
ç„¶å¾Œç™¼ç¾ä»–çš„podå¸¸å¸¸ç„¡æ•…é‡å•Ÿï¼Œ&lt;br /&gt;
ä¸æ˜¯restartï¼Œè€Œæ˜¯æ•´å€‹podé‡å»ºã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;h3 id=&quot;2024-12-13&quot; tabindex=&quot;-1&quot;&gt;2024/12/13æ›´æ–°&lt;/h3&gt;
&lt;p&gt;&lt;mark&gt;æ‰¾çš„æ–¹å‘éŒ¯èª¤ï¼Œç›®å‰æ˜¯é€™å€‹NodePoolåªè¦æ›ä¸ŠTaintå¾Œï¼Œ&lt;br /&gt;
å£“æ¸¬æ™‚ï¼Œå°±æœƒå°è‡´Istio-proxyçš„readines æ¯å°æ™‚é‡é–‹ä¸€æ¬¡ã€‚&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;çœ‹eventäº‹ä»¶ï¼Œç™¼ç¾é€™å€‹éŒ¯èª¤ã€‚&lt;br /&gt;
çœ‹ä¾†æ˜¯istio-proxyæœ¬èº«çš„Readinesså°è‡´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/257-fig.1.png&quot; alt=&quot;257-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œæª¢æŸ¥istio-proxyæœ¬èº«çš„resource ä¹Ÿæœ‰è¨­å®šlimitã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæ”¹å€‹limitè¨­å®šè©¦è©¦ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;spec:
  replicas: 1
  selector:
    matchLabels:
      app: gameservice
      group: gameservice
  template:
    metadata:
      annotations:
        sidecar.istio.io/proxyCPU: 200m
        sidecar.istio.io/proxyCPULimit: 2000m
        sidecar.istio.io/proxyMemory: 128Mi
        sidecar.istio.io/proxyMemoryLimit: 2Gi
    spec:
      containers: 
        .... 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™å€‹å¯ä»¥æŒ‡å®šå–®å€‹podä½¿ç”¨æ­¤è¨­å®šï¼Œ&lt;br /&gt;
å¦‚æœè¦è¨­æˆå…¨åŸŸï¼Œåƒè€ƒ&lt;a href=&quot;https://discuss.istio.io/t/setting-global-resource-requests-for-sidecar-proxy/12066&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;setting-global-resource-requests-for-sidecar-proxy&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œé€™æƒ…æ³ä»ç„¶æœƒç™¼ç”Ÿã€‚&lt;br /&gt;
çŒœæ¸¬å¯èƒ½æ˜¯å£“ç­–æ™‚ï¼Œå¤§é‡çš„è«‹æ±‚å¡åˆ°istio-proxyè£¡é¢å°è‡´ç„¡æ³•è² è·ã€‚&lt;br /&gt;
å¦ä¸€ç¨®æ˜¯ç›´æ¥ &lt;s&gt;åœç”¨readiness&lt;/s&gt;äº† ã€‚&lt;br /&gt;
ä¸‹é¢çš„æ–¹æ³•ï¼Œæ˜¯æ”¹å¯«ä¸æ˜¯åœç”¨ï¼Œ&lt;br /&gt;
ç›®å‰é‚„æ²’æ‰¾åˆ°åœç”¨çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;spec:
  replicas: 1
  selector:
    matchLabels:
      app: gameservice
      group: gameservice
  template:
    metadata:
      annotations:
		sidecar.istio.io/rewriteAppHTTPProbers: &amp;quot;false&amp;quot;
    spec:
      containers: 
        .... 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/latest/zh/docs/ops/configuration/mesh/app-health-check/#disable-the-http-probe-rewrite-for-a-pod&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; Istio æœå‹™çš„å¥åº·æª¢æŸ¥&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/latest/docs/reference/config/annotations/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Resource Annotations&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/latest/docs/reference/config/networking/workload-group/#ReadinessProbe&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Workload Group&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/257. istio-proxy Readiness probe failed/" />
        </entry>
        <entry>
            <title>
                256. httpbinå–å¾—requestçš„header
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/256. httpbinå–å¾—requestçš„header/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;é€™å¹¾å¤©åœ¨GKEå¹«äººæ¶srs origin+edge +zlm ï¼Œ&lt;br /&gt;
ç„¶å¾Œåˆ°æœ‰æ²’æœ‰ä¾†æºIPçš„headerå¯ä¾›ä½¿ç”¨ï¼Œ&lt;br /&gt;
æˆ‘è¨˜å¾—æœ‰ï¼Œä½†å¿˜è¨˜åç¨±ï¼Œ&lt;br /&gt;
ç¾åœ¨åªæœ‰å…©æ¢è·¯ ï¼Œä¸€æ¢æ˜¯è‡ªå·±å¯«å€‹å¾Œç«¯å›å‚³headerçš„æœå‹™ã€‚&lt;br /&gt;
å¦ä¸€å€‹å°±æ˜¯æ‰¾åˆ¥äººå¯«å¥½çš„ï¼Œé‚„å¥½æœ‰æ‰¾åˆ°ï¼ˆæˆ‘å°±è¨˜å¾—æˆ‘çœ‹éï¼‰ï¼Œ&lt;br /&gt;
ä¸ç„¶çœŸçš„è¦è‡ªå·±å¯«äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;æœ‰è«‹ï¼Œ &lt;a href=&quot;https://httpbin.org/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Httpbin&lt;/a&gt; ï¼Œ&lt;br /&gt;
è¦åƒè€ƒç”¨å“ªäº›pathçš„è©±ï¼Œå¯ä»¥å…ˆåˆ°å®˜æ–¹æ–‡ä»¶çœ‹ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å°±ç›´æ¥æ›è¼‰æˆdeployå’Œserviceäº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
kind: Namespace
metadata:
  name: xff
  labels:
    istio-injection: enabled
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: httpbin
  namespace: xff
  labels:
    group: srs
    app: httpbin
spec:
  replicas: 1
  revisionHistoryLimit: 5
  progressDeadlineSeconds: 30
  selector:
    matchLabels:
      group: srs
      app: httpbin
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      labels:
        group: srs
        app: httpbin
    spec:
      containers:
        - name: srs
          image: kennethreitz/httpbin
          imagePullPolicy: IfNotPresent # IfNotPresent, Always, Never
          ports:
            - name: http-web
              containerPort: 80
              protocol: TCP
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      terminationGracePeriodSeconds: 30
---
apiVersion: v1
kind: Service
metadata:
  name: httpbin
  namespace: xff
spec:
  type: LoadBalancer
  selector:
    group: srs
    app: httpbin
  ports:
    - name: http-web
      protocol: TCP
      port: 80
      targetPort: 80
    - name: https
      protocol: TCP
      port: 443
      targetPort: 80  

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œï¼Œcloudflareæ›ipï¼Œé–‹å•Ÿproxyã€‚&lt;br /&gt;
ç”¨è‡ªå·±çš„é›»è…¦å‘¼å«è‡ªå·±è¨­å®šçš„domainã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -X Get https://video-httpbin.abc.com/get
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/256-fig.1.png&quot; alt=&quot;256-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€™æ¨£å°±çœ‹å¾—åˆ°headersè£¡é¢çš„ &lt;code&gt;Cf-Connecting-Ip&lt;/code&gt; å°±æ˜¯ä¾†æºIPã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/256. httpbinå–å¾—requestçš„header/" />
        </entry>
        <entry>
            <title>
                253. dockerå…§ç›£æ§æœå‹™ç‹€æ…‹
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/253. dockerå…§ç›£æ§æœå‹™ç‹€æ…‹/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;ä¸Šä¸€ç¯‡ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/251.%20%20GCE%E4%B8%8A%E7%9A%84docker%E7%9B%A3%E6%8E%A7/&quot;&gt;251.  GCEä¸Šçš„dockerç›£æ§&lt;/a&gt; ï¼Œ&lt;br /&gt;
èƒ½å–å¾—æœå‹™æœ¬èº«çš„CPUã€Memory..ç­‰ï¼Œ&lt;br /&gt;
ä½†å¦‚æœè¦åˆ¤æ–·æœå‹™æœ‰æ²’æœ‰æ­£å¸¸ï¼Œ&lt;br /&gt;
é‚„çœŸçš„ä¸çŸ¥å¾ä½•è‘—æ‰‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨  container_last_seen é…ä¸Š absentå–çµ•å°å€¼&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;absent(container_last_seen{name=~&amp;quot;filebeat&amp;quot;}) OR vector(0)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚ºä»€éº¼è¦åŠ ä¸Š &lt;code&gt;or vector(0)&lt;/code&gt;çš„åŸå› æ˜¯&lt;br /&gt;
ç•¶promQLåˆ¤æ–·æœå‹™ &lt;code&gt;filebeat&lt;/code&gt;é‚„æ´»è‘—çš„è©±ï¼Œ&lt;br /&gt;
ä¸æœƒæœ‰ä»»ä½•è³‡æ–™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/253-fig.1.png&quot; alt=&quot;253-fig.1.png&quot; /&gt;&lt;br /&gt;
ç•¶æœå‹™æ²’å•Ÿå‹•æ™‚ï¼Œæ‰æœƒé¡¯ç¤º &lt;code&gt;1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ–¼æ˜¯åŠ ä¸Šå¾Œé¢ &lt;code&gt;OR vector(0)&lt;/code&gt;&lt;br /&gt;
ç•¶æ²’æœ‰æŸ¥è©¢çµæœæ™‚ï¼Œé è¨­æœƒé¡¯ç¤º 0 ï¼Œæ–¹ä¾¿å‘Šè­¦å¾©æ­¸ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://github.com/google/cadvisor/issues/2305&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;What container_last_seen use for&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/253. dockerå…§ç›£æ§æœå‹™ç‹€æ…‹/" />
        </entry>
        <entry>
            <title>
                252. k8sä¸­çš„podå‘¼å«
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/252. k8sä¸­çš„podå‘¼å«/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;å…¶å¯¦å¦‚æœæ¶æ§‹å¯ä»¥ï¼Œ&lt;br /&gt;
æ‡‰è©²æ˜¯ä¸éœ€è¦ç”¨åˆ°é€™å€‹åŠŸèƒ½ã€‚&lt;br /&gt;
ç”¨é€™å€‹ä¹Ÿæœ‰å‰æï¼Œå¿…é ˆè¦æ˜¯statefulsetã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;podæœ¬èº«çš„nameæ˜¯éš¨æ©Ÿçš„ï¼Œ&lt;br /&gt;
æ‰€ä»¥ä¸å¤ªå¯èƒ½ç”¨ç¨‹å¼å¯«æ­»å»å‘¼å«ä»–ï¼Œ&lt;br /&gt;
ç•¶ç„¶ï¼ŒçœŸçš„è¦ç¡¬å¹¹é‚„æ˜¯å¯ä»¥ã€‚&lt;/p&gt;
&lt;p&gt;statefulSetï¼Œä»–çš„podæ˜¯å¾0é–‹å§‹å¾€å¾Œï¼Œ&lt;br /&gt;
å¾k8sçš„æ–‡ä»¶çœ‹ï¼Œå‘¼å«å–®å€‹podçš„æ–¹å¼ï¼Œ&lt;br /&gt;
&lt;code&gt;&amp;lt;podname&amp;gt;.&amp;lt;servicename&amp;gt;.&amp;lt;namespace&amp;gt;.svc.cluster.local&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/#stable-network-id&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Stable Network ID&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼ï¼ï¼æˆ‘åœ¨æ¸¬è©¦æ™‚ï¼Œå°±è«åå…¶å¦™ä¸€ç›´å¡é—œã€‚&lt;br /&gt;
åˆ°æœ€å¾Œé‚„ç›´æ¥å»æŸ¥kube-dnsçš„å€¼ï¼Œçœ‹æ˜¯æ€éº¼è§£æçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ¸¬è©¦çš„statefulsetæ˜¯rabbitMQï¼Œ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/252-fig.1.png&quot; alt=&quot;252-fig.1.png&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/252-fig.2.png&quot; alt=&quot;252-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¾ä¸Šåœ–å¯ä»¥çµ„æˆä¸‹é¢çš„ç¶²å€&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl http://qa-rabbitmq-server-1.qa-rabbitmq.rabbitmq-system.svc.cluster.local:15692/metrics
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¸¬è©¦æ™‚ï¼Œä¸€ç›´å‡ºç¾éŒ¯èª¤ï¼Œæ‰¾ä¸åˆ°æœå‹™ã€‚&lt;br /&gt;
ä½†ç”¨pod IPå¯ä»¥æ‰¾åˆ°è³‡æ–™ã€‚&lt;/p&gt;
&lt;p&gt;æœ€å¾Œæ°£åˆ°ï¼Œç›´æ¥è£äº†nslookupï¼ŒåæŸ¥dnsåç¨±äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apt-get install dnsutils

or

yum install bind-utils
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¦æŸ¥è©¢ä¹‹å‰ï¼Œæœ€å¥½å…ˆæ‰¾åˆ°ä½ çš„kube-dns çš„pod ipï¼Œ&lt;/p&gt;
&lt;p&gt;ä¸éå…¶å¯¦é è¨­çš„dnsæ‡‰è©²å°±æ˜¯kube-dnsçš„ipäº†&lt;br /&gt;
ä½†ç‚ºäº†è¬ä¸€ï¼Œæˆ‘é‚„æ˜¯å¼·åˆ¶æŒ‡å®šä¸€ä¸‹ï¼Œå¦‚æœæœ‰å¤šå€‹podï¼Œéš¨ä¾¿æŠ“ä¸€å€‹å°±å¥½ï¼Œ&lt;br /&gt;
kube-dnsçš„ip &lt;code&gt;192.168.24.157&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/252-fig.3.png&quot; alt=&quot;252-fig.3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨rabbitMQçš„ip åæŸ¥domain&lt;/p&gt;
&lt;p&gt;çµæœ..ipè¨»å†Šçš„domainæ˜¯&lt;br /&gt;
&lt;code&gt;qa-rabbitmq-server-1.qa-rabbitmq-nodes.rabbitmq-system.svc.cluster.local&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç…§æ ¼å¼ä¾†è¬›æ²’éŒ¯ï¼Œä½†ä»–ç”¨çš„æ˜¯å¦ä¸€å€‹service nameï¼Œ&lt;br /&gt;
ç‚ºä»€éº¼æˆ‘åˆ°ç¾åœ¨é‚„æ˜¯ä¸æ¸…æ¥šã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/252. k8sä¸­çš„podå‘¼å«/" />
        </entry>
        <entry>
            <title>
                251.  GCEä¸Šçš„dockerç›£æ§
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/251.  GCEä¸Šçš„dockerç›£æ§/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;ä¹‹å‰å› ç‚ºæ¶æ§‹é—œä¿‚ï¼Œå»ºäº†å¹¾å€‹åœ¨GCEä¸Šçš„dockeræœå‹™ã€‚&lt;br /&gt;
å¤–å±¤ä¸»æ©Ÿå¯ä»¥é€éGCPçš„metricç›£æ§ï¼Œ&lt;br /&gt;
ä½†è£¡é¢çš„dockerå°±ä¸çŸ¥é“äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;æŸ¥äº†ä¸€ä¸‹ï¼Œ&lt;br /&gt;
æŠŠ&lt;a href=&quot;https://github.com/google/cadvisor&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;cAdvisor&lt;/a&gt;è£èµ·ä¾†å°±å¥½äº†ã€‚&lt;br /&gt;
é€™æ˜¯ä¸€å€‹å°ˆé–€ç”¨åœ¨ç›£æ§VMä¸»æ©Ÿä¸Šçš„dockerã€‚&lt;/p&gt;
&lt;h3 id=&quot;c-advisor&quot; tabindex=&quot;-1&quot;&gt;cAdvisor&lt;/h3&gt;
&lt;p&gt;docker-compose.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;services:
  cadvisor:
    container_name: cadvisor
    image: gcr.io/cadvisor/cadvisor:latest
    pull_policy: if_not_present
    restart: always
    privileged: true
    volumes:
      - /:/rootfs:ro
      - /var/run:/var/run:ro
      - /sys:/sys:ro
      - /var/lib/docker/:/var/lib/docker:ro
      - /dev/disk/:/dev/disk:ro
    ports:
      - 8888:8080
    networks:
      - zlm_network
networks:
  zlm_network:
    name: zlm_network
    driver: bridge
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¨˜å¾—æ”¹ç”¨ &lt;code&gt;gcr.io/cadvisor/cadvisor:latest&lt;/code&gt;&lt;br /&gt;
å¦‚æœä½ æŸ¥åˆ°çš„æ–‡ç« æœ‰äººç”¨ &lt;code&gt;google/cadvisor:latest&lt;/code&gt;&lt;br /&gt;
é€™ç¨®åœ¨å»ºåˆ¶æ™‚æœƒç™¼ç”ŸéŒ¯èª¤&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Failed to create a Container Manager: mountpoint for cpu not found&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¶å¥½å¾Œï¼Œå¯ä½¿ç”¨ä¸‹é¢æ–¹æ³•æ¸¬è©¦&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl http://127.0.0.1:8888/metrics
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;prometheus&quot; tabindex=&quot;-1&quot;&gt;prometheus&lt;/h3&gt;
&lt;p&gt;è¦å»ºä¸€å€‹æ–°çš„æˆ–æ˜¯æ‹¿èˆŠçš„å¥—ç”¨éƒ½å¯ä»¥ã€‚&lt;br /&gt;
é‡é»æ˜¯configï¼Œ&lt;br /&gt;
å› æˆ‘çš„prometheusæ›åœ¨GKEä¸Šé¢ï¼Œ&lt;br /&gt;
æ‰€ä»¥ç›´æ¥è®“prometheuså»å–å¾—GCEçš„metricsã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- job_name: &#39;game-result-stage&#39;
  scrape_interval: 15s
  static_configs:
    - targets:
      - &#39;&amp;lt;ip&amp;gt;:8888&#39; 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;grafana&quot; tabindex=&quot;-1&quot;&gt;Grafana&lt;/h3&gt;
&lt;p&gt;å¯ç›´æ¥åŒ¯å…¥ &lt;a href=&quot;https://grafana.com/grafana/dashboards/11600-docker-container/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;11600&lt;/a&gt; é€™å€‹dashboardã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/cypik/monitoring-servers-and-docker-containers-using-prometheus-with-grafana-2f8bce8b5d84&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Monitoring Servers and Docker Containers using Prometheus with Grafana&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/251.  GCEä¸Šçš„dockerç›£æ§/" />
        </entry>
        <entry>
            <title>
                250. findæŒ‡ä»¤ç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/250. findæŒ‡ä»¤ç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘åœ¨å¼„crontabçš„å•é¡Œï¼Œ&lt;br /&gt;
çµæœæ‰ç™¼ç¾find åŠ ä¸Š deleteæ»¿æ»¿çš„ç´°ç¯€ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;æœå°‹æ™‚é–“&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€™é‚Šè¦å…ˆçŸ¥é“ä¸€ä»¶äº‹ï¼Œatime, mtime , ctime éƒ½æ˜¯ç”¨&lt;code&gt;n*24 hour&lt;/code&gt;&lt;br /&gt;
ä½œç‚ºæ™‚é–“æ¯”å°çš„ä¾æ“šï¼Œ&lt;br /&gt;
åˆ¤æ–·æ–‡ä»¶è·é›¢ä¸Šæ¬¡ä¿®æ”¹æ™‚é–“å·²ç¶“éäº†å¹¾å€‹24å€‹å°æ™‚æ™‚æ®µã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;find . -mtime -1 # æ‰¾åˆ°æœ€å¾Œä¿®æ”¹æ™‚é–“ç‚ºã€Œå°‘æ–¼ 1 å¤©å‰ã€çš„æª”æ¡ˆã€‚
find . -mtime 1  # æ‰¾åˆ°æœ€å¾Œä¿®æ”¹æ™‚é–“ç‚ºã€Œå‰›å¥½ 1 å¤©å‰ã€çš„æª”æ¡ˆã€‚
find . -mtime +1 # æ‰¾åˆ°æœ€å¾Œä¿®æ”¹æ™‚é–“ç‚ºã€Œè¶…é 1 å¤©å‰ã€çš„æª”æ¡ˆã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‡è¨­ç¾åœ¨æ™‚é–“ æ˜ŸæœŸå›› 14:55&lt;br /&gt;
-mtime -1 æœ€å¾Œä¿®æ”¹æ™‚é–“ æ˜¯ æ˜ŸæœŸä¸‰çš„14:55åˆ°æ˜ŸæœŸå››çš„14:55ä¹‹é–“çš„æª”æ¡ˆ&lt;br /&gt;
-mtime 1 æœ€å¾Œä¿®æ”¹æ™‚é–“æ˜¯ æ˜ŸæœŸäºŒ14:55åˆ° æ˜ŸæœŸä¸‰çš„14:55çš„æª”æ¡ˆ&lt;br /&gt;
-mtime +1 æœ€å¾Œä¿®æ”¹æ™‚é–“æ˜¯ æ˜ŸæœŸäºŒ14:55ä¹‹å‰çš„æª”æ¡ˆ&lt;/p&gt;
&lt;p&gt;å…¶ä»–é‚„æœ‰é€™å…©å€‹åƒæ•¸å¯ä¾›ä½¿ç”¨&lt;br /&gt;
-atime  æœ€è¿‘è¨ªå•æ™‚é–“&lt;br /&gt;
-ctime  æœ€è¿‘ç‹€æ…‹æ”¹å‹•æ™‚é–“&lt;/p&gt;
&lt;p&gt;é€™å¹¾å€‹æ™‚é–“éƒ½å¯ç”¨statæŸ¥çœ‹&lt;/p&gt;
&lt;p&gt;é€™å¼µåœ–è¡¨ç¤º -5,5,+5çš„å·®åˆ¥&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/250-fig.1.png&quot; alt=&quot;250-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦æŸ¥è©¢åˆ†é˜çš„è©±ï¼Œ&lt;br /&gt;
å‰‡æ˜¯ä½¿ç”¨ -amin,-mmin,-cmin ç”¨æ³•è·Ÿä¸Šé¢å·®ä¸å¤šã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://blog.csdn.net/db_murphy/article/details/107053545&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¾¹åº•ææ˜ç™½findå‘½ä»¤mtimeå«ç¾©å’Œç”¨æ³•&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;æŸ¥çœ‹èªªæ˜æ–‡ä»¶&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;man find
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;æœå°‹é¡å‹&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;find . -type f # æœå°‹æª”æ¡ˆ
find . -type d # æœå°‹è³‡æ–™å¤¾
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;æœå°‹æª”æ¡ˆåç¨±&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;find . -iname &amp;quot;docker&amp;quot; # ä¸å€åˆ†å¤§å°å¯«
find . -name &amp;quot;*.mp4&amp;quot;  # å‰¯æª”åç‚ºmp4
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;åŸ·è¡Œå¾Œå†å…¶ä»–æŒ‡ä»¤&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;   find . -iname &amp;quot;docker&amp;quot; -exec rm -f {} +
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;{}&lt;/code&gt; ä»£è¡¨å°‡å‰é¢æœå°‹çš„çµæœå‚³åˆ°å¾Œé¢çš„åƒæ•¸ï¼Œ&lt;br /&gt;
&lt;code&gt;+&lt;/code&gt; è¡¨ç¤ºå°‡çµæœä¸€æ¬¡å‚³é€²å»çµ¦rmï¼Œå¦ä¸€ç¨®ä½œæ³•æ˜¯ &lt;code&gt;&#92;;&lt;/code&gt;ï¼Œé‡å°æ¯å€‹è³‡æ–™å¤¾éƒ½åŸ·è¡Œä¸€æ¬¡rmçš„æŒ‡ä»¤&lt;br /&gt;
è¨˜å¾—&lt;code&gt;&#92;&lt;/code&gt;å‰é¢çš„ç©ºæ ¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;æ’é™¤ç‰¹å®šè³‡æ–™å¤¾&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;find . -iname &amp;quot;docker&amp;quot; -mindepth 1 -path /home/user/docker -prune -o -print
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;-o&lt;/code&gt;  åœ¨findä¸­ï¼Œä»£è¡¨ORçš„é‚è¼¯ï¼Œå…¶ä¸­ä¸€å€‹ç‚ºtrueæ‰åŸ·è¡Œï¼Œ&lt;br /&gt;
åŸºæœ¬èªæ³•ç‚º&lt;code&gt;find &amp;lt;path&amp;gt; &amp;lt;condition1&amp;gt; -o &amp;lt;condition2&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ -o -printçš„ç”¨æ„è­˜ï¼Œå¦‚æœä¸æ˜¯ &lt;code&gt;/home/user/docker&lt;/code&gt;çš„è³‡æ–™å¤¾å°±print&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.miniasp.com/post/2010/08/27/Linux-find-command-tips-and-notice&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åœ¨ Linux ä¸‹ä½¿ç”¨ find æŒ‡ä»¤æŸ¥è©¢ç›®éŒ„èˆ‡æª”æ¡ˆçš„é€ŸæŸ¥ç­†è¨˜&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.gtwang.org/linux/unix-linux-find-command-examples/&quot; title=&quot;Unix/Linux çš„ find æŒ‡ä»¤ä½¿ç”¨æ•™å­¸ã€æŠ€å·§èˆ‡ç¯„ä¾‹æ•´ç†&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Unix/Linux çš„ find æŒ‡ä»¤ä½¿ç”¨æ•™å­¸ã€æŠ€å·§èˆ‡ç¯„ä¾‹æ•´ç†&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å–®ç´”ç´€éŒ„ä¸€ä¸‹éº»ç…©çš„è¦æ­»çš„cpåŠŸèƒ½ï¼Œ&lt;br /&gt;
å¾Œé¢é‚„æ˜¯ç”¨glcoud storage rsyncè™•ç†æ‰ï¼ŒcpçœŸçš„å¤ªæ…¢äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/bin/bash
total=$(find /home/user/MP4Final -type f -cmin -1 | wc -l)
find /home/user/MP4Final -type f -cmin -5 | while read file; do

    # æå–æª”æ¡ˆåç¨±
    filename=$(basename &amp;quot;$file&amp;quot;)

    # æå–æœ€å¾Œå…©å€‹è³‡æ–™å¤¾åç¨±
    last_two_dirs=$(echo &amp;quot;$file&amp;quot; | awk -F/ &#39;{print $(NF-2) &amp;quot;/&amp;quot; $(NF-1)}&#39;)

    # ç›®æ¨™ä½ç½®
    target_dir=&amp;quot;video/$last_two_dirs&amp;quot;

    &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#echo&quot;&gt;#echo&lt;/a&gt; &amp;quot;source:$file&amp;quot;
    &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#echo&quot;&gt;#echo&lt;/a&gt; &amp;quot;$target_dir/$filename&amp;quot;
    gcloud storage cp -n &amp;quot;$file&amp;quot; &amp;quot;gs://$target_dir/$filename&amp;quot; --quiet
done
echo &amp;quot;total: $total&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/250. findæŒ‡ä»¤ç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                247. MSSQLæŒ‡ä»¤è³¦äºˆæ¬Šé™
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/247. MSSQLæŒ‡ä»¤è³¦äºˆæ¬Šé™/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;å› ç‚ºä¹‹å‰RDçµ„é•·çœŸçš„å¹¹äº†å¾åˆªåº«åˆ°è·‘è·¯çš„éç¨‹ï¼Œ&lt;br /&gt;
é‡é»åˆªäº†é‚„æ²’è·‘è·¯ã€‚&lt;br /&gt;
æ–¼æ˜¯æ¯å€‹RDçš„è³‡æ–™åº«æ¬Šé™ç›´æ¥ç¸®æ¸›ã€‚&lt;br /&gt;
ä½†ç”±æ–¼ç¨‹å¼æ˜¯ä½¿ç”¨ORM ï¼Œæœƒè‡ªå»ºè³‡æ–™åº«ã€‚&lt;br /&gt;
å°è‡´RDæ²’æœ‰æ¬Šé™å¯ä»¥é€£åˆ°æ–°å»ºçš„DBï¼Œ&lt;br /&gt;
æˆ‘åªèƒ½æ‰‹å‹•è³¦äºˆæ¬Šé™ï¼Œä½†æ¯æ¬¡æ–°å¢å¥½ç…©ï¼Œ&lt;br /&gt;
æˆ‘åˆæ²’windowï¼Œåªèƒ½ç”¨VMé–‹SSMSå‡ºä¾†ç”¨ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;ç”¨æŒ‡ä»¤ç›´æ¥è§£æ±º&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
create USER bmsrd for login bmsrd
EXEC sp_addrolemember &#39;db_datareader&#39;,&#39;bmsrd&#39;
EXEC sp_addrolemember &#39;db_datawriter&#39;,&#39;bmsrd&#39;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥å¾Œç›´æ¥åˆ° Googleçš„ Cloud SQL Studio åŸ·è¡ŒæŒ‡ä»¤å°±å¥½ã€‚&lt;br /&gt;
æˆ–æ˜¯ä½¿ç”¨ Azure Data Studioå°±å¥½äº†ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/247. MSSQLæŒ‡ä»¤è³¦äºˆæ¬Šé™/" />
        </entry>
        <entry>
            <title>
                246. GCPç¶²è·¯è²»ç”¨ç²—ä¼°è¨ˆç®—
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/246. GCPç¶²è·¯è²»ç”¨ç²—ä¼°è¨ˆç®—/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æ˜¨å¤©çªç„¶èªªè¦å«æˆ‘ç®—ä¸€ä¸‹å½±éŸ³ä¸²æµï¼Œå¦‚æœæ¯ç§’2MBçš„è©±ï¼Œä¸€å€‹æœˆå¤šå°‘ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;Q: ç¾åœ¨çš„é¡Œç›®ï¼Œæ¯ç§’æœ‰ 2Mbçš„ä¸²æµï¼Œæ¯æœˆæœƒæœ‰å¤šå°‘è²»ç”¨ã€‚&lt;br /&gt;
å…ˆè¨ˆç®—æ¯æœˆæµé‡&lt;br /&gt;
&lt;code&gt;2*60*60*24*30=5184000(Mb)&lt;/code&gt;&lt;br /&gt;
å†è½‰æˆMB&lt;br /&gt;
&lt;code&gt;51840000/8=648000&lt;/code&gt;&lt;br /&gt;
å› Googleçš„è²»ç”¨å–®ä½éƒ½æ˜¯ GiB (1GB ç´„0.93GiB)ï¼Œ&lt;br /&gt;
æ‰€ä»¥ 648 GB = 602GiB&lt;/p&gt;
&lt;p&gt;p.s GBæ˜¯åé€²åˆ¶ï¼ŒGiBæ˜¯äºŒé€²åˆ¶&lt;/p&gt;
&lt;h3 id=&quot;çµ„æˆ&quot; tabindex=&quot;-1&quot;&gt;çµ„æˆ&lt;/h3&gt;
&lt;p&gt;ç¶²è·¯çš„è²»ç”¨åˆ†æˆå…©å¡Šï¼Œ&lt;br /&gt;
Data transfer(è³‡æ–™å‚³è¼¸) +  data processes(è³‡æ–™è™•ç†)&lt;/p&gt;
&lt;p&gt;å…¥ç«™ä¸æ”¶ data transferçš„è²»ç”¨ï¼Œä½†æœƒæ”¶  data processesçš„è²»ç”¨ã€‚&lt;br /&gt;
å‡ºç«™ï¼Œå…©é‚Šçš„è²»ç”¨éƒ½æœƒæ”¶ã€‚&lt;/p&gt;
&lt;h3 id=&quot;inbound&quot; tabindex=&quot;-1&quot;&gt;Inbound&lt;/h3&gt;
&lt;p&gt;processes dataçš„æœå‹™ æœ‰ Load Balancer ã€Cloud NAT ã€ Protocol forward&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/246-fig.1.png&quot; alt=&quot;246-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¾LB é€²å…¥çš„data processesè²»ç”¨ç‚º &lt;code&gt;602*0.008=4.816&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;LBçš„è½‰ç™¼è¦å‰‡å‰äº”æ¢ï¼Œæ¯å°æ™‚  0.025  ï¼Œæ–¼æ˜¯ &lt;code&gt;0.025*24*30=18&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ–¼æ˜¯ï¼Œinboundçš„ LB è³‡æ–™è™•ç†è²»ç”¨ç‚º 22.816 USD&lt;/p&gt;
&lt;h3 id=&quot;outbound&quot; tabindex=&quot;-1&quot;&gt;Outbound&lt;/h3&gt;
&lt;p&gt;é€™é‚Šè¨ˆç®—æ™‚ï¼Œå‹™å¿…ææ¸…æ¥š å“ªä¸€é‚Šæ˜¯client å“ªä¸€é‚Šæ˜¯ serverã€‚&lt;/p&gt;
&lt;p&gt;GKE Private Cluster çš„ç¶²è·¯å…¥è·Ÿå‡ºçš„IPä¸ä¸€æ¨£ï¼Œ&lt;br /&gt;
æ‰€ä»¥è¨ˆç®—æ–¹å¼ä¹Ÿä¸ä¸€æ¨£ã€‚&lt;/p&gt;
&lt;h3 id=&quot;ç¬¬ä¸€ç¨®&quot; tabindex=&quot;-1&quot;&gt;ç¬¬ä¸€ç¨®&lt;/h3&gt;
&lt;p&gt;å®¢æˆ¶ç›´æ¥é€£ç·šåˆ°serveræŠ“å–ä¸²æµ&lt;br /&gt;
æ‰€ä»¥GKEæ˜¯serverï¼Œæ˜¯å¾Load Balancerå‡ºã€‚&lt;/p&gt;
&lt;p&gt;Data processes è²»ç”¨&lt;br /&gt;
è·Ÿä¸Šé¢inboundçš„è²»ç”¨ä¸€æ¨£ï¼Œéƒ½æ˜¯ æ¯GiB 0.008 ï¼Œæ‰€ä»¥æ˜¯ 22.816&lt;/p&gt;
&lt;p&gt;Data Transfer è²»ç”¨&lt;/p&gt;
&lt;p&gt;&amp;gt; &lt;code&gt; 602*0.23 = 138.46&lt;/code&gt;&lt;br /&gt;
Â &lt;br /&gt;
Â 0.23æ˜¯å°ç£åˆ°ä¸­åœ‹çš„æ¯GBè²»ç”¨ï¼Œ&lt;br /&gt;
Â åˆ°å…¶ä»–åœ°æ–¹çš„åƒ¹æ ¼ä¸ä¸€æ¨£ã€‚&lt;br /&gt;
Â &lt;br /&gt;
Â ref. &lt;a href=&quot;https://cloud.google.com/vpc/network-pricing?hl=zh-tw#vpc-pricing&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è™›æ“¬ç§äººé›²ç«¯&lt;/a&gt; ç¶²éš›ç¶²è·¯è³‡æ–™ç§»è½‰é€Ÿç‡-&amp;gt; é€²éšç´šè¨ˆåƒ¹æ¨¡å¼&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç¸½é‡‘é¡ç´„ç‚º 138.46+22.816 = 161.276&lt;/p&gt;
&lt;h3 id=&quot;ç¬¬äºŒç¨®&quot; tabindex=&quot;-1&quot;&gt;ç¬¬äºŒç¨®&lt;/h3&gt;
&lt;p&gt;æœå‹™ç›´æ¥å°‡ä¸²æµæ‰“åˆ°å°æ–¹çš„ä¼ºæœå™¨ä¸Š&lt;br /&gt;
æ‰€ä»¥GKEæ˜¯clientï¼Œæ˜¯åƒCloud NATçš„æµé‡ã€‚&lt;/p&gt;
&lt;p&gt;Data processes è²»ç”¨&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;(0.044*720) + (0.005*1*720)+(5184*0.045)=43.056&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;(0.044ï¼Š720 ) :  è¶…é32å€‹VM ï¼ŒNAT é–˜é“çš„æ¯å°æ™‚åƒ¹æ ¼ 0.044 ï¼Œä¸€å€‹æœˆæœ‰720å€‹å°æ™‚&lt;br /&gt;
(0.005ï¼Š1ï¼Š720)ï¼šNATé–˜é“çš„IPï¼Œ1å€‹æ¯å°æ™‚0.005&lt;br /&gt;
(172.8ï¼Š0.045)ï¼š æ¯è™•ç† GiB è³‡æ–™ã€å‚³å…¥èˆ‡å‚³å‡ºè³‡æ–™ç§»è½‰çš„åƒ¹æ ¼ 0.045 ï¼Œ172.8G&lt;/p&gt;
&lt;p&gt;Data Transfer è²»ç”¨&lt;/p&gt;
&lt;p&gt;&amp;gt; &lt;code&gt; 602*0.23 = 138.46&lt;/code&gt;&lt;br /&gt;
Â &lt;br /&gt;
Â 0.23æ˜¯å°ç£åˆ°ä¸­åœ‹çš„æ¯GBè²»ç”¨ï¼Œ&lt;br /&gt;
Â åˆ°å…¶ä»–åœ°æ–¹çš„åƒ¹æ ¼ä¸ä¸€æ¨£ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç¸½é‡‘é¡ç´„ç‚º 138.46+43.056 = 181.516&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/vpc/network-pricing?hl=zh-tw#nat-pricing&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Cloud NAT&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;è£œå……&quot; tabindex=&quot;-1&quot;&gt;è£œå……&lt;/h3&gt;
&lt;p&gt;Inter-region data transfer&lt;/p&gt;
&lt;p&gt;å¦‚æœæ˜¯è·¨regionçš„è©±ï¼Œä¹Ÿæ˜¯è¦ç®—éŒ¢çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/246-fig.2.png&quot; alt=&quot;246-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åƒè€ƒ &lt;a href=&quot;https://cloud.google.com/vpc/network-pricing#vpc-pricing&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Inter-region data transfer&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Inter-zone data transfer&lt;br /&gt;
å¦‚æœæ˜¯ç›¸åŒregionï¼Œä¸åŒzoneçš„è©±ï¼Œæ¯ GiB 0.01&lt;br /&gt;
ç›¸åŒregionï¼Œç›¸åŒzoneçš„è©±å‰‡ä¸ç®—éŒ¢ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/246. GCPç¶²è·¯è²»ç”¨ç²—ä¼°è¨ˆç®—/" />
        </entry>
        <entry>
            <title>
                245. gcloud storageå–ä»£gsutil
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/245. gcloud storageå–ä»£gsutil/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;å‰›å¥½æƒ³è¦æŸ¥ä¸€ä¸‹gsutilçš„ rsyncæŒ‡ä»¤ï¼Œ&lt;br /&gt;
çµæœå®˜æ–¹æ–‡ä»¶ä¸€ç›´è·‘ä¸å‡ºä¾†ï¼Œ&lt;br /&gt;
ç´°çœ‹æ‰ç™¼ç¾&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šå¸¸ï¼Œæ‚¨æ‡‰è©²ä½¿ç”¨Â &lt;code&gt;gcloud storage&lt;/code&gt;Â å‘½ä»¤)è€Œä¸æ˜¯Â &lt;code&gt;gsutil&lt;/code&gt;Â å‘½ä»¤ï¼š&lt;br /&gt;
gsutil å·¥å…·æ˜¯ä¸€å€‹èˆŠç‰ˆ Cloud Storage CLIï¼Œåƒ…é€²è¡Œæœ€ä½ç¨‹åº¦çš„ç¶­è­·ã€‚&lt;br /&gt;
gsutil å·¥å…·ä¸æ”¯æ´ä½¿ç”¨è¼ƒæ–°çš„ Cloud Storage åŠŸèƒ½ï¼Œä¾‹å¦‚è»Ÿåˆªé™¤å’Œè¨—ç®¡å¼è³‡æ–™å¤¾&lt;br /&gt;
&lt;code&gt;gcloud storage&lt;/code&gt;Â å‘½ä»¤éœ€è¦è¼ƒå°‘çš„æ‰‹å‹•æœ€ä½³åŒ–å³å¯å¯¦ç¾æœ€å¿«çš„ä¸Šå‚³å’Œä¸‹è¼‰é€Ÿç‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;çœ‹ä¾†æˆ‘è©²æ”¹ç¨‹å¼äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://cloud.google.com/storage/docs/gsutil?hl=zh-cn#builtinhelp&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Gsutil&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;rsync åŒæ­¥&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;gsutil -m rsync -r /home/user/docker-compose/VideoSokoban/MP4Final gs://abc

change 

gcloud storage rsync -r /home/user/docker-compose-yaml/VideoSokoban/MP4Final gs://abc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/storage/rsync&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud storage rsync&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;signurl  ä¸‹è¼‰æ¬Šé™&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;gsutil signurl -d 30m gcs-download.json gs://backup/downloadbak/24-4-17.bak

change

gcloud storage sign-url  -d=30m --private-key-file=gcs-download.json gs://backup/downloadbak/24-4-17.bak

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†ç¬¬ä¸€æ¬¡åŸ·è¡Œæ™‚ï¼Œå¯èƒ½æœƒç™¼ç”ŸéŒ¯èª¤&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ERROR: (gcloud.storage.sign-url) This command requires the pyOpenSSL library. Please install it and set the environment variable CLOUDSDK_PYTHON_SITEPACKAGES to 1 before re-running this command&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸ·è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;export CLOUDSDK_PYTHON_SITEPACKAGES=1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/storage/sign-url&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud storage sign-url&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;du æŸ¥bucketå¤§å°&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;gcloud storage du gs://abc --summarize --readable-sizes
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/storage/du&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud storage du&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ–æ˜¯åœ¨Metrics Explorer ï¼ŒæŸ¥è©¢ &lt;code&gt;Total bytes (v2)&lt;/code&gt; é¸æ“‡ GCS Bucketã€‚&lt;br /&gt;
é€™é‚Šä¹Ÿæœ‰ &lt;code&gt;Total count (v2)&lt;/code&gt; å¯ä»¥æŸ¥è©¢åŠ ç¸½ã€‚&lt;br /&gt;
filterå¯æŒ‡å®šbucket nameã€‚&lt;/p&gt;
&lt;p&gt;å®Œæ•´ api &lt;code&gt;storage.googleapis.com/storage/v2/total_bytes&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/245-fig.1.png&quot; alt=&quot;245-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;cors&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;gsutil cors set example_cors_file.json gs://example_bucket
æ”¹
gcloud storage buckets update gs://example_bucket --cors-file=example_cors_file.json
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/142.gcs%20cors%E8%A8%AD%E5%AE%9A/&quot;&gt;142.gcs corsè¨­å®š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/storage/docs/using-cors#command-line&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Set up and view CORS configurations&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;cp è¤‡è£½&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;gsutil cp -n gs://abc/57d51e14-6ea2-409a-9bee-07a832456cf6.jpg .


gcloud storage cp -n Â gs://abc/57d51e14-6ea2-409a-9bee-07a832456cf6.jpg .
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/storage/cp&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud storage cp&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/245. gcloud storageå–ä»£gsutil/" />
        </entry>
        <entry>
            <title>
                244. åœ¨GCEä½¿ç”¨filebeatå‚³åˆ°GKEçš„ECK
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/244. åœ¨GCEä½¿ç”¨filebeatå‚³åˆ°GKEçš„ECK/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;RDèªªä»–è¦æä¸€å°è‡ªå‹•éŒ„å½±çš„æœå‹™ï¼Œ&lt;br /&gt;
æœ¬ä¾†ä»¥ç‚ºåªæœ‰ä¸€å€‹æœå‹™ï¼Œé‚£å°±æ›åœ¨GKEä¸Šå°±å¥½äº†ã€‚&lt;br /&gt;
ä½†æ˜¯ï¼Œä»–æœ‰å…©å€‹æœå‹™Aè·ŸBï¼Œå…©é‚Šçš„è³‡æ–™è¦äº’é€šã€‚&lt;br /&gt;
çœŸè¦ç”¨GKEç¡¬ä½œä¹Ÿæ˜¯å¯ä»¥ï¼Œä½†å¦‚æœé€™å€‹æœå‹™æœ¬èº«æ•ˆèƒ½å°±åƒå¾ˆå¤§ï¼Œ&lt;br /&gt;
é‚£ç”¨k8sä¹Ÿæ˜¯è¦å¤šé–‹ä¸€å°æ©Ÿå™¨ï¼Œé‚£ä¸å¦‚å°±ç”¨GCEå§ã€‚&lt;br /&gt;
ç„¶å¾Œï¼Œå•é¡Œå°±ä¾†äº†ï¼ŒLOGå’§ï¼ï¼Ÿ&lt;br /&gt;
Logå‡ºå•é¡Œæ™‚è¦æŸ¥ï¼Œæœ€å¥½ä¹Ÿæ˜¯å‚³å»å…±åŒçš„ECKä¸Šé¢ï¼Œä½†ECKåœ¨GKEä¸Šé¢ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;æŠ“å–logçš„æµç¨‹ä¹Ÿè·Ÿä¸€èˆ¬çš„filebeatå·®ä¸å¤šã€‚&lt;br /&gt;
filebeatæœƒå¾ä¸»æ©Ÿä¸Šçš„ &lt;code&gt;/var/lib/docker/containers/*/*.log&lt;/code&gt; æŠ“å–ã€‚&lt;br /&gt;
é€™é‚Šæ–‡å­—æª”çš„logæ˜¯docker logsçš„è³‡æ–™ï¼Œä¹Ÿå°±æ˜¯ç¨‹å¼çš„stdoutã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/running-on-docker.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®˜æ–¹ç°¡å–®èªªæ˜&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;docker-compose-yaml&quot; tabindex=&quot;-1&quot;&gt;Docker-compose.yaml&lt;/h2&gt;
&lt;p&gt;æˆ‘æ˜¯ç”¨docker compose ï¼Œæ¯”è¼ƒå¥½ç®¡ç†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; services:
  filebeat:
    image: docker.elastic.co/beats/filebeat:8.15.3
    build: filebeat
    container_name: filebeat
    user: root
    restart: unless-stopped
    environment:
      - ELASTICSEARCH_HOSTS=https://10.60.7.192:9200
      - ELASTICSEARCH_USERNAME=elastic
      - ELASTICSEARCH_PASSWORD=PASSWORD
    labels:
      co.elastic.logs/enabled: &amp;quot;false&amp;quot;
    volumes:
      - ./filebeat.yml:/usr/share/filebeat/filebeat.yml
      - /var/lib/docker/containers:/var/lib/docker/containers:ro
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - ./ca.crt:/etc/pki/client/ca.crt
      - ./tls.crt:/etc/pki/client/cert.pem
      - ./tls.key:/etc/pki/client/cert.key
    logging:
      driver: &amp;quot;json-file&amp;quot;
      options:
        max-size: &amp;quot;10m&amp;quot;
        max-file: &amp;quot;2&amp;quot;
    networks:
       - zlm_network
networks:
  zlm_network:
    driver: bridge
    name: zlm_network        
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸»è¦æœƒè‘—é‡æ–¼volumeçš„éƒ¨åˆ†ã€‚&lt;br /&gt;
å…¶ä»–åœ°æ–¹å¯èƒ½æœ‰é»å·®ç•°æœƒæŠ“å¹¾å€‹è¬›ã€‚&lt;/p&gt;
&lt;h3 id=&quot;general&quot; tabindex=&quot;-1&quot;&gt;General&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;user: root
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸è¨­å®šçš„è©±ï¼Œåœ¨&lt;code&gt;filebeat.yml&lt;/code&gt; çš„logging æœƒå‡ºç¾æ¬Šé™ä¸è¶³çš„éŒ¯èª¤ã€‚&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;network çš„è¨­å®šï¼Œè®“ä»–è·Ÿè¦æŠ“å–logçš„æœå‹™æ”¾åœ¨ä¸€èµ·ï¼Œæ•…åŒä¸€å€‹ç¶²è·¯åç¨±ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;volume&quot; tabindex=&quot;-1&quot;&gt;Volume&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;filebeat.ymlçš„è¨­å®šæª”é€£çµï¼Œé€™éƒ¨ä»½æ²’ä»€éº¼å•é¡Œã€‚&lt;br /&gt;
è£¡é¢å…§å®¹æœƒåœ¨ä¸‹é¢èªªã€‚&lt;/li&gt;
&lt;li&gt;æŠ“å–logçš„è·¯å¾‘ &lt;code&gt;/var/lib/docker/containers&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ›è¼‰SSLæ†‘è­‰&lt;br /&gt;
ç‚ºä»€éº¼è¦æ›è¼‰å‘¢ï¼Ÿå› ç‚ºECKåœ¨å®‰è£çš„æ™‚å€™ï¼Œé è¨­éƒ½èµ°sslï¼Œ&lt;br /&gt;
ä½†ECKå®‰è£æ™‚åœ¨GKEä¸Šé¢ï¼Œè€Œç›®å‰filebeatåœ¨GCEï¼Œ&lt;br /&gt;
æ‰€ä»¥è¦æ‹¿ECKåœ¨GKEä¸Šé¢çš„æ†‘è­‰ä¾†ç”¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é‡é»ä¾†äº†ï¼Œä½ æ€éº¼çŸ¥é“è¦æŠ“å“ªå€‹æ†‘è­‰ä¾†ç”¨ï¼Œ&lt;br /&gt;
æ­¤æ™‚æˆ‘å€‘å¯ä»¥å…ˆå»çœ‹ä¸€ä¸‹GKEçš„ECKè£¡é¢çš„è¨­å®šæª”ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;volumes:
   - name: elastic-internal-http-certificates
     secret:
       secretName: prod-es-http-certs-internal
       defaultMode: 420
       optional: false
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤æ™‚ï¼Œå°±èƒ½å»decode secretäº†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get secret prod-es-http-certs-internal -n elastic-system  -o=jsonpath=&#39;{.data.ca&#92;.crt}&#39; | base64 -d;echo

kubectl get secret prod-es-http-certs-internal -n elastic-system  -o=jsonpath=&#39;{.data.tls&#92;.crt}&#39; | base64 -d;echo

kubectl get secret prod-es-http-certs-internal -n elastic-system  -o=jsonpath=&#39;{.data.tls&#92;.key}&#39; | base64 -d;echo

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹‹å¾Œå°‡key ï¼Œæ›è¼‰è®“filebeatèƒ½å¤ è®€å–å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/running-on-docker.html#_configure_filebeat_on_docker&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Run Filebeat on Docker&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;filebeat-yml&quot; tabindex=&quot;-1&quot;&gt;Filebeat.yml&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;filebeat.inputs:
 - type: container
   enabled: true
   paths:
     - &#39;/var/lib/docker/containers/*/*.log&#39;
   tags: [&amp;quot;videosokoban-qa&amp;quot;]

 processors:
   - add_docker_metadata: ~
   - drop_event:
       when:
         not:
           equals:
             container.name: &amp;quot;zlm-server&amp;quot;
 output.elasticsearch:
   hosts:  https://prod-es-http:9200 &lt;a class=&quot;tag&quot; onclick=&quot;toggleTagSearch(this)&quot; data-content=&quot;#https&quot;&gt;#https&lt;/a&gt;://10.60.7.192:9200
   username: &amp;quot;elastic&amp;quot;
   password: &amp;quot;PASSWORD&amp;quot;
   ssl:
     certificate_authorities:
       - &amp;quot;/etc/pki/client/ca.crt&amp;quot;
     certificate: &amp;quot;/etc/pki/client/cert.pem&amp;quot;
     key: &amp;quot;/etc/pki/client/cert.key&amp;quot;      
   indices:
     - index: &amp;quot;videosokoban-qa-%{+yyyy.MM}&amp;quot;
       when.contains:
         tags: &amp;quot;videosokoban-qa&amp;quot;
 logging:
   metrics.enabled: false
   level: debug
   to_stderr: true
   to_files: true
   files:
     path: /var/log/filebeat
     name: filebeat
     keepfiles: 7
     permissions: 0644      
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;filebeat-input&quot; tabindex=&quot;-1&quot;&gt;filebeat.input&lt;/h3&gt;
&lt;p&gt;è¦æ“·å–çš„logä¾†æºï¼Œ&lt;br /&gt;
å·²å°‡æœ¬æ©Ÿçš„è·¯å¾‘æ›åˆ°dockerä¸Šé¢çš„è·¯å¾‘çš„ã€‚&lt;br /&gt;
&lt;code&gt;/var/lib/docker/containers/*/*.log&lt;/code&gt;&lt;br /&gt;
é€™å€‹è·¯å¾‘æ“æœ‰æ‰€æœ‰çš„docker logs&lt;/p&gt;
&lt;p&gt;type æœ‰åˆ†æˆ containerèˆ‡ dockerã€‚&lt;/p&gt;
&lt;p&gt;æ“šèªªæ˜¯dockeråªèƒ½ç”¨åœ¨dockerä¸Šé¢ï¼Œ&lt;br /&gt;
ä½†containerå¯ä»¥ç”¨åœ¨ä»»ä½•çš„å®¹å™¨æœå‹™ä¸Šé¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;type: docker&lt;/code&gt;çš„è¨­å®šæˆ‘æ²’æå‡ºä¾†ï¼Œæœ‰èˆˆè¶£çš„å¯ä»¥è‡ªå·±è©¦ä¸€è©¦ã€‚&lt;/p&gt;
&lt;h3 id=&quot;processors&quot; tabindex=&quot;-1&quot;&gt;processors&lt;/h3&gt;
&lt;p&gt;é€™é‚Šç‰½æ‰¯åˆ°çš„éƒ¨åˆ†æ¯”è¼ƒå¤š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;add_docker_metadata&lt;br /&gt;
å¢åŠ ä¸€äº›æ¬„ä½åˆ°logè£¡é¢ï¼Œè©³ç´°å…§å®¹å¯åƒè€ƒ &lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/add-docker-metadata.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Add Docker metadata&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;drop_event ï¼Œåˆ¤æ–·ç•¶container_nameæ˜¯ zlm-serverçš„æ™‚å€™ï¼Œ&lt;br /&gt;
å°±ä¸è¦ç´€éŒ„ï¼Œé€™å€‹å€¼æ˜¯å…ˆå¡è³‡æ–™é€²å»åˆ°ECKå¾Œï¼Œå†ç¯©é¸å‡ºä¾†çš„ã€‚&lt;br /&gt;
æ¢ä»¶åˆ¤æ–·å¯åƒè€ƒ&lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/defining-processors.html#conditions&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;conditions&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¹‹å‰é‚„æœ‰ç”¨é  &lt;code&gt;drop_fileds&lt;/code&gt; ,&lt;code&gt;add_cloud_metadata&lt;/code&gt;ï¼Œ&lt;br /&gt;
å…¶ä»–æ›´å¤šè«‹åƒè€ƒ&lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/defining-processors.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Define processors&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;output-elasticsearch&quot; tabindex=&quot;-1&quot;&gt;output.elasticsearch&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;host &amp;amp; ssl&lt;br /&gt;
è¦å°‡logä¸Ÿå»çš„ECKä¼ºæœå™¨ä½ç½®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;hostsé€™é‚Šï¼Œæœ¬ä¾†æ˜¯ç”¨GKEçš„å…§éƒ¨è² è¼‰å¹³è¡¡çš„ipä½ç½®ï¼Œ&lt;br /&gt;
ä½†æ˜¯ç›´æ¥ä½¿ç”¨ipä½ç½®çš„è©±ï¼Œæœƒå‡ºç¾éŒ¯èª¤ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;cannot validate certificate for 10.60.7.192 because it doesn&#39;t contain any IP SANs&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é€™æ˜¯å› ç‚ºä¼ºæœå™¨çš„æ†‘è­‰æ²’æœ‰åŠ éIPåœ°å€ï¼Œ&lt;br /&gt;
çœ‹ä¸€ä¸‹ &lt;code&gt;tls.crt&lt;/code&gt;ï¼Œè£¡é¢çš„é€™æ®µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/244-fig.1.png&quot; alt=&quot;244-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€™è£¡ä¸¦æ²’æœ‰ipä½ç½®ï¼Œæ‰€ä»¥æ²’è¾¦æ³•é€šéé©—è­‰ã€‚&lt;br /&gt;
ä½†é€™å€‹æ†‘è­‰æ˜¯ECKè‡ªå‹•ç”¢ç”Ÿçš„ï¼Œ&lt;br /&gt;
æ‰€ä»¥æ›å€‹æƒ³æ³•ï¼Œç›´æ¥è®“æœå‹™å»å‘¼å« &lt;code&gt;https://prod-es-http:9200&lt;/code&gt;&lt;br /&gt;
æ­¤æ™‚ï¼Œå°±æ˜¯åˆ°ä¸»æ©Ÿè¨­å®šä¸€ä¸‹&lt;code&gt;/etc/hosts&lt;/code&gt;ï¼Œ&lt;br /&gt;
æ–°å¢&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;10.60.7.192 prod-es-http
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/8.15/securing-communication-elasticsearch.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Secure communication with Elasticsearch&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;indices&lt;br /&gt;
å°‡ç‰¹å®šçš„tagç¶å®šåˆ°æŒ‡å®šçš„indicesä¸Š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/8.15/elasticsearch-output.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Configure the Elasticsearch output&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;logging&quot; tabindex=&quot;-1&quot;&gt;logging&lt;/h3&gt;
&lt;p&gt;é™¤éŒ¯æ™‚ï¼Œ&lt;br /&gt;
å¯ä»¥å…ˆå°‡&lt;code&gt;to_stderr: true &lt;/code&gt; é–‹å•Ÿã€‚&lt;br /&gt;
å¯ç›´æ¥ç”¨&lt;code&gt;docker logs filebeat&lt;/code&gt; çœ‹ logã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œå¦‚æœè¦ç”¨ &lt;code&gt;to_files&lt;/code&gt;, docker-compose.yaml è¨˜å¾—åŠ ä¸Š &lt;code&gt;user: root&lt;/code&gt;ï¼Œ&lt;br /&gt;
å¦å‰‡æœƒç™¼ç”Ÿæ¬Šé™ä¸è¶³çš„æƒ…æ³ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/configuration-logging.html#_logging_to_stderr&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Configure logging&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®˜æ–¹çš„filebeat.yaml ï¼Œè«‹åƒè€ƒ &lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-reference-yml.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;filebeat.reference.yml&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/244. åœ¨GCEä½¿ç”¨filebeatå‚³åˆ°GKEçš„ECK/" />
        </entry>
        <entry>
            <title>
                243. GCP å…¨åŸŸè² è¼‰å¹³è¡¡å™¨é€²éšè·¯ç”±è¨­å®š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/243. GCP å…¨åŸŸè² è¼‰å¹³è¡¡å™¨é€²éšè·¯ç”±è¨­å®š/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æ–°çš„æœå‹™ï¼Œå°±é †ä¾¿æ”¹ä¸€ä¸‹æ–°çš„è² è¼‰å¹³è¡¡å™¨å»æ›è¼‰bucketå§ã€‚&lt;br /&gt;
ç„¶å¾Œæ»¿æ»¿çš„å‘ï¼ŒGCPçš„èªªæ˜ç¯„ä¾‹ä¸çŸ¥é“åœ¨å¯«å•¥ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/243-fig.1.png&quot; alt=&quot;243-fig.1.png&quot; /&gt;&lt;br /&gt;
ä»¥å‰éƒ½æ˜¯é¸æ“‡å‚³çµ±ç‰ˆï¼Œ&lt;br /&gt;
è¨­å®šä¹Ÿé —ç°¡å–®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/243-fig.2.png&quot; alt=&quot;243-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä¸è¦çœ‹ä»–æ–°ç‰ˆä¸Šé¢å¯«å»ºè­°ï¼Œ&lt;br /&gt;
å°±çœŸçš„ç”¨ï¼Œè‡³å°‘å…ˆå¼„å€‹å‚³çµ±çš„æŠŠä½ è¦çš„æ±è¥¿è¨­å®šå¥½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/243-fig.3.png&quot; alt=&quot;243-fig.3.png&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/243-fig.4.png&quot; alt=&quot;243-fig.4.png&quot; /&gt;&lt;br /&gt;
ä¸Šé¢çš„è¨­å®šæ˜¯å°‡ domain/files/123.jpgï¼Œè½‰åˆ° bucketåº•ä¸‹çš„123.jpg&lt;/p&gt;
&lt;p&gt;é€™é‚Šæä¾›ä¸€å€‹æœ€å¿«çš„è§£æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å‡è¨­å·²ç¶“åœ¨å‚³çµ±çš„è² è¼‰å¹³è¡¡å™¨ä¸Šé¢å·²ç¶“å»ºç«‹å¥½äº†è¦å‰‡ï¼Œåç¨±ç‚º abc-qaã€‚&lt;br /&gt;
ä½¿ç”¨æŒ‡ä»¤æŸ¥è©¢&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute url-maps describe abc-qa
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°‡ &lt;code&gt;pathMatchers&lt;/code&gt;åº•ä¸‹çš„æ±è¥¿æŠ„å‡ºä¾†ï¼Œæ”¹ä¸€ä¸‹ï¼Œ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/243-fig.6.png&quot; alt=&quot;243-fig.6.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è²¼åˆ°ã€é€²éšå‹ä¸»æ©Ÿèˆ‡è·¯å¾‘è¦å‰‡ã€ä¸Šé¢å°±å¥½äº†ï¼ˆä¸è¦å¤ªç›¸ä¿¡ç¨‹å¼ç¢¼æŒ‡å—ï¼‰ã€‚&lt;br /&gt;
çœŸçš„è¦åƒè€ƒï¼Œè«‹çœ‹åº•ä¸‹é€£çµã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/243-fig.5.png&quot; alt=&quot;243-fig.5.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;serviceçš„éƒ¨åˆ†ï¼Œåˆ©ç”¨æŒ‡ä»¤æŸ¥è©¢ä½ çš„æœå‹™æˆ–bucketã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute backend-buckets list --uri
or
gcloud compute backend-services list --uri
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æŒ‡ä»¤æœƒå¾—åˆ°é¡ä¼¼ä¸‹é¢çš„ç¶²å€ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://www.googleapis.com/compute/v1/projects/&amp;lt;project_name&amp;gt;/global/backendBuckets/&amp;lt;bucket_name&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;service å¯ä»¥ç‚º &lt;code&gt;projects/&amp;lt;project_name&amp;gt;/global/backendBuckets/&amp;lt;bucket_name&amp;gt;&lt;/code&gt;&lt;br /&gt;
æˆ–æ˜¯&lt;br /&gt;
&lt;code&gt;global/backendBuckets/&amp;lt;bucket_name&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;å‡ºç¾éŒ¯èª¤ &lt;code&gt;Operation type [update] failed with message &amp;quot;Invalid resource: URL_MAP/513614964978.game-result-video-qa&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;éŒ¯èª¤çš„è¨­å®š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;defaultService: global/backendBuckets/abc-qa
name: matcher1
routeRules:
  - matchRules:
      - prefixMatch: /videos
    priority: 100
    routeAction:
      weightedBackendServices:
        - backendService: global/backendBuckets/abc-qa
          weight: 100
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å•é¡§å•ï¼Œèªªä¸è¦ç”¨ &lt;code&gt;weightedBackendServices&lt;/code&gt; ç›´æ¥æŒ‡å®šserviceã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;defaultService: global/backendBuckets/abc-qa
name: matcher1
routeRules:
  - matchRules:
      - prefixMatch: /videos
    priority: 100
    service: global/backendBuckets/abc-qa
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.  &lt;a href=&quot;https://stackoverflow.com/questions/76006293/gcp-https-load-balancer-l7-backend-bucket-issue&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GCP - HTTP(S) Load Balancer L7 Backend Bucket Issue&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;ç¨‹å¼ç¢¼æŒ‡å—çš„ &lt;code&gt;$[DEFAULT_SERVICE_URL]&lt;/code&gt;æ˜¯ä»€éº¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½¿ç”¨æŒ‡ä»¤æŸ¥è©¢&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud compute backend-buckets list --uri
or
gcloud compute backend-services list --uri
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.  &lt;a href=&quot;https://stackoverflow.com/questions/74024072/what-does-default-service-url-refer-to-when-setting-google-load-balancer-to&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;What does &amp;quot;$[DEFAULT_SERVICE_URL]&amp;quot; refer to when setting Google Load Balancer towards a GCP Storage Bucket?&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;conclusion&quot; tabindex=&quot;-1&quot;&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;æ²’äº‹ä¸è¦ç”¨æ–°ç‰ˆçš„æ‡‰ç”¨ç¨‹å¼è² è¼‰å¹³è¡¡å™¨ã€‚&lt;br /&gt;
å®˜æ–¹æ–‡ä»¶è¦çœ‹çš„è©±ï¼Œè«‹çœ‹ä¸‹é¢å…©å€‹é€£çµã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/load-balancing/docs/https/traffic-management-global#advanced_host_path_and_route_rule&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Advanced host,Â path,Â and route rule&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/load-balancing/docs/url-map-concepts&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;URL maps overview&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/243. GCP å…¨åŸŸè² è¼‰å¹³è¡¡å™¨é€²éšè·¯ç”±è¨­å®š/" />
        </entry>
        <entry>
            <title>
                242.  .Net core 8 ä½¿ç”¨apt install æ¬Šé™ä¸è¶³
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/242.  .Net core 8 ä½¿ç”¨apt install æ¬Šé™ä¸è¶³/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;ä»Šå¤©æ—©ä¸Šåˆè¢«äººæŠ“ä½èªªè¦é–‹æ–°æœå‹™ï¼Œ&lt;br /&gt;
çœ‹é€™å€‹æ¶æ§‹è¦æ€éº¼èª¿ã€‚&lt;br /&gt;
æ¸¬è©¦æ™‚ä¾†åˆ°Docker buildï¼Œç„¶å¾Œå°±æ›äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;SOLUTION&lt;/h1&gt;
&lt;p&gt;åœ¨ä½¿ç”¨apt updateçš„æ™‚å€™ï¼Œå‡ºç¾äº†&lt;code&gt;Permission denied&lt;/code&gt;&lt;br /&gt;
åœ¨Dockerfileçš„ä¸Šå±¤åŠ ä¸Š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;USER root
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°±èƒ½åŸ·è¡Œäº†ï¼Œ&lt;br /&gt;
ä½†ä¸çŸ¥é“ç‚ºä»€éº¼ï¼Œæˆ‘æ²’è¾¦æ³•å¾©ç¾éŒ¯èª¤ç‹€æ³ï¼Œ&lt;br /&gt;
ä½¿ç”¨ &lt;code&gt;docker system prune -a&lt;/code&gt; å…¨éƒ¨æ¸…é™¤äº†ä¹Ÿæ˜¯ä¸€æ¨£ã€‚&lt;/p&gt;
&lt;p&gt;ä½†ç•¶æ™‚ç¢ºå¯¦æœ‰ç¢°åˆ°é€™å€‹å•é¡Œã€‚&lt;/p&gt;
&lt;p&gt;é™„ä¸Šå®Œæ•´Dockerfile&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FROM mcr.microsoft.com/dotnet/aspnet:8.0 AS base

USER root
WORKDIR /app

RUN  apt update &amp;amp;&amp;amp; apt install -y curl python3
RUN curl -O https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-cli-443.0.0-linux-x86_64.tar.gz &#92;
&amp;amp;&amp;amp; tar -xf google-cloud-cli-443.0.0-linux-x86_64.tar.gz &amp;amp;&amp;amp; ./google-cloud-sdk/install.sh --command-completion=true --path-update=true --quiet
COPY gcs-download.json .
RUN /app/google-cloud-sdk/bin/gcloud auth activate-service-account abc@abc.com  --key-file=gcs-download.json
EXPOSE 8080
EXPOSE 8081
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…¶å¯¦æ‡‰è©²ç”¨workload Identityæœƒæ¯”è¼ƒå¥½ï¼Œä½†é€™ç¨‹å¼é è¨ˆè¦æ”¾çš„ä½ç½®ï¼Œ&lt;br /&gt;
è¦æ”¹çš„è©±è®Šå‹•å¤ªå¤§ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://learn.microsoft.com/en-us/dotnet/core/compatibility/containers/8.0/app-user&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;# New non-root &#39;app&#39; user in Linux images&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;2024-12-06&quot; tabindex=&quot;-1&quot;&gt;2024/12/06æ›´æ–°&lt;/h3&gt;
&lt;p&gt;é‚„æœ‰å¦ä¸€å€‹æ–¹æ³•ï¼Œ&lt;br /&gt;
åœ¨deployä¸Šé¢åŠ ä¸Šä¸‹é¢æŒ‡ä»¤ï¼Œ&lt;br /&gt;
è®“podä»¥rootçš„èº«åˆ†åŸ·è¡Œã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
securityContext:
	runAsUser: 0
	runAsNonRoot: false
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/security-context/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç‚º Pod æˆ–å®¹å™¨çµ„æ…‹å®‰å…¨ä¸Šä¸‹æ–‡&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/242.  .Net core 8 ä½¿ç”¨apt install æ¬Šé™ä¸è¶³/" />
        </entry>
        <entry>
            <title>
                241. MSSQLç´€éŒ„logï¼Œä½¿ç”¨QUERY_STORE
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/241. MSSQLç´€éŒ„logï¼Œä½¿ç”¨QUERY_STORE/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;ç·šä¸Šå‡ºäº†å•é¡Œï¼Œ&lt;br /&gt;
ä½†æ²’æœ‰ä½œTracerï¼Œæ‰€ä»¥å°±åªèƒ½å…ˆè¿½Slow Queryçœ‹çœ‹äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;p&gt;æœ¬ä¾†ä»¥ç‚ºåªèƒ½å¯«Triggerï¼Œç•¶è§¸ç™¼å‹•ä½œæ™‚ï¼Œè¨˜éŒ„ç•¶ä¸‹çš„Query&lt;br /&gt;
å¾Œä¾†å•äº†ä¸€ä¸‹GPTï¼Œæ‰ç™¼ç¾åŸä¾†ç¾åœ¨çš„SQL serveræœ‰ä¸€å€‹æŸ¥è©¢å­˜æ”¾å€ï¼Œ&lt;br /&gt;
æ˜¯å°ˆé–€æ‹¿ä¾†æ”¾SQLæŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æŸ¥è©¢å­˜æ”¾å€æœƒæ”¶é›† DML é™³è¿°å¼ï¼Œä¾‹å¦‚Â &lt;code&gt;SELECT&lt;/code&gt;ã€&lt;code&gt;INSERT&lt;/code&gt;ã€&lt;code&gt;UPDATE&lt;/code&gt;ã€&lt;code&gt;DELETE&lt;/code&gt;ã€&lt;code&gt;MERGE&lt;/code&gt;Â å’ŒÂ &lt;code&gt;BULK INSERT&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä½†é€™ä¹Ÿä¸æ˜¯å¾ˆæ–°çš„æ±è¥¿ï¼Œå¾SQL 2016å°±æœ‰äº†ã€‚&lt;br /&gt;
ä½†å¾SQL 2022é–‹å§‹ï¼Œé€™å€‹è¨­å®šå°±æœƒé è¨­æ‰“é–‹ã€‚&lt;/p&gt;
&lt;p&gt;é–‹å•Ÿæ–¹å¼&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ALTER DATABASE &amp;lt;database_name&amp;gt;
SET QUERY_STORE = ON (OPERATION_MODE = READ_WRITE);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œï¼Œå°±å¯ä»¥æŸ¥çœ‹çœ‹æ‰€æœ‰åŸ·è¡Œéçš„SQLäº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT Txt.query_text_id, Txt.query_sql_text, Pln.plan_id, Qry.*, RtSt.*
FROM sys.query_store_plan AS Pln
INNER JOIN sys.query_store_query AS Qry
    ON Pln.query_id = Qry.query_id
INNER JOIN sys.query_store_query_text AS Txt
    ON Qry.query_text_id = Txt.query_text_id
INNER JOIN sys.query_store_runtime_stats RtSt
ON Pln.plan_id = RtSt.plan_id;
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://learn.microsoft.com/zh-tw/sql/relational-databases/system-catalog-views/sys-query-store-query-transact-sql?view=sql-server-ver16&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;sys.query_store_queryæ¬„ä½èªªæ˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://learn.microsoft.com/zh-tw/sql/relational-databases/system-catalog-views/sys-query-store-runtime-stats-transact-sql?view=sql-server-ver16&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;sys.query_store_runtime_statsæ¬„ä½èªªæ˜&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;è¨ˆåŠƒå­˜æ”¾å€ä¸­å¯ç‚ºæŸ¥è©¢å„²å­˜çš„ä¸é‡è¤‡è¨ˆåŠƒæ•¸ç›®ï¼Œå—é™æ–¼Â &lt;strong&gt;max_plans_per_query&lt;/strong&gt;Â çµ„æ…‹é¸é …ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æŸ¥è©¢ max_plans_per_queryçš„å€¼åŠå…¶ä»–åƒæ•¸&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select *
from sys.database_query_store_options
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://learn.microsoft.com/zh-tw/sql/relational-databases/system-catalog-views/sys-database-query-store-options-transact-sql?view=sql-server-ver16&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;sys.database_query_store_optionsæ¬„ä½èªªæ˜&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é›–ç„¶èªªä»–çš„æœ€å¤§å€¼é è¨­æ˜¯200ï¼Œ&lt;br /&gt;
ä½†æˆ‘å¯¦éš›çœ‹èµ·ä¾†ï¼Œæˆ‘çš„plan_idå·²ç¶“è¶…é200äº†é‚„åœ¨å­˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/241-fig.1.png&quot; alt=&quot;241-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://learn.microsoft.com/zh-tw/sql/relational-databases/performance/monitoring-performance-by-using-the-query-store?view=sql-server-ver16&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨æŸ¥è©¢å­˜æ”¾å€ç›£è¦–æ•ˆèƒ½&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://learn.microsoft.com/zh-tw/sql/relational-databases/performance/manage-the-query-store?view=sql-server-ver16&amp;amp;source=recommendations&amp;amp;tabs=ssms&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç®¡ç†æŸ¥è©¢å­˜æ”¾å€çš„æœ€ä½³åšæ³•&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/241. MSSQLç´€éŒ„logï¼Œä½¿ç”¨QUERY_STORE/" />
        </entry>
        <entry>
            <title>
                240. git log é™¤éŒ¯æŒ‡ä»¤
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/240. git log é™¤éŒ¯æŒ‡ä»¤/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;å‰é™£å­ï¼ŒRDåŒä»æ‰¾ä¾†ï¼Œèªªç‚ºä»€éº¼é€™æ¨£çš„CIä¸æœƒéã€‚&lt;br /&gt;
æŸ¥äº†ä¸€é€£ä¸²çš„LOGï¼Œç™¼ç¾æ˜¯fast-forwardçš„å•é¡Œã€‚&lt;br /&gt;
éç¨‹ä¸­ç”¨äº†ä¸€å †git æŒ‡ä»¤...&lt;br /&gt;
ç´€éŒ„å§&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;åªé¡¯ç¤ºmergeçš„log&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;git log --merges
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;é¡¯ç¤ºå…¨éƒ¨Log&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;git log
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;é¡¯ç¤ºå–®ä¸€æäº¤çš„è©³ç´°è¨Šæ¯&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;git show &amp;lt;commit&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;æŸ¥è©¢æŸå€‹ç‰¹å®šæäº¤çš„tag&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;git tag --points-at &amp;lt;commit&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;åˆ—å‡ºæ‰€æœ‰tagåŠå°æ‡‰çš„commitå€¼&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;git show-ref --tags
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;ä»¥åœ–å½¢åŒ–é¡¯ç¤ºlog&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;git log --graph
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;7&quot;&gt;
&lt;li&gt;å–å¾—gitçš„tagè³‡æ–™&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;# å–é–‹é ­ç¬¬ä¸€å€‹
git tag --points-at &amp;lt;commit&amp;gt; | head -1
# å–çµå°¾ç¬¬ä¸€å€‹
git tag --points-at &amp;lt;commit&amp;gt; | tail -1
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;8&quot;&gt;
&lt;li&gt;Log Mergeæ¬„ä½çš„æ„æ€&lt;br /&gt;
å‡è¨­é¡¯ç¤ºçš„è³‡è¨Šå¦‚ä¸‹&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;commit a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t
Merge: 1a2b3c4 5d6e7f8
Author: John Doe &amp;lt;john.doe@example.com&amp;gt;
Date:   Tue Sep 11 14:30:00 2024 +0800

    Merge branch &#39;feature-branch&#39; into &#39;develop&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;developçš„ commitå€¼æ˜¯ &lt;code&gt;1a2b3c4&lt;/code&gt;&lt;br /&gt;
feature-branchçš„commitå€¼æ˜¯&lt;code&gt;5d6e7f8&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;é€™å…©å€‹æ˜¯ non-fast-forwardåˆä½µï¼Œå› ç‚ºçœ‹å¾—åˆ°Parents commitã€‚&lt;br /&gt;
å¦‚æœæ˜¯Fast-Forwardåˆä½µï¼Œåªæœƒé¡¯ç¤ºå–®å€‹æäº¤ï¼Œä¸æœƒæœ‰&lt;code&gt;Merge&lt;/code&gt;æ¨™è¨˜ã€‚&lt;/p&gt;
&lt;ol start=&quot;9&quot;&gt;
&lt;li&gt;pullæ™‚ä¸ä½¿ç”¨rebaseï¼Œè€Œæ˜¯ä½¿ç”¨merge&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;git pull --no-rebase
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/240. git log é™¤éŒ¯æŒ‡ä»¤/" />
        </entry>
        <entry>
            <title>
                239. Cloudflareç™½åå–®åŠæ“·å–åœ‹åˆ¥è¨­å®š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/239. Cloudflareç™½åå–®åŠæ“·å–åœ‹åˆ¥è¨­å®š/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æ¯ç•¶è¦å†è¨­å®šä¸€æ¬¡æ™‚ï¼Œ&lt;br /&gt;
éƒ½è¦æ‰¾ä¸€é™£å­ï¼Œæ‰æœƒç™¼ç¾åœ¨å“ªè£¡ï¼Œ&lt;br /&gt;
æ–¼æ˜¯æ‰ç™¼ç¾ï¼Œæˆ‘æ²’ç­†è¨˜å•Š...&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;h2 id=&quot;ç™½åå–®è¨­å®š&quot; tabindex=&quot;-1&quot;&gt;ç™½åå–®è¨­å®š&lt;/h2&gt;
&lt;p&gt;ç¶²è·¯å®‰å…¨-&amp;gt;WAF-&amp;gt;è‡ªè¨‚è¦å‰‡&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/239-fig.1.png&quot; alt=&quot;239-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ–°å¢è¦å‰‡&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/239-fig.2.png&quot; alt=&quot;239-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€™é‚Šå¯é¸æ“‡è¦ç¯©é¸å“ªå€‹æ¬„ä½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/239-fig.3.png&quot; alt=&quot;239-fig.3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å†ä¾†è¦å…è¨±é‚„æ˜¯é˜»æ“‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ€å¾Œè¨˜å¾—ã€ä½ˆç½²ã€ã€‚&lt;/p&gt;
&lt;h2 id=&quot;header&quot; tabindex=&quot;-1&quot;&gt;åœ‹åˆ¥header&lt;/h2&gt;
&lt;p&gt;ç¶²è·¯-&amp;gt; IP åœ°ç†ä½ç½®&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/239-fig.4.png&quot; alt=&quot;239-fig.4.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹å¾Œå°±èƒ½å¾headerè£¡é¢å–å¾—é€™å€‹ä½¿ç”¨è€…æ˜¯å“ªå€‹åœ‹å®¶ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloudflare.zendesk.com/hc/en-us/articles/200168236-Configuring-IP-geolocation&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Configuring IP geolocation&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/239. Cloudflareç™½åå–®åŠæ“·å–åœ‹åˆ¥è¨­å®š/" />
        </entry>
        <entry>
            <title>
                238. Steam Deckå®‰è£Cheat Engine
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/238. Steam Deckå®‰è£Cheat Engine/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æœ‰äº›éŠæˆ²ç”¨ç°¡æ˜“ç‰ˆçš„æœå°‹è»Ÿé«” &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/206.%20steamDeck%20%E7%9A%84%20Cheat%20Engine%E6%9B%BF%E4%BB%A3%E5%93%81/&quot;&gt;206. steamDeck çš„ Cheat Engineæ›¿ä»£å“&lt;/a&gt;ï¼Œ&lt;br /&gt;
å°±æ˜¯æœä¸åˆ°ï¼Œ&lt;br /&gt;
æƒ³èªªæ˜¯ä¸æ˜¯é‚„æ˜¯è©²ç”¨CEä¾†è©¦è©¦çœ‹äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;ä¸»è¦æ˜¯åƒè€ƒé€™å€‹å½±ç‰‡&lt;a href=&quot;https://www.youtube.com/watch?v=ISWTA5Cj1zs&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Cheat Tables (.CT) for Steam Deck SteamOS Cheat Engine Guide Setup Tutorial&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸»è¦å¹¾å€‹æ­¥é©Ÿï¼Œå‚™å¿˜ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸‹è¼‰è»Ÿé«”&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åˆ°æ¡Œé¢æ¨¡å¼ä¸‹ï¼Œå®‰è£ ProtonUP-Qt ä»¥åŠ Protontricks&lt;br /&gt;
å¦‚æœæ²’æœ‰å¤–æ¥æ»‘é¼ çš„è©±ï¼Œ&lt;br /&gt;
å³é‚Šçš„è§¸æ§ç‰ˆæ˜¯æ»‘é¼ ï¼Œ RT(R2) æ˜¯æ»‘é¼ å·¦éµï¼Œ LT(L2)æ˜¯æ»‘é¼ å³éµ&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;æ–°å¢SteamTinkerLaunch&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é–‹å•ŸProtonUP-Qt&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/238-fig.1.png&quot; alt=&quot;238-fig.1.png&quot; /&gt;&lt;br /&gt;
Add version&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/238-fig.2.png&quot; alt=&quot;238-fig.2.png&quot; /&gt;&lt;br /&gt;
åœ¨Compatibility toolé¸æ“‡ &lt;code&gt;SteamTinkerLaunch&lt;/code&gt;&lt;br /&gt;
ç„¶å¾Œ install&lt;/p&gt;
&lt;p&gt;å®Œæˆå¾Œé‡æ–°å•Ÿå‹•Steam&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;æ–°å¢CEåˆ°æ”¶è—åº«&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¡Œé¢æ¨¡å¼ä¸‹ï¼Œé–‹å•ŸSteamã€‚&lt;br /&gt;
åˆ°ã€æ”¶è—åº«ã€ï¼Œå·¦ä¸‹æ–¹æœ‰ä¸€å€‹æ–°å¢éŠæˆ²çš„æŒ‰éˆ•ï¼Œ&lt;br /&gt;
é¸æ“‡ ã€æ–°å¢éSteaméŠæˆ²ã€ã€‚&lt;br /&gt;
æ‰¾åˆ°ä½ å‰›å‰›ä¸‹è¼‰çš„CheatEngine.exeã€‚&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;å®‰è£CE&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ–°å¢å®Œæˆå¾Œï¼Œæœƒå‡ºç¾ä¸‹åœ–ï¼Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/238-fig.3.png&quot; alt=&quot;238-fig.3.png&quot; /&gt;&lt;br /&gt;
é¸æ“‡å³é‚Šçš„å…§å®¹ï¼Œ&lt;br /&gt;
é–‹å•Ÿç›¸å®¹æ€§ã€‚&lt;br /&gt;
ã€å¼·åˆ¶ä½¿ç”¨ç‰¹å®šSteam Play ç›¸å®¹æ€§å·¥å…·ã€æ‰“å‹¾ã€‚&lt;br /&gt;
é¸æ“‡ã€Proton Experimentalã€&lt;/p&gt;
&lt;p&gt;è¨­å®šå®Œå¾Œï¼Œå•Ÿå‹•ã€‚&lt;br /&gt;
æœƒçœ‹åˆ°å®‰è£ç•«é¢ï¼Œå°±å®‰è£å§ã€‚&lt;/p&gt;
&lt;h3 id=&quot;skip-all&quot; tabindex=&quot;-1&quot;&gt;æ³¨æ„ï¼Œä¸­é€”æœƒå•ä½ è¦ä¸è¦è£å…¶ä»–è»Ÿé«”ï¼Œé¸æ“‡Skip All&lt;/h3&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;è¤‡è£½è³‡æ–™å¤¾&lt;br /&gt;
æ‰¾åˆ°CEçš„è³‡æ–™å¤¾ï¼Œè¨˜å¾—å…ˆé–‹å•Ÿã€é¡¯ç¤ºéš±è—æª”ã€&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;/home/.steam/steam/steamapps/compatdata&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;é€™é‚Šæœ‰å…©ç¨®æ–¹å¼ï¼Œ&lt;br /&gt;
ä¸€ç¨®æ˜¯æ‰¾åˆ°å»ºç«‹æ—¥æœŸæ˜¯å‰›å‰›çš„ã€‚&lt;br /&gt;
å¦ä¸€ç¨®æ˜¯æ‰“é–‹&lt;code&gt;Protontricks&lt;/code&gt; çœ‹CheatEngineçš„ç·¨è™Ÿæ˜¯å“ªä¸€å€‹ã€‚&lt;/p&gt;
&lt;p&gt;åƒæˆ‘çš„æ˜¯&lt;code&gt;3262966842&lt;/code&gt; å°±å†é€²å»&lt;br /&gt;
&lt;code&gt;3262966842/pfx/drive_c/Program FIles&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å®Œæ•´è·¯å¾‘æœƒåƒé€™æ¨£&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/home/.steam/steam/steamapps/compatdata/3262966842/pfx/drive_c/Program files&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å°‡&lt;code&gt;Cheat Engine 7.5&lt;/code&gt;è³‡æ–™å¤¾æ•´å€‹è¤‡è£½ï¼Œ&lt;br /&gt;
è²¼åˆ°ä½ æƒ³è¦ä¿®æ”¹çš„éŠæˆ²è³‡æ–™å¤¾ä¸Šé¢ã€‚&lt;/p&gt;
&lt;p&gt;å‡è¨­æˆ‘è¦ä¿®Brotatoï¼Œç·¨è™Ÿæ˜¯ 1942280ï¼ˆé–‹&lt;code&gt;Protontricks&lt;/code&gt;æŸ¥ï¼‰ã€‚&lt;br /&gt;
å°±åƒè€ƒä¸Šé¢çš„è·¯å¾‘&lt;br /&gt;
&lt;code&gt;/home/.steam/steam/steamapps/compatdata/1942280/pfx/drive_c/Program files&lt;/code&gt;&lt;br /&gt;
åˆ°é€™é‚Šå°‡&lt;code&gt;Cheat Engine 7.5&lt;/code&gt;è³‡æ–™å¤¾ è²¼ä¸Šã€‚&lt;/p&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;è¨­å®šBrotatoç”¨&lt;code&gt;SteamTinkerLaunch&lt;/code&gt;é–‹å•Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¡Œé¢æ¨¡å¼&lt;br /&gt;
&lt;code&gt;å…§å®¹-&amp;gt;ç›¸å®¹æ€§-&amp;gt;å¼·åˆ¶ä½¿ç”¨ç‰¹å®šSteam Playç›¸å®¹æ€§å·¥å…·-&amp;gt;Steam Tinker Launch&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&quot;7&quot;&gt;
&lt;li&gt;è¨­å®šGame Menu&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¡Œé¢æ¨¡å¼&lt;br /&gt;
ç…§ä¸Šé¢çš„è¨­å®šå®Œå¾Œï¼ŒåŸ·è¡ŒéŠæˆ²ï¼Œæœƒè·³å‡ºä¸€å€‹è¦–çª—ï¼Œ&lt;br /&gt;
é¸æ“‡ä¸‹æ–¹çš„Main Menu-&amp;gt; Game Menu&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Use custom command æ‰“å‹¾
Custom command é¸æ“‡å‰›å‰›è¤‡è£½éä¾†è³‡æ–™å¤¾è£¡é¢çš„CheatEngine.exe
Fork custom command æ‰“å‹¾
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;8&quot;&gt;
&lt;li&gt;å•Ÿç”¨é–‹ç™¼è€…æ¨¡å¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯ä»¥å›åˆ°éŠæˆ²æ¨¡å¼ï¼Œ&lt;br /&gt;
å…ˆæŒ‰ä¸‹&lt;code&gt;Steam&lt;/code&gt;æŒ‰éˆ•ï¼Œç³»çµ±-&amp;gt; å•Ÿç”¨é–‹ç™¼è€…æ¨¡å¼ã€‚&lt;/p&gt;
&lt;ol start=&quot;9&quot;&gt;
&lt;li&gt;é–‹å§‹ä¿®æ”¹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åŸ·è¡Œä½ çš„éŠæˆ²ï¼Œæ­¤æ™‚æŒ‰ä¸‹ &lt;code&gt;Steam&lt;/code&gt; æŒ‰éˆ•ï¼Œ&lt;br /&gt;
æœƒçœ‹åˆ°åŒæ™‚æœ‰å…©å€‹æª”æ¡ˆåœ¨åŸ·è¡Œï¼Œ&lt;br /&gt;
ä¸€å€‹æ˜¯ä½ ç©å¾—éŠæˆ²ï¼Œ&lt;br /&gt;
å¦ä¸€å€‹å‰‡æ˜¯CheatEngineã€‚&lt;br /&gt;
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ æœ‰é¸æ“‡é–‹å•Ÿå…¶ä»–è¦–çª—çš„è©±ï¼Œ&lt;br /&gt;
éœ€è¦å¾&lt;code&gt;Steam&lt;/code&gt;æŒ‰éˆ•å»é¸æ“‡ä½ é–‹å•Ÿçš„å…¶ä»–è¦–çª—ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;æŠ“åœ–çš„è©±ä½¿ç”¨å…§å»ºçš„Spectacle&lt;/li&gt;
&lt;li&gt;è¤‡è£½åœ–ç‰‡çš„è©±ï¼Œä½¿ç”¨ssh&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;SteamDeck&lt;/p&gt;
&lt;p&gt;å¦‚æœæ²’è¨­éå¯†ç¢¼ï¼Œéœ€ä½¿ç”¨&lt;code&gt;passwd&lt;/code&gt;å…ˆè¡Œè¨­å®š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;systemctl enable sshd  # å•Ÿç”¨sshd
systemctl restart sshd  # é‡æ–°å•Ÿå‹•sshd
systemctl status sshd # æŸ¥è©¢ç‹€æ…‹

ip -4 addr # æŸ¥è©¢ipä½ç½®
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;PC&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;scp -r deck@192.168.1.2:/home/deck/Pictures/ .
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=ISWTA5Cj1zs&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Cheat Tables (.CT) for Steam Deck SteamOS Cheat Engine Guide Setup Tutorial&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://fearlessrevolution.com/index.php&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;FearLess Cheat Engine&lt;/a&gt; ä¸‹è¼‰CTæª”æ¡ˆçš„ç¶²ç«™&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/238. Steam Deckå®‰è£Cheat Engine/" />
        </entry>
        <entry>
            <title>
                237. GCP IAMç¶GKEçš„RBAC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/237. GCP IAMç¶GKEçš„RBAC/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;è¦å¼„å€‹å°ç¨‹å¼å®šæ™‚æ’ˆsecretçš„è³‡æ–™å‡ºä¾†ï¼Œ&lt;br /&gt;
ä½†å¢é›†æ˜¯èˆŠçš„æ²’æœ‰é–‹å•Ÿworkload Identityï¼Œ&lt;br /&gt;
ä¹Ÿåªèƒ½æ›IAMçš„service accountäº†ã€‚&lt;br /&gt;
åªçµ¦äºˆ&lt;code&gt;Kubernetes Engine Viewer&lt;/code&gt;çš„æ¬Šé™ï¼Œ&lt;br /&gt;
ä½†è¦æ’ˆsecretæ™‚ï¼Œæœƒé€šçŸ¥ç¼ºä¹&lt;code&gt;container.secrets.get&lt;/code&gt;çš„æ¬Šé™ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;æª¢æŸ¥Kubernetes Engine Vieweræœ‰å“ªäº›æ¬Šé™&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/237-fig.1.png&quot; alt=&quot;237-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://cloud.google.com/iam/docs/understanding-roles#container.viewer&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç¶²é æŸ¥è©¢&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦ä¸€ç¨®é€éæŒ‡ä»¤çš„æ–¹å¼ï¼Œåƒè€ƒä¸Šåœ–ä¸­çš„roleå°‡å€¼å¸¶å…¥åˆ°ä¸‹é¢æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud iam roles describe roles/container.viewer
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;s&gt;(æˆ‘å¾ˆæƒ³åæ§½ï¼Œæˆ‘æ€éº¼çŸ¥é“é€™å€‹åç¨±è¦ç”¨å“ªå€‹roleå»æŸ¥å•Šï¼Œé‚„ä¸æ˜¯è¦å»ç¶²é çœ‹)&lt;/s&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/iam?hl=zh-cn#permissions&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æŸ¥çœ‹ IAM è§’è‰²æˆäºˆçš„æ¬Šé™&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥å®Œçš„çµæœæ˜¯çœŸçš„ç¼ºä¹ &lt;code&gt;container.secrets.get&lt;/code&gt;çš„æ¬Šé™ã€‚&lt;br /&gt;
é‚£ç¾åœ¨çš„å•é¡Œæ˜¯ï¼Œè¦æ€éº¼åŠ æ¬Šé™ï¼Ÿ&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;é‡æ¸…èªè­‰æ–¹å¼&lt;br /&gt;
Google æ–‡ä»¶èªªæ˜&lt;br /&gt;
æ‚¨å¯ä»¥ä½¿ç”¨Â IAMÂ å’ŒÂ Kubernetes RBAC ä¾†æ§åˆ¶å° GKE å¢é›†çš„å­˜å–æ¬Šï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;IAM ä¸¦éç‰¹å®šæ–¼ Kubernetesï¼›å®ƒç‚ºå¤šç¨® Google Cloud ç”¢å“æä¾›èº«ä»½ç®¡ç†ï¼Œä¸¦ä¸”ä¸»è¦åœ¨ Google Cloud é …ç›®ç´šå±¤é‹è¡Œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kubernetes RBAC æ˜¯ Kubernetes çš„æ ¸å¿ƒçµ„æˆéƒ¨åˆ†ï¼Œå¯è®“æ‚¨é‡å°å¢é›†å…§çš„ä»»ä½•å°è±¡æˆ–å°è±¡é¡å‹å»ºç«‹å’Œæˆäºˆè§’è‰²ï¼ˆä¸€çµ„æ¬Šé™ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç‚ºäº†æˆæ¬Šæ“ä½œï¼ŒGKE é¦–å…ˆæœƒæª¢æŸ¥æ˜¯å¦å­˜åœ¨ RBAC æ”¿ç­–ã€‚å¦‚æœä¸å­˜åœ¨ RBAC æ”¿ç­–ï¼ŒGKE æœƒæª¢æŸ¥ IAM æ¬Šé™ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ GKE ä¸­ï¼ŒIAM å’Œ Kubernetes RBAC æ•´åˆåœ¨ä¸€èµ·ï¼Œæ‚¨å¯ä»¥é€šéä»»ä¸€å·¥å…·å‘ä½¿ç”¨è€…æˆæ¬Šï¼Œä½¿å…¶æœ‰è¶³å¤ çš„æ¬Šé™åŸ·è¡Œæ“ä½œã€‚é€™å°æ–¼ GKE å¢é›†çš„å¼•å°éç¨‹è‡³é—œé‡è¦ï¼Œå› ç‚ºé»˜èªæƒ…æ³ä¸‹ï¼ŒGoogle Cloud ä½¿ç”¨è€…ä¸å…·æœ‰ä»»ä½• Kubernetes RBAC RoleBindingsã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä½¿ç”¨åŸºæ–¼è§’è‰²çš„å­˜å–æ¬Šæ§åˆ¶å‘å¢é›†ä¸­çš„æ“ä½œæˆæ¬Š&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥èªªé è¨­çš„è§’è‰²æ¬Šé™å°±æ˜¯é‚£äº›ï¼Œè¦é‡å°è§’è‰²åŠ æ¬Šé™çš„è©±åªèƒ½è‡ªå·±æ–°å¢äº†ã€‚&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;æ–°å¢RBACæ¬Šé™&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ClusterRoleBinding ä½¿ç”¨ kind: userï¼Œç¶å®šIAMçš„å¸³è™Ÿã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secret-reader
rules:
  - apiGroups: [&amp;quot;&amp;quot;]
    resources: [&amp;quot;secrets&amp;quot;]
    verbs: [&amp;quot;get&amp;quot;, &amp;quot;list&amp;quot;, &amp;quot;watch&amp;quot;]
--- 
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: secret-reader-binding
subjects:
  - kind: User  # æˆ–è€… ServiceAccount æ ¹æ“šå…·é«”çš„éœ€æ±‚
    name: get-api@project.iam.gserviceaccount.com  # æ›¿æ›æˆå…·é«”çš„ä½¿ç”¨è€…æˆ–æœå‹™å¸³è™Ÿåç¨±
    apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;é©—è­‰æ–¹å¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç¶å®Œå¾Œï¼Œå¯ä½¿ç”¨æŒ‡ä»¤çœ‹çœ‹èƒ½ä¸èƒ½æ­£å¸¸è®€å–ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kc auth can-i get secret iplc-test-com-tls &#92;
-o=jsonpath=&#39;{.data.tls&#92;.crt}&#39; &#92;
--as get-api@project.iam.gserviceaccount.com
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯è®€å–æœƒé¡¯ç¤º Yesï¼Œå¦å‰‡å°±æ˜¯ No&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://kubernetes.io/docs/reference/access-authn-authz/authorization/#checking-api-access&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Checking API access&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/237. GCP IAMç¶GKEçš„RBAC/" />
        </entry>
        <entry>
            <title>
                236. Telegramå‚³é€æª”æ¡ˆ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/236. Telegramå‚³é€æª”æ¡ˆ/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;Why&lt;/h1&gt;
&lt;p&gt;çªç„¶æƒ³è¦æ‡¶ä¸€ä¸‹ï¼Œ&lt;br /&gt;
å®šæ™‚é€å€‹æª”æ¡ˆåˆ°TGä¸Šé¢ï¼Œ&lt;br /&gt;
æ€éº¼å‚³æ–‡å­—æˆ‘å¾ˆæ¸…æ¥šï¼Œä½†æª”æ¡ˆé‚„çœŸçš„æ²’æƒ³æ³•ã€‚&lt;br /&gt;
åªæ‰“ç®—å¼„å€‹shï¼Œä¸æƒ³å¯«codeã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;å•äº†GPTå¾ˆç°¡å–®ï¼Œ&lt;br /&gt;
å°±ä¸€è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;987654321&lt;/code&gt; æ˜¯ chat_id&lt;br /&gt;
&lt;code&gt;bot123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11&lt;/code&gt;æ˜¯TGçš„æ©Ÿå™¨äººtoken&lt;br /&gt;
&lt;code&gt;backup.zip&lt;/code&gt;æ˜¯æª”æ¡ˆ&lt;br /&gt;
&lt;code&gt;samplefile&lt;/code&gt;æ˜¯é™„è¨»&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -F chat_id=987654321 &#92;
     -F document=@/path/to/backup.zip &#92;
     -F caption=samplefile &#92;
     https://api.telegram.org/bot123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11/sendDocument

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://core.telegram.org/bots/api#senddocument&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;sendDocument&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å°è£œå……ï¼Œæƒ³åœ¨captionä¸Šé¢æ¨™æ³¨æ—¥æœŸï¼Œæ–¹ä¾¿å°‹æ‰¾ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;today=$(date +%F)
curl -F chat_id=987654321 &#92;
     -F document=@/path/to/backup.zip &#92;
     -F caption=samplefile-${today} &#92;
     https://api.telegram.org/bot123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11/sendDocument

&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/236. Telegramå‚³é€æª”æ¡ˆ/" />
        </entry>
        <entry>
            <title>
                235. Grafana Alert Template
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/235. Grafana Alert Template/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;Why&lt;/h1&gt;
&lt;p&gt;æ–°æœå‹™è¦ä¸Šç·šäº†ï¼Œ&lt;br /&gt;
è¦è¶•ç·ŠæŠŠ Observabilityåšä¸€åšï¼Œ&lt;br /&gt;
ä¹‹å‰çš„ç‰ˆæœ¬éƒ½æœƒæœ‰ä¸€é•·ä¸²è³‡è¨Šï¼Œ&lt;br /&gt;
çœ‹äº†å°±å¾ˆç…©ï¼Œä¸èƒ½å¾ˆç›´è§€çš„çŸ¥é“æ˜¯å“ªé‚Šå‡ºå•é¡Œã€‚&lt;br /&gt;
è¨Šæ¯åˆéƒ½è¦ä¸€å€‹ä¸€å€‹æ‰“ï¼Œ&lt;br /&gt;
æ‰€ä»¥ï¼Œæˆ‘èƒ½ä¸èƒ½å¼„æˆä¸€å€‹ç¯„æœ¬ï¼Œæ¸›å°‘æˆ‘äººå·¥çš„ä½œæ¥­ï¼Ÿ&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼Œå› æœ‰ç‰¹æ®Šç¬¦è™Ÿï¼Œå°è‡´ç·¨è­¯å‡ºå•é¡Œã€‚&lt;br /&gt;
æ•…å°‡è£¡é¢çš„æ‰€æœ‰{ } æ”¹ç‚ºå…¨å½¢ï¼Œè«‹è‡ªè¡Œæ”¹ç‚ºåŠå½¢&lt;br /&gt;
æ•…å°‡è£¡é¢çš„æ‰€æœ‰{ } æ”¹ç‚ºå…¨å½¢ï¼Œè«‹è‡ªè¡Œæ”¹ç‚ºåŠå½¢&lt;br /&gt;
æ•…å°‡è£¡é¢çš„æ‰€æœ‰{ } æ”¹ç‚ºå…¨å½¢ï¼Œè«‹è‡ªè¡Œæ”¹ç‚ºåŠå½¢&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;å¾ˆé‡è¦ï¼Œèªªä¸‰æ¬¡&quot; tabindex=&quot;-1&quot;&gt;å¾ˆé‡è¦ï¼Œèªªä¸‰æ¬¡&lt;/h2&gt;
&lt;p&gt;åŸå§‹çš„ç¯„æœ¬ï¼Œé€šå¸¸é•·æˆé€™æ¨£ã€‚&lt;br /&gt;
æœ‰å¾ˆå¤šè³‡è¨Šï¼Œä½†æœ‰äº›æ˜¯ç”¨ä¸åˆ°çš„ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[FIRING:1] (cpu-dealer GKE Cluster normal backend)

Firing  

Value: B=2.632  
Labels:  
- alertname = cpu-abc  
- grafana_folder = GKE Cluster  
- level = normal  
- service-type = backend  
Annotations:  
- summary = ç’°å¢ƒï¼šProd  
æ©Ÿå™¨åç¨±ï¼šdealer  
å‘Šè­¦è¨Šæ¯ï¼šCPUä½¿ç”¨é‡1core  
Source: http://localhost:3000/alerting/grafana/uRU7sCEnz/view?orgId=1  
Silence: http://localhost:3000/alerting/silence/new?alertmanager=grafana&amp;amp;matcher=alertname%3Dcpu-dealer&amp;amp;matcher=grafana_folder%3DGKE+Cluster&amp;amp;matcher=level%3Dnormal&amp;amp;matcher=service-type%3Dbackend  
Dashboard: http://localhost:3000/d/2-jy90-nk?orgId=1  
Panel: http://localhost:3000/d/2-jy90-nk?orgId=1&amp;amp;viewPanel=13
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€å¾Œçš„æˆæœ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[FIRING:1] sftp-qa Disk Space alarm-GCE (normal sftp-qa value_percent_used_mean_aggregate)


Annotations:  
- summary: ç’°å¢ƒï¼šalarm-GCE  
æ©Ÿå™¨åç¨±ï¼šsftp-qa  
å‘Šè­¦é …ç›®ï¼šsftp-qa Disk Space  
å‘Šè­¦è¨Šæ¯ï¼šç¡¬ç¢Ÿç©ºé–“ç›®å‰ 46.22% ï¼Œå·²é”ä¸Šé™ 70%  
Dashboard URL:  

[View Dashboard](http://&amp;lt;ip&amp;gt;/grafana/d/f649857c-4763-442f-9919-b41c3832d5b8?orgId=1)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;step-1&quot; tabindex=&quot;-1&quot;&gt;Step 1. ç¢ºèªç‰ˆæœ¬&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆç¢ºèªGrafanaçš„ç‰ˆæœ¬ï¼Œç›®å‰æˆ‘ä½¿ç”¨çš„æ˜¯&lt;code&gt;Grafana v11.2.0&lt;/code&gt;ã€‚&lt;br /&gt;
ç‰ˆæœ¬ä¸ä¸€æ¨£ï¼ŒæŒ‡ä»¤å¯èƒ½æœƒä¸ä¸€æ¨£ï¼Œéœ€è¦å†å»æŸ¥æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h3 id=&quot;step-2-notification-template&quot; tabindex=&quot;-1&quot;&gt;Step 2. è¨­å®šNotification Template&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/235-fig.1.png&quot; alt=&quot;235-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é–‹å•Ÿ Home &amp;gt; Alerting &amp;gt; Cotact points&lt;br /&gt;
åˆ‡æ›åˆ°åˆ†é  Notification Templates ï¼Œé¸æ“‡ Add Notification Template&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/235-fig.2.png&quot; alt=&quot;235-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å·¦ä¸Šçš„Templateæ¡†æ¡†ï¼Œè¼¸å…¥ä¸‹é¢ç¨‹å¼ç¢¼ã€‚&lt;br /&gt;
å¦‚æœæŒ‡ä»¤æ²’éŒ¯ï¼Œå¯ä»¥åœ¨å³é‚Šçš„previewçœ‹åˆ°çµæœã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ï½›ï½› define &amp;quot;alert_message&amp;quot; ï½ï½
  ï½›ï½› range .Alerts ï½ï½
    ï½›ï½› if gt (len .Annotations) 0 ï½ï½
      Annotations:
      ï½›ï½› range $key, $value := .Annotations ï½ï½
        - **ï½›ï½› $key ï½ï½**:   
        ï½›ï½› $value ï½ï½
      ï½›ï½› end ï½ï½
    ï½›ï½› else ï½ï½
      No Annotations found.
    ï½›ï½› end ï½ï½

    Dashboard URL:
    [View Dashboard](ï½›ï½› .DashboardURL ï½ï½)
  ï½›ï½› end ï½ï½
ï½›ï½› end ï½ï½
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™ç¨‹å¼æˆ‘æ˜¯å«GPTå¯«çš„ï¼Œå†ç¨å¾®å°æ”¹ä¸€ä¸‹ã€‚&lt;br /&gt;
å¦‚æœæƒ³è‡ªå·±é–‹ç™¼ï¼Œè«‹åƒè€ƒ&lt;a href=&quot;https://grafana.com/docs/grafana/latest/alerting/configure-notifications/template-notifications/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Configure notification messages&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;p.s. æ³¨æ„ç‰ˆæœ¬ï¼Œç‰ˆæœ¬ä¸ä¸€æ¨£å¾ç¶²é çš„ç‰ˆæœ¬è™Ÿèª¿æ•´&lt;/p&gt;
&lt;h3 id=&quot;step-3-notification-policy&quot; tabindex=&quot;-1&quot;&gt;Step 3. ç¶å®šnotification policy&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/235-fig.4.png&quot; alt=&quot;235-fig.4.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å›åˆ°Contact Pointsï¼Œ&lt;br /&gt;
é¸æ“‡ä½ çš„notification policy&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/235-fig.3.png&quot; alt=&quot;235-fig.3.png&quot; /&gt;&lt;br /&gt;
é¸æ“‡å‰›å‰›æ–°å¢çš„Template&lt;/p&gt;
&lt;p&gt;å¯ä»¥æŒ‰ä¸€ä¸‹Testé©—è­‰ä¸€ä¸‹æœ‰æ²’æœ‰é€šã€‚&lt;/p&gt;
&lt;h3 id=&quot;step-4-alert-rules&quot; tabindex=&quot;-1&quot;&gt;Step 4. è¨­å®š Alert Rules&lt;/h3&gt;
&lt;p&gt;åŸºæœ¬çš„è¨­å®šå°±åƒè€ƒ&lt;a href=&quot;https://grafana.com/docs/grafana/latest/alerting/fundamentals/alert-rules/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Alert rules&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨Summaryå‰‡æ˜¯è¼¸å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ç’°å¢ƒï¼šï½›ï½› index $labels &amp;quot;grafana_folder&amp;quot; ï½ï½
æ©Ÿå™¨åç¨±ï¼šï½›ï½› index $labels &amp;quot;metadata.label.system.name&amp;quot; ï½ï½
å‘Šè­¦é …ç›®ï¼šï½›ï½› index $labels &amp;quot;alertname&amp;quot; ï½ï½
å‘Šè­¦è¨Šæ¯ï¼šç¡¬ç¢Ÿç©ºé–“ç›®å‰ ï½›ï½› humanize (index $values &amp;quot;B&amp;quot;).Value  ï½ï½% ï¼Œå·²é”é–¥å€¼ 70%
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;indexæ˜¯ç”¨ä¾†é¡¯ç¤ºæ¨™ç±¤ä¸­çš„å…§å®¹ï¼Œ&lt;br /&gt;
å¯ä»¥æ›´æ–¹ä¾¿å¾—åˆ°ä½ æƒ³è¦çš„æ•¸å€¼ã€‚&lt;br /&gt;
å¯ä»¥åœ¨æ¸¬è©¦æ™‚ç”¨ &lt;code&gt;ï½›ï½› $labels ï½ï½&lt;/code&gt; çœ‹æœ‰å“ªäº›æ¨™ç±¤å¯ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;p.s ç‰ˆæœ¬ä¸ä¸€æ¨£ï¼Œå–å€¼çš„æ–¹å¼ä¹Ÿä¸ä¸€æ¨£ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ¨£å¯ä»¥ä½¿ç”¨çš„æ˜¯ &lt;code&gt;ï½›ï½› $value ï½ï½&lt;/code&gt; ï¼Œé€™é‚Šæ³¨æ„åªæœ‰valueæ²’æœ‰sã€‚&lt;br /&gt;
ä½†åœ¨ä½¿ç”¨indexæ™‚ï¼Œéœ€è¦åŠ ä¸Š sã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://grafana.com/docs/grafana/latest/alerting/fundamentals/notifications/templates/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Notification.Templates&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;code&gt;humanize&lt;/code&gt; æ˜¯æ¯”è¼ƒäººæ€§åŒ–çš„formatå‡½æ•¸ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;humanize&lt;/code&gt; æœƒå°‡å¤šé¤˜çš„å°æ•¸é»ä½æ•¸ç§»é™¤æˆ–æ”¹ç‚ºæ¯”è¼ƒæ˜“è®€çš„æ–¹å¼ã€‚&lt;br /&gt;
&lt;code&gt;humanizePercentage&lt;/code&gt; å°‡å°æ•¸é»è½‰ç‚ºç™¾åˆ†æ¯”&lt;br /&gt;
&lt;code&gt;humanizeDuration&lt;/code&gt; å°‡æ™‚é–“è½‰ç‚ºå¯è®€çš„æ™‚é–“&lt;/p&gt;
&lt;p&gt;æ›´å¤šå¯åƒè€ƒä¸‹é¢é€£çµï¼Œè£¡é¢ä¹Ÿæœ‰å…¶ä»–functionçš„ç”¨æ³•ã€‚&lt;br /&gt;
ref. &lt;a href=&quot;https://grafana.com/docs/grafana/latest/alerting/alerting-rules/templating-labels-annotations/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;humanize&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&quot;troubleshooting&quot; tabindex=&quot;-1&quot;&gt;Troubleshooting&lt;/h4&gt;
&lt;p&gt;ç•¶æœ‰ä¸€å€‹è®Šæ•¸å¯«éŒ¯æ™‚ï¼Œç™¼é€å‘Šè­¦æ™‚ï¼Œå…¨éƒ¨çš„è®Šæ•¸éƒ½ä¸æœƒé¡¯ç¤ºã€‚&lt;br /&gt;
æœƒè®Šæˆä¸‹é¢çš„æƒ…æ³ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- summary:  
ï½›ï½› $value ï½ï½  
ç’°å¢ƒï¼šï½›ï½› index $labels &amp;quot;grafana_folder&amp;quot; ï½ï½  
æ©Ÿå™¨åç¨±ï¼šï½›ï½› (index $values &amp;quot;B&amp;quot;).persistentvolumeclaim ï½ï½  
å‘Šè­¦é …ç›®ï¼šï½›ï½› index $labels &amp;quot;alertname&amp;quot; ï½ï½  
å‘Šè­¦è¨Šæ¯ï¼šç¡¬ç¢Ÿç©ºé–“ç›®å‰ ï½›ï½› humanizePercentage (index $values &amp;quot;B&amp;quot;).Value ï½ï½ ï¼Œå·²é”é–¥å€¼ 70%  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤æ™‚å°±çœ‹ä¸€ä¸‹æ˜¯ä¸æ˜¯é‚£é‚Šè¦åŠ ç©ºæ ¼æ²’ç©ºæ ¼ï¼Œ&lt;br /&gt;
æˆ–æ˜¯æŒ‡å®šçš„valuesçš„æ¬„ä½æœ‰éŒ¯èª¤ã€‚&lt;br /&gt;
åƒä¸Šé¢çš„éŒ¯èª¤ï¼Œæ©Ÿå™¨åç¨±çš„éƒ¨åˆ†æ‡‰è©²è¦æ”¹æˆé€™æ¨£ã€‚&lt;br /&gt;
&lt;code&gt;æ©Ÿå™¨åç¨±ï¼šï½›ï½› (index $values &amp;quot;B&amp;quot;).Labels.persistentvolumeclaim  ï½ï½&lt;/code&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/235. Grafana Alert Template/" />
        </entry>
        <entry>
            <title>
                234. Debianæ–°å¢è»Ÿé«”æº
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/234. Debianæ–°å¢è»Ÿé«”æº/</id>
            <content type="html">
                &lt;h1 id=&quot;cause&quot; tabindex=&quot;-1&quot;&gt;Cause&lt;/h1&gt;
&lt;p&gt;å®¢æˆ¶é‚£é‚Šè¦æ–°å¢ä¸€è‡ºæ©Ÿå™¨ï¼Œ&lt;br /&gt;
é€£éå»è£æ™‚ï¼Œæ‰ç™¼ç¾ä»–æ²’æœ‰software  repositories&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;OSï¼š Debian 10&lt;/p&gt;
&lt;p&gt;ç·¨è¼¯ &lt;code&gt;/etc/apt/sources.list&lt;/code&gt; ï¼Œ&lt;br /&gt;
æ–°å¢&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;deb http://ftp.debian.org/debian stable main contrib non-free
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å¾Œé–‹å•“terminalï¼ŒåŸ·è¡Œä¸‹é¢æŒ‡ä»¤ï¼Œæ”¶å·¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apt update
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.  &lt;a href=&quot;https://wiki.debian.org/DebianRepository&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;DebianRepository&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/234. Debianæ–°å¢è»Ÿé«”æº/" />
        </entry>
        <entry>
            <title>
                233. ä¸åŒå€åŸŸ GCEèˆ‡GKE LBé€£ç·š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/233. ä¸åŒå€åŸŸ GCEèˆ‡GKE LBé€£ç·š/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;Why&lt;/h1&gt;
&lt;p&gt;çªç„¶ä¾†äº†å€‹è¦æ±‚ï¼Œè¦å¾ç¾æ±çš„GCE é€£åˆ°è‡ºç£çš„GKEã€‚&lt;br /&gt;
GKEçš„æ©Ÿå™¨ï¼Œæˆ‘å»ºäº†å…§éƒ¨ LB ã€‚&lt;br /&gt;
ä½†åªæœ‰åŒä¸€å€‹å€åŸŸçš„GCEæ©Ÿå™¨èƒ½å¤ é€£ã€‚&lt;br /&gt;
é€£å»GCE ç›´æ¥pingå„å€‹å€åŸŸçš„æ©Ÿå™¨ï¼Œéƒ½æ­£å¸¸ã€‚&lt;br /&gt;
ä½†é€£GKEçš„LB å°±ä¸é€šã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;è«®è©¢äº†é¡§å•å…¬å¸ï¼Œ&lt;br /&gt;
ä»–å€‘çš„å›ç­”æ˜¯VPCå…§éƒ¨çš„å­ç¶²è·¯éƒ½æ˜¯äº’é€šçš„ï¼ˆæ²’éŒ¯ï¼Œæ¸¬è©¦æœ‰é€šï¼‰ï¼Œ&lt;br /&gt;
ä½†è¦é€£åˆ°GKEçš„internal LBï¼Œ&lt;br /&gt;
LBè¦é–‹å•“ &lt;code&gt;Global access&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/233-fig.1.png&quot; alt=&quot;233-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/load-balancing/docs/internal?hl=zh-cn#client-access&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®¢æˆ¶ç«¯è¨ªå•&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;troubleshoot&quot; tabindex=&quot;-1&quot;&gt;Troubleshoot&lt;/h3&gt;
&lt;p&gt;é€™å¹¾å¤©ç™¼ç¾å€‹å•é¡Œï¼Œ&lt;br /&gt;
æ‰‹å‹•æ›´æ”¹Global accesså¾Œï¼Œæœƒè‡ªå‹•è®ŠæˆDisableã€‚&lt;br /&gt;
é€šå ±çµ¦Googleäº†ï¼Œå¾ŒçºŒçœ‹ç‹€æ³ã€‚&lt;br /&gt;
ä½†æœ‰å»ºè­°èªªç›´æ¥åœ¨serverä¸Šé¢åŠ  annotations&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
kind: Service
metadata:
  annotations:
    # add globle access
    networking.gke.io/internal-load-balancer-allow-global-access: &amp;quot;true&amp;quot;
    networking.gke.io/load-balancer-type: &amp;quot;Internal&amp;quot;
  name: srs-source-internal
  namespace: srs-prod  
spec:
  type: LoadBalancer
  selector:
    app: srs-source
  ports:
    - protocol: TCP
      port: 1935
      targetPort: 1935
      name: rtmp
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/concepts/service-load-balancer-parameters#global_access_internal_lb&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Global access&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/233. ä¸åŒå€åŸŸ GCEèˆ‡GKE LBé€£ç·š/" />
        </entry>
        <entry>
            <title>
                232. GCE Observability å®‰è£agentå¤±æ•—
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/232. GCE Observability å®‰è£agentå¤±æ•—/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;åˆ©ç”¨terraformè£å¥½GCEå¾Œï¼Œ&lt;br /&gt;
è¦ä¾†è£ä¸€ä¸‹ç›£æ§ï¼Œæ‰èƒ½æŠŠè³‡æ–™ä¸Ÿå»grafanaè£é¢çµ±ä¸€ç®¡ã€‚&lt;br /&gt;
çµæœä¸€ç›´å¡åœ¨pendingã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/232-fig.1.png&quot; alt=&quot;232-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ä»¥çˆ²åªæ˜¯å–®ç´”å®‰è£å¤±æ•—ï¼Œå…ˆå¼·åˆ¶é—œé–‰æ›´æ–°å¾Œå†çœ‹çœ‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# é—œé–‰å®‰è£
sudo bash add-monitoring-agent-repo.sh --remove-repo
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‡æ–°å•“ç”¨å¾Œé‚„æœƒå¡åœ¨pendingï¼Œ&lt;br /&gt;
é‚„æ˜¯åªèƒ½æŸ¥ log ï¼Œåˆ° &lt;code&gt;/var/log/google-cloud-ops-agent&lt;/code&gt; åº•ä¸‹ï¼Œ&lt;br /&gt;
æŸ¥çœ‹&lt;code&gt;health-checks.log&lt;/code&gt; ã€‚ç™¼ç¾åŸå› å‡ºç¾permission denied&lt;/p&gt;
&lt;p&gt;å¾Œä¾†æ‰ç™¼ç¾åŸå› ï¼Œ&lt;br /&gt;
æˆ‘ç”¨terraformå»ºç«‹GCEæ™‚ï¼Œæ²’æœ‰è¨­å®šçš„service accountã€‚&lt;br /&gt;
å°è‡´ä»–è¦å®‰è£æ™‚æœƒå¡åœ¨é‚£é‚Šã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œåªè¦æŠŠæ©Ÿå™¨åœæ©Ÿï¼Œ&lt;br /&gt;
å†åˆ°  API and identity management é¸æ“‡ Service accountå³å¯ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/232-fig.2.png&quot; alt=&quot;232-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/stackdriver/docs/solutions/agents/ops-agent/troubleshoot-install-startup?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ’æŸ¥ Ops Agent å®‰è£å’Œå•Ÿå‹•å•é¡Œ&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/232. GCE Observability å®‰è£agentå¤±æ•—/" />
        </entry>
        <entry>
            <title>
                231. GKE node cpu limit è¨ˆç®—
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/231. GKE node cpu limit è¨ˆç®—/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;ç·šä¸Šæœå‹™çš„podï¼ŒCPUé£†é«˜ï¼Œ&lt;br /&gt;
å°è‡´æ‰€å±¬çš„nodeï¼ŒCPUä¹Ÿè·Ÿè‘—è¡é«˜ï¼Œåˆç†ã€‚&lt;br /&gt;
ä½†åŒä»å•äº†ä¸€å¥é‚£å€‹limitæ˜¯å•¥ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/231-fig.1.png&quot; alt=&quot;231-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é‚£æ¢ç´…è‰²çš„ç·šï¼Œ&lt;br /&gt;
åŸæœ¬ä»¥ç‚ºé‚£æ˜¯æŸå€‹nodeçš„cpuæœ€å¤§å€¼ï¼Œ&lt;br /&gt;
ä½†æˆ‘é€™å€‹nodeçš„æœ€å¤§cpuåªæœ‰4è€Œå·²ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æ’é™¤äº†CPUçš„ä¸Šé™ï¼Œæª¢è¦– Metrics Explorer&lt;br /&gt;
æŒ‡æ¨™ä¸Šé¢å¯«Limit cores&lt;br /&gt;
å†æ ¹æ“š &lt;a href=&quot;https://cloud.google.com/monitoring/api/metrics_kubernetes&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GKE system metrics&lt;/a&gt;ï¼Œå¾—çŸ¥é€™å€‹metricsæ˜¯æŒ‡ CPU cores limit of the containerã€‚&lt;/p&gt;
&lt;p&gt;ä½†æˆ‘åˆæ‡¶å¾—ä¸€å€‹ä¸€å€‹æŸ¥é€™å€‹nodeæœ‰å¤šå°‘limitã€‚&lt;br /&gt;
æ–¼æ˜¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get pods --all-namespaces -o wide --field-selector spec.nodeName=&amp;lt;node name&amp;gt; -o custom-columns=:metadata.name,:metadata.namespace --no-headers | while read -r name ns; do
  echo &amp;quot;$name and $ns&amp;quot;
  kubectl get pod $name -n $ns -o jsonpath=&#39;{.spec.containers[*].resources.limits.cpu}&#39; | xargs -n1 echo &amp;quot;  CPU Limit: &amp;quot;
done
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ¬ä¾†æ˜¯ç”¨forï¼Œä½†åœ¨åˆ‡å‰²name èˆ‡ namespaceå‡ºäº†é»å•é¡Œã€‚&lt;br /&gt;
æœ€å¾Œæ‰æ”¹ç”¨whileã€‚&lt;/p&gt;
&lt;p&gt;é€™é‚Šå°‡å€¼ç¸½å’Œè¨ˆç®—å‡ºä¾†å¾Œæ˜¯6.2ï¼Œæ•¸å€¼ä¸€æ¨£ï¼Œè¬åº•è§£é–‹äº†ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://kubernetes.io/docs/reference/kubectl/#output-options&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Command line tool (kubectl)&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/231. GKE node cpu limit è¨ˆç®—/" />
        </entry>
        <entry>
            <title>
                228. Cloudsql PITRé‚„åŸ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/228. Cloudsql PITRé‚„åŸ/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;Why&lt;/h1&gt;
&lt;p&gt;ç‚ºäº†ä¹‹å¾Œçš„æœå‹™ï¼Œè¦ä¾†é©—è­‰ä¸€ä¸‹æœ‰å“ªäº›çš„é‚„åŸæ–¹å¼ã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;ç›®å‰çœ‹åˆ°çš„æ˜¯PITRï¼Œçœ‹èªªæ˜æ–‡ä»¶ï¼Œå¯ä»¥é‚„åŸåˆ°ç§’çš„æ™‚é–“ã€‚&lt;br /&gt;
é–‹å•“æ–¹å¼å¯ä»¥åƒè€ƒ&lt;a href=&quot;https://cloud.google.com/sql/docs/sqlserver/backup-recovery/pitr&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®˜æ–¹æ–‡ä»¶&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æœ‰ä¸€é»æ–‡ä»¶æ²’æåˆ°ï¼Œ&lt;br /&gt;
ä½ åªèƒ½é¸å–äº”åˆ†é˜å‰çš„æ™‚é–“ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚&lt;/p&gt;
&lt;p&gt;ç¾åœ¨æ™‚é–“æ˜¯ 15:30 ï¼Œä½ é‚„åŸçš„æ™‚é–“é»ï¼Œåªèƒ½é¸æ“‡15:25ä»¥å‰ã€‚&lt;br /&gt;
ç•¶ç„¶é‚„æœ‰ç§’æ•¸çš„å•é¡Œï¼Œ&lt;br /&gt;
å¦‚æœé¸æ“‡çš„æ™‚é–“æ˜¯ 15:25~15:30çš„è©±ï¼Œæœƒå‡ºç¾é€™å€‹éŒ¯èª¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/228-fig.1.png&quot; alt=&quot;228-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦ç¢ºèªå¯ä»¥é€€çš„æ™‚é–“é»ï¼Œ&lt;br /&gt;
å¯ä»¥åŸ·è¡Œä¸‹é¢æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud sql instances get-latest-recovery-time &amp;lt;instanceName&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœƒé¡¯ç¤º&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kind: sql#getLatestRecoveryTime
latestRecoveryTime: &#39;2024-08-15T06:48:48Z&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸‹é¢å°±æ˜¯ä½ èƒ½å¤ é‚„åŸçš„æœ€æ—©æ™‚é–“ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/sql/instances/get-latest-recovery-time&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud sql instances get-latest-recovery-time&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/228. Cloudsql PITRé‚„åŸ/" />
        </entry>
        <entry>
            <title>
                225.  Debianå®‰è£å¾Œè¨­å®š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/225.  Debianå®‰è£å¾Œè¨­å®š/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;è¢«è¦æ±‚å¯«å€‹SOPå®‰è£æœå‹™çš„æ‰‹å†Šï¼Œ&lt;br /&gt;
å¾ä½œæ¥­ç³»çµ±é–‹å§‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;note&quot; tabindex=&quot;-1&quot;&gt;Note&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;*** is not in the sudoers file.Â Â This incident will be reported.â€&lt;br /&gt;
ä¿®æ”¹sudoersæª”æ¡ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;su root
chmod 777 /etc/sudoers
vi /etc/sudoers

# åœ¨ rootÂ Â Â Â ALL=(ALL:ALL) ALL ä¸‹é¢åŠ ä¸Š
Â &amp;lt;user&amp;gt; Â Â Â ALL=(ALL)ALL

chmod 440 /etc/sudoers
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;é—œé–‰ä¼‘çœ æ¨¡å¼&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sudo systemctl mask sleep.target suspend.target hibernate.target hybrid-sleep.target

åŸ·è¡Œå®Œå¾Œï¼Œéœ€é‡é–‹æ©Ÿ
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;
&lt;p&gt;é—œé–‰å®‰è£ä¾†æº&lt;br /&gt;
æœ€å¿«çš„æ–¹æ³•æ˜¯ç›´æ¥å¾æ¡Œé¢æ¨¡å¼é—œæ‰ã€‚&lt;br /&gt;
ç¨‹å¼ä»‹é¢æœå°‹ updateï¼Œæ‰¾åˆ°software &amp;amp; update ï¼Œ&lt;br /&gt;
é€²å»å¾Œåˆ‡åˆ°Other softwareçš„é ç±¤ï¼Œå°‡é¸é …æ‹¿æ‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®‰è£deb&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;apt install ./anydesk_6.3.2-1_amd64.deb
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/225.  Debianå®‰è£å¾Œè¨­å®š/" />
        </entry>
        <entry>
            <title>
                224. GKEçš„ç¯€é»ä¸Šé™æ¡å‘è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/224. GKEçš„ç¯€é»ä¸Šé™æ¡å‘è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;WHY&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘åŒäº‹åœ¨æå£“åŠ›æ¸¬è©¦ï¼Œ&lt;br /&gt;
ç„¶å¾Œä»–å°±çªç„¶è·Ÿæˆ‘èªªï¼Œæ¬¸ï¼Œæˆ‘çš„podèµ·ä¸ä¾†ã€‚&lt;br /&gt;
çœ‹äº†ä¸€ä¸‹ï¼Œç™¼ç¾ip æ‡‰è©²æ˜¯é‚„å¤ çš„å•Šï¼Œæ€éº¼æœƒå™´ &lt;code&gt;scale.up.error.ip.space.exhausted&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;how&quot; tabindex=&quot;-1&quot;&gt;How&lt;/h1&gt;
&lt;p&gt;å› ç‚ºGKEæœƒæ ¹æ“šæ¯å€‹nodeä¸Šï¼Œæ‰€è¨­å®šçš„æœ€å¤§podæ•¸é‡ï¼Œ&lt;br /&gt;
ä»¥åŠpodçš„CIDRç¯„åœï¼Œä¾†è¨ˆç®—ä½ é€™å€‹clusterå¯ä»¥é–‹åˆ°å¹¾å€‹nodeã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/flexible-pod-cidr?hl=zh-cn#configuring_maximum_pods_per_node&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;çµ„æ…‹æ¯å€‹ç¯€é»çš„ Pod æ•¸ä¸Šé™&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ–‡ç« çš„æœ€å¾Œæœ‰å¯«åˆ°ï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœæ‚¨å°‡é»˜èªæœ€å¤§ Pod æ•¸è¨­å®šç‚ºÂ &lt;code&gt;110&lt;/code&gt;Â ä¸¦å°‡ Pod çš„æ¬¡è¦ IP åœ°å€ç¯„åœè¨­å®šç‚ºÂ &lt;code&gt;/21&lt;/code&gt;ï¼ŒKubernetes æœƒç‚ºå¢é›†ä¸­çš„ç¯€é»åˆ†é…Â &lt;code&gt;/24&lt;/code&gt;Â CIDR ç¯„åœã€‚é€™å…è¨±å¢é›†ä¸­æœ€å¤šæœ‰&lt;mjx-container class=&quot;MathJax&quot; jax=&quot;SVG&quot; style=&quot;direction: ltr; position: relative;&quot;&gt;&lt;svg style=&quot;overflow: visible; min-height: 1px; min-width: 1px; vertical-align: 0;&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;7.008ex&quot; height=&quot;2.021ex&quot; role=&quot;img&quot; focusable=&quot;false&quot; viewBox=&quot;0 -893.3 3097.5 893.3&quot; aria-hidden=&quot;true&quot;&gt;&lt;g stroke=&quot;currentColor&quot; fill=&quot;currentColor&quot; stroke-width=&quot;0&quot; transform=&quot;scale(1,-1)&quot;&gt;&lt;g data-mml-node=&quot;math&quot;&gt;&lt;g data-mml-node=&quot;msup&quot;&gt;&lt;g data-mml-node=&quot;mn&quot;&gt;&lt;path data-c=&quot;32&quot; d=&quot;M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;TeXAtom&quot; transform=&quot;translate(533,363) scale(0.707)&quot; data-mjx-texclass=&quot;ORD&quot;&gt;&lt;g data-mml-node=&quot;mo&quot;&gt;&lt;path data-c=&quot;28&quot; d=&quot;M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mn&quot; transform=&quot;translate(389,0)&quot;&gt;&lt;path data-c=&quot;32&quot; d=&quot;M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;path data-c=&quot;34&quot; d=&quot;M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z&quot; transform=&quot;translate(500,0)&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mo&quot; transform=&quot;translate(1389,0)&quot;&gt;&lt;path data-c=&quot;2212&quot; d=&quot;M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mn&quot; transform=&quot;translate(2167,0)&quot;&gt;&lt;path data-c=&quot;32&quot; d=&quot;M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;path data-c=&quot;31&quot; d=&quot;M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z&quot; transform=&quot;translate(500,0)&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mo&quot; transform=&quot;translate(3167,0)&quot;&gt;&lt;path data-c=&quot;29&quot; d=&quot;M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;&lt;mjx-assistive-mml unselectable=&quot;on&quot; display=&quot;inline&quot; style=&quot;top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow data-mjx-texclass=&quot;ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;24&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;&lt;/mjx-assistive-mml&gt;&lt;/mjx-container&gt; = &lt;mjx-container class=&quot;MathJax&quot; jax=&quot;SVG&quot; style=&quot;direction: ltr; position: relative;&quot;&gt;&lt;svg style=&quot;overflow: visible; min-height: 1px; min-width: 1px; vertical-align: 0;&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;2.119ex&quot; height=&quot;1.885ex&quot; role=&quot;img&quot; focusable=&quot;false&quot; viewBox=&quot;0 -833.2 936.6 833.2&quot; aria-hidden=&quot;true&quot;&gt;&lt;g stroke=&quot;currentColor&quot; fill=&quot;currentColor&quot; stroke-width=&quot;0&quot; transform=&quot;scale(1,-1)&quot;&gt;&lt;g data-mml-node=&quot;math&quot;&gt;&lt;g data-mml-node=&quot;msup&quot;&gt;&lt;g data-mml-node=&quot;mn&quot;&gt;&lt;path data-c=&quot;32&quot; d=&quot;M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mn&quot; transform=&quot;translate(533,363) scale(0.707)&quot;&gt;&lt;path data-c=&quot;33&quot; d=&quot;M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;&lt;mjx-assistive-mml unselectable=&quot;on&quot; display=&quot;inline&quot; style=&quot;top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;&lt;/mjx-assistive-mml&gt;&lt;/mjx-container&gt; = Â 8Â å€‹ç¯€é»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘çš„æœ€å¤§podæ•¸ç‚º&lt;code&gt;110&lt;/code&gt;ï¼Œæ¬¡è¦IPç¯„åœä¹Ÿæ˜¯&lt;code&gt;/21&lt;/code&gt;ï¼Œ&lt;br /&gt;
æ‰€ä»¥nodeé–‹åˆ°8å€‹ï¼Œå°±é”åˆ°ä¸Šé™äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/224-fig.1.png&quot; alt=&quot;224-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œï¼Œç‚ºä»€éº¼kubernetesæ›¿å¢é›†çš„ç¯€é»åˆ†é…çš„ç¯„åœæ˜¯ &lt;code&gt;/24&lt;/code&gt;ã€‚&lt;br /&gt;
è¦å¾€ä¸‹çœ‹è¡¨æ ¼ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ¯å€‹ç¯€é»çš„æœ€å¤§ Pod æ•¸é‡&lt;/th&gt;
&lt;th&gt;æ¯å€‹ç¯€é»çš„ CIDR ç¯„åœ&lt;/th&gt;
&lt;th&gt;IP åœ°å€æ•¸é‡&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;/28&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9 - 16&lt;/td&gt;
&lt;td&gt;/27&lt;/td&gt;
&lt;td&gt;32&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;17 - 32&lt;/td&gt;
&lt;td&gt;/26&lt;/td&gt;
&lt;td&gt;64&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;33 - 64&lt;/td&gt;
&lt;td&gt;/25&lt;/td&gt;
&lt;td&gt;128&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;65 - 128&lt;/td&gt;
&lt;td&gt;/24&lt;/td&gt;
&lt;td&gt;256&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;129 - 256&lt;/td&gt;
&lt;td&gt;/23&lt;/td&gt;
&lt;td&gt;512&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å‡è¨­æœ€å¤§podæ•¸æ˜¯64ï¼Œé‚£æœ€å¤§ç¯€é»æ•¸å‰‡æ˜¯ &lt;mjx-container class=&quot;MathJax&quot; jax=&quot;SVG&quot; style=&quot;direction: ltr; position: relative;&quot;&gt;&lt;svg style=&quot;overflow: visible; min-height: 1px; min-width: 1px; vertical-align: 0;&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;7.008ex&quot; height=&quot;2.021ex&quot; role=&quot;img&quot; focusable=&quot;false&quot; viewBox=&quot;0 -893.3 3097.5 893.3&quot; aria-hidden=&quot;true&quot;&gt;&lt;g stroke=&quot;currentColor&quot; fill=&quot;currentColor&quot; stroke-width=&quot;0&quot; transform=&quot;scale(1,-1)&quot;&gt;&lt;g data-mml-node=&quot;math&quot;&gt;&lt;g data-mml-node=&quot;msup&quot;&gt;&lt;g data-mml-node=&quot;mn&quot;&gt;&lt;path data-c=&quot;32&quot; d=&quot;M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;TeXAtom&quot; transform=&quot;translate(533,363) scale(0.707)&quot; data-mjx-texclass=&quot;ORD&quot;&gt;&lt;g data-mml-node=&quot;mo&quot;&gt;&lt;path data-c=&quot;28&quot; d=&quot;M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mn&quot; transform=&quot;translate(389,0)&quot;&gt;&lt;path data-c=&quot;32&quot; d=&quot;M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;path data-c=&quot;35&quot; d=&quot;M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z&quot; transform=&quot;translate(500,0)&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mo&quot; transform=&quot;translate(1389,0)&quot;&gt;&lt;path data-c=&quot;2212&quot; d=&quot;M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mn&quot; transform=&quot;translate(2167,0)&quot;&gt;&lt;path data-c=&quot;32&quot; d=&quot;M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;path data-c=&quot;31&quot; d=&quot;M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z&quot; transform=&quot;translate(500,0)&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mo&quot; transform=&quot;translate(3167,0)&quot;&gt;&lt;path data-c=&quot;29&quot; d=&quot;M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;&lt;mjx-assistive-mml unselectable=&quot;on&quot; display=&quot;inline&quot; style=&quot;top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow data-mjx-texclass=&quot;ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;25&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;&lt;/mjx-assistive-mml&gt;&lt;/mjx-container&gt; = &lt;mjx-container class=&quot;MathJax&quot; jax=&quot;SVG&quot; style=&quot;direction: ltr; position: relative;&quot;&gt;&lt;svg style=&quot;overflow: visible; min-height: 1px; min-width: 1px; vertical-align: 0;&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;2.119ex&quot; height=&quot;1.904ex&quot; role=&quot;img&quot; focusable=&quot;false&quot; viewBox=&quot;0 -841.7 936.6 841.7&quot; aria-hidden=&quot;true&quot;&gt;&lt;g stroke=&quot;currentColor&quot; fill=&quot;currentColor&quot; stroke-width=&quot;0&quot; transform=&quot;scale(1,-1)&quot;&gt;&lt;g data-mml-node=&quot;math&quot;&gt;&lt;g data-mml-node=&quot;msup&quot;&gt;&lt;g data-mml-node=&quot;mn&quot;&gt;&lt;path data-c=&quot;32&quot; d=&quot;M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;g data-mml-node=&quot;mn&quot; transform=&quot;translate(533,363) scale(0.707)&quot;&gt;&lt;path data-c=&quot;34&quot; d=&quot;M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z&quot; style=&quot;stroke-width: 3;&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;&lt;mjx-assistive-mml unselectable=&quot;on&quot; display=&quot;inline&quot; style=&quot;top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;&lt;/mjx-assistive-mml&gt;&lt;/mjx-container&gt; = 16&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;å¾Œä¾†æ‰çŸ¥é“åŸå› ï¼Œç•¶æ™‚æœ‰å…¶ä»–æ¡ˆå­åœ¨æ‰‹ä¸­ï¼Œæ²’ç©ºæŸ¥åŸå› ã€‚&lt;br /&gt;
ä½†ç•¶ä¸‹ç›´æ¥åŠ å¤§æ©Ÿå™¨è¦æ ¼ï¼Œæ¸›å°‘nodeçš„æ•¸é‡ã€‚&lt;br /&gt;
æˆ–è€…ç›´æ¥åœ¨vpcä¸Šé¢å¢åŠ æ–°çš„pod rangeï¼Œæ‡‰è©²ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/224. GKEçš„ç¯€é»ä¸Šé™æ¡å‘è¨˜/" />
        </entry>
        <entry>
            <title>
                223. æª¢æŸ¥TCP or UDPæ˜¯å¦æœ‰é€š
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/223. æª¢æŸ¥TCP or UDPæ˜¯å¦æœ‰é€š/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;Why&lt;/h1&gt;
&lt;p&gt;æSRSçš„æ™‚å€™ï¼Œ&lt;br /&gt;
è¦æ¸¬è©¦webRTCçš„åŠŸèƒ½ï¼Œ&lt;br /&gt;
é–‹äº†UDPä½†ä¸çŸ¥é“åˆ°åº•æœ‰æ²’æœ‰é€šã€‚&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;h3 id=&quot;udp&quot; tabindex=&quot;-1&quot;&gt;UDP&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;nc -u YOUR_PUBLIC_IP 30000
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šçš„è©±ï¼Œæ‡‰è©²æ˜¯æœƒç™¼ç¾ä½ å¯ä»¥åœ¨åº•ä¸‹æ‰“å­—ï¼Œç„¶å¾Œä¸æœƒçµæŸã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/223-fig.1.png&quot; alt=&quot;223-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰å¦ä¸€å°ä¼ºæœå™¨å¯ä»¥ç©çš„è©±ï¼Œ&lt;br /&gt;
å¯ä»¥åšserver&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nc -ulvp 30000
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.wildfirechat.cn/webrtc/udp_connectivity.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;UDPé€£æ¥åŸ é€£é€šæ€§æª¢æŸ¥&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;netcat&quot; tabindex=&quot;-1&quot;&gt;Netcat&lt;/h3&gt;
&lt;p&gt;å®‰è£æ–¹å¼&lt;/p&gt;
&lt;p&gt;Mac&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;brew install netcat
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Linux&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apt install netcat
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;CentOS&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;yum install nc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Alpine Linux&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apk add netcat-openbsd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Docker&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apt install netcat-traditional
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;æª¢æŸ¥ç‰¹å®šçš„port æ˜¯å¦é–‹å•Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;nc -v 192.168.0.175 5000
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;æƒæå°æ–¹æ©Ÿå™¨çš„port&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;nc -vnz -w 1 192.168.233.208 1-1000 2000-3000
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ä¾†é‚„æœ‰é€å‡ºhttpè«‹æ±‚ã€å¯„ä¿¡ã€ç°¡æ˜“ç¶²é ä¼ºæœå™¨...&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://blog.gtwang.org/linux/linux-utility-netcat-examples/&quot; title=&quot;Netcatï¼ˆLinux nc æŒ‡ä»¤ï¼‰ç¶²è·¯ç®¡ç†è€…å·¥å…·å¯¦ç”¨ç¯„ä¾‹&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Netcatï¼ˆLinux nc æŒ‡ä»¤ï¼‰ç¶²è·¯ç®¡ç†è€…å·¥å…·å¯¦ç”¨ç¯„ä¾‹&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/223. æª¢æŸ¥TCP or UDPæ˜¯å¦æœ‰é€š/" />
        </entry>
        <entry>
            <title>
                222. elastic æ•´æ‰¹åˆªé™¤indics
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/222. elastic æ•´æ‰¹åˆªé™¤indics/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;Why&lt;/h1&gt;
&lt;p&gt;ä¸çŸ¥é“ç‚ºä»€éº¼ï¼ŒILMæ²’æœ‰å‹•ä½œï¼Œæ²’å°‡èˆŠçš„indicsåˆªé™¤ã€‚&lt;br /&gt;
å°è‡´elasticç›´æ¥å ±éŒ¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;this action would add [2] shards, but this cluster currently has [1000]/[1000] maximum normal shards open;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç·Šæ€¥è™•ç†å…ˆå°‡nodeçš„ sharedé–‹æˆ1500&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;PUT /_cluster/settings
{
  &amp;quot;persistent&amp;quot;: {
    &amp;quot;cluster.max_shards_per_node&amp;quot;: 1500
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;å†ä¾†æ˜¯æª¢æŸ¥ç‚ºä»€éº¼æœ‰é‚£éº¼å¤šsharedæ²’åˆªé™¤ï¼Œ&lt;br /&gt;
ä½†ä¸€æ•´æ‰¹ï¼Œä¸€å€‹ä¸€å€‹åˆªé™¤æœƒç˜‹æ‰ã€‚&lt;br /&gt;
ç”¨wildcardå»æœƒç™¼ç”ŸéŒ¯èª¤ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;DELETE /qa-backend-2024.02.*
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;éŒ¯èª¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{
  &amp;quot;error&amp;quot;: {
    &amp;quot;root_cause&amp;quot;: [
      {
        &amp;quot;type&amp;quot;: &amp;quot;illegal_argument_exception&amp;quot;,
        &amp;quot;reason&amp;quot;: &amp;quot;Wildcard expressions or all indices are not allowed&amp;quot;
      }
    ],
    &amp;quot;type&amp;quot;: &amp;quot;illegal_argument_exception&amp;quot;,
    &amp;quot;reason&amp;quot;: &amp;quot;Wildcard expressions or all indices are not allowed&amp;quot;
  },
  &amp;quot;status&amp;quot;: 400
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸æƒ³å¯«shellscriptï¼Œä¸€å€‹ä¸€å€‹æ’ˆindexå»åˆªé™¤ï¼Œ&lt;br /&gt;
æ–¼æ˜¯å…ˆé–‹æ”¾wildcardå§ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;PUT _cluster/settings
{
    &amp;quot;transient&amp;quot;: {
        &amp;quot;action.destructive_requires_name&amp;quot;: false // allow wildcards
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ä¾†åŸ·è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;DELETE /qa-backend-2024.02.*
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çµæŸã€‚&lt;/p&gt;
&lt;p&gt;ref.  &lt;a href=&quot;https://stackoverflow.com/questions/63388937/elasticsearch-how-to-delete-multiple-indexes-with-wildcard&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;elasticsearch, how to delete multiple indexes with wildcard&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/222. elastic æ•´æ‰¹åˆªé™¤indics/" />
        </entry>
        <entry>
            <title>
                221. L7mp stunnerç›£æ§
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/221. L7mp stunnerç›£æ§/</id>
            <content type="html">
                &lt;h1 id=&quot;why&quot; tabindex=&quot;-1&quot;&gt;Why&lt;/h1&gt;
&lt;p&gt;æœ‰äººæäº†ä¸€å€‹webRTC for k8sç”¨çš„å³æ™‚åª’é«”ä¸²æµæ–¹æ¡ˆï¼Œ&lt;br /&gt;
ç„¶å¾Œæˆ‘è¦ä¾†æ¥ç›£æ§äº†ã€‚&lt;br /&gt;
&lt;a href=&quot;https://l7mp.io/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;L7mp&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;solution&quot; tabindex=&quot;-1&quot;&gt;Solution&lt;/h1&gt;
&lt;p&gt;åƒè€ƒ&lt;a href=&quot;https://docs.l7mp.io/en/stable/MONITORING/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ–‡ä»¶&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŠ  &lt;code&gt;enableMetricsEndpoint&lt;/code&gt; åƒæ•¸åŠ åˆ°Dataplaneè£¡é¢&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;...
spec:
  args:
    - &#39;-w&#39;
    - &#39;--udp-thread-num=16&#39;
  command:
    - stunnerd
  enableMetricsEndpoint: true
  hostNetwork: false
  image: docker.io/l7mp/stunnerd:0.18.0
  imagePullPolicy: Always
  replicas: 1
  resources:
    limits:
      cpu: 2
      memory: 512Mi
    requests:
      cpu: 500m
      memory: 128Mi
  terminationGracePeriodSeconds: 3600
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å¼„å€‹æš«æ™‚çš„podæ¸¬è©¦çœ‹çœ‹metricsæœ‰æ²’æœ‰è³‡æ–™&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl run alpine-pod -n istio-system --image=alpine --restart=Never -- /bin/sleep 600
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…ˆå–å¾—stunnerçš„pod ipï¼Œå†ä¾†å°±çœ‹æœ‰æ²’æœ‰è³‡æ–™äº†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl http://192.168.1.25:8080/metrics
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ‰è³‡æ–™å¾Œå†ä¾†ä¸‹ä¸€æ­¥ã€‚&lt;br /&gt;
é€™é‚Šè¦æ³¨æ„ä¸€ä¸‹ï¼Œå‰›é–‹å¾Œï¼Œ&lt;code&gt;stunner&lt;/code&gt;é–‹é ­çš„æŒ‡æ¨™é€šé€šæ‰¾ä¸åˆ°ï¼Œ&lt;br /&gt;
åƒæ˜¯&lt;code&gt;stunner_listener_connections_total&lt;/code&gt;ã€&lt;code&gt;stunner_listener_bytes_total&lt;/code&gt;...ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘æ”¾äº†ä¸€é™£å­(ä¸€å…©å€‹å°æ™‚ï¼Ÿ)ï¼Œå°±çªç„¶è·‘å‡ºä¾†äº†ï¼Œ&lt;br /&gt;
æˆ‘ä¸ç¢ºå®šç‚ºä»€éº¼ï¼Œç­‰ä¹‹å¾Œå†æ¸¬è©¦çœ‹çœ‹ã€‚&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;prometheus è¨­å®š discover&lt;br /&gt;
è©³ç´°èªªæ˜ï¼Œåƒè€ƒ&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/209.%20k8s%E4%B8%ADsrs%E7%9A%84%E5%90%84%E5%80%8Bpod%20%20metrics%E5%8F%96%E5%BE%97/&quot;&gt;209. k8sä¸­srsçš„å„å€‹pod  metricså–å¾—&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;scrape_configs:
- job_name: &#39;ome&#39;
  scrape_interval: 10s
  kubernetes_sd_configs:
    - role: pod  
  relabel_configs:
    - source_labels: [__meta_kubernetes_pod_name]
      action: keep
      regex: tcp-gateway.*
    - source_labels: [__meta_kubernetes_pod_container_port_name]
      action: replace
      target_label: portname
      replacement: 8080  
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;å»ºç«‹Grafana&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;{
  &amp;quot;annotations&amp;quot;: {
    &amp;quot;list&amp;quot;: [
      {
        &amp;quot;builtIn&amp;quot;: 1,
        &amp;quot;datasource&amp;quot;: {
          &amp;quot;type&amp;quot;: &amp;quot;grafana&amp;quot;,
          &amp;quot;uid&amp;quot;: &amp;quot;-- Grafana --&amp;quot;
        },
        &amp;quot;enable&amp;quot;: true,
        &amp;quot;hide&amp;quot;: true,
        &amp;quot;iconColor&amp;quot;: &amp;quot;rgba(0, 211, 255, 1)&amp;quot;,
        &amp;quot;name&amp;quot;: &amp;quot;Annotations &amp;amp; Alerts&amp;quot;,
        &amp;quot;type&amp;quot;: &amp;quot;dashboard&amp;quot;
      }
    ]
  },
  &amp;quot;editable&amp;quot;: true,
  &amp;quot;fiscalYearStartMonth&amp;quot;: 0,
  &amp;quot;graphTooltip&amp;quot;: 0,
  &amp;quot;id&amp;quot;: 14,
  &amp;quot;links&amp;quot;: [],
  &amp;quot;liveNow&amp;quot;: false,
  &amp;quot;panels&amp;quot;: [
    {
      &amp;quot;datasource&amp;quot;: {
        &amp;quot;type&amp;quot;: &amp;quot;prometheus&amp;quot;,
        &amp;quot;uid&amp;quot;: &amp;quot;PBFA97CFB590B2093&amp;quot;
      },
      &amp;quot;fieldConfig&amp;quot;: {
        &amp;quot;defaults&amp;quot;: {
          &amp;quot;color&amp;quot;: {
            &amp;quot;mode&amp;quot;: &amp;quot;palette-classic&amp;quot;
          },
          &amp;quot;custom&amp;quot;: {
            &amp;quot;axisCenteredZero&amp;quot;: false,
            &amp;quot;axisColorMode&amp;quot;: &amp;quot;text&amp;quot;,
            &amp;quot;axisLabel&amp;quot;: &amp;quot;&amp;quot;,
            &amp;quot;axisPlacement&amp;quot;: &amp;quot;auto&amp;quot;,
            &amp;quot;barAlignment&amp;quot;: 0,
            &amp;quot;drawStyle&amp;quot;: &amp;quot;line&amp;quot;,
            &amp;quot;fillOpacity&amp;quot;: 0,
            &amp;quot;gradientMode&amp;quot;: &amp;quot;none&amp;quot;,
            &amp;quot;hideFrom&amp;quot;: {
              &amp;quot;legend&amp;quot;: false,
              &amp;quot;tooltip&amp;quot;: false,
              &amp;quot;viz&amp;quot;: false
            },
            &amp;quot;lineInterpolation&amp;quot;: &amp;quot;linear&amp;quot;,
            &amp;quot;lineWidth&amp;quot;: 1,
            &amp;quot;pointSize&amp;quot;: 5,
            &amp;quot;scaleDistribution&amp;quot;: {
              &amp;quot;type&amp;quot;: &amp;quot;linear&amp;quot;
            },
            &amp;quot;showPoints&amp;quot;: &amp;quot;auto&amp;quot;,
            &amp;quot;spanNulls&amp;quot;: false,
            &amp;quot;stacking&amp;quot;: {
              &amp;quot;group&amp;quot;: &amp;quot;A&amp;quot;,
              &amp;quot;mode&amp;quot;: &amp;quot;none&amp;quot;
            },
            &amp;quot;thresholdsStyle&amp;quot;: {
              &amp;quot;mode&amp;quot;: &amp;quot;off&amp;quot;
            }
          },
          &amp;quot;mappings&amp;quot;: [],
          &amp;quot;thresholds&amp;quot;: {
            &amp;quot;mode&amp;quot;: &amp;quot;absolute&amp;quot;,
            &amp;quot;steps&amp;quot;: [
              {
                &amp;quot;color&amp;quot;: &amp;quot;green&amp;quot;,
                &amp;quot;value&amp;quot;: null
              },
              {
                &amp;quot;color&amp;quot;: &amp;quot;red&amp;quot;,
                &amp;quot;value&amp;quot;: 80
              }
            ]
          }
        },
        &amp;quot;overrides&amp;quot;: []
      },
      &amp;quot;gridPos&amp;quot;: {
        &amp;quot;h&amp;quot;: 8,
        &amp;quot;w&amp;quot;: 12,
        &amp;quot;x&amp;quot;: 0,
        &amp;quot;y&amp;quot;: 0
      },
      &amp;quot;id&amp;quot;: 3,
      &amp;quot;options&amp;quot;: {
        &amp;quot;legend&amp;quot;: {
          &amp;quot;calcs&amp;quot;: [],
          &amp;quot;displayMode&amp;quot;: &amp;quot;list&amp;quot;,
          &amp;quot;placement&amp;quot;: &amp;quot;bottom&amp;quot;,
          &amp;quot;showLegend&amp;quot;: true
        },
        &amp;quot;tooltip&amp;quot;: {
          &amp;quot;mode&amp;quot;: &amp;quot;single&amp;quot;,
          &amp;quot;sort&amp;quot;: &amp;quot;none&amp;quot;
        }
      },
      &amp;quot;targets&amp;quot;: [
        {
          &amp;quot;datasource&amp;quot;: {
            &amp;quot;type&amp;quot;: &amp;quot;prometheus&amp;quot;,
            &amp;quot;uid&amp;quot;: &amp;quot;PBFA97CFB590B2093&amp;quot;
          },
          &amp;quot;editorMode&amp;quot;: &amp;quot;code&amp;quot;,
          &amp;quot;expr&amp;quot;: &amp;quot;stunner_listener_connections&amp;quot;,
          &amp;quot;legendFormat&amp;quot;: &amp;quot;__auto&amp;quot;,
          &amp;quot;range&amp;quot;: true,
          &amp;quot;refId&amp;quot;: &amp;quot;A&amp;quot;
        }
      ],
      &amp;quot;title&amp;quot;: &amp;quot;stunner_listener_connections&amp;quot;,
      &amp;quot;type&amp;quot;: &amp;quot;timeseries&amp;quot;
    },
    {
      &amp;quot;datasource&amp;quot;: {
        &amp;quot;type&amp;quot;: &amp;quot;prometheus&amp;quot;,
        &amp;quot;uid&amp;quot;: &amp;quot;PBFA97CFB590B2093&amp;quot;
      },
      &amp;quot;fieldConfig&amp;quot;: {
        &amp;quot;defaults&amp;quot;: {
          &amp;quot;color&amp;quot;: {
            &amp;quot;mode&amp;quot;: &amp;quot;palette-classic&amp;quot;
          },
          &amp;quot;custom&amp;quot;: {
            &amp;quot;axisCenteredZero&amp;quot;: false,
            &amp;quot;axisColorMode&amp;quot;: &amp;quot;text&amp;quot;,
            &amp;quot;axisLabel&amp;quot;: &amp;quot;&amp;quot;,
            &amp;quot;axisPlacement&amp;quot;: &amp;quot;auto&amp;quot;,
            &amp;quot;barAlignment&amp;quot;: 0,
            &amp;quot;drawStyle&amp;quot;: &amp;quot;line&amp;quot;,
            &amp;quot;fillOpacity&amp;quot;: 0,
            &amp;quot;gradientMode&amp;quot;: &amp;quot;none&amp;quot;,
            &amp;quot;hideFrom&amp;quot;: {
              &amp;quot;legend&amp;quot;: false,
              &amp;quot;tooltip&amp;quot;: false,
              &amp;quot;viz&amp;quot;: false
            },
            &amp;quot;lineInterpolation&amp;quot;: &amp;quot;linear&amp;quot;,
            &amp;quot;lineWidth&amp;quot;: 1,
            &amp;quot;pointSize&amp;quot;: 5,
            &amp;quot;scaleDistribution&amp;quot;: {
              &amp;quot;type&amp;quot;: &amp;quot;linear&amp;quot;
            },
            &amp;quot;showPoints&amp;quot;: &amp;quot;auto&amp;quot;,
            &amp;quot;spanNulls&amp;quot;: false,
            &amp;quot;stacking&amp;quot;: {
              &amp;quot;group&amp;quot;: &amp;quot;A&amp;quot;,
              &amp;quot;mode&amp;quot;: &amp;quot;none&amp;quot;
            },
            &amp;quot;thresholdsStyle&amp;quot;: {
              &amp;quot;mode&amp;quot;: &amp;quot;off&amp;quot;
            }
          },
          &amp;quot;mappings&amp;quot;: [],
          &amp;quot;thresholds&amp;quot;: {
            &amp;quot;mode&amp;quot;: &amp;quot;absolute&amp;quot;,
            &amp;quot;steps&amp;quot;: [
              {
                &amp;quot;color&amp;quot;: &amp;quot;green&amp;quot;,
                &amp;quot;value&amp;quot;: null
              },
              {
                &amp;quot;color&amp;quot;: &amp;quot;red&amp;quot;,
                &amp;quot;value&amp;quot;: 80
              }
            ]
          }
        },
        &amp;quot;overrides&amp;quot;: [
          {
            &amp;quot;matcher&amp;quot;: {
              &amp;quot;id&amp;quot;: &amp;quot;byName&amp;quot;,
              &amp;quot;options&amp;quot;: &amp;quot;{__name__=&#92;&amp;quot;stunner_listener_connections_total&#92;&amp;quot;, instance=&#92;&amp;quot;192.168.58.102:8080&#92;&amp;quot;, job=&#92;&amp;quot;ome&#92;&amp;quot;, name=&#92;&amp;quot;stunner/tcp-gateway/tcp-listener&#92;&amp;quot;, portname=&#92;&amp;quot;8080&#92;&amp;quot;}&amp;quot;
            },
            &amp;quot;properties&amp;quot;: [
              {
                &amp;quot;id&amp;quot;: &amp;quot;color&amp;quot;,
                &amp;quot;value&amp;quot;: {
                  &amp;quot;fixedColor&amp;quot;: &amp;quot;dark-yellow&amp;quot;,
                  &amp;quot;mode&amp;quot;: &amp;quot;fixed&amp;quot;
                }
              }
            ]
          }
        ]
      },
      &amp;quot;gridPos&amp;quot;: {
        &amp;quot;h&amp;quot;: 8,
        &amp;quot;w&amp;quot;: 12,
        &amp;quot;x&amp;quot;: 12,
        &amp;quot;y&amp;quot;: 0
      },
      &amp;quot;id&amp;quot;: 1,
      &amp;quot;options&amp;quot;: {
        &amp;quot;legend&amp;quot;: {
          &amp;quot;calcs&amp;quot;: [],
          &amp;quot;displayMode&amp;quot;: &amp;quot;list&amp;quot;,
          &amp;quot;placement&amp;quot;: &amp;quot;bottom&amp;quot;,
          &amp;quot;showLegend&amp;quot;: true
        },
        &amp;quot;tooltip&amp;quot;: {
          &amp;quot;mode&amp;quot;: &amp;quot;single&amp;quot;,
          &amp;quot;sort&amp;quot;: &amp;quot;none&amp;quot;
        }
      },
      &amp;quot;targets&amp;quot;: [
        {
          &amp;quot;datasource&amp;quot;: {
            &amp;quot;type&amp;quot;: &amp;quot;prometheus&amp;quot;,
            &amp;quot;uid&amp;quot;: &amp;quot;PBFA97CFB590B2093&amp;quot;
          },
          &amp;quot;editorMode&amp;quot;: &amp;quot;code&amp;quot;,
          &amp;quot;expr&amp;quot;: &amp;quot;rate(stunner_listener_connections_total[1m])&amp;quot;,
          &amp;quot;legendFormat&amp;quot;: &amp;quot;__auto&amp;quot;,
          &amp;quot;range&amp;quot;: true,
          &amp;quot;refId&amp;quot;: &amp;quot;A&amp;quot;
        }
      ],
      &amp;quot;title&amp;quot;: &amp;quot;listener_connections_total&amp;quot;,
      &amp;quot;type&amp;quot;: &amp;quot;timeseries&amp;quot;
    },
    {
      &amp;quot;datasource&amp;quot;: {
        &amp;quot;type&amp;quot;: &amp;quot;prometheus&amp;quot;,
        &amp;quot;uid&amp;quot;: &amp;quot;PBFA97CFB590B2093&amp;quot;
      },
      &amp;quot;description&amp;quot;: &amp;quot;ç›£è½å™¨ä¸Šç™¼é€æˆ–æ¥æ”¶çš„å­—ç¯€ç¸½æ•¸ã€‚&amp;quot;,
      &amp;quot;fieldConfig&amp;quot;: {
        &amp;quot;defaults&amp;quot;: {
          &amp;quot;color&amp;quot;: {
            &amp;quot;mode&amp;quot;: &amp;quot;palette-classic&amp;quot;
          },
          &amp;quot;custom&amp;quot;: {
            &amp;quot;axisCenteredZero&amp;quot;: false,
            &amp;quot;axisColorMode&amp;quot;: &amp;quot;text&amp;quot;,
            &amp;quot;axisLabel&amp;quot;: &amp;quot;&amp;quot;,
            &amp;quot;axisPlacement&amp;quot;: &amp;quot;auto&amp;quot;,
            &amp;quot;barAlignment&amp;quot;: 0,
            &amp;quot;drawStyle&amp;quot;: &amp;quot;line&amp;quot;,
            &amp;quot;fillOpacity&amp;quot;: 0,
            &amp;quot;gradientMode&amp;quot;: &amp;quot;none&amp;quot;,
            &amp;quot;hideFrom&amp;quot;: {
              &amp;quot;legend&amp;quot;: false,
              &amp;quot;tooltip&amp;quot;: false,
              &amp;quot;viz&amp;quot;: false
            },
            &amp;quot;lineInterpolation&amp;quot;: &amp;quot;linear&amp;quot;,
            &amp;quot;lineWidth&amp;quot;: 1,
            &amp;quot;pointSize&amp;quot;: 5,
            &amp;quot;scaleDistribution&amp;quot;: {
              &amp;quot;type&amp;quot;: &amp;quot;linear&amp;quot;
            },
            &amp;quot;showPoints&amp;quot;: &amp;quot;auto&amp;quot;,
            &amp;quot;spanNulls&amp;quot;: false,
            &amp;quot;stacking&amp;quot;: {
              &amp;quot;group&amp;quot;: &amp;quot;A&amp;quot;,
              &amp;quot;mode&amp;quot;: &amp;quot;none&amp;quot;
            },
            &amp;quot;thresholdsStyle&amp;quot;: {
              &amp;quot;mode&amp;quot;: &amp;quot;off&amp;quot;
            }
          },
          &amp;quot;mappings&amp;quot;: [],
          &amp;quot;thresholds&amp;quot;: {
            &amp;quot;mode&amp;quot;: &amp;quot;absolute&amp;quot;,
            &amp;quot;steps&amp;quot;: [
              {
                &amp;quot;color&amp;quot;: &amp;quot;green&amp;quot;,
                &amp;quot;value&amp;quot;: null
              },
              {
                &amp;quot;color&amp;quot;: &amp;quot;red&amp;quot;,
                &amp;quot;value&amp;quot;: 80
              }
            ]
          },
          &amp;quot;unit&amp;quot;: &amp;quot;bytes&amp;quot;
        },
        &amp;quot;overrides&amp;quot;: [
          {
            &amp;quot;matcher&amp;quot;: {
              &amp;quot;id&amp;quot;: &amp;quot;byName&amp;quot;,
              &amp;quot;options&amp;quot;: &amp;quot;{__name__=&#92;&amp;quot;stunner_listener_bytes_total&#92;&amp;quot;, direction=&#92;&amp;quot;rx&#92;&amp;quot;, instance=&#92;&amp;quot;192.168.58.102:8080&#92;&amp;quot;, job=&#92;&amp;quot;ome&#92;&amp;quot;, name=&#92;&amp;quot;stunner/tcp-gateway/tcp-listener&#92;&amp;quot;, portname=&#92;&amp;quot;8080&#92;&amp;quot;}&amp;quot;
            },
            &amp;quot;properties&amp;quot;: [
              {
                &amp;quot;id&amp;quot;: &amp;quot;color&amp;quot;,
                &amp;quot;value&amp;quot;: {
                  &amp;quot;fixedColor&amp;quot;: &amp;quot;purple&amp;quot;,
                  &amp;quot;mode&amp;quot;: &amp;quot;fixed&amp;quot;
                }
              }
            ]
          },
          {
            &amp;quot;matcher&amp;quot;: {
              &amp;quot;id&amp;quot;: &amp;quot;byName&amp;quot;,
              &amp;quot;options&amp;quot;: &amp;quot;rx&amp;quot;
            },
            &amp;quot;properties&amp;quot;: [
              {
                &amp;quot;id&amp;quot;: &amp;quot;color&amp;quot;,
                &amp;quot;value&amp;quot;: {
                  &amp;quot;fixedColor&amp;quot;: &amp;quot;dark-red&amp;quot;,
                  &amp;quot;mode&amp;quot;: &amp;quot;fixed&amp;quot;
                }
              }
            ]
          }
        ]
      },
      &amp;quot;gridPos&amp;quot;: {
        &amp;quot;h&amp;quot;: 9,
        &amp;quot;w&amp;quot;: 24,
        &amp;quot;x&amp;quot;: 0,
        &amp;quot;y&amp;quot;: 8
      },
      &amp;quot;id&amp;quot;: 2,
      &amp;quot;options&amp;quot;: {
        &amp;quot;legend&amp;quot;: {
          &amp;quot;calcs&amp;quot;: [],
          &amp;quot;displayMode&amp;quot;: &amp;quot;list&amp;quot;,
          &amp;quot;placement&amp;quot;: &amp;quot;bottom&amp;quot;,
          &amp;quot;showLegend&amp;quot;: true
        },
        &amp;quot;tooltip&amp;quot;: {
          &amp;quot;mode&amp;quot;: &amp;quot;single&amp;quot;,
          &amp;quot;sort&amp;quot;: &amp;quot;none&amp;quot;
        }
      },
      &amp;quot;targets&amp;quot;: [
        {
          &amp;quot;datasource&amp;quot;: {
            &amp;quot;type&amp;quot;: &amp;quot;prometheus&amp;quot;,
            &amp;quot;uid&amp;quot;: &amp;quot;PBFA97CFB590B2093&amp;quot;
          },
          &amp;quot;editorMode&amp;quot;: &amp;quot;code&amp;quot;,
          &amp;quot;expr&amp;quot;: &amp;quot;sum(irate(stunner_listener_bytes_total[1m])) by (direction)&amp;quot;,
          &amp;quot;hide&amp;quot;: false,
          &amp;quot;legendFormat&amp;quot;: &amp;quot;__auto&amp;quot;,
          &amp;quot;range&amp;quot;: true,
          &amp;quot;refId&amp;quot;: &amp;quot;A&amp;quot;
        }
      ],
      &amp;quot;title&amp;quot;: &amp;quot;stunner_listener_bytes_total&amp;quot;,
      &amp;quot;type&amp;quot;: &amp;quot;timeseries&amp;quot;
    },
    {
      &amp;quot;datasource&amp;quot;: {
        &amp;quot;type&amp;quot;: &amp;quot;prometheus&amp;quot;,
        &amp;quot;uid&amp;quot;: &amp;quot;PBFA97CFB590B2093&amp;quot;
      },
      &amp;quot;description&amp;quot;: &amp;quot;ç™¼é€åˆ°å¾Œç«¯æˆ–å¾å¾Œç«¯æ¥æ”¶çš„å­—ç¯€ç¸½æ•¸ã€‚&amp;quot;,
      &amp;quot;fieldConfig&amp;quot;: {
        &amp;quot;defaults&amp;quot;: {
          &amp;quot;color&amp;quot;: {
            &amp;quot;mode&amp;quot;: &amp;quot;palette-classic&amp;quot;
          },
          &amp;quot;custom&amp;quot;: {
            &amp;quot;axisCenteredZero&amp;quot;: false,
            &amp;quot;axisColorMode&amp;quot;: &amp;quot;text&amp;quot;,
            &amp;quot;axisLabel&amp;quot;: &amp;quot;&amp;quot;,
            &amp;quot;axisPlacement&amp;quot;: &amp;quot;auto&amp;quot;,
            &amp;quot;barAlignment&amp;quot;: 0,
            &amp;quot;drawStyle&amp;quot;: &amp;quot;line&amp;quot;,
            &amp;quot;fillOpacity&amp;quot;: 0,
            &amp;quot;gradientMode&amp;quot;: &amp;quot;none&amp;quot;,
            &amp;quot;hideFrom&amp;quot;: {
              &amp;quot;legend&amp;quot;: false,
              &amp;quot;tooltip&amp;quot;: false,
              &amp;quot;viz&amp;quot;: false
            },
            &amp;quot;lineInterpolation&amp;quot;: &amp;quot;linear&amp;quot;,
            &amp;quot;lineWidth&amp;quot;: 1,
            &amp;quot;pointSize&amp;quot;: 5,
            &amp;quot;scaleDistribution&amp;quot;: {
              &amp;quot;type&amp;quot;: &amp;quot;linear&amp;quot;
            },
            &amp;quot;showPoints&amp;quot;: &amp;quot;auto&amp;quot;,
            &amp;quot;spanNulls&amp;quot;: false,
            &amp;quot;stacking&amp;quot;: {
              &amp;quot;group&amp;quot;: &amp;quot;A&amp;quot;,
              &amp;quot;mode&amp;quot;: &amp;quot;none&amp;quot;
            },
            &amp;quot;thresholdsStyle&amp;quot;: {
              &amp;quot;mode&amp;quot;: &amp;quot;off&amp;quot;
            }
          },
          &amp;quot;mappings&amp;quot;: [],
          &amp;quot;thresholds&amp;quot;: {
            &amp;quot;mode&amp;quot;: &amp;quot;absolute&amp;quot;,
            &amp;quot;steps&amp;quot;: [
              {
                &amp;quot;color&amp;quot;: &amp;quot;green&amp;quot;,
                &amp;quot;value&amp;quot;: null
              },
              {
                &amp;quot;color&amp;quot;: &amp;quot;red&amp;quot;,
                &amp;quot;value&amp;quot;: 80
              }
            ]
          },
          &amp;quot;unit&amp;quot;: &amp;quot;bytes&amp;quot;
        },
        &amp;quot;overrides&amp;quot;: [
          {
            &amp;quot;matcher&amp;quot;: {
              &amp;quot;id&amp;quot;: &amp;quot;byName&amp;quot;,
              &amp;quot;options&amp;quot;: &amp;quot;rx&amp;quot;
            },
            &amp;quot;properties&amp;quot;: [
              {
                &amp;quot;id&amp;quot;: &amp;quot;color&amp;quot;,
                &amp;quot;value&amp;quot;: {
                  &amp;quot;fixedColor&amp;quot;: &amp;quot;dark-red&amp;quot;,
                  &amp;quot;mode&amp;quot;: &amp;quot;fixed&amp;quot;
                }
              }
            ]
          }
        ]
      },
      &amp;quot;gridPos&amp;quot;: {
        &amp;quot;h&amp;quot;: 8,
        &amp;quot;w&amp;quot;: 24,
        &amp;quot;x&amp;quot;: 0,
        &amp;quot;y&amp;quot;: 17
      },
      &amp;quot;id&amp;quot;: 4,
      &amp;quot;options&amp;quot;: {
        &amp;quot;legend&amp;quot;: {
          &amp;quot;calcs&amp;quot;: [],
          &amp;quot;displayMode&amp;quot;: &amp;quot;list&amp;quot;,
          &amp;quot;placement&amp;quot;: &amp;quot;bottom&amp;quot;,
          &amp;quot;showLegend&amp;quot;: true
        },
        &amp;quot;tooltip&amp;quot;: {
          &amp;quot;mode&amp;quot;: &amp;quot;single&amp;quot;,
          &amp;quot;sort&amp;quot;: &amp;quot;none&amp;quot;
        }
      },
      &amp;quot;targets&amp;quot;: [
        {
          &amp;quot;datasource&amp;quot;: {
            &amp;quot;type&amp;quot;: &amp;quot;prometheus&amp;quot;,
            &amp;quot;uid&amp;quot;: &amp;quot;PBFA97CFB590B2093&amp;quot;
          },
          &amp;quot;editorMode&amp;quot;: &amp;quot;code&amp;quot;,
          &amp;quot;expr&amp;quot;: &amp;quot;sum(irate(stunner_cluster_bytes_total[1m])) by (direction)&amp;quot;,
          &amp;quot;legendFormat&amp;quot;: &amp;quot;__auto&amp;quot;,
          &amp;quot;range&amp;quot;: true,
          &amp;quot;refId&amp;quot;: &amp;quot;A&amp;quot;
        }
      ],
      &amp;quot;title&amp;quot;: &amp;quot;stunner_cluster_bytes_total&amp;quot;,
      &amp;quot;type&amp;quot;: &amp;quot;timeseries&amp;quot;
    }
  ],
  &amp;quot;refresh&amp;quot;: false,
  &amp;quot;schemaVersion&amp;quot;: 38,
  &amp;quot;style&amp;quot;: &amp;quot;dark&amp;quot;,
  &amp;quot;tags&amp;quot;: [],
  &amp;quot;templating&amp;quot;: {
    &amp;quot;list&amp;quot;: []
  },
  &amp;quot;time&amp;quot;: {
    &amp;quot;from&amp;quot;: &amp;quot;2024-06-21T01:25:08.227Z&amp;quot;,
    &amp;quot;to&amp;quot;: &amp;quot;2024-06-21T04:12:21.776Z&amp;quot;
  },
  &amp;quot;timepicker&amp;quot;: {},
  &amp;quot;timezone&amp;quot;: &amp;quot;&amp;quot;,
  &amp;quot;title&amp;quot;: &amp;quot;stunner&amp;quot;,
  &amp;quot;uid&amp;quot;: &amp;quot;cbd52e5c-df69-45e6-b2ba-84433a4cd6ec&amp;quot;,
  &amp;quot;version&amp;quot;: 5,
  &amp;quot;weekStart&amp;quot;: &amp;quot;&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://yunlzheng.gitbook.io/prometheus-book/parti-prometheus-ji-chu/promql/prometheus-aggr-ops&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;PromQLèšåˆæ“ä½œ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/l7mp/stunner&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;stunner Github&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.l7mp.io/en/stable/MONITORING/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;stunner Document&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/221. L7mp stunnerç›£æ§/" />
        </entry>
        <entry>
            <title>
                220. windowså°‡ç¨‹å¼è®Šæˆæœå‹™çš„å¥½æ±è¥¿-winSW
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/220. windowså°‡ç¨‹å¼è®Šæˆæœå‹™çš„å¥½æ±è¥¿-winSW/</id>
            <content type="html">
                &lt;h1 id=&quot;ç·£ç”±&quot; tabindex=&quot;-1&quot;&gt;ç·£ç”±&lt;/h1&gt;
&lt;p&gt;æœ¬ä¾†åœ¨Linuxä¸Šé¢è·‘çš„dockerç’°å¢ƒï¼Œ&lt;br /&gt;
é€™æ¬¡åœ¨å®¢æˆ¶é‚£é‚Šçªç„¶è¦è®Šæˆç”¨windowsï¼Œ&lt;br /&gt;
éå¸¸å¥½ï¼Œä¹‹å‰å¼„çš„æ¶æ§‹å®Œå…¨ä¸ä¸€æ¨£ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ä¸»é¡Œ&quot; tabindex=&quot;-1&quot;&gt;ä¸»é¡Œ&lt;/h1&gt;
&lt;p&gt;ä»Šå¤©æœ‰ä¸€å€‹ç¨‹å¼ï¼Œä½ æƒ³è®“ä»–é–‹æ©Ÿæ™‚è‡ªå·±å•Ÿå‹•ï¼Œ&lt;br /&gt;
ä¸æ˜¯åˆ°msconfigè¨­å®šé–‹æ©Ÿå•Ÿå‹•ï¼Œå°±æ˜¯å¼„æˆæœå‹™ã€‚&lt;br /&gt;
ä½†é–‹æ©Ÿå•Ÿå‹•ï¼Œå¦‚æœæ²’æœ‰é–‹æ©Ÿå°±æ²’ç”¨äº†ï¼Œ&lt;br /&gt;
æ‰€ä»¥å¼„æˆæœå‹™ï¼Œä¸€èˆ¬æ˜¯æœ€ç©©å®šçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨nginxç‚ºç¯„ä¾‹èªªæ˜ï¼Œ&lt;br /&gt;
æˆ‘ä¹Ÿæ˜¯æ‰¾nginxå•Ÿå‹•æ™‚ï¼Œæ‰ç™¼ç¾é€™å€‹å¥½æ±è¥¿ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é¦–å…ˆï¼Œå…ˆä¸‹è¼‰&lt;a href=&quot;https://github.com/winsw/winsw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;winSW&lt;/a&gt;ï¼Œ&lt;br /&gt;
ä¸‹è¼‰å›ä¾†çš„ç¨‹å¼ï¼Œæ”¹åæˆ&lt;code&gt;nginx-server.exe&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŒä¸€å±¤ç›®éŒ„ä¸‹ï¼Œå»ºç«‹nginx-server.xml&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!-- nginx-service.xml --&amp;gt;
&amp;lt;service&amp;gt;
    &amp;lt;id&amp;gt;nginx&amp;lt;/id&amp;gt;
    &amp;lt;name&amp;gt;nginx&amp;lt;/name&amp;gt;
    &amp;lt;description&amp;gt;nginx&amp;lt;/description&amp;gt;
    &amp;lt;logpath&amp;gt;C:&#92;nginx-1.26.1&#92;server-logs&#92;&amp;lt;/logpath&amp;gt;
    &amp;lt;logmode&amp;gt;roll&amp;lt;/logmode&amp;gt;
    &amp;lt;depend&amp;gt;&amp;lt;/depend&amp;gt;
    &amp;lt;executable&amp;gt;C:&#92;nginx-1.26.1&#92;nginx.exe&amp;lt;/executable&amp;gt;
    &amp;lt;stopexecutable&amp;gt;C:&#92;nginx-1.26.1&#92;nginx.exe -s stop&amp;lt;/stopexecutable&amp;gt;
&amp;lt;/service&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;å®‰è£&lt;br /&gt;
commandåŸ·è¡Œ &lt;code&gt;nginx-server.exe install&lt;/code&gt;&lt;br /&gt;
å¦‚æœè¦åˆªé™¤å‰‡æ˜¯ &lt;code&gt;nginx-server.exe uninstall&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;é™¤éŒ¯&quot; tabindex=&quot;-1&quot;&gt;é™¤éŒ¯&lt;/h3&gt;
&lt;p&gt;nginx.confå¦‚æœå¯«éŒ¯ï¼Œå°è‡´æœå‹™ç„¡æ³•å•Ÿå‹•æ™‚ï¼Œ&lt;br /&gt;
å¯åˆ°ä¸Šé¢çš„&lt;code&gt;&amp;lt;logpaht&amp;gt;&lt;/code&gt;ä½ç½®æŸ¥çœ‹éŒ¯èª¤è¨Šæ¯ï¼Œ&lt;br /&gt;
ç…§ä¸Šé¢çš„ç¯„ä¾‹ï¼Œæ˜¯&lt;code&gt;C:&#92;nginx-1.26.1&#92;server-logs&#92;&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šæ˜¯æœ€ç°¡å–®çš„ç”¨æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/winsw/winsw&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;githubæ–‡ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.king011.com/view/en-US/view/ms-os-tools/WinSW&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;WinSW&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/220. windowså°‡ç¨‹å¼è®Šæˆæœå‹™çš„å¥½æ±è¥¿-winSW/" />
        </entry>
        <entry>
            <title>
                219. Google Cloud Managed Service for Prometheus  è²»ç”¨
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/219. Google Cloud Managed Service for Prometheus  è²»ç”¨/</id>
            <content type="html">
                &lt;h1 id=&quot;ç·£ç”±&quot; tabindex=&quot;-1&quot;&gt;ç·£ç”±&lt;/h1&gt;
&lt;p&gt;ç”±æ–¼GKEé è¨­æƒ å•Ÿç”¨ Google Cloud Managed Service for Prometheusï¼Œ&lt;br /&gt;
ä¾†æ¯”è¼ƒä¸€ä¸‹ï¼Œçœ‹ä¹‹å¾Œæ˜¯ä¸æ˜¯èƒ½å¤ ä¸€å€‹ç¶²ç«™çœ‹åˆ°å…¨éƒ¨çš„åœ–è¡¨ã€‚&lt;br /&gt;
ä¸éä¹Ÿè¦å…ˆçœ‹ä¸‹åƒ¹æ ¼ï¼Œå¦‚æœå¤ªè²´ï¼Œé‚£ä¹Ÿåªèƒ½åˆ†é–‹äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ä¸»é¡Œ&quot; tabindex=&quot;-1&quot;&gt;ä¸»é¡Œ&lt;/h1&gt;
&lt;h3 id=&quot;2024-06-07&quot; tabindex=&quot;-1&quot;&gt;2024/06/07&lt;/h3&gt;
&lt;p&gt;åƒ¹æ ¼&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$0.06/ç™¾è¬å€‹&lt;a href=&quot;https://cloud.google.com/stackdriver/pricing?hl=zh-cn#metrics-charged-by-samples&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;æ¨£æœ¬&lt;/a&gt;â€ ï¼šæ³¨å…¥çš„å‰ 0-50 å„„å€‹æ¨£æœ¬â€ &lt;/li&gt;
&lt;li&gt;$0.048/ç™¾è¬æ¨£æœ¬ï¼šæ¥ä¸‹ä¾†çš„ 50-2500 å„„å€‹æ¨£æœ¬&lt;/li&gt;
&lt;li&gt;$0.036/ç™¾è¬æ¨£æœ¬ï¼šæ¥ä¸‹ä¾†æ³¨å…¥çš„ 250-5,000 å„„å€‹æ¨£æœ¬&lt;/li&gt;
&lt;li&gt;æ³¨å…¥çš„æ¯ç™¾è¬å€‹æ¨£æœ¬ $0.024ï¼šè¶…é 5000 å„„å€‹æ¨£æœ¬&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€™æ•¸å­—ä»¥ç™¾è¬è¨ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸‹å­çœŸçš„ä¸çŸ¥é“è©²æ€éº¼ç®—ï¼Œ&lt;br /&gt;
é‚£å°±å…ˆç®—å‡º æ¯10ç§’ä¸€å€‹metricï¼Œé‚£ä¸€å€‹æœˆæœƒæœ‰å¤šå°‘è³‡æ–™ã€‚&lt;br /&gt;
ans: 259,200ç­†ã€‚æ‰€ä»¥ä¸€å€‹æœˆ $0.06USD&lt;/p&gt;
&lt;p&gt;åŠ æ¸›ç®—ä¸€ä¸‹50å„„å€‹æ¨£æœ¬ï¼Œè¦å¤šå°‘éŒ¢ã€‚&lt;br /&gt;
ans: $300 USD&lt;/p&gt;
&lt;p&gt;ç¾åœ¨ä¾†ç®—ä¸€ä¸‹ï¼Œä¸€èˆ¬å»ºpvcè¦å¤šå°‘ï¼Œ&lt;br /&gt;
å»ºç«‹ä¸€å€‹PVCï¼Œé è¨­ä½¿ç”¨ Balanced persistent diskã€‚&lt;br /&gt;
pvcé€šå¸¸æ›å€‹100Gï¼Œæ¯å€‹æœˆç´„$10 USDã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Price (monthly in USD)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Standard provisioned space&lt;/td&gt;
&lt;td&gt;$0.04 per GiB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SSD provisioned space&lt;/td&gt;
&lt;td&gt;$0.17 per GiB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Balanced provisioned space&lt;/td&gt;
&lt;td&gt;$0.1 per GiB&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h1&gt;
&lt;p&gt;é€™åƒ¹æ ¼çœ‹èµ·ä¾†é‚„é —æœ‰å¸å¼•åŠ›çš„ï¼Œä¾†è©¦è©¦çœ‹å§ã€‚&lt;/p&gt;
&lt;p&gt;æ—¥å¾Œå¦‚æœè¦å¾å¸³å–®çœ‹æœ‰å¤šå°‘ç­†è³‡æ–™çš„è©±ï¼Œ&lt;/p&gt;
&lt;p&gt;Service -&amp;gt; &lt;strong&gt;Cloud Monitoring&lt;/strong&gt;&lt;br /&gt;
SKUs -&amp;gt; Prometheus Samples Ingested &amp;amp;  Monitoring API Requests&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/stackdriver/pricing?hl=zh-cn#mgd-prometheus-pricing-summary&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Cloud Monitoring åƒ¹æ ¼æ‘˜è¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/stackdriver/docs/managed-prometheus/cost-controls?hl=zh-cn&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è²»ç”¨æ§åˆ¶å’Œæ­¸å› &lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/compute/disks-image-pricing#disk&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç¡¬ç¢Ÿåƒ¹æ ¼&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/219. Google Cloud Managed Service for Prometheus  è²»ç”¨/" />
        </entry>
        <entry>
            <title>
                218. Go GUIå¥—ä»¶ fyneç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/218. Go GUIå¥—ä»¶ fyneç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;ç·£ç”±&quot; tabindex=&quot;-1&quot;&gt;ç·£ç”±&lt;/h1&gt;
&lt;p&gt;å› ç‚ºLineçš„è²¼åœ–å¤ªå¤šäº†ï¼Œ&lt;br /&gt;
é—œéµå­—è·‘å‡ºä¾†çš„è²¼åœ–ï¼Œå¸¸å¸¸åˆä¸æ˜¯è‡ªå·±æƒ³è¦çš„ã€‚&lt;br /&gt;
æ‰€ä»¥æˆ‘å°±æƒ³è¦æåƒMSNé‚£æ¨£çš„è‡ªè¨‚é—œéµå­—ï¼Œ&lt;br /&gt;
è‡³å°‘èƒ½å¤ æ¯”è¼ƒå¿«æ‰¾åˆ°æˆ‘è¦çš„è²¼åœ–ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ä¸»é¡Œ&quot; tabindex=&quot;-1&quot;&gt;ä¸»é¡Œ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Demo&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;go install fyne.io/fyne/v2/cmd/fyne_demo@latest
fyne_demo
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;
&lt;p&gt;åŸºæœ¬è§€å¿µ&lt;br /&gt;
åƒè€ƒ  &lt;a href=&quot;https://www.cnblogs.com/yjf512/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è»’è„ˆåˆƒdeåˆ€å…‰åŠå½±&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸»è¦–çª—&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;func main() {
	myApp := app.New()
	myWindow := myApp.NewWindow(&amp;quot;Line Sticker Alias&amp;quot;)
	// è¨­å®šè¦–çª—çš„åˆå§‹å¤§å°
	myWindow.Resize(fyne.NewSize(800, 600))
	// è¨­å®šè¦–çª—çš„å…§å®¹
	myWindow.SetContent(CreateUI(myWindow))
	// é¡¯ç¤ºè¦–çª—
	myWindow.ShowAndRun()
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;å‚³å…¥å‹æ…‹&lt;br /&gt;
å‚³å…¥å»ºè­°ä½¿ç”¨ &lt;code&gt;fyne.Window&lt;/code&gt;ï¼Œå› å¾ˆå¤šUIè¡Œç‚ºéœ€è¦çš„éƒ½æ˜¯windowã€‚&lt;br /&gt;
å¦‚æœè¦é–‹æ–°è¦–çª—çš„è©±ï¼Œå¯ä»¥æ¡ç”¨ä¸‹é¢çš„ç¨‹å¼&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;func ShowAliasWindow(filePath string, parent fyne.Window) {
	w := fyne.CurrentApp().NewWindow(&amp;quot;æ–°å¢åˆ¥å&amp;quot;)
	....
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;å¸¸ç”¨é¸é …ï¼ŒæŒ‰éˆ•(ç´…è‰²)ã€æ–‡å­—æ–¹å¡Š(ç´«è‰²)ã€åœ–ç‰‡(ç¶ è‰²)&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/218-fig.1.png&quot; alt=&quot;218-fig.1.png&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;// å»¶é²200msï¼Œå•Ÿå‹•æŒ‰éˆ•ï¼ˆçœ‹èµ·ä¾†æ¯”è¼ƒæµæš¢ï¼‰
aliasButton := widget.NewButton(alias, func() {
  time.AfterFunc(200*time.Millisecond, func() {
    ShowAliasWindow(fulPath, parent)
  })
})

// æ–‡å­—æ¡†
textbox := widget.NewEntry()
textbox.SetPlaceHolder(&amp;quot;Enter Keyword...&amp;quot;)

// åœ–ç‰‡
img := canvas.NewImageFromFile(fulPath)
img.FillMode = canvas.ImageFillOriginal

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;ç‰©ä»¶åˆä½µ&lt;br /&gt;
Vï¼švertical&lt;br /&gt;
Hï¼šhorizontal&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;// ä¸Šé¢ 4. çš„ aliasButton è·Ÿ img åˆä½µåœ¨ä¸€èµ·
images = append(images, container.NewVBox(img, aliasButton))
// å°‡åœ–ç‰‡æŒ‰éˆ•ç‰©ä»¶ï¼Œåˆ‡æˆä¸‰å€‹ä¸€è¡Œ
grid := container.NewGridWithColumns(3, images...)

//å¡å…¥windowï¼Œé¡¯ç¤ºã€‚w ç‚º ä¸Šé¢ 3 çš„å®£å‘Š
w.SetContent(container.NewVScroll(grid))
w.Resize(fyne.NewSize(400, 400))
w.Show()
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;dialog&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;
// w ç‚º fyne.window

// éŒ¯èª¤å°è©±æ–¹å¡Š
err := deleteAlias(stickerId)
if err != nil {
  dialog.NewError(err, w).Show()
  return // éŒ¯èª¤ç™¼ç”Ÿå¾Œï¼Œç›´æ¥è¿”å›ï¼Œåœæ­¢ç¹¼çºŒåŸ·è¡Œä¸‹é¢çš„ç¨‹å¼ç¢¼
}
//è¨Šæ¯å°è©±æ–¹å¡Š
dialog.NewInformation(&amp;quot;æç¤º&amp;quot;, &amp;quot;æ–°å¢å®Œæˆï¼&amp;quot;, w).Show()

//é–‹å•Ÿè³‡æ–™å¤¾å°è©±æ–¹å¡Š
dialog.NewFolderOpen(func(folder fyne.ListableURI, err error) {
  if err != nil {
    dialog.ShowError(err, w)
    return
  }
  if folder == nil {
    return // ä½¿ç”¨è€…æŒ‰å–æ¶ˆ
  }
  inputFolder.SetText(folder.Path())
}, w).Show()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/yjf512/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;è»’è„ˆåˆƒdeåˆ€å…‰åŠå½±&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://go-circle.cn/fyne-press/v1.0/1-getting-started/introduction.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Fyneé–‹ç™¼æ–‡ä»¶(ä¸­)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.fyne.io/started/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Fyneå®˜ç¶²æ–‡ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/fyne-io/fyne&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Fyne Github&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/218. Go GUIå¥—ä»¶ fyneç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                217. iptables ç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/217. iptables ç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;ç·£ç”±&quot; tabindex=&quot;-1&quot;&gt;ç·£ç”±&lt;/h1&gt;
&lt;p&gt;istioé‡æ–°è¤‡ç¿’æ¦‚å¿µçš„æ™‚å€™ï¼Œ&lt;br /&gt;
åˆç¢°åˆ°äº†iptableï¼Œç„¶å¾Œï¼Œæˆ‘åˆå¿˜äº†ã€‚&lt;br /&gt;
æ²’æœ‰ç”¨è‡ªå·±ç†è§£éçš„ä½œæ³•ï¼Œ&lt;br /&gt;
æœç„¶å¾ˆå®¹æ˜“å¿˜è¨˜å•Šã€‚&lt;/p&gt;
&lt;h1 id=&quot;ä¸»é¡Œ&quot; tabindex=&quot;-1&quot;&gt;ä¸»é¡Œ&lt;/h1&gt;
&lt;p&gt;iptablesç°¡å–®èªªæ˜¯å€‹ç®¡é«˜é€Ÿå…¬è·¯å¤§é–€çš„ã€‚&lt;/p&gt;
&lt;p&gt;åŸºæœ¬æœ‰ä¸‰æ¢è·¯(chain)ï¼Œ&lt;br /&gt;
åˆ†åˆ¥æ˜¯&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;filterï¼šé€™æ¢è·¯æœƒç›´æ¥åˆ°ç®¡é«˜é€Ÿå…¬è·¯å¤§é–€çš„ç®¡ç†å–®ä½å¤§æ¨“è£¡é¢ã€‚&lt;/li&gt;
&lt;li&gt;natï¼šè¦å»é€™æ¢é«˜é€Ÿå…¬è·¯çš„å…¶ä»–åœ°æ–¹ï¼Œå°±å¾€é€™é‚Šã€‚&lt;/li&gt;
&lt;li&gt;mangleï¼šç‰¹æ¬Šé“è·¯ï¼Œæœ‰é«˜å®˜è¦éæ™‚ï¼Œå°±èµ°é€™æ¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;é³¥å“¥çš„èªªæ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;filter (éæ¿¾å™¨)ï¼šä¸»è¦è·Ÿé€²å…¥ Linux æœ¬æ©Ÿçš„å°åŒ…æœ‰é—œï¼Œé€™å€‹æ˜¯é è¨­çš„ table å–”ï¼&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;INPUTï¼šä¸»è¦èˆ‡æƒ³è¦é€²å…¥æˆ‘å€‘ Linux æœ¬æ©Ÿçš„å°åŒ…æœ‰é—œï¼›&lt;/li&gt;
&lt;li&gt;OUTPUTï¼šä¸»è¦èˆ‡æˆ‘å€‘ Linux æœ¬æ©Ÿæ‰€è¦é€å‡ºçš„å°åŒ…æœ‰é—œï¼›&lt;/li&gt;
&lt;li&gt;FORWARDï¼šé€™å€‹å’šå’šèˆ‡ Linux æœ¬æ©Ÿæ¯”è¼ƒæ²’æœ‰é—œä¿‚ï¼Œ ä»–å¯ä»¥ã€è½‰éå°åŒ…ã€åˆ°å¾Œç«¯çš„é›»è…¦ä¸­ï¼Œèˆ‡ä¸‹åˆ— nat table ç›¸é—œæ€§è¼ƒé«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;nat (ä½å€è½‰æ›)ï¼šæ˜¯ Network Address Translation çš„ç¸®å¯«ï¼Œ é€™å€‹è¡¨æ ¼ä¸»è¦åœ¨é€²è¡Œä¾†æºèˆ‡ç›®çš„ä¹‹ IP æˆ– port çš„è½‰æ›ï¼Œèˆ‡ Linux æœ¬æ©Ÿè¼ƒç„¡é—œï¼Œä¸»è¦èˆ‡ Linux ä¸»æ©Ÿå¾Œçš„å€åŸŸç¶²è·¯å…§é›»è…¦è¼ƒæœ‰ç›¸é—œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PREROUTINGï¼šåœ¨é€²è¡Œè·¯ç”±åˆ¤æ–·ä¹‹å‰æ‰€è¦é€²è¡Œçš„è¦å‰‡(DNAT/REDIRECT)&lt;/li&gt;
&lt;li&gt;POSTROUTINGï¼šåœ¨é€²è¡Œè·¯ç”±åˆ¤æ–·ä¹‹å¾Œæ‰€è¦é€²è¡Œçš„è¦å‰‡(SNAT/MASQUERADE)&lt;/li&gt;
&lt;li&gt;OUTPUTï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ul&gt;
&lt;li&gt;mangle (ç ´å£è€…)ï¼šé€™å€‹è¡¨æ ¼ä¸»è¦æ˜¯èˆ‡ç‰¹æ®Šçš„å°åŒ…çš„è·¯ç”±æ——æ¨™æœ‰é—œï¼Œ æ—©æœŸåƒ…æœ‰ PREROUTING åŠ OUTPUT éˆï¼Œä¸éå¾ kernel 2.4.18 ä¹‹å¾ŒåŠ å…¥äº† INPUT åŠ FORWARD éˆã€‚ ç”±æ–¼é€™å€‹è¡¨æ ¼èˆ‡ç‰¹æ®Šæ——æ¨™ç›¸é—œæ€§è¼ƒé«˜ï¼Œæ‰€ä»¥åƒå’±å€‘é€™ç¨®å–®ç´”çš„ç’°å¢ƒç•¶ä¸­ï¼Œè¼ƒå°‘ä½¿ç”¨ mangle é€™å€‹è¡¨æ ¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://linux.vbird.org/linux_server/centos6/0250simple_firewall.php#netfilter&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;iptables çš„è¡¨æ ¼ (table) èˆ‡éˆ (chain)&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;æ¯å€‹chainè£¡é¢éƒ½æœ‰è‡ªå·±ruleï¼Œ&lt;br /&gt;
rule 1 æ˜¯å»å½°åŒ–ï¼Œ&lt;br /&gt;
rule 2 æ˜¯å»å“¡æ—ï¼Œ&lt;br /&gt;
rule 3æ˜¯å»å˜‰ç¾©ã€‚&lt;/p&gt;
&lt;p&gt;å¾å°ä¸­å—ä¸‹è¦å»å½°åŒ–çš„è©±ï¼Œrule 1 ç¬¦åˆå°±ç›´æ¥å»å½°åŒ–äº†ã€‚&lt;br /&gt;
ä½†å¦‚æœæ˜¯è¦å»å˜‰ç¾©ï¼Œå‰é¢ä¸ç¬¦åˆï¼Œå°±è·³éï¼Œç›´åˆ°rule 3åˆ¤æ–·ç¬¦åˆæ‰æœƒåŸ·è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://jimmysong.io/blog/sidecar-injection-iptables-and-traffic-routing/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Istio ä¸­çš„ Sidecar æ³¨å…¥ã€é€æ˜æµé‡åŠ«æŒåŠæµé‡è·¯ç”±éç¨‹è©³è§£&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/217. iptables ç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                216. GKEæ›è¼‰ReadWrite Manyçš„PVC
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/216. GKEæ›è¼‰ReadWrite Manyçš„PVC/</id>
            <content type="html">
                &lt;h1 id=&quot;ç·£ç”±&quot; tabindex=&quot;-1&quot;&gt;ç·£ç”±&lt;/h1&gt;
&lt;p&gt;GKEä¸Šé¢çš„pvcæ˜¯ä¸æ”¯æ´ReadWrite Manyçš„ã€‚&lt;br /&gt;
ç”¨é€”æ˜¯å…¨éƒ¨çš„Logå¯«åˆ°åŒä¸€å€‹è³‡æ–™å¤¾ï¼Œ&lt;br /&gt;
ç„¶å¾Œå†ç”¨filebeatæ“·å–åˆ°EFKã€‚&lt;/p&gt;
&lt;h1 id=&quot;ä¸»é¡Œ&quot; tabindex=&quot;-1&quot;&gt;ä¸»é¡Œ&lt;/h1&gt;
&lt;p&gt;é€™é‚Šè¦åšçš„æ˜¯è‡ªå»ºä¸€å€‹NFS serverã€‚&lt;/p&gt;
&lt;p&gt;deployè£¡é¢ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨GCEä¸Šé¢å»ºç«‹ä¸€å€‹ç¡¬ç¢Ÿï¼Œ&lt;br /&gt;
ç„¶å¾Œåœ¨deployä¸Šé¢æŒ‡å®šã€‚å°±æ˜¯ä¸‹é¢é€™æ®µï¼Œ&lt;br /&gt;
é€™åŸæœ¬æ˜¯å‰ä»»çš„æ–¹å¼ï¼Œæˆ‘ç›´æ¥æ”¹æ‰äº†ã€‚&lt;br /&gt;
ç›´æ¥åœ¨ä¸€å€‹yamlè£¡é¢å…¨éƒ¨å¼„å¥½ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcePersistentDisk:
    pdName: gke-log-nfs-disk
    fsType: ext4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;NFS-server.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;---
apiVersion: v1
kind: Namespace
metadata:
  name: nfs
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: nfs-pvc
  namespace: nfs
spec:
  storageClassName: &amp;quot;standard&amp;quot;
  resources:
    requests:
      storage: 100Gi
  accessModes:
    - ReadWriteOnce
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nfs-server
  namespace: nfs
spec:
  replicas: 1
  selector:
    matchLabels:
      role: nfs-server
  template:
    metadata:
      labels:
        role: nfs-server
    spec:
      containers:
      - name: nfs-server
        image: gcr.io/google_containers/volume-nfs:0.8
        ports:
          - name: nfs
            containerPort: 2049
          - name: mountd
            containerPort: 20048
          - name: rpcbind
            containerPort: 111
        securityContext:
          privileged: true
        volumeMounts:
          - mountPath: /exports
            name: nfs-pvc
      volumes:
      - name: nfs-pvc
        persistentVolumeClaim:
          claimName: nfs-pvc
        # gcePersistentDisk:
        #     pdName: gke-log-nfs-disk
        #     fsType: ext4
---
apiVersion: v1
kind: Service
metadata:
  name: nfs-server
  namespace: nfs
spec:
  ports:
    - name: nfs
      port: 2049
    - name: mountd
      port: 20048
    - name: rpcbind
      port: 111
  selector:
    role: nfs-server
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ä¾†æ˜¯æ›è¼‰ä¸€å€‹provisioner&lt;/p&gt;
&lt;p&gt;nfs-provisioner.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: apps/v1
kind: Deployment
metadata:
  name: nfs-client-provisioner
  namespace: nfs
  labels:
    app: nfs-client-provisioner  
spec:
  replicas: 1
  selector:
    matchLabels:
      app: nfs-client-provisioner
  strategy:
    type: Recreate
  template:
    metadata:
      labels:
        app: nfs-client-provisioner
    spec:
      serviceAccountName: nfs-client-provisioner
      containers:
        - name: nfs-client-provisioner
          image: gcr.io/k8s-staging-sig-storage/nfs-subdir-external-provisioner:v4.0.2
          # image: registry.k8s.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2
          volumeMounts:
            - name: nfs-client-root
              mountPath: /persistentvolumes
          env:
            - name: PROVISIONER_NAME
              value: nfs-log
            - name: NFS_SERVER
              value: nfs-server.nfs.svc.cluster.local
            - name: NFS_PATH
              value: /
      volumes:
        - name: nfs-client-root
          nfs:
            server: nfs-server.nfs.svc.cluster.local
            path: /
---
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: nfs-log
provisioner: nfs-log
parameters:
  archiveOnDelete: &amp;quot;false&amp;quot;

---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: nfs-client-provisioner-runner
rules:
  - apiGroups: [&amp;quot;&amp;quot;]
    resources: [&amp;quot;nodes&amp;quot;]
    verbs: [&amp;quot;get&amp;quot;, &amp;quot;list&amp;quot;, &amp;quot;watch&amp;quot;]
  - apiGroups: [&amp;quot;&amp;quot;]
    resources: [&amp;quot;persistentvolumes&amp;quot;]
    verbs: [&amp;quot;get&amp;quot;, &amp;quot;list&amp;quot;, &amp;quot;watch&amp;quot;, &amp;quot;create&amp;quot;, &amp;quot;delete&amp;quot;]
  - apiGroups: [&amp;quot;&amp;quot;]
    resources: [&amp;quot;persistentvolumeclaims&amp;quot;]
    verbs: [&amp;quot;get&amp;quot;, &amp;quot;list&amp;quot;, &amp;quot;watch&amp;quot;, &amp;quot;update&amp;quot;]
  - apiGroups: [&amp;quot;storage.k8s.io&amp;quot;]
    resources: [&amp;quot;storageclasses&amp;quot;]
    verbs: [&amp;quot;get&amp;quot;, &amp;quot;list&amp;quot;, &amp;quot;watch&amp;quot;]
  - apiGroups: [&amp;quot;&amp;quot;]
    resources: [&amp;quot;events&amp;quot;]
    verbs: [&amp;quot;create&amp;quot;, &amp;quot;update&amp;quot;, &amp;quot;patch&amp;quot;]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: run-nfs-client-provisioner
subjects:
  - kind: ServiceAccount
    name: nfs-client-provisioner
    namespace: nfs
roleRef:
  kind: ClusterRole
  name: nfs-client-provisioner-runner
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: nfs-client-provisioner
  namespace: nfs
---
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: leader-locking-nfs-client-provisioner
  namespace: nfs
rules:
  - apiGroups: [&amp;quot;&amp;quot;]
    resources: [&amp;quot;endpoints&amp;quot;]
    verbs: [&amp;quot;get&amp;quot;, &amp;quot;list&amp;quot;, &amp;quot;watch&amp;quot;, &amp;quot;create&amp;quot;, &amp;quot;update&amp;quot;, &amp;quot;patch&amp;quot;]
---
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: leader-locking-nfs-client-provisioner
  namespace: nfs
subjects:
  - kind: ServiceAccount
    name: nfs-client-provisioner
roleRef:
  kind: Role
  name: leader-locking-nfs-client-provisioner
  apiGroup: rbac.authorization.k8s.io
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¦ä½¿ç”¨çš„è©±ï¼Œ&lt;br /&gt;
å»ºç«‹ä¸€å€‹pvc, storageClassNameæ”¹æˆä¸Šé¢å»ºç«‹çš„storageClass&lt;br /&gt;
å…¶ä»–deployæ›è¼‰æ–¹å¼ï¼Œè·Ÿæ›pvcä¸€æ¨£ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;---
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: logs-nfs-pvc
  namespace: default
spec:
  accessModes:
    - ReadWriteMany
  storageClassName: nfs-log
  resources:
    requests:
      storage: 100Gi

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/%E8%BC%95%E9%AC%86%E5%B0%8F%E5%93%81-pks%E8%88%87k8s%E7%9A%84%E9%BB%9E%E6%BB%B4/%E5%9C%A8gke%E4%B8%8A%E4%BD%BF%E7%94%A8readwrite-many%E7%9A%84disk-9945ff67a4d&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åœ¨GKEä¸Šä½¿ç”¨ReadWrite Manyçš„Disk&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/kubernetes-sigs/nfs-subdir-external-provisioner&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;nfs-subdir-external-provisioner&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/216. GKEæ›è¼‰ReadWrite Manyçš„PVC/" />
        </entry>
        <entry>
            <title>
                214. Elastic APIå»ºç«‹ Index_template
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/214. Elastic APIå»ºç«‹ Index_template/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å¹«åŒäº‹æ¸¬è©¦ä¸åŒLOGçš„åˆªé™¤æ™‚é–“ï¼Œ&lt;br /&gt;
æ¯æ¬¡è¦å»é»ä¸€é»åˆæ€•å¿˜è¨˜ï¼Œ&lt;br /&gt;
å¼„å€‹APIäº†ï¼Œ&lt;br /&gt;
ä¸çŸ¥é“ä¹‹å¾Œèƒ½ä¸èƒ½åœ¨éƒ¨å±¬æ™‚ç›´æ¥æ›ä¸Šå»ï¼Œå†ç ”ç©¶çœ‹çœ‹ã€‚&lt;br /&gt;
é€™æ¬¡å°±å…ˆç°¡å–®å»ºç«‹å€‹ index templateè·Ÿlife cycleäº†&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;filebeat-elastic-efk-57-filebeat-57-filebeat&quot; tabindex=&quot;-1&quot;&gt;é¦–å…ˆè¦å…ˆç¢ºå®šä½ çš„filebeatæœ‰å°‡è³‡æ–™ä¸Ÿåˆ°elasticè£¡é¢ï¼Œå¯åƒè€ƒ&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%97%92%20EFK/57.filebeat%20%E8%A3%9C%E5%85%85%E8%AA%AA%E6%98%8E/&quot;&gt;57.filebeat è£œå……èªªæ˜&lt;/a&gt;ã€‚&lt;/h3&gt;
&lt;p&gt;å†ä¾†æ ¹æ“šä½ å»ºçš„æ˜¯indicesé‚„æ˜¯datastreamï¼Œä¾†æ±ºå®šä½ çš„index_templateã€‚&lt;br /&gt;
ä¸‹é¢çš„æŒ‡ä»¤ï¼Œéƒ½åœ¨dev toolsä¸­åŸ·è¡Œã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;APIå¾Œé¢çš„æœ€å¾Œä¸€å€‹è·¯å¾‘ç‚ºåç¨±&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;indices&quot; tabindex=&quot;-1&quot;&gt;indices&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;APIå»ºç«‹ Index Lifecycle Policies&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;PUT _ilm/policy/worker
{
  &amp;quot;policy&amp;quot;: {
    &amp;quot;_meta&amp;quot;: {
      &amp;quot;description&amp;quot;: &amp;quot;used for worker log&amp;quot;,
      &amp;quot;author&amp;quot;: &amp;quot;Ezio&amp;quot;,
      &amp;quot;project&amp;quot;: {
        &amp;quot;name&amp;quot;: &amp;quot;srs&amp;quot;,
        &amp;quot;department&amp;quot;: &amp;quot;lerouge&amp;quot;
      }
    },
    &amp;quot;phases&amp;quot;: {
      &amp;quot;hot&amp;quot;: {
        &amp;quot;min_age&amp;quot;: &amp;quot;0ms&amp;quot;,
        &amp;quot;actions&amp;quot;: {
          &amp;quot;set_priority&amp;quot;: {
            &amp;quot;priority&amp;quot;: 100
          },
          &amp;quot;rollover&amp;quot;: {
            &amp;quot;max_age&amp;quot;: &amp;quot;3d&amp;quot;,
            &amp;quot;max_primary_shard_size&amp;quot;: &amp;quot;50gb&amp;quot;
          }
        }
      },
      &amp;quot;delete&amp;quot;: {
        &amp;quot;min_age&amp;quot;: &amp;quot;3d&amp;quot;,
        &amp;quot;actions&amp;quot;: {
          &amp;quot;delete&amp;quot;: {
            &amp;quot;delete_searchable_snapshot&amp;quot;: true
          }
        }
      }
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å»ºç«‹ index_template&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;PUT _index_template/worker
{
  &amp;quot;index_patterns&amp;quot; : [&amp;quot;worker-*&amp;quot;],
  &amp;quot;template&amp;quot;: {
    &amp;quot;settings&amp;quot;: {
      &amp;quot;index&amp;quot;: {
        &amp;quot;lifecycle&amp;quot;: {
          &amp;quot;name&amp;quot;: &amp;quot;videoworker&amp;quot;
        }
      }
    }
  },
  &amp;quot;composed_of&amp;quot;: [&amp;quot;ecs@mappings&amp;quot;, &amp;quot;logs@mappings&amp;quot;,&amp;quot;logs@settings&amp;quot;],
  &amp;quot;priority&amp;quot; : 200,
  &amp;quot;version&amp;quot;: 1,
  &amp;quot;_meta&amp;quot;: {
    &amp;quot;description&amp;quot;: &amp;quot;test by Ezio&amp;quot;,
    &amp;quot;latest_modify_date&amp;quot;: &amp;quot;2024-05-28&amp;quot;
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;æª¢æŸ¥  Index Lifecycle Policies åŠ index template&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;GET _ilm/policy/worker  #  Index Lifecycle Policies
GET _index_template/worker # index template
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/ilm-put-lifecycle.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Create or update lifecycle policy API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/index-templates.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Index templates&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;data-stream&quot; tabindex=&quot;-1&quot;&gt;data stream&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;å»ºç«‹ index template&lt;br /&gt;
èˆ‡ä¸Šé¢çš„å·®ç•°é»åœ¨æ–¼ï¼Œæœ‰æ²’æœ‰å¢åŠ &lt;code&gt;data_stream&lt;/code&gt;èˆ‡ &lt;code&gt;template.lifecycle.data_retention&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;PUT _index_template/videowork
{
  &amp;quot;index_patterns&amp;quot; : [&amp;quot;videoworker-*&amp;quot;],
  &amp;quot;template&amp;quot;: {
    &amp;quot;lifecycle&amp;quot;: {
      &amp;quot;data_retention&amp;quot;: &amp;quot;3d&amp;quot;
    }
  },
  &amp;quot;data_stream&amp;quot;: { },
  &amp;quot;composed_of&amp;quot;: [&amp;quot;ecs@mappings&amp;quot;, &amp;quot;logs@mappings&amp;quot;,&amp;quot;logs@settings&amp;quot;],
  &amp;quot;priority&amp;quot; : 200,
  &amp;quot;version&amp;quot;: 1,
  &amp;quot;_meta&amp;quot;: {
    &amp;quot;description&amp;quot;: &amp;quot;test by Ezio&amp;quot;,
    &amp;quot;latest_modify_date&amp;quot;: &amp;quot;2024-05-28&amp;quot;
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/tutorial-manage-new-data-stream.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Create a data stream with a lifecycle&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;indices-vs-data-stream&quot; tabindex=&quot;-1&quot;&gt;indices vs data stream&lt;/h3&gt;
&lt;p&gt;ä¸‹é¢è³‡æ–™æ˜¯ç”¨gpt-4oæä¾›çš„&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‰¹æ€§&lt;/th&gt;
&lt;th&gt;Indices&lt;/th&gt;
&lt;th&gt;Data Streams&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç®¡ç†æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ‰‹å‹•ç®¡ç†æˆ–ä½¿ç”¨ ILM&lt;/td&gt;
&lt;td&gt;è‡ªå‹•ç®¡ç†æ»¾å‹•å’Œç´¢å¼•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ•¸æ“šå­˜å„²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é©åˆä»»æ„çµæ§‹æ•¸æ“š&lt;/td&gt;
&lt;td&gt;å°ˆç‚ºæ™‚é–“åºåˆ—æ•¸æ“šè¨­è¨ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å°æ‡‰çµ„æ…‹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¯å€‹ç´¢å¼•ç¨ç«‹çµ„æ…‹&lt;/td&gt;
&lt;td&gt;é€éç´¢å¼•ç¯„æœ¬è‡ªå‹•çµ„æ…‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ»¾å‹•ç­–ç•¥&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€æ‰‹å‹•æˆ– ILM çµ„æ…‹&lt;/td&gt;
&lt;td&gt;è‡ªå‹•æ»¾å‹•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æŸ¥è©¢æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;åŸºæ–¼æ¨™æº–ç´¢å¼•&lt;/td&gt;
&lt;td&gt;å„ªåŒ–æ™‚é–“åºåˆ—æ•¸æ“šæŸ¥è©¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç´¢å¼•å‰µå»º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ &lt;code&gt;PUT /index_name&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€éç´¢å¼•ç¯„æœ¬è‡ªå‹•å‰µå»º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é©ç”¨æ•¸æ“š&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä»»æ„æ•¸æ“šï¼ŒåŒ…æ‹¬éæ™‚é–“åºåˆ—æ•¸æ“š&lt;/td&gt;
&lt;td&gt;ä¸»è¦ç‚ºæ—¥èªŒã€æŒ‡æ¨™ç­‰æ™‚é–“åºåˆ—æ•¸æ“š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­¸ç¿’æ›²ç·š&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€è¦å­¸ç¿’å’Œç®¡ç†ç´¢å¼•çš„ç´°ç¯€&lt;/td&gt;
&lt;td&gt;ç°¡åŒ–ï¼Œç‰¹åˆ¥é©åˆå¤§è¦æ¨¡æ™‚é–“åºåˆ—æ•¸æ“š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç”Ÿå‘½é€±æœŸç®¡ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;éœ€è¦çµ„æ…‹ ILM&lt;/td&gt;
&lt;td&gt;è‡ªå‹•ç®¡ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å­˜å„²æ•ˆç‡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä¾è³´æ‰‹å‹•å„ªåŒ–&lt;/td&gt;
&lt;td&gt;ç‚ºæ™‚é–“åºåˆ—æ•¸æ“šè¨­è¨ˆï¼Œå…·å‚™å­˜å„²æ•ˆç‡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;å„ªç¼ºé»&quot; tabindex=&quot;-1&quot;&gt;å„ªç¼ºé»&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é …ç›®&lt;/th&gt;
&lt;th&gt;Indices&lt;/th&gt;
&lt;th&gt;Data Streams&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å„ªé»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;- æ›´éˆæ´»ï¼Œå¯ç”¨æ–¼ä»»æ„é¡å‹æ•¸æ“š&lt;/td&gt;
&lt;td&gt;- è‡ªå‹•ç®¡ç†æ»¾å‹•å’Œç´¢å¼•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;- å®Œå…¨è‡ªå®šç¾©å°æ‡‰å’Œè¨­ç½®&lt;/td&gt;
&lt;td&gt;- ç°¡åŒ–çµ„æ…‹å’Œç®¡ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;- æ”¯æ´è¤‡é›œçš„æŸ¥è©¢å’Œèšåˆ&lt;/td&gt;
&lt;td&gt;- å„ªåŒ–æ™‚é–“åºåˆ—æ•¸æ“šæŸ¥è©¢å’Œå­˜å„²&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;- é©åˆå¤§è¦æ¨¡æ—¥èªŒå’ŒæŒ‡æ¨™æ•¸æ“š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç¼ºé»&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;- éœ€æ‰‹å‹•ç®¡ç†ç´¢å¼•å’Œæ»¾å‹•ç­–ç•¥&lt;/td&gt;
&lt;td&gt;- ä¸»è¦é‡å°æ™‚é–“åºåˆ—æ•¸æ“š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;- çµ„æ…‹å’Œç®¡ç†ç›¸å°è¤‡é›œ&lt;/td&gt;
&lt;td&gt;- ä¸é©åˆéæ™‚é–“åºåˆ—æ•¸æ“š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;- éœ€è¦çµ„æ…‹å’Œç¶­è­· ILM&lt;/td&gt;
&lt;td&gt;- å°æ‡‰å’Œè¨­ç½®ç›¸å°ä¸éˆæ´»&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;æ¨è–¦ä½¿ç”¨å ´æ™¯&quot; tabindex=&quot;-1&quot;&gt;æ¨è–¦ä½¿ç”¨å ´æ™¯&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ä½¿ç”¨å ´æ™¯&lt;/th&gt;
&lt;th&gt;Indices&lt;/th&gt;
&lt;th&gt;Data Streams&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ—¥èªŒç®¡ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯ä»¥ä½¿ç”¨ï¼Œä½†éœ€è¦æ‰‹å‹•çµ„æ…‹æ»¾å‹•å’Œç®¡ç†&lt;/td&gt;
&lt;td&gt;æœ€ä½³é¸æ“‡ï¼Œè‡ªå‹•ç®¡ç†ï¼Œç°¡åŒ–é‹ç¶­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ‡‰ç”¨ç›£æ§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;å¯ä»¥ä½¿ç”¨ï¼Œä½†éœ€è‡ªå®šç¾©ç´¢å¼•å’Œå°æ‡‰&lt;/td&gt;
&lt;td&gt;æœ€ä½³é¸æ“‡ï¼Œå°ˆç‚ºæ™‚é–“åºåˆ—æ•¸æ“šè¨­è¨ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®šæœŸå ±è¡¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;é©åˆä»»ä½•é¡å‹å ±è¡¨&lt;/td&gt;
&lt;td&gt;é©åˆæ™‚é–“åºåˆ—å ±è¡¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ­·å²æ•¸æ“šæŸ¥è©¢&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ä½³é¸æ“‡ï¼Œå¯é‡å°å…·é«”éœ€æ±‚å„ªåŒ–æŸ¥è©¢&lt;/td&gt;
&lt;td&gt;é©åˆåŸºæ–¼æ™‚é–“ç¯„åœçš„æ­·å²æ•¸æ“šæŸ¥è©¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è¤‡é›œæ•¸æ“šåˆ†æ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ä½³é¸æ“‡ï¼Œæ”¯æ´éˆæ´»çš„å°æ‡‰å’ŒæŸ¥è©¢&lt;/td&gt;
&lt;td&gt;é©åˆæ™‚é–“åºåˆ—æ•¸æ“šçš„å¿«é€ŸæŸ¥è©¢å’Œèšåˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;éæ™‚é–“åºåˆ—æ•¸æ“šå­˜å„²&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æœ€ä½³é¸æ“‡ï¼Œé©åˆæ‰€æœ‰é¡å‹æ•¸æ“š&lt;/td&gt;
&lt;td&gt;ä¸æ¨è–¦ï¼Œåƒ…é©åˆæ™‚é–“åºåˆ—æ•¸æ“š&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h3&gt;
&lt;p&gt;å…¶å¯¦å¾APIä¾†çœ‹çš„è©±ï¼Œç›´æ¥ç”¨data streamæ¯”è¼ƒå¿«ï¼Œä¹Ÿæ¯”è¼ƒçœäº‹ã€‚&lt;br /&gt;
åŠ ä¸Šç›®å‰ç”¨çš„æ˜¯ECKï¼Œ&lt;br /&gt;
æˆ‘æ ¹æœ¬æ²’å»è¨­è¨ˆ warm phase æˆ– cold phaseçš„ç¡¬ç¢Ÿã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://training.onedoggo.com/tech-sharing/uncle-joe-teach-es-elasticsearch/index-jian-li-qian-ni-gai-zhi-dao-de/es-de-chao-qian-bu-shu-index-template&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ES çš„è¶…å‰ä½ˆç½² - Index Template&lt;/a&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/214. Elastic APIå»ºç«‹ Index_template/" />
        </entry>
        <entry>
            <title>
                212. k8sçš„è¦ªå’Œæ€§èˆ‡åè¦ªå’Œæ€§
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/212. k8sçš„è¦ªå’Œæ€§èˆ‡åè¦ªå’Œæ€§/</id>
            <content type="html">
                &lt;h1 id=&quot;ç·£ç”±&quot; tabindex=&quot;-1&quot;&gt;ç·£ç”±&lt;/h1&gt;
&lt;p&gt;å¾Œç«¯çš„æœå‹™ï¼Œæ²’æœ‰HPAï¼Œæ‰€ä»¥ç›®å‰éƒ½å–®Podåœ¨åŸ·è¡Œã€‚&lt;br /&gt;
ä½†å¾ˆä¸å·§çš„ï¼Œéƒ½åœ¨åŒä¸€å€‹Nodeè£¡é¢ã€‚&lt;br /&gt;
æ‰€ä»¥ç•¶ä¸€å€‹Nodeå‡ºå•é¡Œæ™‚ï¼Œå…¶ä»–æœå‹™æœƒä¸€èµ·é™£äº¡ã€‚&lt;br /&gt;
ä½†åªæœ‰ä¸€å€‹NodePoolï¼Œä¹Ÿæ²’è¾¦æ³•ç”¨nodeSelectorã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;GKEç‰ˆæœ¬ï¼š1.27&lt;/p&gt;
&lt;p&gt;å…ˆä¸Šç¯„ä¾‹ï¼Œè©³ç´°èªªæ˜åœ¨ä¸‹é¢(æ ¼å¼æœ‰é»è·‘æ‰ï¼Œè¤‡è£½ä½¿ç”¨æ™‚è¦æ³¨æ„ï¼‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: apps/v1
kind: Deployment
metadata:
  name: bms
  labels:
    group: svc
    app: backend
spec:
  replicas: 1
  selector:
    matchLabels:
      group: svc
      app: backend
  template:
    metadata:
      labels:
        group: svc
        app: backend
    spec:
      containers:
        - name: service
          image: my-image:v1.0.6
          ports:
            - name: http
              containerPort: 80
              protocol: TCP
      affinity:
        podAntiAffinity:
			preferredDuringSchedulingIgnoredDuringExecution:
	        - weight: 100
		        podAffinityTerm:
	              labelSelector:
	                matchExpressions:
	                - key: app
	                  operator: In
	                  values:
	                  - gcp
	              topologyKey: kubernetes.io/hostname
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™å€‹çš„ç”¨é€”ï¼Œä¸»è¦æ˜¯è®“podæ±ºå®šè¦è·Ÿå“ªå€‹æœå‹™åœ¨ä¸€èµ·ï¼Œæˆ–ä¸åœ¨ä¸€èµ·ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­æ¯”è¼ƒé‡è¦çš„åƒæ•¸ï¼Œ&lt;/p&gt;
&lt;h3 id=&quot;åè¦ªå’Œæ€§èˆ‡è¦ªå’Œæ€§&quot; tabindex=&quot;-1&quot;&gt;åè¦ªå’Œæ€§èˆ‡è¦ªå’Œæ€§&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;podAntiAffinity&lt;/li&gt;
&lt;li&gt;podAffinity&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‰è€…æ˜¯åè¦ªå’Œæ€§ï¼Œä¸è¦è·Ÿå“ªå€‹æœå‹™åœ¨ä¸€èµ·&lt;br /&gt;
å¾Œè€…æ˜¯è¦ªå’Œæ€§ï¼Œè¦è·Ÿå“ªå€‹æœå‹™åœ¨ä¸€èµ·&lt;/p&gt;
&lt;h3 id=&quot;å¿…è¦èˆ‡æœ€å¥½å¯ä»¥&quot; tabindex=&quot;-1&quot;&gt;å¿…è¦èˆ‡æœ€å¥½å¯ä»¥&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;requiredDuringSchedulingIgnoredDuringExecution&lt;/li&gt;
&lt;li&gt;preferredDuringSchedulingIgnoredDuringExecution&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‰è€…æ˜¯ä¸€å®šè¦é”æˆä¸‹é¢çš„æ¢ä»¶ï¼Œ&lt;br /&gt;
å¾Œè€…æ˜¯æœ€å¥½æ˜¯é”æˆé€™æ¨£çš„æ¢ä»¶ï¼Œä¸¦è¨­æˆæ¯”é‡åˆ†æ•¸&lt;/p&gt;
&lt;h3 id=&quot;é¸æ“‡æ¢ä»¶&quot; tabindex=&quot;-1&quot;&gt;é¸æ“‡æ¢ä»¶&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;requiredDuringSchedulingIgnoredDuringExecution:
- labelSelector:
    matchExpressions:
    - key: app
      operator: In
      values:
      - gcp
  topologyKey: kubernetes.io/hostname  
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;preferredDuringSchedulingIgnoredDuringExecution:
- weight: 100
  podAffinityTerm:
    labelSelector:
      matchExpressions:
      - key: app
        operator: In
        values:
        - gcp
    topologyKey: kubernetes.io/hostname
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¤§è‡´ä¸Šçš„é‚è¼¯ä¸€æ¨£ï¼Œ&lt;br /&gt;
&lt;code&gt;ä½†preferredDuringSchedulingIgnoredDuringExecution&lt;/code&gt; ï¼Œ&lt;br /&gt;
å¿…é ˆåŠ ä¸Š&lt;code&gt;podAffinityTerm&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ç°¡å–®èªªæ˜è¦å‰‡ï¼Œ&lt;br /&gt;
é¸æ“‡é€™å€‹æœå‹™è¦è·Ÿå“ªå€‹labelç•¶æ¯”è¼ƒå€¼ã€‚&lt;br /&gt;
ç„¶å¾Œï¼Œ&lt;code&gt;topologyKey&lt;/code&gt; æœ‰é»é¡ä¼¼SQL groupçš„æ¦‚å¿µï¼Œä½ è¦æ ¹æ“šå“ªå€‹ä¾†åˆ†ç¾¤ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„ä¾‹å­æ˜¯æ ¹æ“š node nameä¾†å€åˆ†ï¼Œ&lt;br /&gt;
é‚„æœ‰æ ¹æ“šå€åŸŸ &lt;code&gt;kind.zone&lt;/code&gt; ä¾†åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæƒ³çŸ¥é“æœ‰å“ªäº›çš„è©±ï¼Œå¯ä»¥ä¸‹æŒ‡ä»¤çœ‹ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get nodes --show-labels
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢æ˜¯ç°¡å–®çš„å¯«æ³•ï¼Œ&lt;br /&gt;
è©³ç´°éç¨‹å¯ä»¥åƒè€ƒ çŸ½è°·ç‰›å¤§å¤§çš„æ–‡ç« ï¼Œé€£çµåœ¨ä¸‹æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.hwchiu.com/docs/2023/k8s-assigning-pod-2&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;çŸ½è°·ç‰›-è§£å¯† Assigning Pod To Nodes(ä¸‹)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/zh-cn/docs/concepts/scheduling-eviction/assign-pod-node/#operators&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;K8sæ–‡ä»¶-å°‡ Pod æŒ‡æ´¾çµ¦ç¯€é»&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://godleon.github.io/blog/Kubernetes/k8s-Assigning-Pod-to-Nodes/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[Kubernetes] Assigning Pods to Nodes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/212. k8sçš„è¦ªå’Œæ€§èˆ‡åè¦ªå’Œæ€§/" />
        </entry>
        <entry>
            <title>
                211. k8s serviceèˆ‡ endpointç„¡æ³•é€£çµ
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/211. k8s serviceèˆ‡ endpointç„¡æ³•é€£çµ/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æŸå¤©åœ¨å»ºç«‹æ–°çš„å¢é›†ï¼Œ&lt;br /&gt;
æœå‹™éƒ½å·²ç¶“æ¶å¥½æº–å‚™çµ¦RDäº†ï¼Œ&lt;br /&gt;
æœ€å¾Œæ‰ç™¼ç¾ï¼Œå¹³å¸¸ç”¨çš„é€£ç·šæ–¹å¼é€£ä¸åˆ°GCPçš„Memorystore.Redisã€‚&lt;br /&gt;
é€™å€‹å•é¡Œå¡äº†æ•´æ•´ä¸€é€±ï¼Œ&lt;br /&gt;
ä¸æ–·çš„åˆªé™¤é‡å»ºã€æ¯”å°ã€æ‰¾å·®ç•°ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ•…äº‹å±•é–‹&quot; tabindex=&quot;-1&quot;&gt;æ•…äº‹å±•é–‹&lt;/h1&gt;
&lt;p&gt;GKE ç‰ˆæœ¬ï¼š 1.28.7-gke.1026000&lt;/p&gt;
&lt;p&gt;å…ˆç°¡å–®èªªä¸€ä¸‹æ¶æ§‹ï¼Œ&lt;br /&gt;
istioå¢åŠ 6379 çš„port ï¼Œ&lt;br /&gt;
æ–°å¢redisçš„svcä»¥åŠendpointï¼Œ&lt;br /&gt;
ç”±æ–¼redisæ˜¯GCPçš„æœå‹™ï¼Œæ•…æœ¬èº«æ²’æœ‰podï¼Œ&lt;br /&gt;
è®“istioèƒ½å¤ é€évirtusalServiceé€£åˆ°é€™å€‹serviceï¼Œ&lt;br /&gt;
ç„¶å¾ŒRDé€éé€™å€‹ipä»¥åŠporté€£åˆ° GCPçš„Redisã€‚&lt;/p&gt;
&lt;p&gt;å…ˆä¾†çœ‹éŒ¯èª¤çš„ä½¿ç”¨æ–¹å¼ï¼Œ&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/211-fig.1.jpg&quot; alt=&quot;211-fig.1.jpg&quot; /&gt;&lt;br /&gt;
åœ¨port nameä¸Šé¢è¨­å®šredisçš„åç¨±ï¼Œ&lt;br /&gt;
å°è‡´svcçš„endpointsä¸Šé¢ç„¡æ³•ç¶å®šã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¨­å®šport nameçš„è©±&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/211-fig.2.jpg&quot; alt=&quot;211-fig.2.jpg&quot; /&gt;&lt;br /&gt;
å‰‡å¯ä»¥æ­£å¸¸ç¶å®šã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰çŒœæ¸¬ï¼Œå¯èƒ½è·Ÿ IANAçš„port nameæœ‰é—œä¿‚ã€‚&lt;br /&gt;
ä½†ç‚ºä»€éº¼æœƒé€™æ¨£ï¼Œ&lt;br /&gt;
å°±ä¸æ¸…æ¥šäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;# Service Name and Transport Protocol Port Number Registry&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç›®å‰æ¸¬è©¦å‡ºä¾†ï¼Œåªè¦æœ‰è¨­å®šNameå°±æœƒç¶ä¸åˆ°endpointsã€‚&lt;/p&gt;
&lt;h4 id=&quot;endpoint-slice-2024-05-20&quot; tabindex=&quot;-1&quot;&gt;å¦å¤–ï¼ŒEndpointSliceç›®å‰(2024/05/20)ä»æœƒç„¡æ³•ç¶å®šï¼Œ&lt;/h4&gt;
&lt;p&gt;è«‹å…ˆæ”¹ç”¨Endpointçš„apiã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/211-fig.3.jpg&quot; alt=&quot;211-fig.3.jpg&quot; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: discovery.k8s.io/v1
kind: EndpointSlice
metadata:
  name: redis # must be the same as service name
  namespace: istio-system
  labels:
    # You should set the &amp;quot;kubernetes.io/service-name&amp;quot; label.
    # Set its value to match the name of the Service
    kubernetes.io/service-name: redis
addressType: IPv4
ports:
  - name: redis # should match with the name of the service port defined above
    appProtocol: redis
    protocol: TCP
    port: 6379
endpoints:
  - addresses:
      - &amp;quot;10.1.11.43&amp;quot;

---
apiVersion: v1
kind: Service
metadata:
  name: redis
  namespace: istio-system
spec:
  ports:
    - protocol: TCP
      port: 6379
      targetPort: 6379
      name: redis    
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åƒç…§å®˜æ–¹æ–‡ä»¶çš„ä½œæ³•ä¹Ÿä¸æœƒç¶å®šã€‚&lt;br /&gt;
&lt;a href=&quot;https://kubernetes.io/docs/concepts/services-networking/service/#services-without-selectors&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Services without selectors&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2024/05/8&lt;/p&gt;
&lt;p&gt;æœ‰å¦ä¸€å€‹å·¥ç¨‹å¸«å‘ŠçŸ¥ï¼Œ&lt;br /&gt;
endpointé‚£é‚Šçš„Port Nameä¹ŸåŠ ä¸Šå»çš„è©±ï¼Œ&lt;br /&gt;
å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;çµè«–&quot; tabindex=&quot;-1&quot;&gt;çµè«–&lt;/h1&gt;
&lt;p&gt;é ‚å¤šæ”¹æ”¹ Endpointsçš„addresså°±å¥½äº†ï¼Œ&lt;br /&gt;
port nameé‚£äº›ï¼Œåˆ¥äº‚åŠ ã€‚&lt;br /&gt;
è¦åŠ å°±è¦ä¸€èµ·åŠ ï¼Œä¸”åç¨±ä¹Ÿè¦ä¸€æ¨£ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;---
apiVersion: v1
kind: Endpoints
metadata:
  name: redis # must be the same as service name
  namespace: istio-system
subsets:
  - addresses:
      - ip: 10.122.11.43
    ports:
      - port: 6379
	    name: redis
---
apiVersion: v1
kind: Service
metadata:
  name: redis
  namespace: istio-system
spec:
  ports:
    - protocol: TCP
      port: 6379
      targetPort: 6379
      name: redis
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/211. k8s serviceèˆ‡ endpointç„¡æ³•é€£çµ/" />
        </entry>
        <entry>
            <title>
                210. Arc Browserç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/210. Arc Browserç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘çœ‹åˆ°ä¸€å€‹é —ç¥çš„ç€è¦½å™¨ï¼Œ&lt;a href=&quot;https://arc.net/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Arc from The Browser Company&lt;/a&gt;&lt;br /&gt;
æœ€è¿‘å‰›å‡ºäº†win11ç‰ˆæœ¬ï¼Œmacå‰‡è¦12ç‰ˆæœ¬ä»¥ä¸Šæ‰èƒ½ä½¿ç”¨ã€‚&lt;br /&gt;
æˆ‘çš„macæ˜¯2015å¹´çš„å¯ä»¥å®‰è£ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;å¯ä»¥å…ˆçœ‹ä¸€ä¸‹é€™å€‹&lt;a href=&quot;https://www.youtube.com/watch?v=nlNsCB4SbVc&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Arc çœŸé¦™ï¼è…¦æ´å¤§é–‹çš„åŠŸèƒ½è®“è¶…å¤š Chrome æ­»å¿ ç²‰æ±ºå®šæŠŠ Arc ç•¶ä½œé è¨­ç€è¦½å™¨äº†ï¼&lt;/a&gt;  è£¡é¢æœ‰ç°¡å–®çš„æ•™å­¸ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¦æ³¨æ„çš„æ˜¯ï¼Œç¾åœ¨çš„ç‰ˆæœ¬å·²ç¶“æŠŠå…§å»ºNoteç æ‰äº†ï¼Œ&lt;br /&gt;
å¦‚æœè¦ä½¿ç”¨åªèƒ½ç”¨ç·šä¸Šçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ‰“é–‹ Preferences &amp;gt; Profiles &amp;gt; New documents&lt;br /&gt;
é¸æ“‡ä½ è¦è¨­å®šçš„ç·šä¸Šæœå‹™&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/210-fig.1.png&quot; alt=&quot;210-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç€è¦½å™¨è¨­å®šæª”&lt;br /&gt;
ARC æœ¬èº«ä¹Ÿæ˜¯ç”¨chromeçš„æ ¸å¿ƒå»åšçš„ï¼Œ&lt;br /&gt;
æ‰€ä»¥é™¤äº†Arcæœ¬èº«çš„è¨­å®šä»¥å¤–ï¼Œé‚„æœ‰chromiumçš„è¨­å®šã€‚&lt;br /&gt;
é€²å»çš„æ–¹å¼ Preferences &amp;gt; Profiles  &amp;gt; Search Settings..&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/210-fig.2.png&quot; alt=&quot;210-fig.2.png&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/210-fig.3.png&quot; alt=&quot;210-fig.3.png&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/210-fig.4.png&quot; alt=&quot;210-fig.4.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç›®å‰æœƒå¸¸ç”¨åˆ°çš„å¿«é€Ÿéµ&lt;br /&gt;
âŒ˜+Sï¼šé–‹é—œå·¦é‚Šçš„SideBar&lt;br /&gt;
âŒ˜+Tï¼šé–‹å•Ÿæ–°åˆ†é &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼Œé–‹å•Ÿçš„åˆ†é é è¨­åªæœƒç¶­æŒ12hourï¼Œ&lt;br /&gt;
æ›´æ”¹å¯åˆ° åœ–1 çš„&lt;code&gt;Archive tabs after&lt;/code&gt;ä¿®æ”¹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;âŒ˜ï¼‹âŒ¥(options)ï¼‹Gï¼šå¿«é€Ÿé–‹å•ŸchatGPT&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Archiveçš„æ­·å²ç´€éŒ„&lt;br /&gt;
åœ¨sidebar å¾€å·¦æ»‘å³å¯ã€‚&lt;br /&gt;
æˆ–ç›´æ¥é»é¸&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/210-fig.5.png&quot; alt=&quot;210-fig.5.png&quot; /&gt;&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/210. Arc Browserç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                209. k8sä¸­srsçš„å„å€‹pod  metricså–å¾—
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/209. k8sä¸­srsçš„å„å€‹pod  metricså–å¾—/</id>
            <content type="html">
                &lt;h1 id=&quot;äº‹ç”±&quot; tabindex=&quot;-1&quot;&gt;äº‹ç”±&lt;/h1&gt;
&lt;p&gt;åŒäº‹æ­£åœ¨å¼„SRSä¸²æµï¼Œç…§æˆ‘ä»¥å‰çš„å¯«æ³•ï¼Œ&lt;br /&gt;
æ˜¯é€éserviceå»å–å¾—å–®ä¸€å€‹podçš„metricsï¼Œ&lt;br /&gt;
é€™æ¨£åªæœƒæœ‰ä¸€å€‹podçš„è³‡æ–™ï¼Œ&lt;br /&gt;
æ‰€ä»¥è¦æƒ³è¾¦æ³•å–å¾—æ‰€æœ‰podçš„è³‡æ–™ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ç”±æ–¼æˆ‘æœ‰å¥—ç”¨istioï¼Œ&lt;br /&gt;
æ–¼æ˜¯æœ‰å¥—istio-proxyçš„podé€šé€šæœƒé è¨­å¡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;prometheus.io/path: /stats/prometheus
prometheus.io/port: &#39;15020&#39;
prometheus.io/scrape: &#39;true&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥ç›´æ¥åœ¨deployåŠ åƒæ•¸é€²å»æ™‚ï¼Œä¹Ÿæœƒè¢«æ”¹å¯«ã€‚&lt;/p&gt;
&lt;p&gt;æ–¼æ˜¯åªå¥½é¡å¤–å¯«job å¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- job_name: &#39;srs&#39;
  scrape_interval: 10s
  static_configs:
    - targets:
      - &#39;srs.default.svc.cluster.local:9972&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‘¼å« service çš„ srs ï¼Œç„¶å¾Œå»å–å¾—metricsçš„metricsã€‚&lt;br /&gt;
ä½†ç•¶æœ‰å¤šå€‹podçš„æ™‚å€™ï¼Œé€™å°±æœƒå‡ºå•é¡Œäº†ã€‚&lt;br /&gt;
å› ç‚ºserviceåˆ°podçš„æµé‡å¹³å‡åˆ†é…ï¼Œä½ ä¸æœƒçŸ¥é“ä»–é€£å»å“ªå€‹podã€‚&lt;br /&gt;
ä½†ä»Šå¤©æˆ‘è¦æŠ“å…¨éƒ¨metricsï¼Œé€™ç¨®å¯«æ³•å°±æœƒå‡ºå•é¡Œã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ &lt;code&gt;static_configs&lt;/code&gt; é€™å€‹åªé©ç”¨æ–¼ å›ºå®šå­—ä¸²ï¼Œ&lt;br /&gt;
æ‰€ä»¥å°æ–¼æœƒè®Šä¾†è®Šå»çš„pod ipæ²’æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ–¼æ˜¯è¦æ”¹æˆ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- job_name: &#39;srs&#39;
  scrape_interval: 10s
  kubernetes_sd_configs:
    - role: pod  
  relabel_configs:
    - source_labels: [__meta_kubernetes_pod_name]
      action: keep
      regex: srs-.*
    - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]
      action: replace
      target_label: __metrics_path__
      replacement: /metrics   # å¼·åˆ¶æŒ‡å®šè·¯å¾‘ç‚º /metrics
    - source_labels: [__meta_kubernetes_pod_container_port_name]
      action: replace
      target_label: portname
      replacement: 9972 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¦å‰‡ç”±ä¸Šå¾€ä¸‹ä¾åºåŸ·è¡Œï¼Œæœ‰ç¬¦åˆæ‰æœƒå¾€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;kubernetes_sd_configs&lt;/code&gt; æœ‰é€™5ç¨®æ–¹å¼(GPTæŠ„ä¾†çš„)&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;role: endpointsï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€™å€‹çµ„æ…‹é …å‘Šè¨´ Prometheus å»ç™¼ç¾ Kubernetes ä¸­çš„ç«¯é»å°è±¡ã€‚ç«¯é»å°è±¡ä»£è¡¨äº†æœå‹™çš„å¾Œç«¯ Pod çš„ IP åœ°å€å’Œé€£æ¥åŸ ã€‚&lt;/li&gt;
&lt;li&gt;é€šéæ­¤çµ„æ…‹é …ï¼ŒPrometheus å¯ä»¥ç›´æ¥èˆ‡å¾Œç«¯ Pod é€²è¡Œé€šè¨Šï¼Œæ”¶é›†æŒ‡æ¨™è³‡æ–™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;role: serviceï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€™å€‹çµ„æ…‹é …å‘Šè¨´ Prometheus å»ç™¼ç¾ Kubernetes ä¸­çš„æœå‹™å°è±¡ã€‚&lt;/li&gt;
&lt;li&gt;Prometheus å°‡æœƒç‚ºæ¯å€‹æœå‹™ç™¼ç¾æœå‹™çš„æ‰€æœ‰å¾Œç«¯ Podï¼Œä¸¦å¾æ¯å€‹ Pod ä¸­æŠ“å–æŒ‡æ¨™è³‡æ–™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;role: podï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€™å€‹çµ„æ…‹é …å‘Šè¨´ Prometheus å»ç™¼ç¾ Kubernetes ä¸­çš„ Pod å°è±¡ã€‚&lt;/li&gt;
&lt;li&gt;Prometheus å°‡æœƒç‚ºæ¯å€‹ç™¼ç¾çš„ Pod æ”¶é›†æŒ‡æ¨™è³‡æ–™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;role: ingressï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€™å€‹çµ„æ…‹é …å‘Šè¨´ Prometheus å»ç™¼ç¾ Kubernetes ä¸­çš„ Ingress å°è±¡ã€‚&lt;/li&gt;
&lt;li&gt;Prometheus å°‡æœƒç›£è¦– Ingress å°è±¡ï¼Œä¸¦æ”¶é›†èˆ‡ä¹‹ç›¸é—œçš„æŒ‡æ¨™è³‡æ–™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;role: nodeï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€™å€‹çµ„æ…‹é …å‘Šè¨´ Prometheus å»ç™¼ç¾ Kubernetes ä¸­çš„ç¯€é»å°è±¡ã€‚&lt;/li&gt;
&lt;li&gt;Prometheus å°‡æœƒç‚ºæ¯å€‹ç¯€é»æ”¶é›†ç›¸é—œçš„æŒ‡æ¨™è³‡æ–™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å†ä¾†æ˜¯é‡é» &lt;code&gt;relabel_configs&lt;/code&gt;&lt;br /&gt;
åˆ†åˆ¥æœ‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;source_labelsï¼šä¾†æºæ¨™ç±¤ï¼Œå¯ä»¥åƒè€ƒprometheusçš„UIï¼Œä¸Šé¢æœ‰é¡¯ç¤ºå¾ˆå¤šlabel&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/209-fig.1.png&quot; alt=&quot;209-fig.1.png&quot; /&gt;&lt;/li&gt;
&lt;li&gt;actionï¼šå››ç¨®å‹•ä½œï¼ˆkeep,drop,replace,labelmapï¼‰ã€‚&lt;br /&gt;
æ±ºå®šä½ è¦å°‡å€¼ä¿ç•™ã€çµ‚æ­¢ã€å–ä»£æˆ–æ¨™ç±¤å°æ‡‰&lt;/li&gt;
&lt;li&gt;target_labelï¼šç›®çš„æ¨™ç±¤ï¼Œ&lt;br /&gt;
æŠ“è³‡æ–™çš„urlï¼Œç”±ä¸‹é¢ä¸‰ç¨®ç‰¹æ®Šæ¨™ç±¤çµ„æˆ&lt;code&gt;__scheme__&lt;/code&gt;Â +Â &lt;code&gt;__address__&lt;/code&gt;Â +Â &lt;code&gt;__metrics_path__&lt;/code&gt;ã€‚&lt;br /&gt;
ç¯„ä¾‹ï¼š &lt;code&gt;https://192.168.103.224:9527/metrics&lt;/code&gt;&lt;br /&gt;
ä¸»è¦æ˜¯æ±ºå®šç‰¹æ®Šæ¨™ç±¤è¦ç”¨ä»€éº¼ï¼Œä¸ç„¶éš¨ä¾¿å–åéƒ½å¯ä»¥ã€‚&lt;/li&gt;
&lt;li&gt;regexï¼Œç•¶ä½œæ˜¯æ¢ä»¶åˆ¤æ–·é€™è£¡é¢çš„å€¼è¦ç¬¦åˆè¦å‰‡èƒ½å¾€ä¸‹ã€‚&lt;br /&gt;
ä¸‹é¢regexæ„æ€æ˜¯ï¼Œpod nameè¦ç¬¦åˆ&lt;code&gt;srs-.*&lt;/code&gt;çš„æ‰ä¿ç•™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;    - source_labels: [__meta_kubernetes_pod_name]
      action: keep
      regex: srs-.*
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;replacementï¼šè®Šæ›´çš„å€¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ossrs.io/lts/zh-cn/docs/v5/doc/exporter&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;SRS-Prometheus Exporter&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://p8s.io/docs/service-discovery/relabel/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Relabeling é‡æ–°æ¨™è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://godleon.github.io/blog/Prometheus/Prometheus-Relabel/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt; [Prometheus] Service Discovery &amp;amp; Relabel&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/209. k8sä¸­srsçš„å„å€‹pod  metricså–å¾—/" />
        </entry>
        <entry>
            <title>
                208. æ¶è¨­ sftp
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/208. æ¶è¨­ sftp/</id>
            <content type="html">
                &lt;h1 id=&quot;äº‹ç”±&quot; tabindex=&quot;-1&quot;&gt;äº‹ç”±&lt;/h1&gt;
&lt;p&gt;éœ€è¦ä¸€å€‹åœ°æ–¹æ”¾å¤§é‡çš„è³‡æ–™ï¼Œæ—¥å¾Œæä¾›çµ¦å®¢æˆ¶ä¸‹è¼‰ï¼Œ&lt;br /&gt;
æœ¬ä¾†æƒ³èªªç”¨GCSå°±å¥½ï¼Œä½†å¦‚æœè¦ä¸€æ¬¡ä¸‹è¼‰å¥½å¹¾å€‹æª”æ¡ˆå°±æ²’è¾¦æ³•äº†ã€‚&lt;br /&gt;
åªå¥½ä¹–ä¹–å¼„FTPã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä¸€é–‹å§‹ç”¨vsftpï¼Œæå€‹docker å¤§æ¦‚æ²’10åˆ†é˜å°±å¥½äº†ã€‚&lt;br /&gt;
æœ‰ä¸€åŠçš„æ™‚é–“åœ¨æ‰¾imageä¸Šé¢ï¼Œ&lt;br /&gt;
ä½†å¦‚æœè¦é”æˆã€ä¸€å€‹ä½¿ç”¨è€…ï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰ä½¿ç”¨è€…çš„ç›®éŒ„ï¼Œå…¶ä»–ä½¿ç”¨è€…éœ€è¦ç¨ç«‹ã€å°±æ‡µäº†ã€‚&lt;/p&gt;
&lt;p&gt;å¾ŒçºŒæ‰¾è³‡æ–™æ™‚ï¼Œçœ‹åˆ°é³¥å“¥èªªäº†ä¸€å¥è©±ï¼Œã€æ‰€ä»¥ï¼Œå»ºè­°æ‚¨ï¼Œé™¤éå¿…è¦ï¼Œå¦å‰‡çš„è©±ï¼Œä½¿ç”¨ SSH æä¾›çš„ sftp-server åŠŸèƒ½å³å¯ã€&lt;br /&gt;
ref. &lt;a href=&quot;https://linux.vbird.org/linux_server/redhat9/0400wuftp.php&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;FTP çš„å®‰å…¨æ€§å•é¡Œèˆ‡æ›¿ä»£æ–¹æ¡ˆ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘å°±è½‰å¾€sftpäº†ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆä¾†é‡æ¸…ç›®æ¨™ï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€å€‹æœ€é«˜æ¬Šé™çš„å¸³è™Ÿï¼Œ&lt;br /&gt;
å¯ä»¥åœ¨æ‰€æœ‰ä½¿ç”¨è€…çš„ç›®éŒ„æ–°å¢æª”æ¡ˆï¼Œ&lt;br /&gt;
ç„¶å¾Œæ‰€æœ‰ä½¿ç”¨è€…é–“æ˜¯ä¸èƒ½äº’ç›¸çœ‹åˆ°å½¼æ­¤çš„æª”æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;docker image ä½¿ç”¨ &lt;a href=&quot;https://hub.docker.com/r/corilus/sftp&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;corilus/sftp&lt;/a&gt;ï¼Œ&lt;br /&gt;
ä¸‹è¼‰é‡å·²é”1Mã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåªæ˜¯ç°¡å–®çš„ftpåŠŸèƒ½ï¼Œç›´æ¥æ¶èµ·ä¾†å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†è¦åšæˆä¸Šé¢çš„ç›®æ¨™ï¼Œè¦ç”¨mountçš„æ–¹å¼ï¼Œå°‡è³‡æ–™å¤¾æ›è¼‰åˆ°ä¸»ç›®éŒ„åº•ä¸‹ã€‚&lt;br /&gt;
è©³ç´°ä½œæ³•åƒè€ƒä¸‹é¢ã€‚&lt;/p&gt;
&lt;p&gt;docker-compose.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;version: &#39;3&#39;
services:
  sftp:
    container_name: sftp
    image: corilus/sftp
    privileged: true
    volumes:
        - ./mount.sh:/etc/sftp.d/bindmount.sh
        - ./userlist.conf:/etc/sftp/users.conf:ro
        - ./upload:/home
    ports:
        - &amp;quot;2222:22&amp;quot;
    restart: always
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŒ‡ä»¤èªªæ˜ï¼Œå¯åƒè€ƒ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%90%A7%20Linux/108.%20linux%20shell%20%E9%80%B2%E9%9A%8E%E6%8C%87%E4%BB%A4/#bdeaee&quot;&gt;108. linux shell é€²éšæŒ‡ä»¤#^bdeaee&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;http://mount.sh/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;mount.sh&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/bin/bash
# File mounted as: /etc/sftp.d/bindmount.sh
# Just an example (make your own)

function bindmount() {
    if [[ !  -d &amp;quot;$1&amp;quot; ]]; then
        mkdir -p &amp;quot;$1&amp;quot;
    fi

    if [[ ! -d &amp;quot;$2&amp;quot; ]]; then
	     mkdir -p &amp;quot;$2&amp;quot;
    fi

    chown -R :100 &amp;quot;$1&amp;quot; &amp;quot;$2&amp;quot;
    chmod 775 &amp;quot;$1&amp;quot; &amp;quot;$2&amp;quot;
    mount --bind &amp;quot;$1&amp;quot; &amp;quot;$2&amp;quot;
}

# Remember permissions, you may have to fix them:
# chown -R :users /data/common
bindmount &amp;quot;/home/mike/upload&amp;quot; &amp;quot;/home/ms/mike&amp;quot;
bindmount &amp;quot;/home/aaron/upload&amp;quot; &amp;quot;/home/ms/aaron&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;userlist.conf&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ms:ms:1001:100
mike:mike:1002:100
aaron:aaron:1003:100
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ¬ä¾†æƒ³ç”¨lnçš„æ–¹å¼å»æ“ä½œï¼Œ&lt;br /&gt;
å¾terminal èƒ½å¤ é€²å»è³‡æ–™å¤¾ï¼Œä½†ç”¨FTPç™»å…¥å°±æ˜¯èªª &lt;code&gt;no such file or dirctory&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å•äº†è€åŠå¤©GPTä¹Ÿéƒ½æ˜¯å¤±æ•—ï¼Œ&lt;br /&gt;
å¾ä¸€é–‹å§‹èªªè¦åŠ å€‹ä¸å­˜åœ¨çš„åƒæ•¸ FollowSymlinks ï¼Œ&lt;br /&gt;
åˆ°å¾Œé¢çš„ä¸€é€£ä¸²é‡è¤‡å›ç­”ã€‚&lt;/p&gt;
&lt;p&gt;æœ€å¾Œçœ‹åˆ° &lt;a href=&quot;https://serverfault.com/questions/448647/symbolic-link-and-filezilla-over-sftp&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Symbolic link and filezilla over sftp&lt;/a&gt;&lt;br /&gt;
çœ‹ä¾†æ˜¯lnçš„å…ˆå¤©é™åˆ¶ï¼Œæ‰€ä»¥æ”¹ç”¨mountå¾Œï¼Œèª¿å€‹æ¬Šé™ï¼Œå¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/Corilus/sftp&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Corilus/sftp Github&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/208. æ¶è¨­ sftp/" />
        </entry>
        <entry>
            <title>
                207. mapgenieæ•´æ‰¹unfound
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/207. mapgenieæ•´æ‰¹unfound/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å‰é™£å­ç©éŠæˆ²æ™‚ç™¼ç¾ä¸€å€‹ç¶²ç«™ï¼Œ&lt;a href=&quot;http://mapgenie.io/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;mapgenie.io&lt;/a&gt;&lt;br /&gt;
è£¡é¢æœ‰å¾ˆå¤šéŠæˆ²çš„åœ°åœ–ï¼Œ&lt;br /&gt;
æŒ‰ä¸‹foundä»¥å¾Œï¼Œä¸æƒ³ä¸€å€‹ä¸€å€‹æŠŠå‹¾æ‹¿æ‰ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æœ‰é¤˜åŠ›çš„è©±ï¼Œæ‡‰è©²æ˜¯è²·VIPæœƒå“¡æ‰å°ï¼Œ&lt;br /&gt;
ä½†æˆ‘è¦ºå¾—æˆ‘ç”¨ä¸åˆ°é‚£éº¼å¤šåŠŸèƒ½ï¼Œ&lt;br /&gt;
å¯èƒ½é€™å€‹åŠŸèƒ½ä¹Ÿæ˜¯VIPå°ˆç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ç•¢ç«ŸèŠ±éŒ¢å°±æ˜¯è¦çœæ™‚é–“ï¼Œä¸æƒ³èŠ±éŒ¢åˆæƒ³çœæ™‚é–“çš„è©±ï¼Œ&lt;br /&gt;
æ´—æ´—ç¡å§ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰“é–‹ç¶²é çš„é–‹ç™¼è€…å·¥å…·ï¼Œ&lt;br /&gt;
æ‰¾åˆ° &lt;code&gt;body &amp;gt; div#app&lt;/code&gt;&lt;br /&gt;
åº•ä¸‹çš„scriptsï¼Œæœƒé•·çš„åƒé€™æ¨£&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/207-fig.1.png&quot; alt=&quot;207-fig.1.png&quot; /&gt;&lt;br /&gt;
æœ€ä¸Šé¢æœ‰ä¸€äº›æ•¸å­—ï¼Œé‚£äº›æ•¸å­—å°±æ˜¯æˆ‘å€‘è¦çš„ã€‚&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;
&lt;p&gt;é¸æ“‡ç¶²è·¯é ç±¤&lt;br /&gt;
å†ä¾†å°‡ä¸€å€‹foundé—œæ‰ï¼Œæœƒçœ‹åˆ°åº•ä¸‹çš„Fetch/XHRï¼Œæ–°å¢ä¸€ç­†ã€‚&lt;br /&gt;
é»é¸å¾Œï¼Œæ³¨æ„çœ‹ç®­é ­æ˜¯ä¸æ˜¯å¯«DELETE&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/207-fig.2.png&quot; alt=&quot;207-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¤‡è£½æˆCURL&lt;br /&gt;
å°è‘—å‰›å‰›çš„58673æŒ‰å³éµï¼Œé¸æ“‡è¤‡è£½æˆCURL&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/207-fig.3.png&quot; alt=&quot;207-fig.3.png&quot; /&gt;&lt;br /&gt;
ç„¶å¾Œæ‰¾å€‹è¨˜äº‹æœ¬è²¼ä¸Šï¼Œä½ æœƒç™¼ç¾ä¸€é•·ä¸²çš„æ±è¥¿ã€‚&lt;br /&gt;
æˆ‘æ¸¬è©¦éï¼Œå¯ä»¥æŠŠ &lt;code&gt;-H &#39;cookie:&#39;&lt;/code&gt; æ•´æ®µæ‹¿æ‰ï¼Œ&lt;br /&gt;
å…¶ä»–æ±è¥¿æ‡‰è©²å°±ä¸å¥½åˆªäº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/207-fig.4.png&quot; alt=&quot;207-fig.4.png&quot; /&gt;&lt;br /&gt;
å†ä¾†å°±æ˜¯æ›´æ›æœ€ä¸Šé¢çš„æ•¸å­—ï¼Œå°±ä¸ç”¨ä¸€å€‹ä¸€å€‹é»æ¨™èªŒï¼Œç„¶å¾ŒæŠŠå‹¾æ‹¿æ‰äº†ã€‚&lt;br /&gt;
ä¸Šé¢çš„åœ–ç‰‡ï¼Œæˆ‘åªç¯€éŒ„äº†ä¸‰è¡Œï¼Œå®Œæ•´çš„ä¸åªé€™æ¨£ã€‚&lt;br /&gt;
ç„¶å¾Œå°‡curlä¸Ÿå» å‘½ä»¤ææ˜¯å­—å…ƒåŸ·è¡Œå°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ›´æ‡¶ä¸€é»ï¼Œå¼„å€‹forè¿´åœˆï¼ŒæŠŠæ•¸å­—è‡ªå‹•å¸¶é€²å»ç¶²å€ã€‚&lt;br /&gt;
å¯ä»¥åƒè€ƒ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%98%81%EF%B8%8E%20GCP/135.%20gsutil%E6%95%B4%E6%89%B9%E8%A4%87%E8%A3%BD/&quot;&gt;135. gsutilæ•´æ‰¹è¤‡è£½&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é‚„æœ‰å¦ä¸€ç¨®å°±æ˜¯å»æ‰¾newmanå»æè‡ªå‹•åŒ–å¸¶å…¥åƒæ•¸æ‡‰è©²ä¹Ÿèƒ½åšåˆ°ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/207. mapgenieæ•´æ‰¹unfound/" />
        </entry>
        <entry>
            <title>
                206. steamDeck çš„ Cheat Engineæ›¿ä»£å“
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/206. steamDeck çš„ Cheat Engineæ›¿ä»£å“/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ˜¥ç‰¹å…¥æ‰‹äº†å¹¾æ¬¾ è·Ÿå¼Ÿå¼Ÿä¸€èµ·ç©çš„éŠæˆ²ï¼Œ&lt;/p&gt;
&lt;p&gt;ä½†æœ‰äº›æ™‚å€™é‡è¤‡åˆ·çš„æœ‰é»ç…©ï¼Œ&lt;/p&gt;
&lt;p&gt;å°±æƒ³èªªæ”¹ä¸€ä¸‹çœé»æ™‚é–“ï¼Œ&lt;/p&gt;
&lt;p&gt;æŸ¥äº†ä¸€äº›è³‡è¨Šï¼Œç™¼ç¾CheatEngineä¸æ˜¯ä¸èƒ½è£ï¼Œ&lt;/p&gt;
&lt;p&gt;ä½†æœ‰å¤ &lt;strong&gt;éº»ç…©&lt;/strong&gt;ï¼ï¼ï¼ï¼ï¼&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;é®é‡è²æ˜ï¼Œä¿®æ”¹æœ‰ä¸€å®šé¢¨éšªã€‚&quot; tabindex=&quot;-1&quot;&gt;é®é‡è²æ˜ï¼Œä¿®æ”¹æœ‰ä¸€å®šé¢¨éšªã€‚&lt;/h3&gt;
&lt;h4 id=&quot;c-c-memory-deck&quot; tabindex=&quot;-1&quot;&gt;æ„Ÿè¬å·´å‹C.Cå‘ŠçŸ¥å¦ä¸€å¥—è»Ÿé«”ã€memory deckã€&lt;/h4&gt;
&lt;p&gt;ç›´æ¥åœ¨Decky loader æœå°‹ï¼Œå®‰è£å³å¯ã€‚&lt;br /&gt;
æœå°‹æ–¹å¼ä¹Ÿå¾ˆç°¡å–®ï¼Œç›´æ¥æŒ‰æŒæ©Ÿå³ä¸‹çš„ &lt;code&gt;...&lt;/code&gt; å°±èƒ½æœå°‹ã€‚&lt;br /&gt;
ç¼ºé»æ˜¯æ¯æ¬¡è¦æ”¹å°±è¦é‡æ–°æœå°‹ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;æœ€å¾Œåœ¨&lt;a href=&quot;https://ref.gamer.com.tw/redir.php?url=https%3A%2F%2Fwww.reddit.com%2Fr%2FSteamDeck%2Fcomments%2F10dslcm%2Fcheat_engine_or_some_equivalent_on_steam_deck%2F&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;reddit&lt;/a&gt;æ‰¾åˆ°äº†Â &lt;a href=&quot;https://ref.gamer.com.tw/redir.php?url=https%3A%2F%2Fgithub.com%2Fprimetime00%2Fmemory_hack&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;memory_hack&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é€™æ¬¾çš„å¥½è™•åœ¨æ–¼ï¼Œsteam deck(æ¡Œé¢æ¨¡å¼)é–‹å•ŸéŠæˆ²å¾Œï¼Œ&lt;/p&gt;
&lt;p&gt;ç”¨æ‰‹æ©Ÿæˆ–é›»è…¦åœ¨åŒä¸€å€‹wifiåº•ä¸‹ï¼Œé–‹å•Ÿç¶²é å³å¯ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;å®‰è£æ–¹å¼ä¹Ÿå¾ˆç°¡å–®ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å»ºç«‹ä¸€å€‹è³‡æ–™å¤¾ï¼Œè¦æ”¾å®‰è£æª”&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;python3 &amp;lt;(wget -qO- https://github.com/primetime00/memory_hack/raw/master/app/patches/install.py)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;å®‰è£å®Œå¾Œï¼Œæœƒå•ä½ è¦ä¸è¦ç•¶æˆé è¨­ç¨‹å¼ï¼Œæˆ‘æ˜¯é¸n ï¼Œç•¶æœ‰éœ€è¦æ™‚å†åˆ°å‰›å‰›çš„è³‡æ–™å¤¾å•Ÿå‹•å°±å¥½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å•Ÿå‹•æŒ‡ä»¤ï¼Œåˆ°è©²è³‡æ–™å¤¾åº•ä¸‹åŸ·è¡ŒÂ Â Â &lt;code&gt;./run.sh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://ref.gamer.com.tw/redir.php?url=https%3A%2F%2Fgithub.com%2Fprimetime00%2Fmemory_hack%3Ftab%3Dreadme-ov-file%23steam-deck&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®‰è£èªªæ˜é€£çµ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œå°±å¯ä»¥å…ˆåœ¨steam deckä¸Šé¢é–‹ç¶²é ï¼Œ&lt;a href=&quot;http://localhost:5000/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;http://localhost:5000&lt;/a&gt; çœ‹æœ‰æ²’æœ‰è³‡æ–™ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦ç”¨æ‰‹æ©Ÿæˆ–é›»è…¦é€£çš„è©±ï¼Œ&lt;/p&gt;
&lt;p&gt;å¯ä»¥å¦å¤–é–‹å•Ÿkonsole ï¼ŒåŸ·è¡Œ &lt;code&gt;ip -4 addr&lt;/code&gt;Â Â å°±æœƒçœ‹åˆ°ä½ çš„ipï¼Œå‡è¨­æ˜¯192.168.0.125ï¼Œ&lt;/p&gt;
&lt;p&gt;åœ¨æ‰‹æ©Ÿä¸Šé–‹å•Ÿ &lt;a href=&quot;http://192.168.0.125:5000/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;http://192.168.0.125:5000&lt;/a&gt; ï¼Œå°±æœƒçœ‹åˆ°ç•«é¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç°¡æ˜“æ“ä½œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;åˆ° Search çš„é ç±¤ä¸Šï¼Œé¸æ“‡ Processçš„ éŠæˆ²åç¨±&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¼¸å…¥æ•¸å€¼æŸ¥è©¢ï¼Œé€šå¸¸è¦å…©æ¬¡æŸ¥è©¢ï¼Œç¬¬ä¸€æ¬¡æœ‰å¾ˆå¤šè³‡æ–™ï¼Œç•¶æ•¸å€¼è®Šå‹•æ™‚ï¼Œå†æœå°‹ä¸€æ¬¡ï¼Œå°±æœƒæœ‰äº†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¤‡è£½è¨˜æ†¶é«”ä½ç½®&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ° Codeçš„é ç±¤ï¼Œé¸æ“‡ Processçš„éŠæˆ²åç¨±&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¼¸å…¥æ•¸å€¼ï¼Œæ—é‚Šçš„æ–¹æ ¼ï¼Œæ‰“å‹¾è¡¨ç¤ºé–å®šæ•¸å€¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;p.s æ”¹å®Œå¾Œï¼Œæ•¸å€¼å¯èƒ½ä¸æœƒé¦¬ä¸Šé‡ç¾ï¼Œè®“éŠæˆ²çš„æ•¸å€¼è®Šå‹•ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;å®Œæ•´æ“ä½œèªªæ˜ï¼Œè«‹åƒè€ƒÂ &lt;a href=&quot;https://ref.gamer.com.tw/redir.php?url=https%3A%2F%2Fgithub.com%2Fprimetime00%2Fmemory_hack%2Fblob%2Fmaster%2Fdocs%2Ftutorial%2FTUTORIAL.md&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Memory Hack Beginner Tutorial&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹å‰æœ‰äººä»‹ç´¹å¦ä¸€æ¬¾ï¼Œ&lt;br /&gt;
Memory Deck ï¼Œç›´æ¥åœ¨æŒæ©Ÿæ¨¡å¼ä¸‹çš„Decky loader å•†åº—æœå°‹ï¼Œ&lt;br /&gt;
è£èµ·ä¾†å°±å¥½äº†ã€‚&lt;/p&gt;

            </content>
            <link href="https://daimom.github.io/206. steamDeck çš„ Cheat Engineæ›¿ä»£å“/" />
        </entry>
        <entry>
            <title>
                205. Grafana ç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/205. Grafana ç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰æ–‡&quot; tabindex=&quot;-1&quot;&gt;å‰æ–‡&lt;/h1&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;å–®ä½æ›ç®—&quot; tabindex=&quot;-1&quot;&gt;å–®ä½æ›ç®—&lt;/h3&gt;
&lt;p&gt;byte(IEC)ï¼šä»¥1024è½‰æ›è¨ˆç®—ã€‚2MB = 2042 kb&lt;br /&gt;
byte(SI) ï¼š ä»¥åé€²ä½è¨ˆç®—ã€‚ 2MB= 2000kb&lt;/p&gt;
&lt;h3 id=&quot;æ›´æ›ç·šæ¢é¡è‰²&quot; tabindex=&quot;-1&quot;&gt;æ›´æ›ç·šæ¢é¡è‰²&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆæŠŠLegend  æ‰“é–‹&lt;/li&gt;
&lt;li&gt;é»é¸Legendçš„é¡è‰²&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/205-fig.1.png&quot; alt=&quot;205-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;éš±è—&quot; tabindex=&quot;-1&quot;&gt;éš±è—&lt;/h3&gt;
&lt;p&gt;Overridesè£¡é¢çš„é¸é …ï¼Œæœ‰æ™‚æœƒè¢«æ‰“å‹¾ï¼Œå°è‡´ç·šåœ–ä¸æœƒå‡ºç¾&lt;/p&gt;
&lt;h3 id=&quot;åŒ¯å‡º&quot; tabindex=&quot;-1&quot;&gt;åŒ¯å‡º&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é»é¸æ¨™é¡Œçš„å³é‚Šåˆ†äº«æŒ‰éˆ•&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/205-fig.2.png&quot; alt=&quot;205-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é¸æ“‡Export ï¼Œå†ä¾†çœ‹è¦å­˜æª”æˆ–æª¢è¦–Json&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/205-fig.3.png&quot; alt=&quot;205-fig.3.png&quot; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/205. Grafana ç­†è¨˜/" />
        </entry>
        <entry>
            <title>
                203. istio Authorization æ‹’çµ•æŒ‡å®šæª”æ¡ˆç€è¦½
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/203. istio Authorization æ‹’çµ•æŒ‡å®šæª”æ¡ˆç€è¦½/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ¥åˆ°å€‹éœ€æ±‚ï¼Œè¦é™å®šç¶²ç«™çš„æŸå€‹å‰¯æª”åä¸èƒ½è¢«ç€è¦½ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;Authorization-policyçš„yaml&lt;/p&gt;
&lt;p&gt;Ruleè¦å‰‡åˆ†æˆä¸‰å¤§å¡Š&lt;/p&gt;
&lt;p&gt;From&lt;br /&gt;
è«‹æ±‚ä¾†æº&lt;br /&gt;
To&lt;br /&gt;
è«‹æ±‚ç›®çš„&lt;br /&gt;
When&lt;br /&gt;
æŒ‡å®šçš„è«‹æ±‚é™„åŠ æ¢ä»¶&lt;/p&gt;
&lt;h3 id=&quot;to&quot; tabindex=&quot;-1&quot;&gt;To&lt;/h3&gt;
&lt;p&gt;nginxæŸ¥ä¸€ä¸‹ï¼Œæ˜¯æœ‰é¡ä¼¼çš„æ±è¥¿ã€‚&lt;br /&gt;
ä½†istioæˆ‘çœ‹äº†å®˜æ–¹æ–‡ä»¶ï¼Œ&lt;br /&gt;
å¯«æ³•æ˜¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- to:
  - operation:
      paths: [&amp;quot;/user/profile/*&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç›®å‰åªæœ‰æ”¯æ´å–®å€‹ &lt;code&gt;*&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Exact match:Â &lt;code&gt;abc&lt;/code&gt;Â will match on valueÂ &lt;code&gt;abc&lt;/code&gt;.&lt;br /&gt;
å®Œå…¨åŒ¹é…ï¼šÂ &lt;code&gt;abc&lt;/code&gt;Â å°‡åŒ¹é…å€¼Â &lt;code&gt;abc&lt;/code&gt;Â ã€‚&lt;/li&gt;
&lt;li&gt;Prefix match:Â &lt;code&gt;abc*&lt;/code&gt;Â will match on valueÂ &lt;code&gt;abc&lt;/code&gt;Â andÂ &lt;code&gt;abcd&lt;/code&gt;.&lt;br /&gt;
å‰ç¶´åŒ¹é…ï¼šÂ &lt;code&gt;abc*&lt;/code&gt;Â å°‡åŒ¹é…å€¼Â &lt;code&gt;abc&lt;/code&gt;Â å’ŒÂ &lt;code&gt;abcd&lt;/code&gt;Â ã€‚&lt;/li&gt;
&lt;li&gt;Suffix match:Â &lt;code&gt;*abc&lt;/code&gt;Â will match on valueÂ &lt;code&gt;abc&lt;/code&gt;Â andÂ &lt;code&gt;xabc&lt;/code&gt;.&lt;br /&gt;
å¾Œç¶´åŒ¹é…ï¼šÂ &lt;code&gt;*abc&lt;/code&gt;Â å°‡åŒ¹é…å€¼Â &lt;code&gt;abc&lt;/code&gt;Â å’ŒÂ &lt;code&gt;xabc&lt;/code&gt;Â ã€‚&lt;/li&gt;
&lt;li&gt;Presence match:Â &lt;code&gt;*&lt;/code&gt;Â will match when value is not empty.&lt;br /&gt;
å­˜åœ¨åŒ¹é…ï¼šç•¶å€¼ä¸ç‚ºç©ºæ™‚ï¼ŒÂ &lt;code&gt;*&lt;/code&gt;Â å°‡åŒ¹é…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¾åœ¨çš„ç›®æ¨™æ˜¯è¦é˜»æ“‹ index-erscvs.js.map ï¼Œç¦æ­¢ä»»ä½•äººè§€çœ‹ã€‚&lt;br /&gt;
ä½† index-erscvs.js ä¸èƒ½è¢«deny&lt;/p&gt;
&lt;p&gt;æ–¼æ˜¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kind: AuthorizationPolicy
metadata:
  name: frontend-map-policy
spec:
  selector:
    matchLabels:
      group: frontend
  action: DENY
  rules:
    - to:
      - operation:
          hosts: [&amp;quot;abc.def.com&amp;quot;]
          ports: [&amp;quot;80&amp;quot;]
          paths: [&amp;quot;*.js.map&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å„ªå…ˆé †åºè©•ä¼°è¡¨ &lt;code&gt;Custom &amp;gt; Deny &amp;gt; Allow&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://istio.io/latest/docs/reference/config/security/authorization-policy&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Authorization Policy&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;when&quot; tabindex=&quot;-1&quot;&gt;When&lt;/h3&gt;
&lt;h5 id=&quot;values-cidr&quot; tabindex=&quot;-1&quot;&gt;æ³¨æ„ï¼Œvaluesä¸æ”¯æ´CIDRï¼Œéœ€ç”¨* ä»£æ›¿ç§æœ‰ç¶²æ®µ&lt;/h5&gt;
&lt;p&gt;é€™é‚Šæ²¿ç”¨ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%E2%9B%B5%EF%B8%8F%20istio/186.%20istio%E7%9A%84Authorization%20policy(%E7%99%BD%E5%90%8D%E5%96%AE)/&quot;&gt;186. istioçš„Authorization policy(ç™½åå–®)&lt;/a&gt; çš„æ–¹å¼ï¼Œ&lt;br /&gt;
è¨­å®šç™½åå–®ã€‚&lt;/p&gt;
&lt;p&gt;æ–¼æ˜¯ï¼Œä¸‹é¢çš„è¨­å®šæ–¹å¼ï¼Œlabel æ˜¯ group=frontendçš„deployï¼Œ&lt;br /&gt;
ä¸å…è¨±è¨ªå•&lt;code&gt;*.js.map&lt;/code&gt;çš„æª”æ¡ˆï¼Œé™¤äº†ä¾†æºæ˜¯ &lt;code&gt;123.123.123.123&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
  name: frontend-map-policy
spec:
  selector:
    matchLabels:
      group: frontend
  action: DENY
  rules:
    - to:
      - operation:
          hosts: [&amp;quot;abc.def.com&amp;quot;]
          ports: [&amp;quot;80&amp;quot;]
          paths: [&amp;quot;*.js.map&amp;quot;]
      when:      
      - key: request.headers[X-Envoy-External-Address]
        notValues:
          - &amp;quot;123.123.123.123&amp;quot; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é©—è­‰æ™‚ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„æŒ‡ä»¤å”åŠ©æŸ¥è©¢ï¼Œ&lt;br /&gt;
è¦æ³¨æ„æ˜¯ä¸æ˜¯è¢«å…¶ä»–çš„policyå½±éŸ¿äº†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# å…ˆé–‹å•Ÿdebugæ¨¡å¼ï¼Œè³‡è¨Šæ¯”è¼ƒå¤šï¼ŒæŸ¥å®Œå¾Œå°‡deployé‡å•Ÿå³å¯
istioctl proxy-config log deploy/httpbin --level &amp;quot;rbac:debug&amp;quot; | grep rbac

for i in {1..20}; do curl -H &#39;Cache-Control: no-cache, no-store&#39; https://abc.def.com/assets/index-d74bceac.js -s -o /dev/null -w &amp;quot;%{http_code}&#92;n&amp;quot;; done

kubectl logs &amp;lt;pod name&amp;gt; -c istio-proxy
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;æ³¨æ„&quot; tabindex=&quot;-1&quot;&gt;æ³¨æ„&lt;/h2&gt;
&lt;p&gt;when è·Ÿ to å¦‚æœç”¨ ä¸‹é¢æ–¹å¼çš„è©±ï¼Œè¡¨ç¤ºæ˜¯å…©æ¢è¦å‰‡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;...
	- to:
		...
	- when:
		...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æ¨£æ‰æ˜¯åŒä¸€æ¢è¦å‰‡ï¼Œ&lt;br /&gt;
æˆ‘çŠ¯äº†é€™å€‹è ¢éŒ¯èª¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;	- to:
		...
	  when:
		...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/latest/docs/reference/config/security/authorization-policy&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Authorization Policy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/latest/docs/reference/config/security/conditions/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Authorization Policy Conditions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/hxpjava1/article/details/117330067&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;authorizationPolicyè©³è§£&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/203. istio Authorization æ‹’çµ•æŒ‡å®šæª”æ¡ˆç€è¦½/" />
        </entry>
        <entry>
            <title>
                202. GCPå¤šå¸³è™Ÿåˆ‡æ›
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/202. GCPå¤šå¸³è™Ÿåˆ‡æ›/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘é©é€¢å°ˆæ¡ˆæ¬å®¶æ™‚æœŸï¼Œå¸³è™Ÿè¦åˆ‡ä¾†åˆ‡å»ï¼Œ&lt;br /&gt;
çµæœä¸€åˆ‡éå»å°±ä¸èƒ½ç”¨äº†ã€‚&lt;br /&gt;
éŒ¯èª¤å¯«ï¼Œä½ çš„Bå¸³è™Ÿç„¡æ³•åœ¨Aå°ˆæ¡ˆä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;OSæ˜¯ MacOSï¼Œwindowæœƒä¸æœƒæœ‰ç›¸åŒéŒ¯èª¤ä¸æ¸…æ¥š&lt;/p&gt;
&lt;p&gt;è©¦äº†å¹¾æ¬¡ï¼Œåˆ‡æ›GCPå¸³è™Ÿçš„æŒ‡ä»¤éƒ½æ²’ç”¨ï¼Œ&lt;br /&gt;
æœ€å¾Œæ‘¸å‡ºä¸€å¥—å¯è¡Œçš„æ­¥é©Ÿ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆç¢ºå®šç›®å‰ä½¿ç”¨çš„gcpå¸³è™Ÿæ˜¯å“ªä¸€å€‹ï¼Œ* ä»£è¡¨ä½¿ç”¨ä¸­çš„å¸³è™Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;gcloud auth list
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/202-fig.1.png&quot; alt=&quot;202-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œç¢ºèªconfigè¨­å®šæœ‰æ²’æœ‰éŒ¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud config list
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœå¸³è™Ÿæˆ–projectæœ‰éŒ¯èª¤ï¼Œå°±ä¿®æ”¹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# ä¿®æ”¹å¸³è™Ÿ
gcloud config set account abc@abc.com
# ä¿®æ”¹project
gcloud config set project project_id
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;ç¢ºèªè¦ä½¿ç”¨å°ˆæ¡ˆçš„contextè¨­å®š&lt;br /&gt;
æŒ‡ä»¤&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;# å–å¾—æ‰€æœ‰clusterè¨­å®š
kubectl config get-contexts
# åˆ‡æ›è¦ä½¿ç”¨çš„cluster
kubectl config use-context [NAME]
# æª¢æŸ¥ç›®å‰ä½¿ç”¨ä¸­çš„cluster
kubectl config current-context
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Docker åˆ‡æ›&lt;br /&gt;
é¸æ“‡ç’°å¢ƒå¾Œæ»‘é¼ é»ä¸€ä¸‹&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/202-fig.2.png&quot; alt=&quot;202-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;å®Œæˆå¾Œï¼Œé‡é–‹ Terminal&lt;br /&gt;
ä¸€å®šè¦é‡é–‹ï¼ï¼ï¼ï¼ä¸ç„¶æœƒåƒé¬¼æ‰“ç‰†ä¸€æ¨£ï¼Œä¸€ç›´è·³éŒ¯èª¤ã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/202-fig.3.png&quot; alt=&quot;202-fig.3.png&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å·®é»éƒ½æƒ³ç›´æ¥ç”¨ &lt;code&gt;gcloud auth revoke &amp;lt;account&amp;gt;&lt;/code&gt; æŠŠå¸³è™Ÿå¼·åˆ¶ç™»å‡ºäº†ã€‚&lt;/p&gt;
&lt;h4 id=&quot;2024-04-11&quot; tabindex=&quot;-1&quot;&gt;2024/04/11&lt;/h4&gt;
&lt;p&gt;è¦åˆ‡å¸³è™Ÿæ™‚ï¼Œterraformåˆæ›äº†ï¼Œä¸€ç›´æç¤ºæˆ‘ç”¨å¦ä¸€å€‹å¸³è™Ÿã€‚&lt;br /&gt;
ä½†ç”¨kubectl æŒ‡ä»¤æ™‚ï¼Œéƒ½æ­£å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;å¾Œä¾†åŸ·è¡Œé€™è¡Œï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcloud auth application-default login
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‡æ–°ç™»å…¥å¾Œæ­£å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.kmp.tw/post/gcloudchangeaccountandproject/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[GCP]gcloudåˆ‡æ›å¸³è™Ÿã€å°ˆæ¡ˆ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sdk/gcloud/reference/auth&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;gcloud auth&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/202. GCPå¤šå¸³è™Ÿåˆ‡æ›/" />
        </entry>
        <entry>
            <title>
                201. kustomize patch
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/201. kustomize patch/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ‡¶ç™Œç™¼ä½œï¼Œè¦éƒ¨ç½²æ–°ç’°å¢ƒæ™‚ï¼Œ&lt;br /&gt;
æƒ³åˆ°æ¯å€‹deploymentè¦ä¸€å€‹ä¸€å€‹æ”¹ï¼Œå°±å¥½æ‡¶ã€‚&lt;br /&gt;
è©²æ›æ“¬å‡ºä¾†äº† kustomizeï¼Œ&lt;br /&gt;
kubectl ç¾åœ¨é è¨­å°±æœ‰æ”¯æ´ï¼Œä»¥å‰é‚„è¦å–®ç¨è£æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;æŸ¥çœ‹kustomizeçš„çµæœ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl kustomize ./
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŸ·è¡Œæ–¹å¼&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl apply -k &amp;lt;folder path&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;ä¿®æ”¹æ˜ åƒæª”&quot; tabindex=&quot;-1&quot;&gt;ä¿®æ”¹æ˜ åƒæª”&lt;/h4&gt;
&lt;p&gt;è¦æ³¨æ„å¾—é»æ˜¯ï¼Œ deployment.yaml çš„imageè£é¢çš„æ˜ åƒæª”åç¨±ï¼Œ&lt;br /&gt;
è¦å°æ‡‰åˆ°kustomize.yaml çš„ &lt;a href=&quot;http://images.name/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;images.name&lt;/a&gt;ã€‚&lt;br /&gt;
ä»¥ä¸‹é¢çš„ç¯„ä¾‹ä¾†èªªï¼Œ my-image:1.2.3  å…¶ä¸­my-imageå°±æ˜¯æ˜ åƒæª”åç¨±ï¼Œ&lt;br /&gt;
æ‰€ä»¥åœ¨kustomize.yamlè£é¢çš„image nameè¦å¯« my-image&lt;/p&gt;
&lt;p&gt;deployment.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
spec:
  template:
    spec:
      containers:
      - name: my-container
        image: my-image:1.2.3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;kustomize.yaml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;resources:
- ../../../base
images:
- name: my-image
  newName: my.image.registry/nginx
  newTag: 1.4.0

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/201-fig.1.png&quot; alt=&quot;201-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;ä¿®æ”¹å…¶ä»–æ¬„ä½&quot; tabindex=&quot;-1&quot;&gt;ä¿®æ”¹å…¶ä»–æ¬„ä½&lt;/h4&gt;
&lt;p&gt;é™¤äº†ä¸€èˆ¬èƒ½ä¿®æ”¹çš„æ±è¥¿ï¼Œèƒ½ç”¨ cross-cutting field ä¿®æ”¹ä»¥å¤–ï¼Œ&lt;br /&gt;
å…¶ä»–è¦ä¿®æ”¹åªèƒ½é€épatchçš„æ–¹å¼ã€‚&lt;br /&gt;
å…¶ä¸­ patchesJson6902è·Ÿ patchesStrategicMergeï¼Œ&lt;br /&gt;
ç›®å‰å·²ç¶“è¢«patcheså–ä»£ï¼Œä¹Ÿå°‡æ–¼å¾ŒçºŒç‰ˆæœ¬deprecated.&lt;/p&gt;
&lt;p&gt;ä¸” patchesèƒ½å¤ åœ¨ nameä»¥åŠnamespaceä¸Šä½¿ç”¨regexã€‚&lt;/p&gt;
&lt;p&gt;ref.  &lt;a href=&quot;https://stackoverflow.com/questions/63604579/what-is-the-difference-between-patches-vs-patchesjson6902-in-kustomize&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;What is the difference between patches vs patchesJson6902 in Kustomize&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;cross-cutting åŸºæœ¬æœ‰é€™äº›&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/201-fig.1.png&quot; alt=&quot;201-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸Šé¢æœ‰ç”¨åˆ° cross-cutting çš„åƒæ•¸ï¼Œä¸‹é¢çš„åŸå§‹æª”ï¼Œ&lt;br /&gt;
åªè¦å¯«åŸå§‹çš„å°±å¥½ï¼Œä¸ç”¨å¯«ä¿®æ”¹éçš„åƒæ•¸ã€‚&lt;br /&gt;
ä¾‹å¦‚ namespace åœ¨åŸå§‹çš„deployment.yamlæ˜¯defaultï¼Œ&lt;br /&gt;
ç„¶å¾Œåœ¨ kustomize.yaml è£é¢ ä¿®æ”¹æˆ gameï¼Œ&lt;br /&gt;
é‚£Patchesé‚„æ˜¯å¯«åŸæœ¬çš„defaultã€‚&lt;/p&gt;
&lt;p&gt;Patchesåº•ä¸‹çš„patchï¼Œåªè¦æœ‰ä»¥ä¸‹è³‡è¨Šå³å¯ï¼Œ&lt;br /&gt;
ç„¶å¾Œå°±æ˜¯è¦ä¿®æ”¹çš„è¨­å®šäº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    apiVersion: apps/v1
    kind: Deployment
    metadata:
      name: systemmanageservice
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸‹é¢ç¯„ä¾‹æ˜¯ï¼Œä¿®æ”¹containeråº•ä¸‹çš„envè®Šæ•¸ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;patches:
- target:
    kind: Deployment
    name: systemmanageservice
  patch: |-
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      name: systemmanageservice
    spec:
      template:
        spec:
          containers:
          - name: systemmanageservice
            env:
            - name: ASPNETCORE_ENVIRONMENT
              value: QA
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/zh-cn/docs/tasks/manage-kubernetes-objects/kustomization/#kustomize-feature-list&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Kustomize åŠŸèƒ½ç‰¹æ€§åˆ—è¡¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kubectl.docs.kubernetes.io/zh/api-reference/kustomization/patches/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;patches&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;patches-json6902&quot; tabindex=&quot;-1&quot;&gt;patchesJson6902&lt;/h2&gt;
&lt;p&gt;ä¸Šé¢æœ‰æåˆ°patchesæ˜¯  patchesJson6902 èˆ‡&lt;br /&gt;
patchesStrategicMergeçš„çµåˆã€‚&lt;/p&gt;
&lt;p&gt;æ–¼æ˜¯ patchesä¹Ÿæ”¯æ´ä¸‹é¢é€™ç¨®ç”¨æ³•ã€‚&lt;br /&gt;
ä½¿ç”¨ op ä¾†ä½œæ–°å¢æˆ–å–ä»£ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

patchesJson6902:
- target:
    version: v1
    kind: Deployment
    name: my-deployment
  patch: |-
    - op: add
      path: /some/new/path
      value: value
    - op: replace
      path: /some/existing/path
      value: &amp;quot;new value&amp;quot;    
&lt;/code&gt;&lt;/pre&gt;

            </content>
            <link href="https://daimom.github.io/201. kustomize patch/" />
        </entry>
        <entry>
            <title>
                200. Net core SDKå®‰è£è‡³container
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/200. Net core SDKå®‰è£è‡³container/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å¾Œç«¯ä¹‹å‰ç™¼äº†ä¸€å€‹ç‰ˆæœ¬ä¸Šå»å¾Œï¼Œ&lt;br /&gt;
è¨˜æ†¶é«”å°±ä¸€è·¯å¾€ä¸Šé£†ï¼Œ&lt;br /&gt;
ä»–å€‘ä¹ŸæŸ¥ä¸å‡ºå€‹æ‰€ä»¥ï¼Œ&lt;br /&gt;
å¾Œä¾†å¹«ä»–å€‘æŸ¥ï¼Œæœ‰è«‹ä»–å€‘åŠ å€‹ç¨‹å¼ç¢¼è©¦è©¦ï¼Œçœ‹ä¾†ä¹ŸæˆåŠŸäº†ã€‚&lt;br /&gt;
ä½†ç‚ºäº†ä»¥å¾Œï¼Œé‚„æ˜¯çŸ¥é“ä¸€ä¸‹è¦æ€éº¼æŠ“è¨˜æ†¶é«”çš„ç”¨é‡æ¯”è¼ƒå¥½ï¼Œ&lt;br /&gt;
å°±äº¤çµ¦ä»–å»çœ‹äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-xml&quot;&gt;&amp;lt;PropertyGroup&amp;gt; 
    &amp;lt;ServerGarbageCollection&amp;gt;false&amp;lt;/ServerGarbageCollection&amp;gt;
&amp;lt;/PropertyGroup&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://www.zendei.com/article/38158.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ã€è­¯ã€‘Asp.net coreæ‡‰ç”¨åœ¨ Kubernetesä¸Šè¨˜æ†¶é«”ä½¿ç”¨ç‡éé«˜å•é¡Œåˆ†æ&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä»¥ä¸‹ç‚ºåŒäº‹åŸ·è¡Œçš„æŒ‡ä»¤ï¼Œ&lt;br /&gt;
å¯èƒ½éœ€è¦å…ˆå®‰è£wgetä¹‹é¡çš„æ±è¥¿ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è£ dotnet SDK&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;wget https://dot.net/v1/dotnet-install.sh -O dotnet-install.sh
chmod +x ./dotnet-install.sh
./dotnet-install.sh --version latest
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;åŸ·è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è£å®Œå¾Œï¼Œæœ€å¥½å…ˆç”¨ &lt;code&gt;find / -iname dotnet&lt;/code&gt; ï¼Œ&lt;br /&gt;
æŸ¥ä¸€ä¸‹å®‰è£å¾Œçš„dotnetåœ¨å“ªã€‚&lt;br /&gt;
åŸ·è¡Œçš„æ™‚å€™ï¼Œè¨˜å¾—ç”¨ &lt;code&gt;./dotnet --version&lt;/code&gt; ï¼Œçš„æ–¹å¼åŸ·è¡Œã€‚&lt;br /&gt;
ä¸ç„¶ï¼Œé è¨­æ˜¯ç”¨&lt;code&gt;/usr/bin&lt;/code&gt; è£é¢çš„dotnetåŸ·è¡Œçš„ã€‚&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;
&lt;p&gt;é™¤éŒ¯&lt;/p&gt;
&lt;p&gt;æ²’ç ”ç©¶ï¼Œä½†åŒäº‹æ˜¯åƒè€ƒä¸‹é¢é€™ç¯‡å»å¯¦ä½œã€‚&lt;br /&gt;
åƒè€ƒé€£çµ &lt;a href=&quot;https://developer.samsung.com/tizen/blog/en/2020/07/31/identifying-memory-leaks-with-dotnet-dump-and-dotnet-gcdump&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Identifying Memory Leaks with dotnet-dump and dotnet-gcdump&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://learn.microsoft.com/zh-tw/dotnet/core/install/linux-scripted-manual#scripted-install&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å·²ç·¨å¯«æŒ‡ä»¤ç¢¼çš„å®‰è£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.samsung.com/tizen/blog/en/2020/07/31/identifying-memory-leaks-with-dotnet-dump-and-dotnet-gcdump&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Identifying Memory Leaks with dotnet-dump and dotnet-gcdump&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

            </content>
            <link href="https://daimom.github.io/200. Net core SDKå®‰è£è‡³container/" />
        </entry>
        <entry>
            <title>
                193. Obsidianç™¼ä½ˆåˆ°github.ioå€‹äººç¶²ç«™
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/193. Obsidianç™¼ä½ˆåˆ°github.ioå€‹äººç¶²ç«™/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å‰é™£å­å¼„å¥½äº†Obsidianè‡ªå‹•ç™¼ä½ˆåˆ°&lt;a href=&quot;https://daimom.vercel.app/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;vercel&lt;/a&gt;ï¼Œ&lt;br /&gt;
æˆæœä¹Ÿé‚„ä¸éŒ¯ï¼Œä½†å°±æ˜¯å¶çˆ¾æœ‰é»å•é¡Œï¼Œ&lt;br /&gt;
å› ç‚ºæ˜¯å…è²»ç”¨æˆ¶ï¼Œæ‰€ä»¥æœƒç¢°åˆ°ç„¡æ³•æ›´æ–°ã€‚&lt;br /&gt;
æœ‰å¤©ä¸€æ€’ä¹‹ä¸‹ï¼Œå°±è‡ªå·±æ”¹æˆç”¨githubäº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆå‰é¢é‚„æ˜¯ä¸€æ¨£&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%86%92%20SideProject/160.Obsidian%E7%99%BC%E4%BD%88%E7%B6%B2%E7%AB%99/&quot;&gt;160.Obsidianç™¼ä½ˆç¶²ç«™&lt;/a&gt;ï¼Œ&lt;br /&gt;
æ­¥é©Ÿè¦å…ˆè¨­å®šå¥½å¾Obsidiantå‚³åˆ°ä½ çš„githubã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/193-fig.1.png&quot; alt=&quot;193-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç•¶ä½ åœ¨Obsidiané¸æ“‡publishæ™‚ï¼Œæœƒå°‡å…§å®¹å‚³åˆ°public_vercel é€™å€‹repositoryã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/193-fig.2.jpg&quot; alt=&quot;193-fig.2.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæ¥ä¸‹ä¾†çš„æµç¨‹æ˜¯ï¼Œåœ¨public_vercel ä½¿ç”¨github actionï¼Œ&lt;br /&gt;
å°‡obsidiançš„å…§å®¹ç·¨è­¯æˆhtmlï¼Œå†è½‰åˆ°githubçš„ç¶²ç«™ä¸Šé¢ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;åˆ°githubå»ºç«‹å€‹äººç¶²é &lt;br /&gt;
åˆ°githubï¼Œå»ºç«‹ä¸€å€‹è‡ªå·±ä½¿ç”¨è€…çš„å­ç¶²åŸŸï¼Œ&lt;br /&gt;
repositoryçš„åç¨±æœƒæ˜¯ &lt;code&gt;user.github.io&lt;/code&gt; é€™ç¨®åç¨±ï¼Œ&lt;br /&gt;
åªæœ‰&lt;code&gt;user&lt;/code&gt;é€™å€‹å­—å¯ä»¥æ”¹ã€‚&lt;br /&gt;
å»ºç«‹å®Œå¾Œï¼Œå¯ä»¥å…ˆå¼„å€‹index.htmlåˆ°githubè£é¢ï¼Œ&lt;br /&gt;
ç„¶å¾Œè¨ªå•å‰›å‰›å»ºç«‹çš„ç¶²å€ï¼Œ&lt;br /&gt;
æˆ‘å»ºç«‹çš„åç¨±ç‚º&lt;code&gt;daimom.github.io&lt;/code&gt;&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/193-fig.3.jpg&quot; alt=&quot;193-fig.3.jpg&quot; /&gt;&lt;br /&gt;
æ‰€ä»¥ç¶²å€å°±æ˜¯ &lt;a href=&quot;https://daimom.github.io/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;daimom.github.io&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://pages.github.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;github_page&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å°‡npmè½‰æˆpnpm&lt;br /&gt;
å…¶å¯¦é€™ä¸€æ­¥ä¹Ÿå¯ä»¥ä¸åšï¼Œ&lt;br /&gt;
é‚£å°±æ˜¯å¯«github actionçš„æ™‚å€™ï¼Œä¸èƒ½ç”¨pnpmåªèƒ½ç”¨npmï¼Œ&lt;br /&gt;
ç¨‹å¼æ‡‰è©²ä¹Ÿè¦å°æ”¹ä¸€ä¸‹ï¼Œ&lt;br /&gt;
ä½†pnpmæœƒæ¯”è¼ƒå¿«ï¼Œæˆ‘å°±é †ä¾¿æ”¹ä¸€æ”¹äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åˆ° public_vercelçš„è³‡æ–™å¤¾åº•ä¸‹ï¼ŒåŸ·è¡Œä¸‹é¢ä¸‰è¡Œï¼Œåƒè€ƒ&lt;a href=&quot;https://booop.net/migrate-from-npm-to-pnpm/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å¾ npm é·ç§»åˆ° pnpm&lt;/a&gt;ï¼Œ&lt;br /&gt;
æœ‰äº›æ­¥é©Ÿæˆ‘æ¸¬è©¦æ˜¯ä¸éœ€è¦ï¼Œ&lt;br /&gt;
é‡é»æ˜¯ &lt;code&gt;pnpm import&lt;/code&gt;ï¼Œè¦å°‡&lt;code&gt;package-lock.json&lt;/code&gt; è½‰æˆ &lt;code&gt;pnpm-lock.yaml&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# åˆªé™¤npm package
rm -rf node_modules 
# å®‰è£pnpm
npm install -g pnpm
# è½‰æ›ç›¸é—œæª”æ¡ˆ
pnpm import
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®Œæˆå¾Œï¼Œä¸Šå‚³åˆ°githubã€‚&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;å»ºç«‹github action&lt;br /&gt;
è³‡æ–™å¤¾çµæ§‹å¦‚ä¸‹&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/193-fig.4.jpg&quot; alt=&quot;193-fig.4.jpg&quot; /&gt;&lt;br /&gt;
èƒ½æ”¹æª”æ¡ˆåç¨±çš„åªæœ‰&lt;code&gt;build-site.yaml&lt;/code&gt;ä»¥åŠ &lt;code&gt;install-pnpm&lt;/code&gt;ï¼Œ&lt;br /&gt;
ä½†å¾Œè€…è¦æ”¹çš„è©±ï¼Œç¨‹å¼å…§å®¹ä¹Ÿéœ€è¦æ”¹ï¼Œä¸ç†Ÿçš„è©±ä¸å»ºè­°æ›´æ”¹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;build-site.yamlçš„ç¨‹å¼å¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;name: &#39;Build Sites&#39;

on:
  workflow_dispatch:
    inputs:
      deployment-version:
        description: æŒ‡å®šç‰ˆæœ¬
        required: false
  schedule:
    - cron: &#39;0 10 * * *&#39;
jobs:
  build-site-test:
    runs-on: ubuntu-latest
    steps:
      # [Checkout]
      - name: Checkout code repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # [åŸ·è¡Œè…³æœ¬] æ§‹å»º pnpm åŠ Node ç’°å¢ƒ
      - name: &#39;[Macro] Prepare environment&#39;
        uses: ./.github/actions/install-pnpm

      # [åŸ·è¡Œè…³æœ¬] æ§‹å»ºhtml
      - name: &#39;[Macro] Build sites &#39;
        shell: bash
        run: pnpm build

      - name: Push to HTML Repository
        run: |
          git config --global user.email $
          git config --global user.name &amp;quot;daimom&amp;quot;
          git config --list
          git clone https://$@github.com/daimom/daimom.github.io.git temp-html-repo
          cp -r dist/. temp-html-repo/
          
          cd temp-html-repo
          git add .
          git commit -m &amp;quot;Update from Build Repository&amp;quot;
          git remote -v
          git push origin main

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;install-pnpm/action.yamlçš„ç¨‹å¼å¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;name: &#39;prepare&#39;
description: &#39;Prepare environment&#39;

runs:
  using: &#39;composite&#39;
  steps:
    - name: Setup pnpm
      uses: pnpm/action-setup@v2
      with:
        version: 8
    - name: Setup node.js
      uses: actions/setup-node@v4
      with:
        node-version: 20
        cache: &#39;pnpm&#39;

    - name: Install dependencies
      shell: bash
      run: pnpm install

&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&quot;ç°¡æ˜“èªªæ˜&quot; tabindex=&quot;-1&quot;&gt;ç°¡æ˜“èªªæ˜&lt;/h5&gt;
&lt;p&gt;é€™é‚Šçš„è¨­å®šæ˜¯æ¯å¤©çš„UTC 10:00 åŸ·è¡Œä¸€æ¬¡ï¼Œ&lt;br /&gt;
å¦‚æœè¦è‡ªå®šæ™‚é–“çš„è©±ï¼Œå¯ä»¥åƒè€ƒ&lt;a href=&quot;https://crontab.informaship.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;CrontabÂ ä¸­æ–‡ç·šä¸ŠÂ ç·¨è¼¯å™¨&lt;/a&gt;&lt;br /&gt;
æ¸¬è©¦çš„æ™‚å€™å¯ä»¥å…ˆæŠŠ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  schedule:
    - cron: &#39;0 10 * * *&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ”¹æˆ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;push:
  branches:
	- &#39;main&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€™æ¨£åªè¦æ¨ä¸Šå»mainå°±æœƒè§¸ç™¼å‹•ä½œäº†(æ³¨æ„æ’ç‰ˆ)ã€‚&lt;/p&gt;
&lt;p&gt;ref. &lt;a href=&quot;https://gugod.org/2021/02/run-twitter-bot-with-github-actions/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä»¥ GitHub Action ä¾†ç™¼æ¨æ–‡&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ–è€…æ˜¯ç›´æ¥æ‰‹å‹•éƒ¨ç½²ï¼Œ&lt;br /&gt;
åœ¨public_vercelçš„github actioné¸æ“‡ä½ çš„Action ï¼Œå†é¸ Run workflow&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/193-fig.6.jpg&quot; alt=&quot;193-fig.6.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç¨‹å¼è£é¢çš„ &lt;code&gt;$ &lt;/code&gt; æ˜¯è¦åˆ°repositoryè£é¢è¨­å®šã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/193-fig.5.jpg&quot; alt=&quot;193-fig.5.jpg&quot; /&gt;&lt;br /&gt;
ä¹Ÿå¯ä»¥ç›´æ¥è¼¸å…¥ä½ çš„emailï¼Œåæ­£emailé€™æ±è¥¿æ‡‰è©²å·²ç¶“...ã€‚&lt;br /&gt;
ä½†é‡é»æ˜¯åº•ä¸‹çš„ &lt;code&gt;$&lt;/code&gt; ï¼Œ&lt;br /&gt;
é€™å€‹ä¸€å®šè¦ç”¨secretéš±è—ï¼Œè€Œä¸”ä¸èƒ½å¤–æµã€‚&lt;br /&gt;
ç”¢ç”Ÿçš„æ–¹å¼ï¼Œè©³é–±ï¼Œ &lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%86%92%20SideProject/160.Obsidian%E7%99%BC%E4%BD%88%E7%B6%B2%E7%AB%99/#github-token&quot;&gt;160.Obsidianç™¼ä½ˆç¶²ç«™#å»ºç«‹github token&lt;/a&gt;&lt;br /&gt;
å†ä¾†å°‡ç”¢ç”Ÿçš„tokenï¼Œæ–°å¢åˆ°sercretè£é¢ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.github.com/zh/actions&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;GitHub Actions æ–‡ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;internal-link&quot; data-note-icon=&quot;&quot; href=&quot;https://daimom.github.io/%F0%9F%92%BB%20Code/110.github%20action%20pipeline%E7%AD%86%E8%A8%98/&quot;&gt;110.github action pipelineç­†è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/193. Obsidianç™¼ä½ˆåˆ°github.ioå€‹äººç¶²ç«™/" />
        </entry>
        <entry>
            <title>
                191. Steam deckå®‰è£é™¤éŒ¯è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/191. Steam deckå®‰è£é™¤éŒ¯è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å¥½ä¹…æ²’è²·è–èª•ç¦®ç‰©äº†ï¼Œ&lt;br /&gt;
å‰é™£å­åˆæœ‰äººèªªsteam deck oledå¾ˆæ¨ï¼Œ&lt;br /&gt;
çœ‹äº†å¹¾æ¬¡éƒ½æ²’ç¾è²¨ï¼Œ&lt;br /&gt;
ä¸Šé€±äº”ï¼Œå‰›å¥½å–µåˆ°pchomeæœ‰è²¨ï¼Œä¸‹è¨‚éš”å¤©åˆ°ã€‚&lt;br /&gt;
ç¦®æ‹œå…­åƒå–œé…’ï¼Œåˆé€›äº†ä¸€ä¸‹lalaportï¼Œ&lt;br /&gt;
ç¦®æ‹œå¤©ä¸­åˆè·Ÿæœ‹å‹åƒé£¯ï¼Œæ‰é–‹å§‹å‹•å·¥ï¼Œ&lt;br /&gt;
ç„¶å¾Œå°±æ˜¯ä¸€æ•´å€‹è¸©å‘è¨˜ã€‚&lt;/p&gt;
&lt;p&gt;ç¦®æ‹œå¤©é–‹å§‹å®‰è£ï¼Œç¬¬ä¸€æ¬¡æsteamä¸€å †å•é¡Œã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&quot;1&quot; tabindex=&quot;-1&quot;&gt;å®‰è£æ™‚ï¼Œä¸€ç›´å¡åœ¨å®‰è£å‰©é¤˜1ç§’&lt;/h3&gt;
&lt;p&gt;æˆ‘è©¦äº†å¹¾ç¨®æ–¹æ³•ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é‡é–‹æ©Ÿï¼ˆæ²’ç”¨ï¼‰ï¼Œé‡é–‹äº†äº”å…­æ¬¡ï¼Œé‚„æ˜¯å¡ä½&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çœ‹&lt;a href=&quot;https://www.reddit.com/r/SteamDeck/comments/t4x2q6/steamdeck_setup_stuck_at_1_second_remaining_for/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;redit&lt;/a&gt;èªª ä¸è¦é€£2.4gçš„wifiï¼Œé‡é–‹æ©Ÿå®‰è£ï¼Œä¸€æ¨£å¡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸æ–·é—œé–‰wifiå¾Œï¼Œé‡é€£æˆ‘ä¹Ÿè©¦éï¼Œæ²’ç”¨(è¨­å®šé–‹é—œåœ¨å³ä¸‹æ–¹çš„é‚£ä¸‰å€‹é»ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœ€å¾Œæ”¹é€£æ‰‹æ©Ÿçš„ç†±é»åˆ†äº«ï¼Œçµ‚æ–¼éäº†&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;å¤–æ›æ¨è–¦(ä¸è£ä¹Ÿå¯ä»¥ï¼‰&quot; tabindex=&quot;-1&quot;&gt;å¤–æ›æ¨è–¦(ä¸è£ä¹Ÿå¯ä»¥ï¼‰&lt;/h3&gt;
&lt;p&gt;ç›®å‰çœ‹åˆ°çš„éƒ½æ˜¯ä¸€äº›æ¯”è¼ƒå€‹äººåŒ–çš„æ±è¥¿ï¼Œ&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯èƒ½æˆ‘éŠæˆ²ç©ä¸å¤šï¼Œ&lt;/p&gt;
&lt;p&gt;ä¹‹å‰ä¸»è¦éƒ½åœ¨ç©p4&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥å…ˆå®‰è£Â &lt;a href=&quot;https://github.com/SteamDeckHomebrew/decky-loader&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Decky loader&lt;/a&gt;ï¼Œå¯ä»¥åƒè€ƒ ç‰ˆä¸Šçš„Â &lt;a href=&quot;https://forum.gamer.com.tw/C.php?bsn=60599&amp;amp;snA=39936&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;é€™ç¯‡&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆæ¡Œé¢æ¨¡å¼ï¼ŒæŒ‰å·¦ä¸‹çš„steamæŒ‰éˆ•-&amp;gt;é›»æº-&amp;gt;åˆ‡æ›è‡³æ¡Œé¢ï¼‰&lt;/p&gt;
&lt;p&gt;ï¼ˆæ²’å¤–æ¥éµç›¤çš„è©±ï¼Œéœ€æŒ‰ä¸‹ steamæŒ‰éˆ•+X ï¼Œé–‹å•“è¢å¹•å°éµç›¤)&lt;/p&gt;
&lt;p&gt;å‰é¢çš„è¨­å®šå…ˆæ”¹å¥½ï¼Œå¾Œé¢å®‰è£ä¸éœ€è¦è¼¸å…¥æŒ‡ä»¤ï¼Œåœ¨&lt;a href=&quot;https://github.com/SteamDeckHomebrew/decky-loader&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ç¶²ç«™&lt;/a&gt;ä¸Šé»æ“Šå³å¯ä¸‹è¼‰ï¼Œ&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œå°ç€ä¸‹è¼‰ä¸‹ä¾†çš„æª”æ¡ˆï¼Œé»å…©ä¸‹å®‰è£ï¼Œ&lt;/p&gt;
&lt;p&gt;æœ€å¾Œå¾æ¡Œé¢ä¸Šçš„ åœ–ç¤ºï¼Œå›åˆ°æŒæ©Ÿç•«é¢ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰æˆ‘è£çš„æœ‰&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Bluetooth ï¼š æ“šèªªæ˜¯èƒ½è®“è—ç‰™è€³æ©Ÿè‡ªå‹•é€£ç·š&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Animation Changerï¼šé—œæ©Ÿ(é•·æŒ‰é›»æºï¼‰ã€æš«åœï¼ˆçŸ­æŒ‰é›»æºï¼‰çš„ç•«é¢ä¿®æ”¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ProtonDB Badgesï¼šåˆ¤æ–·éŠæˆ²åœ¨è£ç½®ä¸Šçš„å¯ç©æ€§&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SteamGridDBï¼šä¿®æ”¹æŒæ©Ÿæ¨¡å¼ä¸‹éŠæˆ²çš„åœ–ç‰‡ï¼Œè£é€™å€‹æ˜¯æŒæ©Ÿæ¨¡å¼ä¸‹çš„Chromeæ²’åœ–æ¡ˆçœŸçš„å¤ªé†œäº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CSS-Loaderï¼šæ¡Œé¢ä½ˆæ™¯ï¼Œå¯ä»¥åˆ°&lt;a href=&quot;https://deckthemes.com/themes?filters=&amp;amp;order=Most+Downloaded&amp;amp;type=CSS&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;å®˜ç¶²&lt;/a&gt;çœ‹æœ‰å“ªäº›&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;animation-changer&quot; tabindex=&quot;-1&quot;&gt;Animation Changer ï¼Œå½±ç‰‡æ”¾å¤§&lt;/h4&gt;
&lt;p&gt;å®‰è£CSS-Loaderï¼Œç„¶å¾Œæœå°‹Â Â Full Suspend ï¼Œå®‰è£å®Œå¾Œå³å¯ã€‚&lt;/p&gt;
&lt;h4 id=&quot;è£œä¸å®‰è£&quot; tabindex=&quot;-1&quot;&gt;è£œä¸å®‰è£&lt;/h4&gt;
&lt;p&gt;å‰é¢æ­¥é©Ÿï¼Œè«‹çœ‹é€™ä¸€ç¯‡&lt;a href=&quot;https://forum.gamer.com.tw/C.php?bsn=60599&amp;amp;snA=40118&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;steam deckå¤æ—¥ç‹‚æƒ³æ›²ä¸­æ–‡18+è£œä¸&lt;/a&gt;ï¼Œå¦‚æœä½ bottleç„¡æ³•å»ºç«‹çš„è©±å†å›ä¾†ã€‚&lt;/p&gt;
&lt;p&gt;åŒäº‹ä¸€ç›´æ¨å‘æˆ‘å¤æ—¥ç‹‚æƒ³æ›²ï¼Œç„¶å¾Œbottleçš„bottlesç„¡æ³•å»ºç«‹ï¼Œä¸€ç›´å¡åœ¨Arial fontçš„å­—é«”å®‰è£å¤±æ•—ï¼Œ&lt;/p&gt;
&lt;p&gt;æŸ¥&lt;a href=&quot;https://steamcommunity.com/sharedfiles/filedetails/?id=2802396237&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;åŸæ–‡&lt;/a&gt;æœ‰äººæ¨è–¦ç”¨Q4wineï¼Œå°±è©¦è©¦çœ‹äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†åœ¨flatseléœ€å°‡Q4wineåº•ä¸‹çš„Filesystemä¸­çš„All system filesæ‰“é–‹ï¼Œ&lt;/p&gt;
&lt;p&gt;å®‰è£æ™‚æ‰èƒ½å¤ è®€å–åˆ°&lt;a href=&quot;https://forum.gamer.com.tw/C.php?bsn=60599&amp;amp;snA=40118&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;steam deckå¤æ—¥ç‹‚æƒ³æ›²ä¸­æ–‡18+è£œä¸&lt;/a&gt;Â é€™é‚Šèªªçš„&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Z:&#92;home&#92;deck&#92;Summer Memories
&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;é¡å¤–è£œå……&quot; tabindex=&quot;-1&quot;&gt;é¡å¤–è£œå……&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.protondb.com/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;protonDB&lt;/a&gt;Â ï¼šæŸ¥éŠæˆ²ç›¸å®¹æ€§çš„ç¶²ç«™ï¼Œä¸åŒçç‰Œä»£è¡¨çš„æ„æ€&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç™½é‡‘ï¼šå®Œç¾åŸ·è¡Œã€‚&lt;br /&gt;
é‡‘ï¼šèª¿æ•´å¾Œå®Œç¾åŸ·è¡Œã€‚&lt;br /&gt;
éŠ€ï¼šæœ‰å°å•é¡Œï¼Œä½†å¯ç©ã€‚&lt;br /&gt;
éŠ…ï¼šå¯ç©ï¼Œä½†ç¶“å¸¸é‡åˆ°éŠæˆ²å´©æ½°ç­‰å•é¡Œã€‚&lt;br /&gt;
ç„¡æ³•åŸ·è¡Œï¼šå¦‚é¡Œã€‚&lt;/p&gt;
&lt;h4 id=&quot;oled&quot; tabindex=&quot;-1&quot;&gt;Oledç‡ˆè™Ÿé–ƒçˆæ„æ€&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç‹€æ…‹&lt;/th&gt;
&lt;th&gt;èªªæ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ä¸‰é–ƒç´…ç‡ˆ&lt;/td&gt;
&lt;td&gt;é›»æ± é›»åŠ›ä¸è¶³ç„¡æ³•é–‹æ©Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å•Ÿå‹•ä¸­(ç¶ ç‡ˆ)&lt;/td&gt;
&lt;td&gt;ä¸»æ©Ÿåœ¨PSUé€£æ¥ç‹€æ…‹ä¸”é›»æ± å·²ç¶“å……æ»¿&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å•Ÿå‹•ä¸­(ç™½ç‡ˆ)&lt;/td&gt;
&lt;td&gt;ä¸»æ©Ÿåœ¨PSUé€£æ¥ç‹€æ…‹ä¸”å……é›»åŠŸç‡èˆ‡PDå”å®šæœ‰æˆåŠŸè¾¨è­˜ä¸¦åœ¨é›»é‡é”åˆ°è§¸ç™¼é–¾å€¼å¾Œé€²å…¥æ—è·¯å……é›»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å•Ÿå‹•ä¸­(æ©˜ç‡ˆ)&lt;/td&gt;
&lt;td&gt;ä¸»æ©Ÿåœ¨PSUé€£æ¥ç‹€æ…‹ä¸”å……é›»åŠŸç‡ä¸è¶³æˆ–PDå”å®šç„¡æ³•è¾¨è­˜,ç°¡å–®èªªå°±æ˜¯ä»¥ä½åŠŸç‡å……é›»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å•Ÿå‹•ä¸­(ç´…ç‡ˆ)&lt;/td&gt;
&lt;td&gt;åµæ¸¬åˆ°ä¸»æ©Ÿæº«åº¦é«˜æ–¼95åº¦C,ç„¡æ³•é–‹æ©Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å‘¼å¸ç™½ç‡ˆ&lt;/td&gt;
&lt;td&gt;ä¸»æ©Ÿé–‹æ©Ÿä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å‘¼å¸è—ç‡ˆ&lt;/td&gt;
&lt;td&gt;ä¸»æ©Ÿæ›´æ–°éŸŒé«”æˆ–ç³»çµ±ä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç„¡äº®ç‡ˆ&lt;/td&gt;
&lt;td&gt;ä¸»æ©Ÿé—œæ©Ÿ,ä¸”æ²’æœ‰åµæ¸¬åˆ°PSUé€£æ¥&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a href=&quot;https://steamdb.info/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;steamdb&lt;/a&gt;ï¼šæŸ¥éŠæˆ²ç‰¹åƒ¹æ­·å²åƒ¹æ ¼&lt;/p&gt;
&lt;h4 id=&quot;sudo&quot; tabindex=&quot;-1&quot;&gt;é‡ç½®sudo å¯†ç¢¼&lt;/h4&gt;
&lt;p&gt;å¦‚æœä½ å¿˜è¨˜å¯†ç¢¼ï¼ˆå› çˆ²æˆ‘å°±å¿˜äº†ï¼‰ï¼Œ&lt;/p&gt;
&lt;p&gt;åªå‰©ä¸‹é‡åˆ·é€™ä¸€æ¢è·¯äº†ã€‚&lt;/p&gt;
&lt;p&gt;å°‡steam decké—œæ©Ÿï¼ŒæŒ‰ä½å³ä¸‹æ–¹çš„ã€...ã€èˆ‡é–‹æ©ŸæŒ‰éˆ•é–‹æ©Ÿï¼Œ&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œæ¸…é™¤è³‡æ–™å§ã€‚&lt;/p&gt;
&lt;h3 id=&quot;çµ„åˆéµ&quot; tabindex=&quot;-1&quot;&gt;çµ„åˆéµ&lt;/h3&gt;
&lt;p&gt;é•·æŒ‰SteamæŒ‰éˆ•ï¼Œæœ‰å¿«é€Ÿéµåˆ—è¡¨&lt;/p&gt;
&lt;p&gt;steam + R1 ï¼š æˆªåœ–&lt;/p&gt;
&lt;p&gt;steam +X ï¼š é–‹å•“è¢å¹•éµç›¤&lt;/p&gt;
&lt;p&gt;ã€ ... ã€+é¡æ¯”ä¸Šä¸‹ï¼šèª¿æ•´è¢å¹•äº®åº¦&lt;/p&gt;
&lt;p&gt;ã€ ... ã€+é›»æºï¼šÂ Recovery Manager&lt;/p&gt;
&lt;p&gt;éŸ³é‡ã€ - ã€+é›»æº ï¼šBoot Manager&lt;/p&gt;
&lt;p&gt;éŸ³é‡ã€ + ã€+é›»æºÂ Â ï¼šBiOS&lt;/p&gt;
&lt;h3 id=&quot;é…ä»¶&quot; tabindex=&quot;-1&quot;&gt;é…ä»¶&lt;/h3&gt;
&lt;p&gt;æœªä¾†æ‡‰è©²å†ä¾†ä¸‹é¢å¹¾å€‹æ±è¥¿ï¼Œå†è§€å¯Ÿçœ‹çœ‹éœ€ä¸éœ€è¦äº†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;tomtoc  Steam Deckç¡¬æ®¼æ”¶ç´åŒ… ï¼šçœ‹èµ·ä¾†è·Ÿsteam deckå¾ˆåˆ&lt;/li&gt;
&lt;li&gt;Innergie C6 Duo 63ç“¦ USB-C é›™å­”ï¼šè‡ºé”çš„å……é›»å™¨ï¼Œç¾åœ¨æœ‰ä¸€å€‹å–®å­”çš„ï¼Œä½†æœ‰æ™‚è¦æ‹”ä¾†æ‹”å»ä¸æ–¹ä¾¿ã€‚&lt;/li&gt;
&lt;li&gt;type c hubï¼šæ„Ÿè¦ºé‚„æ˜¯é —éœ€è¦ï¼Œå¦‚æœè¦ç”¨æ¡Œé¢æ¨¡å¼æ¥éµç›¤ã€æ»‘é¼ æˆ–å¤–æ¥è¢å¹•çš„è©±ï¼Œé€™å€‹è¦å†æ‰¾æ‰¾çœ‹äº†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;ç›®å‰æ‡‰è©²å°±é€™æ¨£ï¼Œ&lt;/p&gt;
&lt;p&gt;å‰©ä¸‹çš„ç­‰æœ‰ç¢°åˆ°å†ç ”ç©¶ã€‚&lt;/p&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://forum.gamer.com.tw/C.php?page=1&amp;amp;bsn=60599&amp;amp;snA=39919&amp;amp;tnum=460&amp;amp;bPage=2&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Steam Deck å¤§æ¨“ï¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.reddit.com/r/SteamDeck/comments/yb96pf/suspend_animations_are_extremely_small_using_deck/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;Suspend animations are extremely small using Deck Loader&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.ptt.cc/bbs/Steam/M.1672478420.A.6FC.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[é–’èŠ] SteamDeckå…©å‘¨å¿ƒå¾—(é…ä»¶ã€èª¿æ ¡ã€å¥—ä»¶)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/191. Steam deckå®‰è£é™¤éŒ¯è¨˜/" />
        </entry>
        <entry>
            <title>
                159. RBACç­†è¨˜
                
            </title>
            <updated>2025-07-08T10:28:05Z</updated>
            <id>https://daimom.github.io/159. RBACç­†è¨˜/</id>
            <content type="html">
                &lt;h1 id=&quot;å‰è¨€&quot; tabindex=&quot;-1&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;RBACé€™æ±è¥¿å¾ˆä¹…å‰å°±çŸ¥é“äº†ï¼Œä½†ä¸€ç›´æ²’å¯¦éš›å»é©—è­‰éã€‚&lt;br /&gt;
æœ€è¿‘çœ‹istio ambientï¼Œçœ‹åˆ°ä»–ç”¨L4çš„æ–¹å¼ç®¡ç†SAè§’è‰²èª°å¯ä»¥å‘¼å«èª°ï¼Œ&lt;br /&gt;
æ‰åˆè·‘å»èªçœŸçœ‹äº†ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ­£æ–‡&quot; tabindex=&quot;-1&quot;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;p&gt;ä¸€å€‹æ¨™æº–çš„Roleé€šå¸¸é•·å¾—åƒé€™æ¨£&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: default
  name: pod-reader
rules:
- apiGroups: [&amp;quot;&amp;quot;] # &amp;quot;&amp;quot; æ¨™æ˜ core API çµ„
  resources: [&amp;quot;volumesnapshots&amp;quot;]
  verbs: [&amp;quot;get&amp;quot;, &amp;quot;watch&amp;quot;, &amp;quot;list&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;rules åˆ†æˆä¸‹é¢ä¸‰å€‹éƒ¨åˆ†&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦æœ€é«˜æ¬Šé™çš„è©±å°±æ˜¯ç”¨ &lt;code&gt;*&lt;/code&gt; ä»£æ›¿ï¼Œ&lt;br /&gt;
ä½†åˆ‡è¨˜å‹¿äº‚ç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&quot;api-groups&quot; tabindex=&quot;-1&quot;&gt;apiGroups&lt;/h3&gt;
&lt;p&gt;apiGroupsæ¯å€‹è³‡æºåç¨±æ‰€ä»£è¡¨çš„apiGroupséƒ½ä¸ä¸€æ¨£ã€‚&lt;br /&gt;
åŸ·è¡Œ &lt;code&gt;kubectl api-resources&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/159-fig.2.png&quot; alt=&quot;159-fig.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è§€å¯ŸAPIVERSIONçš„æ¬„ä½ï¼Œ&lt;br /&gt;
åƒ &lt;code&gt;bindings&lt;/code&gt;çš„APIVERSION æ˜¯ &lt;code&gt;v1&lt;/code&gt; çš„è©±ä»£è¡¨æ˜¯æ ¸å¿ƒï¼Œæ‰€ä»¥ &lt;code&gt;apiGroups: [&amp;quot;&amp;quot;]&lt;/code&gt;&lt;br /&gt;
è€Œ&lt;code&gt;allowlistedworkloads&lt;/code&gt;çš„APIVERSIONæ˜¯&lt;code&gt;auto.gke.io/v1&lt;/code&gt;ï¼Œæ‰€ä»¥&lt;code&gt;apiGroups: [&amp;quot;auto.gke.io&amp;quot;]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;p.s namespaceä»£è¡¨é€™å€‹resourceæ˜¯ä¸æ˜¯å…¨åŸŸè³‡æºï¼Œéœ€ä¸éœ€è¦æŒ‡å®šnamespaceä¾†ä½¿ç”¨&lt;/p&gt;
&lt;h3 id=&quot;resources&quot; tabindex=&quot;-1&quot;&gt;resources&lt;/h3&gt;
&lt;p&gt;ä¸Šé¢æœ‰æåˆ°æ¯å€‹resourceæœ‰æŒ‡å®šçš„APIGroupsï¼Œ&lt;br /&gt;
é€™é‚Šå°±æ¯”è¼ƒç°¡å–®ï¼Œåªè¦å°‡ä¸Šé¢æŒ‡ä»¤æŸ¥åˆ°çš„NAMEæ‹¿ä¾†ç”¨å°±å¥½ã€‚&lt;br /&gt;
æ³¨æ„ï¼Œä¸æ˜¯å¾Œé¢çš„kindã€‚&lt;/p&gt;
&lt;h3 id=&quot;verb&quot; tabindex=&quot;-1&quot;&gt;verb&lt;/h3&gt;
&lt;p&gt;æŸ¥è©¢æ‰€æœ‰çš„resouce&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-yaml&quot;&gt;kubectl api-resources --sort-by name -o wide
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨ä½ è¦é¸æ“‡çš„è³‡æºå…§ï¼Œç”¨&lt;code&gt;[ ]&lt;/code&gt; åŒ…èµ·ä¾†çš„è¡¨ç¤ºç‚ºæ­¤resouceçš„å¯ä»¥æ¥å—å“ªäº›å‹•ä½œã€‚&lt;br /&gt;
&lt;img src=&quot;https://daimom.github.io/img/user/159-fig.0.jpg&quot; alt=&quot;159-fig.0.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åœ¨K8sè£é¢é€éRBACç®¡ç†é€™å€‹è§’è‰²å¯ä»¥å°é€™å€‹resouceåšä»€éº¼ï¼Œ&lt;br /&gt;
å°ç…§è¡¨ï¼Œåƒè€ƒ&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;å‹•ä½œ&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;verb&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;èªªæ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;è®€å–&lt;/td&gt;
&lt;td&gt;&lt;code&gt;get&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å–å¾—å–®ä¸€è³‡æºçš„è©³ç´°è³‡è¨Š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è®€å–&lt;/td&gt;
&lt;td&gt;&lt;code&gt;list&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ—å‡ºè³‡æºæ¸…å–®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è®€å–&lt;/td&gt;
&lt;td&gt;&lt;code&gt;watch&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŒçºŒç›£è½è³‡æºè®ŠåŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¯«å…¥&lt;/td&gt;
&lt;td&gt;&lt;code&gt;create&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å‰µå»ºæ–°è³‡æº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¿®æ”¹&lt;/td&gt;
&lt;td&gt;&lt;code&gt;update&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¿®æ”¹ç¾æœ‰è³‡æº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¿®æ”¹&lt;/td&gt;
&lt;td&gt;&lt;code&gt;patch&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å±€éƒ¨ä¿®æ”¹ (ä½¿ç”¨ &lt;code&gt;kubectl patch&lt;/code&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åˆªé™¤&lt;/td&gt;
&lt;td&gt;&lt;code&gt;delete&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆªé™¤è³‡æº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åˆªé™¤&lt;/td&gt;
&lt;td&gt;&lt;code&gt;deletecollection&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ‰¹é‡åˆªé™¤è³‡æº&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;put èˆ‡ patchçš„å·®åˆ¥åœ¨æ–¼ï¼Œå¦‚æœåªæœ‰å–®ä¸€å€‹è³‡æ–™è¦æ›´æ–°çš„è©±ï¼Œä½¿ç”¨patch ï¼Œæ‰€æœ‰è³‡æ–™éƒ½è¦æ›´æ–°çš„è©±ç”¨put&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ChatGPT&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;çµ±æ•´&quot; tabindex=&quot;-1&quot;&gt;çµ±æ•´&lt;/h3&gt;
&lt;p&gt;è¨­å®šçš„æµç¨‹ï¼Œæœƒå…ˆæŒ‡å®šrole å¯ä»¥å°å“ªäº›è³‡æºåšäº›ä»€éº¼æ“ä½œã€‚&lt;br /&gt;
ç„¶å¾Œä½¿ç”¨rolebindingï¼Œä¾†æŒ‡å®šé€™å€‹roleèˆ‡user/group&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://daimom.github.io/img/user/159-fig.1.png&quot; alt=&quot;159-fig.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è¨­å®šå®Œä½¿ç”¨è€…å¾Œï¼Œè¦ç¶åˆ°deployä¸Šé¢ ï¼Œ&lt;br /&gt;
è¦åœ¨template.specåº•ä¸‹å¯« serviceAccountName&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;template:
  metadata:
    labels:
      app: filebeat
  spec:
    serviceAccountName: filebeat
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;podæœ‰ä½¿ç”¨é€™å€‹saçš„è©±ï¼Œé‚£tokenæœƒåœ¨ä¸‹é¢çš„é€™å€‹ä½ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/var/run/secrets/kubernetes.io/serviceaccount/token
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ref.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://godleon.github.io/blog/Kubernetes/k8s-How-to-access-resource-legally/&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;[Kubernetes] å¦‚ä½•å–å¾—åˆæ³•å¯ç”¨çš„æ¬Šé™ï¼Œè®“ pod èˆ‡ API server æºé€š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[ &lt;a href=&quot;https://www.cnblogs.com/fanfanfanlichun/p/15005427.html&quot; target=&quot;_blank&quot; class=&quot;external-link&quot;&gt;ä¸€æ–‡è®€æ‡‚k8s rbac æ¬Šé™é©—è­‰&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;

            </content>
            <link href="https://daimom.github.io/159. RBACç­†è¨˜/" />
        </entry>
</feed>
